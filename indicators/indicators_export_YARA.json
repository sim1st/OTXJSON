{
	"count": 1151,
	"next": "https://otx.alienvault.com/api/v1/indicators/export?modified_since=2017-01-01T12%3A35%3A00+00%3A00&page=2&types=YARA",
	"results": [
		{
			"indicator": "3acf31a28e3efb829c8810975471369429c6f3cc",
			"description": "",
			"title": "",
			"content": "rule Dropper_Hancitor {\n  meta:\n    authors = \"Nick Hoffman & Jeremy Humble - Morphick Inc.\"\n    last_update = \"2016-08-19\"\n    description = \"rule to find unpacked Hancitor, useful against memory dumps\"\n    hash = \"587a530cc82ff01d6b2d387d9b558299b0eb36e7e2c274cd887caa39fcc47c6f\"\n\n  strings:\n    /*\n    .text:00401C02 83 FA 3A                                      cmp     edx, ':'\n    .text:00401C05 75 6B                                         jnz     short loc_401C72\n    .text:00401C07 B8 01 00 00 00                                mov     eax, 1\n    .text:00401C0C 6B C8 00                                      imul    ecx, eax, 0\n    .text:00401C0F 8B 55 08                                      mov     edx, [ebp+arg_0]\n    .text:00401C12 0F BE 04 0A                                   movsx   eax, byte ptr [edx+ecx]\n    .text:00401C16 83 F8 72                                      cmp     eax, 'r'\n    .text:00401C19 74 50                                         jz      short loc_401C6B\n    .text:00401C1B B9 01 00 00 00                                mov     ecx, 1\n    .text:00401C20 6B D1 00                                      imul    edx, ecx, 0\n    .text:00401C23 8B 45 08                                      mov     eax, [ebp+arg_0]\n    .text:00401C26 0F BE 0C 10                                   movsx   ecx, byte ptr [eax+edx]\n    .text:00401C2A 83 F9 75                                      cmp     ecx, 'u'\n    .text:00401C2D 74 3C                                         jz      short loc_401C6B\n    .text:00401C2F BA 01 00 00 00                                mov     edx, 1\n    .text:00401C34 6B C2 00                                      imul    eax, edx, 0\n    .text:00401C37 8B 4D 08                                      mov     ecx, [ebp+arg_0]\n    .text:00401C3A 0F BE 14 01                                   movsx   edx, byte ptr [ecx+eax]\n    .text:00401C3E 83 FA 64                                      cmp     edx, 'd'\n    .text:00401C41 74 28                                         jz      short loc_401C6B\n    .text:00401C43 B8 01 00 00 00                                mov     eax, 1\n    .text:00401C48 6B C8 00                                      imul    ecx, eax, 0\n    .text:00401C4B 8B 55 08                                      mov     edx, [ebp+arg_0]\n    .text:00401C4E 0F BE 04 0A                                   movsx   eax, byte ptr [edx+ecx]\n    .text:00401C52 83 F8 6C                                      cmp     eax, 'l'\n    .text:00401C55 74 14                                         jz      short loc_401C6B\n    .text:00401C57 B9 01 00 00 00                                mov     ecx, 1\n    .text:00401C5C 6B D1 00                                      imul    edx, ecx, 0\n    .text:00401C5F 8B 45 08                                      mov     eax, [ebp+arg_0]\n    .text:00401C62 0F BE 0C 10                                   movsx   ecx, byte ptr [eax+edx]\n    .text:00401C66 83 F9 6E                                      cmp     ecx, 'n'\n    */\n\n    $arg_parsing = { 83 f? ( 3a | 6c | 64 | 75 | 74 ) 7? ?? b? 01 00 00 00 6b ?? 00 8b ?? 08 0f be 0? ?? }\n\n    /*   \n\n    .text:00401116 B8 01 00 00 00                                mov     eax, 1\n    .text:0040111B 85 C0                                         test    eax, eax\n    .text:0040111D 74 49                                         jz      short loc_401168\n    .text:0040111F 8B 0D 88 5B 40 00                             mov     ecx, dword_405B88\n    .text:00401125 0F BE 11                                      movsx   edx, byte ptr [ecx]\n    .text:00401128 83 FA 7C                                      cmp     edx, '|'\n    .text:0040112B 74 0C                                         jz      short loc_401139\n    .text:0040112D A1 88 5B 40 00                                mov     eax, dword_405B88\n    .text:00401132 0F BE 08                                      movsx   ecx, byte ptr [eax]\n    .text:00401135 85 C9                                         test    ecx, ecx\n    .text:00401137 75 08                                         jnz     short loc_401141\n\n    */\n\n    $pipe_delimit = { b8 01 00 00 00 85 c0 7? ?? 8b 0d ?? ?? ?? ?? 0f be 11 83 fa 7c 7? }\n\n    $fmt_string = \"GUID=%I64u&BUILD=%s&INFO=%s&IP=%s&TYPE=1&WIN=%d.%d(%s)\"\n\n    /*\n\n    .text:00401AEE 83 FA 3C                                      cmp     edx, '<'\n    .text:00401AF1 75 48                                         jnz     short loc_401B3B\n    .text:00401AF3 B8 01 00 00 00                                mov     eax, 1\n    .text:00401AF8 C1 E0 00                                      shl     eax, 0\n    .text:00401AFB 0F BE 8C 05 FC FD FF FF                       movsx   ecx, [ebp+eax+Buffer]\n    .text:00401B03 83 F9 21                                      cmp     ecx, '!'\n    .text:00401B06 75 33                                         jnz     short loc_401B3B\n    .text:00401B08 BA 01 00 00 00                                mov     edx, 1\n    .text:00401B0D D1 E2                                         shl     edx, 1\n    .text:00401B0F 0F BE 84 15 FC FD FF FF                       movsx   eax, [ebp+edx+Buffer]\n    .text:00401B17 83 F8 64                                      cmp     eax, 'd'\n    .text:00401B1A 75 1F                                         jnz     short loc_401B3B\n    .text:00401B1C B9 01 00 00 00                                mov     ecx, 1\n    .text:00401B21 6B D1 03                                      imul    edx, ecx, 3\n    .text:00401B24 0F BE 84 15 FC FD FF FF                       movsx   eax, [ebp+edx+Buffer]\n    .text:00401B2C 83 F8 6F                                      cmp     eax, 'o'\n\n    */\n\n    $connectivty_google_check = { 83 fa 3c 7? ?? b8 01 00 00 00 c1 e0 00 0f be 8c 05 fc fd ff ff 83 f9 21 7? ?? ba 01 00 00 00 d1 e2 0f be 84 15 fc fd ff ff 83 f8 64 7? ?? b9 01 00 00 00 6b d1 03 0f be 84 15 fc fd ff ff 83 f8 6f }\n\n  condition:\n\n    #arg_parsing > 1 or any of ($pipe_delimit, $fmt_string,$connectivty_google_check)\n\n}",
			"type": "YARA",
			"id": 28485364
		},
		{
			"indicator": "1808cc16db658d89625eb33a09989998f479d06e",
			"description": "",
			"title": "",
			"content": "rule AlienSpy   \n   {   \n    strings:   \n    $sa_1 = \"META-INF/MANIFEST.MF\"   \n    $sa_2 = \"Main.classPK\"   \n    $sa_3 = \"plugins/Server.classPK\"   \n    $sa_4 = \"IDPK\"   \n    $sb_1 = \"config.iniPK\"   \n    $sb_2 = \"password.iniPK\"   \n    $sb_3 = \"plugins/Server.classPK\"   \n    $sb_4 = \"LoadStub.classPK\"   \n    $sb_5 = \"LoadStubDecrypted.classPK\"   \n    $sb_7 = \"LoadPassword.classPK\"   \n    $sb_8 = \"DecryptStub.classPK\"   \n    $sb_9 = \"ClassLoaders.classPK\"   \n    $sc_1 = \"config.xml\"   \n    $sc_2 = \"options\"   \n    $sc_3 = \"plugins\"   \n    $sc_4 = \"util\"   \n    $sc_5 = \"util/OSHelper\"   \n    $sc_6 = \"Start.class\"   \n    $sc_7 = \"AlienSpy\"   \n    $sc_8 = \"PK\"   \n    condition:   \n      \n   (all of ($sa_*)) or (all of ($sb_*)) or (all of ($sc_*))   \n   }",
			"type": "YARA",
			"id": 28485371
		},
		{
			"indicator": "f95e54408db7780fca94b010e950c8add68e8deb",
			"description": "",
			"title": "",
			"content": "rule BernhardPOS {   \n      meta:   \n        author = \"Nick Hoffman / Jeremy Humble\"   \n        last_update = \"2015-07-14\"   \n        source = \"Morphick Inc.\"   \n        description = \"BernhardPOS Credit Card dumping tool\"   \n      strings:   \n        /*   \n        33C0        xor    eax, eax   \n        83C014        add    eax, 0x14   \n        83E814        sub    eax, 0x14   \n        64A130000000        mov    eax, dword ptr fs:[0x30]   \n        83C028        add    eax, 0x28   \n        83E828        sub    eax, 0x28   \n        8B400C        mov    eax, dword ptr [eax + 0xc]   \n        83C063        add    eax, 0x63   \n        83E863        sub    eax, 0x63   \n        8B4014        mov    eax, dword ptr [eax + 0x14]   \n        83C078        add    eax, 0x78   \n        83E878        sub    eax, 0x78   \n        8B00        mov    eax, dword ptr [eax]   \n        05DF030000        add    eax, 0x3df   \n        2DDF030000        sub    eax, 0x3df   \n        8B00        mov    eax, dword ptr [eax]   \n        83C057        add    eax, 0x57   \n        83E857        sub    eax, 0x57   \n        8B4010        mov    eax, dword ptr [eax + 0x10]   \n        83C063        add    eax, 0x63   \n        */   \n        $shellcode_kernel32_with_junk_code = { 33 c0 83 ?? ?? 83 ?? ?? 64 a1 30 00 00 00 83 ?? ?? 83 ?? ?? 8b 40 0c 83 ?? ?? 83 ?? ?? 8b 40 14 83 ?? ?? 83 ?? ?? 8b 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 8b 00 83 ?? ?? 83 ?? ?? 8b 40 10 83 ?? ?? }   \n        $mutex_name = \"OPSEC_BERNHARD\"    \n        $build_path = \"C:\\\\bernhard\\\\Debug\\\\bernhard.pdb\"    \n        /*   \n        55        push    ebp   \n        8BEC        mov    ebp, esp   \n        83EC50        sub    esp, 0x50   \n        53        push    ebx   \n        56        push    esi   \n        57        push    edi   \n        A178404100        mov    eax, dword ptr [0x414078]   \n        8945F8        mov    dword ptr [ebp - 8], eax   \n        668B0D7C404100        mov    cx, word ptr [0x41407c]   \n        66894DFC        mov    word ptr [ebp - 4], cx   \n        8A157E404100        mov    dl, byte ptr [0x41407e]   \n        8855FE        mov    byte ptr [ebp - 2], dl   \n        8D45F8        lea    eax, dword ptr [ebp - 8]   \n        50        push    eax   \n        FF150CB04200        call    dword ptr [0x42b00c]   \n        8945F0        mov    dword ptr [ebp - 0x10], eax   \n        C745F400000000        mov    dword ptr [ebp - 0xc], 0   \n        EB09        jmp    0x412864   \n        8B45F4        mov    eax, dword ptr [ebp - 0xc]   \n        83C001        add    eax, 1   \n        8945F4        mov    dword ptr [ebp - 0xc], eax   \n        8B4508        mov    eax, dword ptr [ebp + 8]   \n        50        push    eax   \n        FF150CB04200        call    dword ptr [0x42b00c]   \n        3945F4        cmp    dword ptr [ebp - 0xc], eax   \n        7D21        jge    0x412894   \n        8B4508        mov    eax, dword ptr [ebp + 8]   \n        0345F4        add    eax, dword ptr [ebp - 0xc]   \n        0FBE08        movsx    ecx, byte ptr [eax]   \n        8B45F4        mov    eax, dword ptr [ebp - 0xc]   \n        99        cdq   \n        F77DF0        idiv    dword ptr [ebp - 0x10]   \n        0FBE5415F8        movsx    edx, byte ptr [ebp + edx - 8]   \n        33CA        xor    ecx, edx   \n        8B4508        mov    eax, dword ptr [ebp + 8]   \n        0345F4        add    eax, dword ptr [ebp - 0xc]   \n        8808        mov    byte ptr [eax], cl   \n        EBC7        jmp    0x41285b   \n        5F        pop    edi   \n        5E        pop    esi   \n        5B        pop    ebx   \n        8BE5        mov    esp, ebp   \n        5D        pop    ebp   \n        */   \n        $string_decode_routine = { 55 8b ec 83 ec 50 53 56 57 a1 ?? ?? ?? ?? 89 45 f8 66 8b 0d ?? ?? ?? ?? 66 89 4d fc 8a 15 ?? ?? ?? ?? 88 55 fe 8d 45 f8 50 ff ?? ?? ?? ?? ?? 89 45 f0 c7 45 f4 00 00 00 00 ?? ?? 8b 45 f4 83 c0 01 89 45 f4 8b 45 08 50 ff ?? ?? ?? ?? ?? 39 45 f4 ?? ?? 8b 45 08 03 45 f4 0f be 08 8b 45 f4 99 f7 7d f0 0f be 54 15 f8 33 ca 8b 45 08 03 45 f4 88 08 ?? ?? 5f 5e 5b 8b e5 5d }   \n      condition:   \n        any of them   \n    }",
			"type": "YARA",
			"id": 28518372
		},
		{
			"indicator": "5f6ea719b250c78af9b0228a679f9061ad4f53ca",
			"description": "",
			"title": "",
			"content": "rule malware_red_leaves_generic {\n  meta:\n    author = \"David Cannings\"\n    description = \"Red Leaves malware, related to APT10\"\n\n    // This hash from VT retrohunt, original sample was a memory dump\n    sha256 = \"2e1f902de32b999642bb09e995082c37a024f320c683848edadaf2db8e322c3c\"\n\n  strings:\n    // MiniLZO release date\n    $ = \"Feb 04 2015\"\n    $ = \"I can not start %s\"\n    $ = \"dwConnectPort\" fullword\n    $ = \"dwRemoteLanPort\" fullword\n    $ = \"strRemoteLanAddress\" fullword\n    $ = \"strLocalConnectIp\" fullword\n    $ = \"\\\\\\\\.\\\\pipe\\\\NamePipe_MoreWindows\" wide\n    $ = \"RedLeavesCMDSimulatorMutex\" wide\n    $ = \"(NT %d.%d Build %d)\" wide\n    $ = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E)\" wide\n    $ = \"red_autumnal_leaves_dllmain.dll\" wide ascii\n    $ = \"__data\" wide\n    $ = \"__serial\" wide\n    $ = \"__upt\" wide\n    $ = \"__msgid\" wide\n\n  condition:\n    7 of them\n}",
			"type": "YARA",
			"id": 28546108
		},
		{
			"indicator": "5f3faad50cc56ca2aed3fab74c5d39cedbe3651c",
			"description": "",
			"title": "",
			"content": "rule IronTiger_ChangePort_Toolkit_driversinstall   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cyber Safety Solutions, Trend Micro\"   \n   \t\tdescription = \"Iron Tiger Malware - Changeport Toolkit driverinstall\"   \n   \t\treference = \"http://goo.gl/T5fSJC\"   \n   \tstrings:   \n   \t\t$str1 = \"openmydoor\" nocase wide ascii   \n   \t\t$str2 = \"Install service error\" nocase wide ascii   \n   \t\t$str3 = \"start remove service\" nocase wide ascii   \n   \t\t$str4 = \"NdisVersion\" nocase wide ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and (2 of ($str*))   \n   }",
			"type": "YARA",
			"id": 28546109
		},
		{
			"indicator": "8b8d1a6ea21ae9e4397e6d76b47c31188c789b75",
			"description": "",
			"title": "",
			"content": "rule IronTiger_Gh0stRAT_variant   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cyber Safety Solutions, Trend Micro\"   \n   \t\tdescription = \"This is a detection for a s.exe variant seen in Op. Iron Tiger\"   \n   \t\treference = \"http://goo.gl/T5fSJC\"   \n   \tstrings:   \n   \t\t$str1 = \"Game Over Good Luck By Wind\" nocase wide ascii   \n   \t\t$str2 = \"ReleiceName\" nocase wide ascii   \n   \t\t$str3 = \"jingtisanmenxiachuanxiao.vbs\" nocase wide ascii   \n   \t\t$str4 = \"Winds Update\" nocase wide ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and (any of ($str*))   \n   }",
			"type": "YARA",
			"id": 28546110
		},
		{
			"indicator": "b19f7090445b4677f8a0b106d416bd4799a94b26",
			"description": "",
			"title": "",
			"content": "rule IronTiger_ReadPWD86   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cyber Safety Solutions, Trend Micro\"   \n   \t\tdescription = \"Iron Tiger Malware - ReadPWD86\"   \n   \t\treference = \"http://goo.gl/T5fSJC\"   \n   \tstrings:   \n   \t\t$str1 = \"Fail To Load LSASRV\" nocase wide ascii   \n   \t\t$str2 = \"Fail To Search LSASS Data\" nocase wide ascii   \n   \t\t$str3 = \"User Principal\" nocase wide ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and (all of ($str*))   \n   }",
			"type": "YARA",
			"id": 28546113
		},
		{
			"indicator": "3b59f2b53dd142e8e254736bd9a789cffa7956e0",
			"description": "",
			"title": "",
			"content": "rule IronTiger_GTalk_Trojan   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cyber Safety Solutions, Trend Micro\"   \n   \t\tdescription = \"Iron Tiger Malware - GTalk Trojan\"   \n   \t\treference = \"http://goo.gl/T5fSJC\"   \n   \tstrings:   \n   \t\t$str1 = \"gtalklite.com\" nocase wide ascii   \n   \t\t$str2 = \"computer=%s&lanip=%s&uid=%s&os=%s&data=%s\" nocase wide ascii   \n   \t\t$str3 = \"D13idmAdm\" nocase wide ascii   \n   \t\t$str4 = \"Error: PeekNamedPipe failed with %i\" nocase wide ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and (2 of ($str*))   \n   }",
			"type": "YARA",
			"id": 28546114
		},
		{
			"indicator": "3b3b1761c034172a982a3cdd933efaa6c0e6934b",
			"description": "",
			"title": "",
			"content": "rule IronTiger_NBDDos_Gh0stvariant_dropper   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cyber Safety Solutions, Trend Micro\"   \n   \t\tdescription = \"Iron Tiger Malware - NBDDos Gh0stvariant Dropper\"   \n   \t\treference = \"http://goo.gl/T5fSJC\"   \n   \tstrings:   \n   \t\t$str1 = \"This service can't be stoped.\" nocase wide ascii   \n   \t\t$str2 = \"Provides support for media palyer\" nocase wide ascii   \n   \t\t$str4 = \"CreaetProcess Error\" nocase wide ascii   \n   \t\t$bla1 = \"Kill You\" nocase wide ascii   \n   \t\t$bla2 = \"%4.2f GB\" nocase wide ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and ((any of ($str*)) or (all of ($bla*)))   \n   }",
			"type": "YARA",
			"id": 28546115
		},
		{
			"indicator": "dd53aa20d5c8f0f9dd91674c56c99ba1d6b1f80a",
			"description": "",
			"title": "",
			"content": "rule IronTiger_Ring_Gh0stvariant   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cyber Safety Solutions, Trend Micro\"   \n   \t\tdescription = \"Iron Tiger Malware - Ring Gh0stvariant\"   \n   \t\treference = \"http://goo.gl/T5fSJC\"   \n   \tstrings:   \n   \t\t$str1 = \"RING RAT Exception\" nocase wide ascii   \n   \t\t$str2 = \"(can not update server recently)!\" nocase wide ascii   \n   \t\t$str4 = \"CreaetProcess Error\" nocase wide ascii   \n   \t\t$bla1 = \"Sucess!\" nocase wide ascii   \n   \t\t$bla2 = \"user canceled!\" nocase wide ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and ((any of ($str*)) or (all of ($bla*)))   \n   }",
			"type": "YARA",
			"id": 28546116
		},
		{
			"indicator": "b7dba0567833c59c1754c154c080224186bcb5ba",
			"description": "",
			"title": "",
			"content": "rule IronTiger_dllshellexc2010   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cyber Safety Solutions, Trend Micro\"   \n   \t\tdescription = \"dllshellexc2010 Exchange backdoor + remote shell\"   \n   \t\treference = \"http://goo.gl/T5fSJC\"   \n   \tstrings:   \n   \t\t$str1 = \"Microsoft.Exchange.Clients.Auth.dll\" nocase ascii wide   \n   \t\t$str2 = \"Dllshellexc2010\" nocase wide ascii   \n   \t\t$str3 = \"Users\\\\ljw\\\\Documents\" nocase wide ascii   \n   \t\t$bla1 = \"please input path\" nocase wide ascii   \n   \t\t$bla2 = \"auth.owa\" nocase wide ascii   \n   \tcondition:   \n   \t\t(uint16(0) == 0x5a4d) and ((any of ($str*)) or (all of ($bla*)))   \n   }",
			"type": "YARA",
			"id": 28546118
		},
		{
			"indicator": "60172061fbe43e657243161f4043d7990a5ec95f",
			"description": "",
			"title": "",
			"content": "rule IronTiger_PlugX_FastProxy   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cyber Safety Solutions, Trend Micro\"   \n   \t\tdescription = \"Iron Tiger Malware - PlugX FastProxy\"   \n   \t\treference = \"http://goo.gl/T5fSJC\"   \n   \tstrings:   \n   \t\t$str1 = \"SAFEPROXY HTServerTimer Quit!\" nocase wide ascii   \n   \t\t$str2 = \"Useage: %s pid\" nocase wide ascii   \n   \t\t$str3 = \"%s PORT[%d] TO PORT[%d] SUCCESS!\" nocase wide ascii   \n   \t\t$str4 = \"p0: port for listener\" nocase wide ascii   \n   \t\t$str5 = \"\\\\users\\\\whg\\\\desktop\\\\plug\\\\\" nocase wide ascii   \n   \t\t$str6 = \"[+Y] cwnd : %3d, fligth:\" nocase wide ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and (any of ($str*))   \n   }",
			"type": "YARA",
			"id": 28546119
		},
		{
			"indicator": "74e9ad866a7e79b1056a6bb56852f23e30fda75a",
			"description": "",
			"title": "",
			"content": "rule IronTiger_ChangePort_Toolkit_ChangePortExe   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cyber Safety Solutions, Trend Micro\"   \n   \t\tdescription = \"Iron Tiger Malware - Toolkit ChangePort\"   \n   \t\treference = \"http://goo.gl/T5fSJC\"   \n   \tstrings:   \n   \t\t$str1 = \"Unable to alloc the adapter!\" nocase wide ascii   \n   \t\t$str2 = \"Wait for master fuck\" nocase wide ascii   \n   \t\t$str3 = \"xx.exe <HOST> <PORT>\" nocase wide ascii   \n   \t\t$str4 = \"chkroot2007\" nocase wide ascii   \n   \t\t$str5 = \"Door is bind on %s\" nocase wide ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and (2 of ($str*))   \n   }",
			"type": "YARA",
			"id": 28546120
		},
		{
			"indicator": "03e124666c03ed1c02ada09befb54ff8c9fa08f0",
			"description": "",
			"title": "",
			"content": "rule IronTiger_dnstunnel   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cyber Safety Solutions, Trend Micro\"   \n   \t\tdescription = \"This rule detects a dns tunnel tool used in Operation Iron Tiger\"   \n   \t\treference = \"http://goo.gl/T5fSJC\"   \n   \tstrings:   \n   \t\t$str1 = \"\\\\DnsTunClient\\\\\" nocase wide ascii   \n   \t\t$str2 = \"\\\\t-DNSTunnel\\\\\" nocase wide ascii   \n   \t\t$str3 = \"xssok.blogspot\" nocase wide ascii   \n   \t\t$str4 = \"dnstunclient\" nocase wide ascii   \n   \t\t$mistake1 = \"because of error, can not analysis\" nocase wide ascii   \n   \t\t$mistake2 = \"can not deal witn the error\" nocase wide ascii   \n   \t\t$mistake3 = \"the other retun one RST\" nocase wide ascii   \n   \t\t$mistake4 = \"Coversation produce one error\" nocase wide ascii   \n   \t\t$mistake5 = \"Program try to use the have deleted the buffer\" nocase wide ascii   \n   \tcondition:   \n   \t\t(uint16(0) == 0x5a4d) and ((any of ($str*)) or (any of ($mistake*)))   \n   }",
			"type": "YARA",
			"id": 28546121
		},
		{
			"indicator": "fd668b90a9024eee1c9018370cac063cc550d7b6",
			"description": "",
			"title": "",
			"content": "rule IronTiger_EFH3_encoder   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cyber Safety Solutions, Trend Micro\"   \n   \t\tdescription = \"Iron Tiger EFH3 Encoder\"   \n   \t\treference = \"http://goo.gl/T5fSJC\"   \n   \tstrings:   \n   \t\t$str1 = \"EFH3 [HEX] [SRCFILE] [DSTFILE]\" nocase wide ascii   \n   \t\t$str2 = \"123.EXE 123.EFH\" nocase wide ascii   \n   \t\t$str3 = \"ENCODER: b[i]: = \" nocase wide ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and (any of ($str*))   \n   }",
			"type": "YARA",
			"id": 28546123
		},
		{
			"indicator": "60bf64a8af4d82d102e61b5c74bab0468d40c5cb",
			"description": "",
			"title": "",
			"content": "rule IronTiger_GetPassword_x64   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cyber Safety Solutions, Trend Micro\"   \n   \t\tdescription = \"Iron Tiger Malware - GetPassword x64\"   \n   \t\treference = \"http://goo.gl/T5fSJC\"   \n   \tstrings:   \n   \t\t$str1 = \"(LUID ERROR)\" nocase wide ascii   \n   \t\t$str2 = \"Users\\\\K8team\\\\Desktop\\\\GetPassword\" nocase wide ascii   \n   \t\t$str3 = \"Debug x64\\\\GetPassword.pdb\" nocase wide ascii   \n   \t\t$bla1 = \"Authentication Package:\" nocase wide ascii   \n   \t\t$bla2 = \"Authentication Domain:\" nocase wide ascii   \n   \t\t$bla3 = \"* Password:\" nocase wide ascii   \n   \t\t$bla4 = \"Primary User:\" nocase wide ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and ((any of ($str*)) or (all of ($bla*)))   \n   }",
			"type": "YARA",
			"id": 28546124
		},
		{
			"indicator": "d650e391fdbd6e74bf0d589a5958e0004e1de338",
			"description": "",
			"title": "",
			"content": "rule keyboy_systeminfo      \n      {      \n          meta:      \n              author = \"Matt Brooks, @cmatthewbrooks\"      \n              desc = \"Matches the system information format before sending to C2\"      \n              date = \"2016-08-28\"      \n              md5 = \"495adb1b9777002ecfe22aaf52fcee93\"      \n                \n          strings:      \n              //These strings are ASCII pre-2015 and UNICODE in 2016      \n              $s1 = \"SystemVersion:    %s\" ascii wide      \n              $s2 = \"Product  ID:      %s\" ascii wide      \n              $s3 = \"InstallPath:      %s\" ascii wide      \n              $s4 = \"InstallTime:      %d-%d-%d, %02d:%02d:%02d\" ascii wide      \n              $s5 = \"ResgisterGroup:   %s\" ascii wide      \n              $s6 = \"RegisterUser:     %s\" ascii wide      \n              $s7 = \"ComputerName:     %s\" ascii wide      \n              $s8 = \"WindowsDirectory: %s\" ascii wide      \n              $s9 = \"System Directory: %s\" ascii wide      \n              $s10 = \"Number of Processors:       %d\" ascii wide      \n              $s11 = \"CPU[%d]:  %s: %sMHz\" ascii wide      \n              $s12 = \"RAM:         %dMB Total, %dMB Free.\" ascii wide      \n              $s13 = \"DisplayMode: %d x %d, %dHz, %dbit\" ascii wide      \n              $s14 = \"Uptime:      %d Days %02u:%02u:%02u\" ascii wide      \n                    \n          condition:      \n              //MZ header      \n              uint16(0) == 0x5A4D and      \n                    \n              //PE signature      \n              uint32(uint32(0x3C)) == 0x00004550 and      \n              filesize < 200KB and      \n              7 of them      \n      }",
			"type": "YARA",
			"id": 28623280
		},
		{
			"indicator": "c0733885fc1f9e7038609e723d85521e934cf01d",
			"description": "",
			"title": "",
			"content": "rule CVE_2012_0158_KeyBoy {      \n        meta:      \n            author = \"Etienne Maynier <etienne@citizenlab.ca>\"      \n            description = \"CVE-2012-0158 variant\"      \n            file = \"8307e444cad98b1b59568ad2eba5f201\"      \n            \n        strings:      \n            $a = \"d0cf11e0a1b11ae1000000000000000000000000000000003e000300feff09000600000000000000000000000100000001\" nocase // OLE header      \n            $b = \"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\" nocase // junk data      \n            $c = /5(\\{\\\\b0\\}|)[ ]*2006F00(\\{\\\\b0\\}|)[ ]*6F007(\\{\\\\b0\\}|)[ ]*400200045(\\{\\\\b0\\}|)[ ]*006(\\{\\\\b0\\}|)[ ]*E007(\\{\\\\b0\\}|)[ ]*400720079/ nocase      \n            $d = \"MSComctlLib.ListViewCtrl.2\"      \n            $e = \"ac38c874503c307405347aaaebf2ac2c31ebf6e8e3\" nocase //decoding shellcode      \n            \n        condition:      \n            all of them      \n      }",
			"type": "YARA",
			"id": 28623281
		},
		{
			"indicator": "da9baf502c58b0cf07b26fb144dd0c912d5820f4",
			"description": "",
			"title": "",
			"content": "rule keyboy_errors      \n      {      \n          meta:      \n              author = \"Matt Brooks, @cmatthewbrooks\"      \n              desc = \"Matches the sample's shell error2 log statements\"      \n              date = \"2016-08-28\"      \n              md5 = \"495adb1b9777002ecfe22aaf52fcee93\"      \n                \n          strings:      \n              //These strings are in ASCII pre-2015 and UNICODE in 2016      \n              $error = \"Error2\" ascii wide      \n              //2016 specific:      \n              $s1 = \"Can't find [%s]!Check the file name and try again!\" ascii wide      \n              $s2 = \"Open [%s] error! %d\" ascii wide      \n              $s3 = \"The Size of [%s] is zero!\" ascii wide      \n              $s4 = \"CreateThread DownloadFile[%s] Error!\" ascii wide      \n              $s5 = \"UploadFile [%s] Error:Connect Server Failed!\" ascii wide      \n              $s6 = \"Receive [%s] Error(Recved[%d] != Send[%d])!\" ascii wide      \n              $s7 = \"Receive [%s] ok! Use %2.2f seconds, Average speed %2.2f k/s\" ascii wide      \n              $s8 = \"CreateThread UploadFile[%s] Error!\" ascii wide      \n              //Pre-2016:      \n              $s9 = \"Ready Download [%s] ok!\" ascii wide      \n              $s10 = \"Get ControlInfo from FileClient error!\" ascii wide      \n              $s11 = \"FileClient has a error!\" ascii wide      \n              $s12 = \"VirtualAlloc SendBuff Error(%d)\" ascii wide      \n              $s13 = \"ReadFile [%s] Error(%d)...\" ascii wide      \n              $s14 = \"ReadFile [%s] Data[Readed(%d) != FileSize(%d)] Error...\" ascii wide      \n              $s15 = \"CreateThread DownloadFile[%s] Error!\" ascii wide      \n              $s16 = \"RecvData MyRecv_Info Size Error!\" ascii wide      \n              $s17 = \"RecvData MyRecv_Info Tag Error!\" ascii wide      \n              $s18 = \"SendData szControlInfo_1 Error!\" ascii wide      \n              $s19 = \"SendData szControlInfo_3 Error!\" ascii wide      \n              $s20 = \"VirtualAlloc RecvBuff Error(%d)\" ascii wide      \n              $s21 = \"RecvData Error!\" ascii wide      \n              $s22 = \"WriteFile [%s} Error(%d)...\" ascii wide      \n                    \n          condition:      \n              //MZ header      \n              uint16(0) == 0x5A4D and      \n                    \n              //PE signature      \n              uint32(uint32(0x3C)) == 0x00004550 and      \n              filesize < 200KB and      \n              $error and 3 of ($s*)      \n      }",
			"type": "YARA",
			"id": 28623282
		},
		{
			"indicator": "4f426b62f4dbebb2348793a994adb4c68cddaa49",
			"description": "",
			"title": "",
			"content": "rule keyboy_commands      \n      {      \n          meta:      \n              author = \"Matt Brooks, @cmatthewbrooks\"      \n              desc = \"Matches the 2016 sample's sent and received commands\"      \n              date = \"2016-08-28\"      \n              md5 = \"495adb1b9777002ecfe22aaf52fcee93\"      \n                \n          strings:      \n              $s1 = \"Update\" wide fullword      \n              $s2 = \"UpdateAndRun\" wide fullword      \n              $s3 = \"Refresh\" wide fullword      \n              $s4 = \"OnLine\" wide fullword      \n              $s5 = \"Disconnect\" wide fullword      \n              $s6 = \"Pw_Error\" wide fullword      \n              $s7 = \"Pw_OK\" wide fullword      \n              $s8 = \"Sysinfo\" wide fullword      \n              $s9 = \"Download\" wide fullword      \n              $s10 = \"UploadFileOk\" wide fullword      \n              $s11 = \"RemoteRun\" wide fullword      \n              $s12 = \"FileManager\" wide fullword      \n                    \n          condition:      \n              //MZ header      \n              uint16(0) == 0x5A4D and      \n                    \n              //PE signature      \n              uint32(uint32(0x3C)) == 0x00004550 and      \n              filesize < 200KB and      \n              6 of them      \n      }",
			"type": "YARA",
			"id": 28623283
		},
		{
			"indicator": "cfbdfa699fd6daafd25392bfb6b08720a45f805d",
			"description": "",
			"title": "",
			"content": "rule Shamoon_Disttrack_Dropper {   \n      meta:   \n         description = \"Detects Shamoon 2.0 Disttrack Dropper\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/jKIfGB\"   \n         date = \"2016-12-01\"   \n         score = 70   \n         hash1 = \"4744df6ac02ff0a3f9ad0bf47b15854bbebb73c936dd02f7c79293a2828406f6\"   \n         hash2 = \"5a826b4fa10891cf63aae832fc645ce680a483b915c608ca26cedbb173b1b80a\"   \n      strings:   \n         $a1 = \"\\\\#{9A6DB7D2-FECF-41ff-9A92-6EDA696613DF}#\" wide   \n         $a2 = \"\\\\#{8A6DB7D2-FECF-41ff-9A92-6EDA696613DE}#\" wide   \n      \n         $s1 = \"\\\\amd64\\\\elrawdsk.pdb\" fullword ascii   \n         $s2 = \"RawDiskSample.exe\" fullword wide   \n         $s3 = \"RawDisk Driver. Allows write access to files and raw disk sectors for user mode applications in Windows 2000 and later.\" fullword wide   \n         $s4 = \"elrawdsk.sys\" fullword wide   \n         $s5 = \"\\\\DosDevices\\\\ElRawDisk\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 90KB and 1 of ($a*) and 1 of ($s*) )   \n   }",
			"type": "YARA",
			"id": 28632823
		},
		{
			"indicator": "59571c50a0d7f6605b573e607626d4acd85c7b62",
			"description": "",
			"title": "",
			"content": "rule VBPacker_FareIT_Zbot   \n   {   \n   meta:   \n   copyright = \"Kaspersky Lab\"   \n   description = \"Rule to detect VB Packer of FareIT and Zbot samples\"   \n   hash1 = \"0b7f872d098ef8f1dd0e52f6d5c5a92e\"   \n   hash2 = \"0eb12f0c3aa4ec1db178fbbe69a329cf\"   \n   version = \"1.1\"   \n      \n   strings:   \n   $a1 = \"C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\VB98\\\\VB6.OLB\"   \n      \n   //\"gdi32\" + 0x11 +\"SetViewportOrgEx\"   \n   $a2 = {67 64 69 33 32 00 00 00 11 00 00 00 53 65 74 56 69 65 77 70 6F 72 74 4F 72 67 45 78}   \n      \n   //OriginalFilename AX.exe   \n   $b1 = {4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 41 00 58 00 2E 00 65 00 78 00 65 00}   \n   //OriginalFilename AS.exe   \n   $b2 = {4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 41 00 53 00 2E 00 65 00 78 00 65 00}   \n   //OriginalFilename Can.exe   \n   $b3 = {4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 43 00 61 00 6E 00 2E 00 65 00 78 00 65 00}   \n   //OriginalFilename usisui.exe   \n   $b5 = {4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 75 00 73 00 69 00 73 00 75 00 69 00 2E 00 65 00 78 00 65 00}   \n   condition:   \n   uint16(0) == 0x5A4D   \n   and (all of ($a*))   \n   and (any of ($b*))   \n   //and (any of ($c*))   \n   and filesize > 250000   \n   }",
			"type": "YARA",
			"id": 28632824
		},
		{
			"indicator": "5401fb108d99702e3a1a0405d55a699ddcb5c867",
			"description": "",
			"title": "",
			"content": "rule MSILPacker_FareIT_ISR_Stealer_Luminosity_HawkEye   \n   {   \n   meta:   \n   copyright = \"Kaspersky Lab\"   \n   description = \"Rule to detect MSIL Packer of FareIT, ISR Stealer, Luminosity, HawkEye Keylogger samples\"   \n   hash1 = \"1f9ea55ec924bf927db4fb4f429d49b6\"   \n   hash2 = \"80c4a3d66159877e264b0eab74a791db\"   \n   hash2 = \"e8bfa64826d095ff3699a5e3df205d24\"   \n   version = \"1.1\"   \n      \n   strings:   \n   $a1 = \"set_Key\"   \n   $a2 = \"set_IV\"   \n   $a3 = \"set_ClientSize\"   \n   $a4 = \"set_ControlBox\"   \n   $a5 = \"SetCompatibleTextRenderingDefault\"   \n   $a6 = \"CompilationRelaxationsAttribute\"   \n   $a7 = \"ICryptoTransform\"   \n   $a8 = \"_CorExeMain\"   \n      \n   $b1 = \"Video card management\"   \n   $b2 = \"Net Extensible Autheticator\"   \n   $b3 = \"NetTcpActivator\"   \n   $b4 = \"nVidia PhysX technology\"   \n   $b5 = \"WdiSytemHost\"   \n      \n   condition:   \n   uint16(0) == 0x5A4D   \n   and (all of ($a*))   \n   and (any of ($b*))   \n   and filesize > 100000   \n   }",
			"type": "YARA",
			"id": 28632825
		},
		{
			"indicator": "a9b8988e834ffa62af3557adb4e74abb1e520be2",
			"description": "",
			"title": "",
			"content": "rule crime_ZZ_EyePyramid {   \n      \n   meta:   \n      \n   copyright = \" Kaspersky Lab\"    \n   author = \"Kaspersky Lab\"   \n   maltype = \"crimeware\"   \n   filetype = \"Win32 EXE\"   \n   date = \"2016-01-11\"   \n   version = \"1.0\"   \n      \n   strings:   \n      \n   $a0=\"eyepyramid.com\" ascii wide nocase fullword   \n   $a1=\"hostpenta.com\" ascii wide nocase fullword   \n   $a2=\"ayexisfitness.com\" ascii wide nocase fullword   \n   $a3=\"enasrl.com\" ascii wide nocase fullword   \n   $a4=\"eurecoove.com\" ascii wide nocase fullword   \n   $a5=\"marashen.com\" ascii wide nocase fullword   \n   $a6=\"millertaylor.com\" ascii wide nocase fullword   \n   $a7=\"occhionero.com\" ascii wide nocase fullword   \n   $a8=\"occhionero.info\" ascii wide nocase fullword   \n   $a9=\"wallserv.com\" ascii wide nocase fullword   \n   $a10=\"westlands.com\" ascii wide nocase fullword   \n   $a11=\"217.115.113.181\" ascii wide nocase fullword   \n   $a12=\"216.176.180.188\" ascii wide nocase fullword   \n   $a13=\"65.98.88.29\" ascii wide nocase fullword   \n   $a14=\"199.15.251.75\" ascii wide nocase fullword   \n   $a15=\"216.176.180.181\" ascii wide nocase fullword   \n   $a16=\"MN600-849590C695DFD9BF69481597241E-668C\" ascii wide nocase fullword   \n   $a17=\"MN600-841597241E8D9BF6949590C695DF-774D\" ascii wide nocase fullword   \n   $a18=\"MN600-3E3A3C593AD5BAF50F55A4ED60F0-385D\" ascii wide nocase fullword   \n   $a19=\"MN600-AD58AF50F55A60E043E3A3C593ED-874A\" ascii wide nocase fullword   \n   $a20=\"gpool@hostpenta.com\" ascii wide nocase fullword   \n   $a21=\"hanger@hostpenta.com\" ascii wide nocase fullword   \n   $a22=\"hostpenta@hostpenta.com\" ascii wide nocase fullword   \n   $a23=\"ulpi715@gmx.com\" ascii wide nocase fullword   \n   $b0=\"purge626@gmail.com\" ascii wide fullword   \n   $b1=\"tip848@gmail.com\" ascii wide fullword   \n   $b2=\"dude626@gmail.com\" ascii wide fullword   \n   $b3=\"octo424@gmail.com\" ascii wide fullword   \n   $b4=\"antoniaf@poste.it\" ascii wide fullword   \n   $b5=\"mmarcucci@virgilio.it\" ascii wide fullword   \n   $b6=\"i.julia@blu.it\" ascii wide fullword   \n   $b7=\"g.simeoni@inwind.it\" ascii wide fullword   \n   $b8=\"g.latagliata@live.com\" ascii wide fullword   \n   $b9=\"rita.p@blu.it\" ascii wide fullword   \n   $b10=\"b.gaetani@live.com\" ascii wide fullword   \n   $b11=\"gpierpaolo@tin.it\" ascii wide fullword   \n   $b12=\"e.barbara@poste.it\" ascii wide fullword   \n   $b13=\"stoccod@libero.it\" ascii wide fullword   \n   $b14=\"g.capezzone@virgilio.it\" ascii wide fullword   \n   $b15=\"baldarim@blu.it\" ascii wide fullword   \n   $b16=\"elsajuliette@blu.it\" ascii wide fullword   \n   $b17=\"dipriamoj@alice.it\" ascii wide fullword   \n   $b18=\"izabelle.d@blu.it\" ascii wide fullword   \n   $b19=\"lu_1974@hotmail.com\" ascii wide fullword   \n   $b20=\"tim11235@gmail.com\" ascii wide fullword   \n   $b21=\"plars575@gmail.com\" ascii wide fullword   \n   $b22=\"guess515@fastmail.fm\" ascii wide fullword   \n      \n   condition:   \n      \n   ((uint16(0) == 0x5A4D)) and (filesize < 10MB) and    \n   ((any of ($a*)) or (any of ($b*)) )   \n   }",
			"type": "YARA",
			"id": 28634758
		},
		{
			"indicator": "6e4caecf814a9298a26120704dfff26d5bb5645d",
			"description": "",
			"title": "",
			"content": "rule venomLinuxRootkit {   \n       meta:   \n           description = \"Venom Linux Rootkit\"   \n           author = \"jaime.blasco@alienvault.com\"   \n           ref = \"https://security.web.cern.ch/security/venom.shtml\"   \n       strings:   \n           $a1 = \"%%VENOM%\"   \n           $a2 = \"justCANTbeSTOPPED\"   \n           $a3 = \"ABZFZU.wWdRDU\"   \n       condition:   \n           (uint16(0) == 0x457F) and (filesize < 10MB) and (all of ($a*))   \n   }",
			"type": "YARA",
			"id": 28634772
		},
		{
			"indicator": "dbec9f59a983aa6a7a217c76183bf6dd3681fb80",
			"description": "",
			"title": "",
			"content": "rule Downloader_Mar17_1 {   \n     meta:   \n        description = \"Detects Downloader\"   \n        author = \"Florian Roth\"   \n        reference = \"http://www.clearskysec.com/iec/\"   \n        date = \"2017-03-13\"   \n        hash1 = \"15b5fb226689fdddc04c3e6ddeb84e3aae4ce009cc4c95f6fa68045033ca905f\"   \n        hash2 = \"1b7ab355fe28efc14c6a5a7a0f663507a6cdc921ecbadf228005d9f635852463\"   \n        hash3 = \"143313a610b77d03202a23bc08f0721de693782d07d27e0dac89004cc1cf9ea3\"   \n        hash4 = \"a6a71a00b1f1e2b37332b461611615f98f3aefc57c0274cf1ab217b66149912a\"   \n        hash5 = \"f434ec69bf2f6310a8fa5e2dccb3b05e94584a4ab03898da101eaed703737d20\"   \n     strings:   \n        $x1 = \"\\\\Downloader\\\\Release\\\\Downloader.pdb\" ascii   \n        $x2 = \"\\\\tsDownloader\\\\Release\\\\tsDownloader.pdb\" ascii   \n      \n        $x3 = \" /c wmic /Node:localhost /Namespace:\\\\\\\\root\\\\SecurityCenter Path AntiVirusProduct Get displayName /Format:List > \" fullword wide   \n        $x4 = \"\\\\temp1.txt && wmic path win32_physicalmedia get SerialNumber > \" fullword ascii   \n        $x5 = \"\\\\ProgramData\\\\system.dll\" fullword ascii   \n        $x6 = \" /c wmic NICCONFIG WHERE IPEnabled=true GET IPAddress /format:csv > \" fullword wide   \n        $x7 = \"/ProgramData/system.dll\" fullword ascii   \n        $x8 = \"\\\\ProgramData\\\\dll.dll\" fullword wide   \n      \n        $s1 = \"$ie = new-object -comobject InternetExplorer.Application; $ie.Visible = $false; $ie.Silent = $true; $ie.navigate('http://\" fullword wide   \n        $s2 = \"dasHost.exe\" fullword ascii   \n        $s3 = \"/ProgramData/System Update/check.txt\" fullword wide   \n        $s4 = \"Explorer.Exe\" fullword wide   \n        $s5 = \"svchosts.Exe\" fullword wide   \n        $s6 = \"C:/ProgramData/window/\" fullword wide   \n      \n        $op1 = { 68 72 8d 42 00 8d 4c 24 08 c7 44 24 08 } /* Opcode */   \n     condition:   \n        ( uint16(0) == 0x5a4d and filesize < 900KB and ( 1 of ($x*) or 2 of ($s*) ) ) or ( 4 of them )   \n   }",
			"type": "YARA",
			"id": 28644335
		},
		{
			"indicator": "04ca83fa6c16b42b300f6140abb5133dbfd3fe66",
			"description": "",
			"title": "",
			"content": "rule StoneDrill_main_sub {   \n   meta:   \n    author = \"Kaspersky Lab\"   \n    description = \"Rule to detect StoneDrill (decrypted) samples\"   \n    hash = \"d01781f1246fd1b64e09170bd6600fe1\"   \n    hash = \"ac3c25534c076623192b9381f926ba0d\"   \n    version = \"1.0\"   \n   strings:   \n    $code = {B8 08 00 FE 7F FF 30 8F 44 24 ?? 68 B4 0F 00 00 FF 15 ?? ?? ?? 00 B8 08 00 FE 7F FF   \n   30 8F 44 24 ?? 8B ?? 24 [1 - 4] 2B ?? 24 [6] F7 ?1 [5 - 12] 00}   \n   condition:   \n    uint16(0) == 0x5A4D and   \n    $code and   \n    filesize < 5000000   \n   }",
			"type": "YARA",
			"id": 28644336
		},
		{
			"indicator": "8dc1a164ef59b2dcb1b77086416eda0cb3d84455",
			"description": "",
			"title": "",
			"content": "rule crashoverride_wiperModuleRegistry   \n   {   \n       meta:   \n           description = \"Registry Wiper functionality assoicated with CRASHOVERRIDE\"   \n           author = \"Dragos Inc\"   \n          \n       strings:   \n           $s0 = { 8d 85 a0 ?? ?? ?? 46 50 8d 85 a0 ?? ?? ?? 68 68 0d ?? ?? 50 }   \n           $s1 = { 6a 02 68 78 0b ?? ?? 6a 02 50 68 b4 0d ?? ?? ff b5 98 ?? ?? ?? ff 15 04 ?? ?? ?? }   \n           $s2 = { 68 00 02 00 00 8d 85 a0 ?? ?? ?? 50 56 ff b5 9c ?? ?? ?? ff 15 00 ?? ?? ?? 85 c0 }   \n          \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 28657776
		},
		{
			"indicator": "f652dcefffd0453625f6a0514db666b445b83093",
			"description": "",
			"title": "",
			"content": "rule crashoverride_socketCreationArtifacts   \n   {   \n       meta:   \n           description = \"Socket and connection creation functionality\"   \n           author = \"Dragos Inc\"   \n          \n       strings:   \n           $s0 = { c7 85 ?? fe ff ff 02 00 00 00 c7 85 ?? fe ff ff 01 00 00 00 c7 85 ?? fe ff ff 06 00 00 00 ff 15 ?? 91 01 10 }   \n           $s1 = { 6a 04 ?? ?? ?? fe ff ff 8d 85 ?? fe ff ff 50 68 06 10 00 68 ff ff 00 00 57 ff 15 ?? ?? ?? 01 10 }   \n              \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 28657777
		},
		{
			"indicator": "0cf8a8e5b490c205142e1d9e2177e96709ea9243",
			"description": "",
			"title": "",
			"content": "rule crashoverride_serviceStomper   \n   {   \n       meta:   \n           description = \"Identify service hollowing and persistence setting\"   \n           author = \"Dragos Inc\"   \n          \n       strings:   \n           $s0 = { 33 c9 51 51 51 51 51 51 ?? ?? ?? }   \n           $s1 = { 6a ff 6a ff 6a ff 50 ff 15 24 ?? 40 00 ff ?? ?? ff 15 20 ?? 40 00 }   \n          \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 28657778
		},
		{
			"indicator": "99faeab3bdc31876b56e0da9b911fae074609c92",
			"description": "",
			"title": "",
			"content": "rule crashoverride_weirdMutex   \n   {   \n       meta:   \n           description = \"Blank mutex creation assoicated with CRASHOVERRIDE\"   \n           author = \"Dragos Inc\"   \n       strings:   \n           $s1 = { 81 ec 08 02 00 00 57 33 ff 57 57 57 ff 15 ?? ?? 40 00 a3 ?? ?? ?? 00 85 c0 }   \n           $s2 = { 8d 85 ?? ?? ?? ff 50 57 57 6a 2e 57 ff 15 ?? ?? ?? 00 68 ?? ?? 40 00}   \n          \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 28657779
		},
		{
			"indicator": "affa3c9074a2628a0dc22797af94bc7c4024d86d",
			"description": "",
			"title": "",
			"content": "rule crashoverride_wiperFileManipulation   \n   {   \n       meta:   \n           description = \"File manipulation actions associated with CRASHOVERRIDE wiper\"   \n           author = \"Dragos Inc\"   \n          \n       strings:   \n           $s0 = { 6a 00 68 80 00 00 00 6a 03 6a 00 6a 02 8b f9 68 00 00 00 40 57 ff 15 1c ?? ?? ?? 8b d8 }   \n           $s2 = { 6a 00 50 57 56 53 ff 15 4c ?? ?? ?? 56 }   \n              \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 28657780
		},
		{
			"indicator": "be3b3ec715f8fc0e08ff75a39b3d155abb1876a5",
			"description": "",
			"title": "",
			"content": "rule crashoverride_finalCountdownToWiper   \n   {   \n       meta:   \n           description = \"Countdown to wiper module loading\"   \n           author = \"Dragos Inc\"   \n          \n       strings:   \n           $s0 = { 68 80 ee 36 00 ff ?? ?? ?? 40 00 68 e8 09 41 00 ff  ?? ?? ?? 40 00 85 c0 }   \n           $s1 = { 68 fc 09 41 00 50 ff ?? ?? ?? 40 00 85 c0 74 07 6a 00 ff d0 83 c4 04 }   \n          \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 28657781
		},
		{
			"indicator": "706342f5d4c84ffec56e704506713830dfc213b7",
			"description": "",
			"title": "",
			"content": "rule crashoverride_configReader   \n   {   \n       meta:   \n           description = \"CRASHOVERRIDE v1 Config File Parsing\"   \n           author = \"Dragos Inc\"   \n          \n       strings:   \n           $s0 = { 68 e8 ?? ?? ?? 6a 00 e8 a3 ?? ?? ?? 8b f8 83 c4 ?8 }   \n           $s1 = { 8a 10 3a 11 75 ?? 84 d2 74 12 }   \n           $s2 = { 33 c0 eb ?? 1b c0 83 c8 ?? }   \n           $s3 = { 85 c0 75 ?? 8d 95 ?? ?? ?? ?? 8b cf ?? ?? }   \n              \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 28657782
		},
		{
			"indicator": "e40732912d8bf10208e796c2571be8352b69a281",
			"description": "",
			"title": "",
			"content": "rule macSpy   \n   {   \n       meta:   \n           author = \"AlienVault Labs\"   \n           type = \"malware\"   \n           description = \"MacSpy\"   \n       strings:   \n       $header0 = {cf fa ed fe}   \n       $header1 = {ce fa ed fe}   \n       $header2 = {ca fe ba be}   \n       $c1 = { 76 31 09 00 76 32 09 00 76 33 09 00 69 31 09 00 69 32 09 00 69 33 09 00 69 34 09 00 66 31 09 00 66 32 09 00 66 33 09 00 66 34 09 00 74 63 3A 00 }   \n       condition:   \n          ($header0 at 0 or $header1 at 0 or $header2 at 0) and $c1   \n   }",
			"type": "YARA",
			"id": 28657783
		},
		{
			"indicator": "0d09ca38fc387db0e565d73d3a13b41f06cf7c5a",
			"description": "",
			"title": "",
			"content": "rule LogPOS   \n   {   \n       meta:   \n           author = \"Morphick Security\"   \n           description = \"Detects Versions of LogPOS\"   \n           md5 = \"af13e7583ed1b27c4ae219e344a37e2b\"   \n       strings:   \n           $mailslot = \"\\\\\\\\.\\\\mailslot\\\\LogCC\"   \n           $get = \"GET /%s?encoding=%c&t=%c&cc=%I64d&process=\"   \n           //64A130000000      mov eax, dword ptr fs:[0x30]   \n           //8B400C        mov eax, dword ptr [eax + 0xc]   \n           //8B401C        mov eax, dword ptr [eax + 0x1c]   \n           //8B4008        mov eax, dword ptr [eax + 8]   \n           $sc = {64 A1 30 00 00 00 8B 40 0C 8B 40 1C 8B 40 08 }   \n       condition:   \n           $sc and 1 of ($mailslot,$get)   \n   }",
			"type": "YARA",
			"id": 28667386
		},
		{
			"indicator": "0c21d88952bb18095f224bf09ab4824cd6363df1",
			"description": "",
			"title": "",
			"content": "rule FE_LEGALSTRIKE_MACRO {   \n          meta:version=\".1\"   \n          filetype=\"MACRO\"   \n          author=\"Ian.Ahl@fireeye.com @TekDefense\"   \n          date=\"2017-06-02\"   \n          description=\"This rule is designed to identify macros with the specific encoding used in the sample 30f149479c02b741e897cdb9ecd22da7.\"   \n   strings:   \n          // OBSFUCATION   \n          $ob1 = \"ChrW(114) & ChrW(101) & ChrW(103) & ChrW(115) & ChrW(118) & ChrW(114) & ChrW(51) & ChrW(50) & ChrW(46) & ChrW(101)\" ascii wide   \n          $ob2 = \"ChrW(120) & ChrW(101) & ChrW(32) & ChrW(47) & ChrW(115) & ChrW(32) & ChrW(47) & ChrW(110) & ChrW(32) & ChrW(47)\" ascii wide   \n          $ob3 = \"ChrW(117) & ChrW(32) & ChrW(47) & ChrW(105) & ChrW(58) & ChrW(104) & ChrW(116) & ChrW(116) & ChrW(112) & ChrW(115)\" ascii wide   \n          $ob4 = \"ChrW(58) & ChrW(47) & ChrW(47) & ChrW(108) & ChrW(121) & ChrW(110) & ChrW(99) & ChrW(100) & ChrW(105) & ChrW(115)\" ascii wide   \n          $ob5 = \"ChrW(99) & ChrW(111) & ChrW(118) & ChrW(101) & ChrW(114) & ChrW(46) & ChrW(50) & ChrW(98) & ChrW(117) & ChrW(110)\" ascii wide   \n          $ob6 = \"ChrW(110) & ChrW(121) & ChrW(46) & ChrW(99) & ChrW(111) & ChrW(109) & ChrW(47) & ChrW(65) & ChrW(117) & ChrW(116)\" ascii wide   \n          $ob7 = \"ChrW(111) & ChrW(100) & ChrW(105) & ChrW(115) & ChrW(99) & ChrW(111) & ChrW(118) & ChrW(101) & ChrW(114) & ChrW(32)\" ascii wide   \n          $ob8 = \"ChrW(115) & ChrW(99) & ChrW(114) & ChrW(111) & ChrW(98) & ChrW(106) & ChrW(46) & ChrW(100) & ChrW(108) & ChrW(108)\" ascii wide   \n          $obreg1 = /(\\w{5}\\s&\\s){7}\\w{5}/   \n          $obreg2 = /(Chrw\\(\\d{1,3}\\)\\s&\\s){7}/   \n          // wscript   \n          $wsobj1 = \"Set Obj = CreateObject(\\\"WScript.Shell\\\")\" ascii wide   \n          $wsobj2 = \"Obj.Run \" ascii wide   \n      \n   condition:   \n           (   \n                 (   \n                         (uint16(0) != 0x5A4D)   \n                 )   \n                 and   \n                 (   \n                         all of ($wsobj*) and 3 of ($ob*)   \n                         or   \n                         all of ($wsobj*) and all of ($obreg*)   \n                 )   \n          )   \n   }",
			"type": "YARA",
			"id": 28667387
		},
		{
			"indicator": "32162ba33725eaa3791d17cde5a1e182ed4f9faa",
			"description": "",
			"title": "",
			"content": "rule diamond_fox   \n   {   \n       meta:   \n           author = \"Brian Wallace @botnet_hunter\"   \n           author_email = \"bwall@ballastsecurity.net\"   \n           date = \"2015-08-22\"   \n           description = \"Identify DiamondFox\"   \n       strings:   \n       \t$s1 = \"UPDATE_B\"   \n           $s2 = \"UNISTALL_B\"   \n           $s3 = \"S_PROTECT\"   \n           $s4 = \"P_WALLET\"   \n           $s5 = \"GR_COMMAND\"   \n           $s6 = \"FTPUPLOAD\"   \n       condition:   \n       \tall of them   \n   }",
			"type": "YARA",
			"id": 28669374
		},
		{
			"indicator": "d781807c435ffb9862c00e635732c6725c66b540",
			"description": "",
			"title": "",
			"content": "rule Trojan_Python_Ragua : APT {   \n           meta:   \n                   description = \"Detect the Python Trojan Ragua (known from Kaspersky 'Machete' APT report)\"   \n                   author = \"Florian Roth\"   \n                   hash0 = \"d7928af839db6c651c6b9d5a8937e00191f01358\"   \n                   hash1 = \"907f17693aa626a65595b64ae01d0a3e948834d1\"   \n                   hash2 = \"85537f2c50825358d67536de1cdfcd3f1c790149\"   \n           strings:   \n                   $s2 = \"\\\\py2exe\\\\boot_common.pyR\"   \n                   $s10 = \"win32com/client/util.pyo\" fullword   \n      \n                   $x1 = \"JavaS.exe\" wide fullword   \n                   $x2 = \"JavaS.pyR$\" fullword   \n           condition:   \n                   uint16(0) == 0x5A4D and all of them   \n   }",
			"type": "YARA",
			"id": 28669375
		},
		{
			"indicator": "90a8520f63cd025dda3e99992f068f10a6f49cf1",
			"description": "",
			"title": "",
			"content": "rule warning_EPS_xor_exec {   \n       meta:   \n           is_exploit = false   \n           is_warning = true   \n           is_feature = true   \n           rank = 5   \n           revision = \"1\"   \n           date = \"May 11 2017\"   \n           author = \"@tylabs\"   \n   \trelease = \"lite\"   \n           copyright = \"QuickSand.io (c) Copyright 2017. All rights reserved.\"   \n           tlp = \"green\"   \n           sigtype = \"cryptam_exploit\"   \n           desc = \"EPS obfuscation using xor and exec\"   \n       strings:   \n   \t$h1 = \"%!PS-Adobe-\" nocase   \n           $s1 = \"mod get xor put\"   \n   \t$s2 = \"exec quit\"   \n      \n       condition:   \n   \t$h1 at 0 and all of ($s*)   \n       }",
			"type": "YARA",
			"id": 28679669
		},
		{
			"indicator": "25d05a48cbc956af4bf3ba1585e686470ab6b0ce",
			"description": "",
			"title": "",
			"content": "rule SnakeTurla_Installd_SH {   \n      meta:   \n         description = \"Detects Snake / Turla Sample\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/QaOh4V\"   \n         date = \"2017-05-04\"   \n      strings:   \n         $s1 = \"PIDS=`ps cax | grep installdp\" ascii   \n         $s2 = \"${SCRIPT_DIR}/installdp ${FILE}\" ascii   \n      condition:   \n         ( uint16(0) == 0x2123 and filesize < 20KB and all of them )   \n   }",
			"type": "YARA",
			"id": 28681901
		},
		{
			"indicator": "54f910a12b64f124a264fc5da271ca05101df37c",
			"description": "",
			"title": "",
			"content": "rule SnakeTurla_Malware_May17_4 {   \n      meta:   \n         description = \"Detects Snake / Turla Sample\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/QaOh4V\"   \n         date = \"2017-05-04\"   \n         hash1 = \"d5ea79632a1a67abbf9fb1c2813b899c90a5fb9442966ed4f530e92715087ee2\"   \n      strings:   \n         $s1 = \"Install Adobe Flash Player.app/com.adobe.updatePK\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x4b50 and filesize < 5000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 28681902
		},
		{
			"indicator": "de49beddf65f9c48f072a879e45315392fb1b1d8",
			"description": "",
			"title": "",
			"content": "rule SnakeTurla_Malware_May17_3 {   \n      meta:   \n         description = \"Detects Snake / Turla Sample\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/QaOh4V\"   \n         date = \"2017-05-04\"   \n         hash1 = \"7848f7808af02ba0466f3a0687cf949c4d29a2d94b035481a3299ec519aaaa30\"   \n      strings:   \n         $x1 = \"Addy Symonds1\" ascii   \n         $x2 = \"com.addy.InstallAdobeFlash\" ascii   \n      condition:   \n         ( uint16(0) == 0xfacf and filesize < 3000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 28681903
		},
		{
			"indicator": "4f1e0aca4eda774085a91abb40d856e5f11a147e",
			"description": "",
			"title": "",
			"content": "rule SnakeTurla_Install_SH {   \n      meta:   \n         description = \"Detects Snake / Turla Sample\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/QaOh4V\"   \n         date = \"2017-05-04\"   \n      strings:   \n         $s1 = \"${TARGET_PATH}/installd.sh\" ascii   \n         $s2 = \"$TARGET_PATH2/com.adobe.update.plist\" ascii   \n      condition:   \n      ( uint16(0) == 0x2123 and filesize < 20KB and all of them )   \n   }",
			"type": "YARA",
			"id": 28681904
		},
		{
			"indicator": "2ff636f2149af37a12f405ed25c07f1d13b6a874",
			"description": "",
			"title": "",
			"content": "rule SnakeTurla_Malware_May17_1 {   \n      meta:   \n         description = \"Detects Snake / Turla Sample\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/QaOh4V\"   \n         date = \"2017-05-04\"   \n         hash1 = \"5b7792a16c6b7978fca389882c6aeeb2c792352076bf6a064e7b8b90eace8060\"   \n      strings:   \n         $s1 = \"/Users/vlad/Desktop/install/install/\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0xfacf and filesize < 200KB and all of them )   \n   }",
			"type": "YARA",
			"id": 28681905
		},
		{
			"indicator": "044d72d419030f2d9730a0ffcf9af0d67b0d2f3f",
			"description": "",
			"title": "",
			"content": "rule SnakeTurla_Malware_May17_2 {   \n      meta:   \n         description = \"Detects Snake / Turla Sample\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/QaOh4V\"   \n         date = \"2017-05-04\"   \n         hash1 = \"b8ee4556dc09b28826359b98343a4e00680971a6f8c6602747bd5d723d26eaea\"   \n      strings:   \n         $s1 = \"b_openssl: oops - number of mutexes is 0\" fullword ascii   \n         $s2 = \"networksetup -get%sproxy Ethernet\" fullword ascii   \n         $s3 = \"012A04DECBC441e49C527B2798F54CA7LOG_NAMED_PIPE_NAME\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0xfacf and filesize < 6000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 28681906
		},
		{
			"indicator": "257f43c2ced1ba031b47052c1a6391ad17c54ad0",
			"description": "",
			"title": "",
			"content": "rule osx_dok {   \n      \n   meta:   \n      \n   author = \"AlienVault Labs\"   \n      \n   type = \"malware\"   \n      \n   description = \"OSX/Dok\"   \n      \n   strings:   \n      \n   $header0 = {cf fa ed fe}   \n   $header1 = {ce fa ed fe}   \n   $header2 = {ca fe ba be}   \n      \n   $c1 = \"/usr/local/bin/brew\"   \n      \n   $c2 = \"/usr/local/bin/tor\"   \n      \n   $c3 = \"/usr/local/bin/socat\"   \n      \n   $c4 = \"killall Safari\"   \n      \n   $c5 = \"killall \\\"Google Chrome\\\"\"   \n      \n   $c6 = \"killall firefox\"   \n      \n   $c7 = \"security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain %@\"   \n      \n   condition:   \n      \n   ($header0 at 0 or $header1 at 0 or $header2 at 0) and (all of ($c*))   \n      \n   }",
			"type": "YARA",
			"id": 28713779
		},
		{
			"indicator": "4f70cfa3a0ae0c80af2ce4555ec78edc02cd786a",
			"description": "",
			"title": "",
			"content": "rule rtf_objdata_urlmoniker_http {   \n    strings:   \n    $header = \"{\\\\rtf1\"   \n    $objdata = \"objdata 0105000002000000\" nocase   \n    $urlmoniker = \"E0C9EA79F9BACE118C8200AA004BA90B\" nocase   \n    $http = \"68007400740070003a002f002f00\" nocase   \n    condition:   \n    $header at 0 and $objdata and $urlmoniker and $http   \n    }",
			"type": "YARA",
			"id": 28723438
		},
		{
			"indicator": "67e2ee9b63bd3673732046dd24f8feed58ea1e03",
			"description": "",
			"title": "",
			"content": "rule CarbanakVBSCRIPT {   \n       meta:   \n           author = \"jaime.blasco@alienvault.com\"   \n       strings:   \n           $a = \"URLEncode(SimpleEncrypt\"   \n           $b = \"isRunWList = checkWhiteList\"   \n           $c = \"dim runnerr\"   \n           $d = \"dim myini\"   \n       condition:   \n          $a or $b or ($c and $d)   \n   }",
			"type": "YARA",
			"id": 28723439
		},
		{
			"indicator": "47b5c60d744970acd1b04e3d2072c8d1f3d5b2de",
			"description": "",
			"title": "",
			"content": "rule CarbanakRTFPayload {   \n       meta:   \n           author = \"jaime.blasco@alienvault.com\"   \n       strings:   \n           $RTF = \"{\\\\rtf\"   \n           $c = \"dim runnerr\"   \n           $d = \"dim myini\"   \n           $e = \"unprotect.vbs\"   \n           $h = \"756e70726f746563742e766273\"   \n           $f = \"64696d2072756e6e657272\"   \n           $g = \"64696d206d79696e69\"   \n       condition:   \n          $RTF at 0 and (($c and $d) or $e or $h or ($f and $g))   \n   }",
			"type": "YARA",
			"id": 28723440
		},
		{
			"indicator": "2a22fc82d86d030c810af0769459977d1cb14ff2",
			"description": "",
			"title": "",
			"content": "rule apt_RU_MoonlightMaze_u_logcleaner {   \n   meta:   \n   author = \"Kaspersky Lab\"   \n   date = \"2017-03-27\"   \n   version = \"1.0\"   \n   last_modified = \"2017-03-27\"   \n   reference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"   \n   description = \"Rule to detect log cleaners based on utclean.c\"   \n   reference2 = \"http://cd.textfiles.com/cuteskunk/Unix-Hacking-Exploits/utclean.c\"   \n   hash = \"d98796dcda1443a37b124dbdc041fe3b\"   \n   hash = \"73a518f0a73ab77033121d4191172820\"   \n   strings:   \n   $a1=\"Hiding complit...n\"   \n   $a2=\"usage: %s <username> <fixthings> [hostname]\"   \n   $a3=\"ls -la %s* ; /bin/cp ./wtmp.tmp %s; rm ./wtmp.tmp\"   \n   condition:   \n   (uint32(0)==0x464c457f) and (any of them)   \n   }",
			"type": "YARA",
			"id": 28725378
		},
		{
			"indicator": "b468cbdd0edd4bdb354ce1034bbaf768a0cb67b7",
			"description": "",
			"title": "",
			"content": "rule apt_RU_MoonlightMaze_IRIX_exploit_GEN {   \n   meta:   \n   author = \"Kaspersky Lab\"   \n   date = \"2017-03-27\"   \n   version = \"1.0\"   \n   last_modified = \"2017-03-27\"   \n   reference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"   \n   description = \"Rule to detect Irix exploits from David Hedley used by Moonlight Maze hackers\"   \n   reference2 = \"https://www.exploit-db.com/exploits/19274/\"   \n   hash = \"008ea82f31f585622353bd47fa1d84be\" //df3   \n   hash = \"a26bad2b79075f454c83203fa00ed50c\" //log   \n   hash = \"f67fc6e90f05ba13f207c7fdaa8c2cab\" //xconsole   \n   hash = \"5937db3896cdd8b0beb3df44e509e136\" //xlock   \n   hash = \"f4ed5170dcea7e5ba62537d84392b280\" //xterm   \n   strings:   \n   $a1=\"stack = 0x%x, targ_addr = 0x%x\"   \n   $a2=\"execl failed\"   \n   condition:   \n   (uint32(0)==0x464c457f) and (all of them)   \n   }",
			"type": "YARA",
			"id": 28725379
		},
		{
			"indicator": "3c1f631e9738e9d4d3abb0b0af6bc80168ed7324",
			"description": "",
			"title": "",
			"content": "rule apt_RU_MoonlightMaze_de_tool {   \n   meta:   \n   author = \"Kaspersky Lab\"   \n   date = \"2017-03-27\"   \n   version = \"1.0\"   \n   last_modified = \"2017-03-27\"   \n   reference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"   \n   description = \"Rule to detect Moonlight Maze 'de' and 'deg' tunnel tool\"   \n   hash = \"4bc7ed168fb78f0dc688ee2be20c9703\"   \n   hash = \"8b56e8552a74133da4bc5939b5f74243\"   \n   strings:   \n   $a1=\"Vnuk: %d\" ascii fullword   \n   $a2=\"Syn: %d\" ascii fullword   \n   //%s\\r%s\\r%s\\r%s\\r ->   \n   $a3={25 73 0A 25 73 0A 25 73 0A 25 73 0A}   \n   condition:   \n   ((2 of ($a*)))   \n   }",
			"type": "YARA",
			"id": 28725380
		},
		{
			"indicator": "48763dc1b0bfd08e6cabe012a1a7e72bdbacf91a",
			"description": "",
			"title": "",
			"content": "rule apt_RU_MoonlightMaze_cle_tool {   \n   meta:   \n   author = \"Kaspersky Lab\"   \n   date = \"2017-03-27\"   \n   version = \"1.0\"   \n   last_modified = \"2017-03-27\"   \n   reference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"   \n   description = \"Rule to detect Moonlight Maze 'cle' log cleaning tool\"   \n   hash = \"647d7b711f7b4434145ea30d0ef207b0\"   \n   strings:   \n   $a1=\"./a filename template_file\" ascii wide   \n   $a2=\"May be %s is empty?\" ascii wide   \n   $a3=\"template string = |%s|\" ascii wide   \n   $a4=\"No blocks !!!\"   \n   $a5=\"No data in this block !!!!!!\" ascii wide   \n   $a6=\"No good line\"   \n   condition:   \n   ((3 of ($a*)))   \n   }",
			"type": "YARA",
			"id": 28725382
		},
		{
			"indicator": "e21ad65ee4d3852eadc71404d4fc701cb10d3c47",
			"description": "",
			"title": "",
			"content": "rule apt_RU_MoonlightMaze_customsniffer {   \n   meta:   \n   author = \"Kaspersky Lab\"   \n   date = \"2017-03-15\"   \n   version = \"1.1\"   \n   reference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"   \n   description = \"Rule to detect Moonlight Maze sniffer tools\"   \n   hash = \"7b86f40e861705d59f5206c482e1f2a5\"   \n   hash = \"927426b558888ad680829bd34b0ad0e7\"   \n   original_filename = \"ora;tdn\"   \n   strings:   \n   //strings from ora ->   \n   $a1=\"/var/tmp/gogo\" fullword   \n   $a2=\"myfilename= |%s|\" fullword   \n   $a3=\"mypid,mygid=\" fullword   \n   $a4=\"mypid=|%d| mygid=|%d|\" fullword   \n   //strings from tdn ->   \n   $a5=\"/var/tmp/task\" fullword   \n   $a6=\"mydevname= |%s|\" fullword   \n   condition:   \n   ((any of ($a*)))   \n   }",
			"type": "YARA",
			"id": 28725383
		},
		{
			"indicator": "6cf9953148c1b00c134f2138f59052fdcf1c00ee",
			"description": "",
			"title": "",
			"content": "rule apt_RU_MoonlightMaze_xk_keylogger {   \n   meta:   \n   author = \"Kaspersky Lab\"   \n   date = \"2017-03-27\"   \n   version = \"1.0\"   \n   last_modified = \"2017-03-27\"   \n   reference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"   \n   description = \"Rule to detect Moonlight Maze 'xk' keylogger\"   \n   strings:   \n   $a1=\"Log ended at => %s\"   \n   $a2=\"Log started at => %s [pid %d]\"   \n   $a3=\"/var/tmp/task\" fullword   \n   $a4=\"/var/tmp/taskhost\" fullword   \n   $a5=\"my hostname: %s\"   \n   $a6=\"/var/tmp/tasklog\"   \n   $a7=\"/var/tmp/.Xtmp01\" fullword   \n   $a8=\"myfilename=-%s-\"   \n   $a9=\"/var/tmp/taskpid\"   \n   $a10=\"mypid=-%d-\" fullword   \n   $a11=\"/var/tmp/taskgid\" fullword   \n   $a12=\"mygid=-%d-\" fullword   \n   condition:   \n   ((3 of ($a*)))   \n   }",
			"type": "YARA",
			"id": 28725384
		},
		{
			"indicator": "c258ec5040ed6541a6053a41bedf7e11eabdd12c",
			"description": "",
			"title": "",
			"content": "rule apt_RU_MoonlightMaze_customlokitools {   \n   meta:   \n   author = \"Kaspersky Lab\"   \n   date = \"2017-03-15\"   \n   version = \"1.1\"   \n   last_modified = \"2017-03-22\"   \n   reference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"   \n   description = \"Rule to detect Moonlight Maze Loki samples by custom attackerauthored strings\"   \n   hash = \"14cce7e641d308c3a177a8abb5457019\"   \n   hash = \"a3164d2bbc45fb1eef5fde7eb8b245ea\"   \n   hash = \"dabee9a7ea0ddaf900ef1e3e166ffe8a\"   \n   hash = \"1980958afffb6a9d5a6c73fc1e2795c2\"   \n   hash = \"e59f92aadb6505f29a9f368ab803082e\"   \n   strings:   \n   $a1=\"Write file Ok...\" ascii wide   \n   $a2=\"ERROR: Can not open socket....\" ascii wide   \n   $a3=\"Error in parametrs:\" ascii wide   \n   $a4=\"Usage: @<get/put> <IP> <PORT> <file>\" ascii wide   \n   $a5=\"ERROR: Not connect...\" ascii wide   \n   $a6=\"Connect successful....\" ascii wide   \n   $a7=\"clnt <%d> rqstd n ll kll\" ascii wide   \n   $a8=\"clnt <%d> rqstd swap\" ascii wide   \n   $a9=\"cld nt sgnl prcs grp\" ascii wide   \n   $a10=\"cld nt sgnl prnt\" ascii wide   \n   //keeping only ascii version of string ->   \n   $a11=\"ork error\" ascii fullword   \n   condition:   \n   ((any of ($a*)))   \n   }",
			"type": "YARA",
			"id": 28725385
		},
		{
			"indicator": "80b8b96fb2e050379cceafffc48b651101c2b4d7",
			"description": "",
			"title": "",
			"content": "rule apt_RU_MoonlightMaze_encrypted_keylog {   \n   meta:   \n   author = \"Kaspersky Lab\"   \n   date = \"2017-03-27\"   \n   version = \"1.0\"   \n   last_modified = \"2017-03-27\"   \n   reference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"   \n   description = \"Rule to detect Moonlight Maze encrypted keylogger logs\"   \n   strings:   \n   $a1={47 01 22 2A 6D 3E 39 2C}   \n   condition:   \n   ($a1 at 0)   \n   }",
			"type": "YARA",
			"id": 28725386
		},
		{
			"indicator": "3faae883959bf47d68f12566504090760c8419da",
			"description": "",
			"title": "",
			"content": "rule generic_carbon   \n   {   \n   strings:   \n   $s1 = \"ModStart\"   \n   $s2 = \"ModuleStart\"   \n   $t1 = \"STOP|OK\"   \n   $t2 = \"STOP|KILL\"   \n   condition:   \n   (uint16(0) == 0x5a4d) and (1 of ($s*)) and (1 of ($t*))   \n   }",
			"type": "YARA",
			"id": 28725387
		},
		{
			"indicator": "ecbeeef8b89f3955b508d4cb719c4892ad6cd7f4",
			"description": "",
			"title": "",
			"content": "rule PoS_Malware_NewPOSThings2015 : newposthings2015   \n   {   \n   meta:   \n   author = \"Trend Micro, Inc.\"   \n   date = \"2015-03-10\"   \n   description = \"Used to detect NewPoSThings RAM scraper, including 2015 sample set\"   \n   strings:   \n   $pdb1 = \"C:\\\\Users\\\\Tom\\\\documents\\\\visual studio 2012\\\\Projects\\\\NewPosThings\\\\Release\\\\NewPosThings.pdb\" nocase   \n   $pdb2 = \"C:\\\\Final32\\\\Release\\\\Final.pdb\" nocase   \n   $pdb3 = \"C:\\\\Users\\\\Tom\\\\documents\\\\visual studio 2012\\\\Projects\\\\jsd_12.2\\\\Release\\\\jsd_12.2.pdb\" nocase   \n   $pdb4 = \"C:\\\\Users\\\\Tom\\\\documents\\\\visual studio 2012\\\\Projects\\\\jsd_12.2\\\\x64\\\\Release\\\\jsd_12.2.pdb\" nocase   \n   $string0 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" wide   \n   $string1 = \"Mozilla/4.0(compatible; MSIE 7.0b; Windows NT 6.0)\" wide   \n   $string2 = \"Content-Type: application/x-www-form-urlencoded\" wide   \n   $string3 = \"Use 64bit version.\" wide   \n   $string4 = \"SeDebugPrivilege\" wide   \n   $string5 = \"Java Update Manager\" wide   \n   $string6 = \"Java\\\\Javaj.exe\" wide   \n   $string7 = \"lsass.exe\" wide   \n   $string8 = \"aW5zZXJ0\"   \n   condition:   \n   (any of ($pdb*)) or (all of ($str*))   \n   }",
			"type": "YARA",
			"id": 28854706
		},
		{
			"indicator": "5994cab79e04e8ec25714f9cb24a51bbc4a1fb64",
			"description": "",
			"title": "",
			"content": "rule backdoor_apt_pcclient   \n   {   \n      \n       meta:   \n           author = \"@patrickrolsen\"   \n           maltype = \"APT.PCCLient\"   \n           filetype = \"DLL\"   \n           version = \"0.1\"   \n           description = \"Detects the dropper: 869fa4dfdbabfabe87d334f85ddda234 AKA dw20.dll/msacm32.drv dropped by 4a85af37de44daf5917f545c6fd03902 (RTF)\"   \n           date = \"2012-10\"   \n      \n       strings:   \n           $magic = { 4d 5a } // MZ   \n           $string1 = \"www.micro1.zyns.com\"   \n           $string2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Win32)\"   \n           $string3 = \"msacm32.drv\" wide   \n           $string4 = \"C:\\\\Windows\\\\Explorer.exe\" wide   \n           $string5 = \"Elevation:Administrator!\" wide   \n           $string6 = \"C:\\\\Users\\\\cmd\\\\Desktop\\\\msacm32\\\\Release\\\\msacm32.pdb\"   \n      \n       condition:   \n           $magic at 0 and 4 of ($string*)   \n   }",
			"type": "YARA",
			"id": 28854708
		},
		{
			"indicator": "23cab549bde8e6cd11d1348a3d0ea1c66bf735bc",
			"description": "",
			"title": "",
			"content": "rule Lightserver_variant_B : Red_Salamander\n\n{\n\n      meta:\n\n            description = \"Elise lightserver variant.\"\n\n            author = \"PwC Cyber Threat Operations :: @michael_yip\"\n\n            version = \"1.0\"\n\n            created = \"2015-12-16\"\n\n            exemplar_md5 = \"c205fc5ab1c722bbe66a4cb6aff41190\"\n\n      strings:\n\n            $json = /\\{\\\"r\\\":\\\"[0-9]{12}\\\",\\\"l\\\":\\\"[0-9]{12}\\\",\\\"u\\\":\\\"[0-9]{7}\\\",\\\"m\\\":\\\"[0-9]{12}\\\"\\}/\n\n            $mutant1 = \"Global\\\\{7BDACDEE-8BF6-4664-B946-D00FCFF1FFBA}\"\n\n            $mutant2 = \"{5947BACD-63BF-4e73-95D7-0C8A98AB95F2}\"\n\n            $serv1 = \"Server1=%s\"\n\n            $serv2 = \"Server2=%s\"\n\n            $serv3 = \"Server3=%s\"\n\n      condition:\n\n            uint16(0) == 0x5A4D and ($json or $mutant1 or $mutant2 or all of ($serv*))\n\n}",
			"type": "YARA",
			"id": 28854862
		},
		{
			"indicator": "31880e8affc529d8f50a4d20c875eeb975aa8a35",
			"description": "",
			"title": "",
			"content": "import \"pe\"\n\nrule Elise_lstudio_variant_B_resource\n\n{\n\nmeta:\n\ndescription = \"Elise lightserver variant.\"\n\nauthor = \"PwC Cyber Threat Operations :: @michael_yip\"\n\nversion = \"1.0\"\n\ncreated = \"2015-12-16\"\n\nexemplar_md5 = \"c205fc5ab1c722bbe66a4cb6aff41190\"\n\n \n\ncondition:\n\nuint16(0) == 0x5A4D and for any i in (0..pe.number_of_resources - 1) : (pe.resources[i].type_string == \"A\\x00S\\x00D\\x00A\\x00S\\x00D\\x00A\\x00S\\x00D\\x00A\\x00S\\x00D\\x00S\\x00A\\x00D\\x00\")\n\n}",
			"type": "YARA",
			"id": 28854863
		},
		{
			"indicator": "7d5c5ddfbb53bf83edc1c9ffadd98d5b93f0314b",
			"description": "",
			"title": "",
			"content": "rule apt_sofacy_xtunnel   \n   {   \n      meta:   \n        author = \"Claudio Guarnieri\"   \n      \n      strings:   \n         $xaps = \":\\\\PROJECT\\\\XAPS_\"   \n      \n         $variant11 = \"XAPS_OBJECTIVE.dll\"   \n         $variant12 = \"start\"   \n      \n         $variant21 = \"User-Agent: Mozilla/5.0 (Windows NT 6.3;\"   \n         $variant22 = \"is you live?\"   \n      \n         $mix1 = \"176.31.112.10\"   \n         $mix2 = \"error in select, errno %d\"   \n         $mix3 = \"no msg\"   \n         $mix4 = \"is you live?\"   \n         $mix5 = \"127.0.0.1\"   \n         $mix6 = \"err %d\"   \n         $mix7 = \"i`m wait\"   \n         $mix8 = \"hello\"   \n         $mix9 = \"OpenSSL 1.0.1e 11 Feb 2013\"   \n         $mix10 = \"Xtunnel.exe\"   \n      \n      condition:   \n         ((uint16(0) == 0x5A4D) or (uint16(0) == 0xCFD0)) and   \n         (($xaps) or (all of ($variant1*)) or (all of ($variant2*))   \n   or (6 of ($mix*)))   \n   }",
			"type": "YARA",
			"id": 28856644
		},
		{
			"indicator": "d86e4e29a47311ed239cbefc31616e431bf2d008",
			"description": "",
			"title": "",
			"content": "rule bbsrat {   \n   \tmeta:   \n   \t\tauthor = \"Tyler Halfpop\"   \n   \t\tcompany = \"Palo Alto Networks\"   \n   \t\tlast_updated = \"12-16-15\"   \n      \n   \tstrings:   \n   \t\t$sa0 = \"%ALLUSERSPROFILE%\\\\SSONSVR\" fullword wide   \n   \t\t$sa1 = \"%ALLUSERSPROFILE%\\\\Application Data\\\\SSONSVR\" fullword wide   \n   \t\t$sa2 = \"\\\\ssonsvr.exe\" fullword wide   \n   \t\t$oa0 = { 83 E8 01 88 0C 04 75 F8 8B 44 24 40 89 4C 24 18 89 4C 24 1C 89 4C 24 30 89 4C 24 34 89 4C 24 20 89 4C 24 38 8D 0C 24 51 C7 44 24 04 3C 00 00 00 C7 44 24 08 40 00 00 00 C7 44 24 10 70 20 40 00 C7 44 24 14 A0 20 40 00 89 44 24 18 FF 15 54 20 40 00 85 C0 75 04 83 C4 3C C3 }   \n   \t\t$oa1 = { 75 11 5F 5E B8 0D 00 00 00 5B 81 C4 ?? 07 00 00 C2 10 00 53 68 80 00 00 00 6A 02 53 6A 02 6A 02 8D 54 24 ?? 52 89 5C 24 30 FF 15 38 20 40 00 }   \n   \t\t$sb0 = \"%systemroot%\\\\Web\\\\\"   \n   \t\t$sb1 = \"srvcl32.dll\"   \n   \t\t$ob0 = { B8 67 66 66 66 F7 E9 D1 FA 8B C2 C1 E8 1F 03 C2 8D 04 80 8B D1 2B D0 8A 44 94 04 30 81 08 58 40 00 41 3B CE 7C DA B8 08 58 40 00 5E 83 C4 14 C3 }   \n   \t\t$ob1 = { 8D 84 24 18 02 00 00 50 C7 84 24 1C 02 00 00 94 00 00 00 FF 15 4C 20 40 00 8B 8C 24 20 02 00 00 0F B7 94 24 1C 02 00 00 C1 E9 10 0B CA 83 F9 06 0F 85 7F 00 00 00 }   \n      \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and filesize < 300KB and (all of ($sa*) or all of ($oa*) or all of ($sb*) or all of ($ob*))   \n   }",
			"type": "YARA",
			"id": 28856645
		},
		{
			"indicator": "4dfc8e3f62db09d25c7d8ee08ef26d60a685faed",
			"description": "",
			"title": "",
			"content": "rule hancitor_dropper : vb_win32api   \n   {   \n     meta:   \n       author = \"Jeff White - jwhite@paloaltonetworks @noottrak\"   \n       date   = \"18AUG2016\"   \n       hash1  = \"03aef51be133425a0e5978ab2529890854ecf1b98a7cf8289c142a62de7acd1a\"   \n       hash2  = \"4b3912077ef47515b2b74bc1f39de44ddd683a3a79f45c93777e49245f0e9848\"   \n       hash3  = \"a78972ac6dee8c7292ae06783cfa1f918bacfe956595d30a0a8d99858ce94b5a\"   \n       \n     strings:   \n       $api_01 = { 00 56 69 72 74 75 61 6C 41 6C 6C 6F 63 00 }  // VirtualAlloc   \n       $api_02 = { 00 52 74 6C 4D 6F 76 65 4D 65 6D 6F 72 79 00 }  // RtlMoveMemory   \n       $api_04 = { 00 43 61 6C 6C 57 69 6E 64 6F 77 50 72 6F 63 41 00 }  // CallWindowProcAi   \n       $magic  = { 50 4F 4C 41 }  // POLA   \n       \n     condition:   \n       uint32be(0) == 0xD0CF11E0 and all of ($api_*) and $magic   \n   }",
			"type": "YARA",
			"id": 28856646
		},
		{
			"indicator": "ce7fe3f82ca70f8d9c783cba81318a83ee798d7a",
			"description": "",
			"title": "",
			"content": "rule PoS_Malware_fastpos2 : FastPOS2   \n   {   \n   meta:   \n    author = \"Trend Micro, Inc\"   \n    date = \"2016-09-21\"   \n    description = \"Used to detect newer FastPOS variants and their modules.\"   \n    sample_filetype = \"exe\"   \n   strings:   \n    $pdb0 =\"\\\\_hookLoader\\\\Release\\\\_hookLoader.pdb\" nocase   \n    $pdb1 =\"\\\\_hookKlg\\\\Release\\\\_hookKlg.pdb\" nocase   \n    $pdb2 =\"\\\\_hookKlg\\\\x64\\\\Release\\\\_hookKlg.pdb\" nocase   \n    $pdb3 =\"\\\\_hookProc\\\\Release\\\\_hookProc.pdb\" nocase   \n    $pdb4 =\"\\\\_hookProc\\\\x64\\\\Release\\\\_hookProc.pdb\" nocase   \n    $pdb5 =\"\\\\_hookRecvSrvc\\\\Release\\\\_hookRecvSrvc.pdb\" nocase   \n    $exec_ref0 = \"\\\\kl32.exe\"   \n    $exec_ref1 = \"\\\\servhelp.exe\"   \n    $exec_ref2 = \"\\\\kbd.exe\"   \n    $exec_ref3 = \"\\\\servproc.exe\"   \n    $exec_ref4 = \"\\\\service.exe\"   \n    $exec_ref5= \"\\\\proc64.exe\"   \n    $exec_ref6 = \"\\\\proc32.exe\"   \n    $exec_ref7 = \"//cdosys.php\"   \n    $string0 = \"DeleteService\"   \n    $string1 = \"CreateMailslotA\"   \n    $string2 = \"StartServiceCtrlDispatcherA\"   \n    $string3 = \"\\\\\\\\.\\\\mailslot\\\\trackslot\"   \n    $string4 = \"Can't install hook service\"   \n    $string5 = \" -r to remove hook.\" wide   \n   condition:   \n    (any of ($pdb*)) and (3 of ($exec_ref*)) and (2 of ($string*))   \n   }",
			"type": "YARA",
			"id": 28856652
		},
		{
			"indicator": "7f72091e829266bb134cf224b592fb0b93b7f771",
			"description": "",
			"title": "",
			"content": "rule StreamEx   \n   {   \n      \n   strings:   \n       $a = \"0r+8DQY97XGB5iZ4Vf3KsEt61HLoTOuIqJPp2AlncRCgSxUWyebhMdmzvFjNwka=\"   \n       $b = {34 ?? 88 04 11 48 63 C3 48 FF C1 48 3D D8 03 00 00}   \n       $bb = {81 86 ?? ?? 00 10 34 ?? 88 86 ?? ?? 00 10 46 81 FE D8 03 00 00}   \n       $c = \"greendll\"   \n       $d = \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36\" wide   \n       $f = {26 5E 25 24 23 91 91 91 91}   \n       $g = \"D:\\\\pdb\\\\ht_d6.pdb\"    \n      \n   condition:   \n       $a or $b or $bb or ($c and $d) or $f or $g   \n   }",
			"type": "YARA",
			"id": 28856653
		},
		{
			"indicator": "db20b7369936d92eaac3badab88a21e8b34ece0d",
			"description": "",
			"title": "",
			"content": "rule crime_linux_umbreon : rootkit   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Catches Umbreon rootkit\"   \n   \t\treference = \"http://blog.trendmicro.com/trendlabs-security-intelligence/pokemon-themed-umbreon-linux-rootkit-hits-x86-arm-systems\"   \n   \t\tauthor = \"Fernando Merces, FTR, Trend Micro\"   \n   \t\tdate = \"2016-08\"   \n   \t   \n   \tstrings:   \n   \t\t$ = { 75 6e 66 75 63 6b 5f 6c 69 6e 6b 6d 61 70 }   \n   \t\t$ = \"unhide.rb\" ascii fullword   \n   \t\t$ = \"rkit\" ascii fullword   \n      \n   \tcondition:   \n   \t\tuint32(0) == 0x464c457f // Generic ELF header   \n   \t\tand uint8(16) == 0x0003 // Shared object file   \n   \t\tand all of them   \n   }",
			"type": "YARA",
			"id": 28856654
		},
		{
			"indicator": "0b9b7d51930909320e0939cbd3c83e0bc6ef3c28",
			"description": "",
			"title": "",
			"content": "rule crime_linux_umbreon_espeon : rootkit backdoor   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Catches Umbreon strace rootkit component\"   \n   \t\treference = \"http://blog.trendmicro.com/trendlabs-security-intelligence/pokemon-themed-umbreon-linux-rootkit-hits-x86-arm-systems\"   \n   \t\tauthor = \"Fernando Merces, FTR, Trend Micro\"   \n   \t\tdate = \"2016-08\"   \n      \n   \tstrings:   \n   \t\t$ = \"Usage: %s [interface]\" fullword   \n   \t\t$ = \"Options:\" fullword   \n   \t\t$ = \"    interface    Listen on <interface> for packets.\" fullword   \n   \t\t$ = \"/bin/espeon-shell %s %hu\"   \n   \t\t$ = { 66 75 63 6b 20 6f 66 66 20 63 75 6e 74 }   \n   \t\t$ = \"error: unrecognized command-line options\" fullword   \n      \n   \tcondition:   \n   \t\tuint32(0) == 0x464c457f // Generic ELF header   \n   \t\tand uint8(16) == 0x0002 // Executable file   \n   \t\tand all of them   \n   }",
			"type": "YARA",
			"id": 28856655
		},
		{
			"indicator": "dce0ca50f071443fae4884be8d507e576e677bf5",
			"description": "",
			"title": "",
			"content": "rule crime_linux_umbreon_strace : rootkit   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Catches Umbreon strace rootkit component\"   \n   \t\treference = \"http://blog.trendmicro.com/trendlabs-security-intelligence/pokemon-themed-umbreon-linux-rootkit-hits-x86-arm-systems\"   \n   \t\tauthor = \"Fernando Merces, FTR, Trend Micro\"   \n   \t\tdate = \"2016-08\"   \n   \t   \n   \tstrings:   \n   \t\t$ = \"LD_PRELOAD\" fullword   \n   \t\t$ = /ld\\.so\\.[a-zA-Z0-9]{7}/ fullword   \n   \t\t$ = \"\\\"/etc/ld.so.preload\\\"\" fullword   \n   \t\t$ = \"fputs_unlocked\" fullword   \n      \n   \tcondition:   \n   \t\tuint32(0) == 0x464c457f // Generic ELF header   \n   \t\tand uint8(16) == 0x0003 // Shared object file   \n   \t\tand all of them   \n   }",
			"type": "YARA",
			"id": 28856656
		},
		{
			"indicator": "f6f97c38b75b48753affb0b94b9c1d3b3505ff0f",
			"description": "",
			"title": "",
			"content": "rule tofsee   \n   {   \n       meta:   \n       author=\"akrasuski1\"   \n   \tstrings:   \n      \n   \t$decryptStr = {32 55 14\t88 10 8A D1 02 55 18 F6 D9 00 55 14}   \n   \t$xorGreet = {C1 EB 03 C0 E1 05 0A D9 32 DA 34 C6 88 1E}   \n   \t$xorCrypt = {F7 FB 8A 44 0A 04 30 06 FF 41 0C}   \n      \n   \t$string_res1 = \"loader_id\"   \n   \t$string_res2 = \"born_date\"   \n   \t$string_res3 = \"work_srv\"   \n   \t$string_res4 = \"flags_upd\"   \n   \t$string_res5 = \"lid_file_upd\"   \n   \t$string_res6 = \"localcfg\"   \n      \n   \t$string_var0 = \"%RND_NUM\"   \n   \t$string_var1 = \"%SYS_JR\"   \n   \t$string_var2 = \"%SYS_N\"   \n   \t$string_var3 = \"%SYS_RN\"   \n   \t$string_var4 = \"%RND_SPACE\"   \n   \t$string_var5 = \"%RND_DIGIT\"   \n   \t$string_var6 = \"%RND_HEX\"   \n   \t$string_var7 = \"%RND_hex\"   \n   \t$string_var8 = \"%RND_char\"   \n   \t$string_var9 = \"%RND_CHAR\"   \n      \n       condition:   \n   \t\t(7 of ($string_var*) and 4 of ($string_res*))   \n   \t\tor   \n   \t\t(7 of ($string_var*) and 2 of ($decryptStr, $xorGreet, $xorCrypt))   \n   \t\tor   \n   \t\t(4 of ($string_res*) and 2 of ($decryptStr, $xorGreet, $xorCrypt))   \n   }",
			"type": "YARA",
			"id": 28856657
		},
		{
			"indicator": "b4f4d712b184768746d5eb390d513c8bf35eb0a0",
			"description": "",
			"title": "",
			"content": "rule Molerats_certs   \n      \n   {   \n      \n   meta:   \n      \n   author = \"FireEye Labs\"   \n      \n   description = \"this rule detections code signed with certificates used by the Molerats actor\"   \n      \n   strings:   \n      \n   $cert1 = {06 50 11 A5 BC BF 83 C0 93 28 16 5E 7E 85 27 75}   \n      \n   $cert2 = {03 e1 e1 aa a5 bc a1 9f ba 8c 42 05 8b 4a bf 28}   \n      \n   $cert3 = {0c c0 35 9c 9c 3c da 00 d7 e9 da 2d c6 ba 7b 6d}   \n      \n   condition:   \n      \n   1 of ($cert*)   \n      \n   }",
			"type": "YARA",
			"id": 28856658
		},
		{
			"indicator": "c8f0461406f5acd664e026a862a196134b15b4ec",
			"description": "",
			"title": "",
			"content": "rule PoS_Malware_RawPOS2015_dumper : RawPOS2015_dumper   \n   {   \n   meta:   \n    author = \"Trend Micro, Inc.\"   \n    date = \"2015-03-10\"   \n    description = \"Used to detect RawPOS RAM dumper, including 2015 sample set\"   \n    sample_filetype = \"exe\"   \n   strings:   \n    $string1 = \"(1[0-2]))([0-9]\"   \n    $string2 = \"(1[0-2]))[0-9]{8,30})\"   \n    $string3 = \"((B(([0-9]{13,16})\"   \n    $mess1 = \"Found track data at %s with PID %d\"   \n    $mess2 = \"Enter Process Id: \"   \n    $mess3 = \" Dump private process memory by PID\"   \n    $mess4 = \"Dumping private memory for pid %s to %s.dmp...\"   \n    $mess5 = \" Full private dump of all running processes\"   \n    $memd1 = \"memdump\\\\%s-%d.dmp\"   \n    $memd2 = \"mkdir memdump >NUL 2>NUL\"   \n   condition:   \n    (all of ($memd*)) and (all of ($mess*)) and (any of ($string*))   \n   }",
			"type": "YARA",
			"id": 28856659
		},
		{
			"indicator": "e091f6fbffab1c9ec88342e95ed6ce1732de2634",
			"description": "",
			"title": "",
			"content": "rule rawpos_service   \n   {   \n   \tmeta:   \n   \t\tdescription = \"RAW.Pos is a fairly prevalent memory scraper that has been seen on a number of cases. This detection discovers the service component to this malware family.\"   \n   \t\tcategory = \"Point of Sale\"   \n   \t\tauthor = \"Josh Grunzweig\"   \n      \n   \tstrings:   \n   \t\t$string1 = \"install\"   \n   \t\t$string2 = \"remove\"   \n   \t\t$string3 = \"debug\"   \n   \t\t$string4 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\EventLog\\\\Application\\\\%s\"   \n   \t\t$string5 = \"\\\\\\\\.\\\\pipe\\\\susrv\"   \n      \n   \t\t$cmd = /start \\/min \\w+\\.exe/   \n      \n   \tcondition:   \n   \t\tall of ($string*) and #cmd > 1   \n   }",
			"type": "YARA",
			"id": 28856660
		},
		{
			"indicator": "472999e69f73ec33a239cdaa32df1a8e5897cec0",
			"description": "",
			"title": "",
			"content": "rule PoS_Malware_RawPOS2015_dumper_old : RawPOS2015_dumper_old   \n   {   \n   meta:   \n    author = \"Trend Micro, Inc.\"   \n    date = \"2015-03-10\"   \n    description = \"Used to detect RawPOS memory dumper, pre-2012\"   \n    sample_filetype = \"exe\"   \n   strings:   \n    $string0 = \" Full private dump of all running processes\"   \n    $string1 = \" show info on Process like Path\"   \n    $string2 = \" Show this help\"   \n    $string3 = \" List all running processes\"   \n    $string4 = \"Dumping private memory for pid %s to %s.dmp...\"   \n    $string5 = \"%s-%d.dmp\"   \n    $string6 = \"memdump\\\\%s-%d.dmp\"   \n    $string7 = \"del memdump\\\\\"   \n    $string8 = \"Process Memory Dumper\"   \n    $string9 = \"Base size: %u\"   \n    $string10 = \"Module ID: %u\"   \n    $string11 = \"Hex: %xh\"   \n   condition:   \n    all of ($string*)   \n   }",
			"type": "YARA",
			"id": 28856661
		},
		{
			"indicator": "ccb4ab685fa96973ce1cbd0f4ac9cd271c2e4f49",
			"description": "",
			"title": "",
			"content": "rule rawpos   \n   {   \n   \tmeta:   \n   \t\tdescription = \"RAW.Pos is a fairly prevalent memory scraper that has been seen on a number of cases\"   \n   \t\tcategory = \"Point of Sale\"   \n   \t\tauthor = \"Josh Grunzweig\"   \n      \n   \tstrings:   \n   \t\t$_main = { 55 8B EC 81 C4 00 F8 FF FF 53 56 57 8B 75 0C 6A 00 E8 0A 09 00 00 59 6A ?? E8 ?? B0 00 00 59 FF 36 68 ?? ?? ?? ?? 8D 85 00 F8 FF FF 50 E8 ?? ?? ?? ?? 83 C4 0C 8D 95 00 F8 FF FF 52 E8 ?? B0 00 00 59 6A 00 E8 ?? 9D 00 00 }   \n      \n   \t\t$string1 = \"cmd /C start %s\"   \n   \t\t$string2 = \"pid-%s.dmp\"   \n   \t\t$string3 = \"Dumping private memory for pid %s to %s.dmp...\"   \n   \t\t$string4 = \"Process Memory Dumper\"   \n   \t\t$string5 = \"Made By: DiabloHorn (Proud Member of: KD-Team)\"   \n   \t\t$string6 = \"Found track data at %s with PID %d!\"   \n   \t\t$string7 = \"memdump\\\\data-%s-%d.dmp\"   \n      \n   \tcondition:   \n   \t\t$_main or all of ($string*)   \n   }",
			"type": "YARA",
			"id": 28856662
		},
		{
			"indicator": "04cdd94fecc6ce9993498c9008faf15299db5f41",
			"description": "",
			"title": "",
			"content": "rule Lionrock_Loader   \n   {   \n   strings:   \n                 $a = \"sfarfdk|amiqd|s\"   \n                 $b = \"s1-s{wlsz,s\"   \n                 $c = \"q}llyer|eldll\"   \n   condition:   \n                 ($a and $b) or $c   \n   }",
			"type": "YARA",
			"id": 28856663
		},
		{
			"indicator": "c36e0720e8dcde84c8d4d89aef2086145d835f02",
			"description": "",
			"title": "",
			"content": "rule Lionrock_Powershell   \n   {   \n   strings:   \n                 $http = \"hffbZ]]\"   \n                 $geo = \"www\\\\ue}qifies\\\\xb]\"   \n   condition:   \n                 $http or $geo   \n   }",
			"type": "YARA",
			"id": 28856664
		},
		{
			"indicator": "368d1790b0d3af35b4f13b08c4959ddb6cf874f0",
			"description": "",
			"title": "",
			"content": "rule Lionrock_Backdoor   \n   {   \n   strings:   \n                 $a = \"windows\\\\currentversion\\\\run;reglist\"   \n                 $power = \"b}wershell\\\\eje@M|}br}tile@)|v}yeM1}mma|d@Msqribfpl}qy{DbafhOUEsU[DdafaO5efM1}|fe|f@Dbafh[t}reaqhHDqmd@i|@DdafaI{iej@Dqmd[oo\"              $b = \"agf}ejeqdir\"   \n                $c = \"sfarfdk|amiqd|s\"   \n   condition:   \n                $power or $b or ($a and $c)   \n   }",
			"type": "YARA",
			"id": 28856665
		},
		{
			"indicator": "496c2a3470df875f41457508e38b215ca14eb34f",
			"description": "",
			"title": "",
			"content": "rule Typhoon_Downloader   \n   {   \n   strings:   \n                 $ps = \"<<<:resource\"   \n                 $exp = \"start_adobeup\"   \n                 $e = \"W78D432S34A9\"   \n                 $f = \"!SJ1B0RSWRKK\"   \n                 $b = \"wyy}EBB\"   \n                 $geo = \"hhhCjzbnvyvzlCg}B\"   \n   condition:   \n                 $ps or $exp or ($e and $f) or $b or $geo   \n   }",
			"type": "YARA",
			"id": 28856666
		},
		{
			"indicator": "81a5ae51ffd1ba3db8132b1e95fa9837d229f7c0",
			"description": "",
			"title": "",
			"content": "rule APT32_ActiveMime_Lure {   \n     meta:   \n       filetype=\"MIME entity\"   \n       author=\"Ian Ahl (@TekDefense) and Nick Carr (@ItsReallyNick)\"   \n       date=\"2017-03-02\"   \n       description=\"Developed to detect APT32 (OceanLotus group) phishing lures used to target FireEye customers in 2016 and 2017\"   \n          \n     strings:   \n       $a1= \"office_text\" wide ascii   \n       $a2= \"schtasks /create /tn\" wide ascii   \n       $a3= \"scrobj.dll\" wide ascii   \n       $a4= \"new-object net.webclient\" wide ascii   \n       $a5= \"GetUserName\" wide ascii   \n       $a6= \"WSHnet.UserDomain\" wide ascii   \n       $a7= \"WSHnet.UserName\" wide ascii   \n     condition:   \n       4 of them   \n   }",
			"type": "YARA",
			"id": 28856667
		},
		{
			"indicator": "f0433b68a66028565a8452457ed31728b4222018",
			"description": "",
			"title": "",
			"content": "rule EternalRocks_shadowbrokers   \n   {   \n       strings:   \n           $s0 = \"eternalblue\" fullword ascii   \n           $s1 = \"eternalchampion\" fullword ascii   \n           $s2 = \"eternalromance\" fullword ascii   \n           $s3 = \"eternalsynergy\" fullword ascii   \n           $s4 = \"shellcode\" ascii   \n           $s5 = \".inconfig.xml\" ascii   \n      \n       condition:   \n           uint16(0) == 0x4b50 and all of them   \n   }",
			"type": "YARA",
			"id": 28856668
		},
		{
			"indicator": "e5e1e67515eb2fd53ff8933ff33dc230907112e1",
			"description": "",
			"title": "",
			"content": "rule EternalRocks_UpdateInstaller   \n   {   \n       strings:   \n           $s0 = \"C:\\\\Users\\\\tmc\\\\Documents\\\\\" ascii   \n           $s1 = \"C:\\\\Users\\\\tmc\\\\Documents\\\\\" wide   \n           $s2 = \"20b70e57-1c2e-4de9-99e5-69f369006912\" fullword wide   \n           $s3 = \"{8F6F0AC4-B9A1-45fd-A8CF-727220DE8F}\" fullword wide   \n           $s4 = \"ubgdgno5eswkhmpy.onion\" fullword wide   \n           $s5 = \"Wrote SVCHOST to File System\" fullword wide   \n           $s6 = \"Going to copy SharpZLib now\" fullword wide   \n           $s7 = \"Already Copied Task Scheduler\" fullword wide   \n           $s8 = \"required.glo\" fullword wide   \n           $s9 = \"\\\\Tor\\\\tor.exe \\\"Microsoft Update Installer\\\" ENABLE\" fullword wide   \n           $s10 = \"C:\\\\Program Files\\\\Microsoft Updates\" fullword wide   \n           $s11 = \"MicroBotMassiveNet\" fullword ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and 2 of them   \n   }",
			"type": "YARA",
			"id": 28856669
		},
		{
			"indicator": "5a5d6f2f7c0640341704fe6883cc640445d6ddff",
			"description": "",
			"title": "",
			"content": "rule EternalRocks_svchost   \n   {   \n       strings:   \n           $s0 = \"Microsoft.Win32.TaskScheduler\" fullword ascii   \n           $s1 = \"svchost.exe\" fullword ascii   \n           $s2 = \"svchost.exe\" fullword wide   \n           $s3 = \"ConfusedByAttribute\" fullword ascii   \n           $s4 = \"ICSharpCode.SharpZipLib\" fullword ascii   \n           $s5 = \"Microsoft 2017\" fullword ascii   \n       condition:   \n           uint16(0) == 0x5a4d and all of them   \n   }",
			"type": "YARA",
			"id": 28856670
		},
		{
			"indicator": "33c689db1378ba23eb903a2436eb776c3ca46a50",
			"description": "",
			"title": "",
			"content": "rule EternalRocks_TorUnzip   \n   {   \n       strings:   \n           $s0 = \"c:\\\\Program Files\\\\Microsoft Updates\\\\temp\\\\tor.zip\" wide   \n           $s1 = \"C:\\\\Users\\\\tmc\\\\Documents\\\\TorUnzip\\\\Project1.vbp\" wide   \n           $s2 = \"TorUnzip\" fullword ascii   \n           $s3 = \"WindowsUnZip\" fullword ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and 3 of them   \n   }",
			"type": "YARA",
			"id": 28856671
		},
		{
			"indicator": "20dffdf1847813e84e494e57a10816ee731b369e",
			"description": "",
			"title": "",
			"content": "rule EternalRocks_taskhost_final   \n   {   \n       strings:   \n           $s0 = \"EternalRocks\" fullword wide   \n           $s1 = \"EternalRocks\" fullword ascii   \n           $s2 = \"20D5CCEE9C91A1E61F72F46FA117B93FB006DB51\" fullword ascii   \n           $s5 = \"4086658a-cbbb-11cf-b604-00c04fd8d565\" fullword ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and 3 of them   \n   }",
			"type": "YARA",
			"id": 28856672
		},
		{
			"indicator": "cbaf67b378fe0c7941d2dde112bcc2b37a918a59",
			"description": "",
			"title": "",
			"content": "rule MiSType_Backdoor_Packed   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cylance SPEAR Team\"   \n   \t\tnote = \"Probably Prone to False Positive\"   \n      \n   \tstrings:   \n   \t\t$upx = {33 2E 30 33 00 55 50 58 21}   \n   \t\t$send_httpquery = {00 00 00 48 74 74 70 51 75 65 72 79 49 6E 66 6F 41 00 00 73 65 6E 64 00 00}   \n   \t\t$delphi_sec_pe = {50 45 00 00 4C 01 03 00 19 5E 42 2A}   \n   \t   \n   \tcondition:   \n   \t\tfilesize < 100KB and $upx and $send_httpquery and $delphi_sec_pe   \n   }",
			"type": "YARA",
			"id": 29315710
		},
		{
			"indicator": "2cea564c07fbe2c6fa21c64cdc1f0a81fabaabc1",
			"description": "",
			"title": "",
			"content": "rule Misdat_Backdoor_Packed   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cylance SPEAR Team\"   \n   \t\tnote = \"Probably Prone to False Positive\"   \n      \n   \tstrings:   \n   \t\t$upx = {33 2E 30 33 00 55 50 58 21}   \n   \t\t$send = {00 00 00 73 65 6E 64 00 00 00}   \n   \t\t$delphi_sec_pe = {50 45 00 00 4C 01 03 00 19 5E 42 2A}   \n   \t\t$shellexec = {00 00 00 53 68 65 6C 6C 45 78 65 63 75 74 65 57 00 00 00}   \n   \t\t   \n   \tcondition:   \n   \t\tfilesize < 100KB and $upx and $send and $delphi_sec_pe and $shellexec   \n   }",
			"type": "YARA",
			"id": 29315711
		},
		{
			"indicator": "4b11705f0a4b56c1ee17b12441c91f7457490972",
			"description": "",
			"title": "",
			"content": "rule Zlib_Backdoor   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cylance SPEAR Team\"   \n   \t\t   \n   \t\t/* String   \n   \t\tC7 45 FC 00 04 00 00    \t  mov     [ebp+Memory], 400h   \n   \t\tC6 45 D8 50                   mov     [ebp+Str], 'P'   \n   \t\tC6 45 D9 72                   mov     [ebp+var_27], 'r'   \n   \t\tC6 45 DA 6F                   mov     [ebp+var_26], 'o'   \n   \t\tC6 45 DB 78                   mov     [ebp+var_25], 'x'   \n   \t\tC6 45 DC 79                   mov     [ebp+var_24], 'y'   \n   \t\tC6 45 DD 2D                   mov     [ebp+var_23], '-'   \n   \t\tC6 45 DE 41                   mov     [ebp+var_22], 'A'   \n   \t\tC6 45 DF 75                   mov     [ebp+var_21], 'u'   \n   \t\tC6 45 E0 74                   mov     [ebp+var_20], 't'   \n   \t\tC6 45 E1 68                   mov     [ebp+var_1F], 'h'   \n   \t\tC6 45 E2 65                   mov     [ebp+var_1E], 'e'   \n   \t\tC6 45 E3 6E                   mov     [ebp+var_1D], 'n'   \n   \t\tC6 45 E4 74                   mov     [ebp+var_1C], 't'   \n   \t\tC6 45 E5 69                   mov     [ebp+var_1B], 'i'   \n   \t\tC6 45 E6 63                   mov     [ebp+var_1A], 'c'   \n   \t\tC6 45 E7 61                   mov     [ebp+var_19], 'a'   \n   \t\tC6 45 E8 74                   mov     [ebp+var_18], 't'   \n   \t\tC6 45 E9 65                   mov     [ebp+var_17], 'e'   \n   \t\tC6 45 EA 3A                   mov     [ebp+var_16], ':'   \n   \t\tC6 45 EB 20                   mov     [ebp+var_15], ' '   \n   \t\tC6 45 EC 4E                   mov     [ebp+var_14], 'N'   \n   \t\tC6 45 ED 54                   mov     [ebp+var_13], 'T'   \n   \t\tC6 45 EE 4C                   mov     [ebp+var_12], 'L'   \n   \t\tC6 45 EF 4D                   mov     [ebp+var_11], 'M'   \n   \t\tC6 45 F0 20                   mov     [ebp+var_10], ' '   \n   \t\t*/   \n      \n      \n   \tstrings:   \n   \t\t$auth = {C6 45 D8 50 C6 45 D9 72 C6 45 DA 6F C6 45 DB 78 C6 45 DC 79 C6 45 DD 2D}   \n   \t\t$auth2 = {C7 45 FC 00 04 00 00 C6 45 ?? 50 C6 45 ?? 72 C6 45 ?? 6F}   \n   \t\t$ntlm = \"NTLM\" wide   \n   \t   \n   \tcondition:   \n   \t\t($auth or $auth2) and $ntlm   \n   }",
			"type": "YARA",
			"id": 29315712
		},
		{
			"indicator": "502469a0b8658b4c20c42873f6fc42f2132fa938",
			"description": "",
			"title": "",
			"content": "rule Misdat_Backdoor   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cylance SPEAR Team\"   \n   \t\t/* Decode Function   \n   \t\tCODE:00406C71 8B 55 F4\t\t\t\t\tmov     edx, [ebp+var_C]   \n   \t\tCODE:00406C74 8A 54 1A FF\t\t\t\tmov     dl, [edx+ebx-1]   \n   \t\tCODE:00406C78 8B 4D F8\t\t\t\t\tmov     ecx, [ebp+var_8]   \n   \t\tCODE:00406C7B C1 E9 08 \t\t\t\t\tshr     ecx, 8   \n   \t\tCODE:00406C7E 32 D1\t\t\t\t\t\txor     dl, cl   \n   \t\tCODE:00406C80 88 54 18 FF\t\t\t\tmov     [eax+ebx-1], dl   \n   \t\tCODE:00406C84 8B 45 F4\t\t\t\t\tmov     eax, [ebp+var_C]   \n   \t\tCODE:00406C87 0F B6 44 18 FF\t\t\tmovzx   eax, byte ptr [eax+ebx-1]   \n   \t\tCODE:00406C8C 03 45 F8\t\t\t\t\tadd     eax, [ebp+var_8]   \n   \t\tCODE:00406C8F 69 C0 D9 DB 00 00  \t\timul    eax, 0DBD9h   \n   \t\tCODE:00406C95 05 3B DA 00 00 \t\t\tadd     eax, 0DA3Bh   \n   \t\tCODE:00406C9A 89 45 F8 \t\t\t\t\tmov     [ebp+var_8], eax   \n   \t\tCODE:00406C9D 43 \t\t\t\t\t\tinc     ebx   \n   \t\tCODE:00406C9E 4E \t\t\t\t\t\tdec     esi   \n   \t\tCODE:00406C9F 75 C9 \t\t\t\t\tjnz     short loc_406C6A   \n   \t\t*/   \n   \tstrings:   \n   \t\t$imul = {03 45 F8 69 C0 D9 DB 00 00 05 3B DA 00 00}   \n   \t\t$delphi = {50 45 00 00 4C 01 08 00 19 5E 42 2A}   \n   \t\t   \n   \tcondition:   \n   \t\t$imul and $delphi   \n   }",
			"type": "YARA",
			"id": 29315713
		},
		{
			"indicator": "31d2d6121c8a3a96dc7f388b57c1b5b1406dea19",
			"description": "",
			"title": "",
			"content": "rule SType_Backdoor   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Cylance SPEAR Team\"   \n   \t\t   \n   \t\t/* Decode Function   \n   \t\t8B 1A\t\tmov     ebx, [edx]   \n   \t\t8A 1B\t\tmov     bl, [ebx]   \n   \t\t80 EB 02\tsub     bl, 2   \n   \t\t8B 74 24 08 mov     esi, [esp+14h+var_C]   \n   \t\t32 1E\t\txor     bl, [esi]   \n   \t\t8B 31\t\tmov     esi, [ecx]   \n   \t\t88 1E\t\tmov     [esi], bl   \n   \t\t8B 1A\t\tmov     ebx, [edx]   \n   \t\t43\t\t\tinc     ebx   \n   \t\t89 1A\t\tmov     [edx], ebx   \n   \t\t8B 19\t\tmov     ebx, [ecx]   \n   \t\t43\t\t\tinc     ebx   \n   \t\t89 19\t\tmov     [ecx], ebx   \n   \t\t48\t\t\tdec     eax   \n   \t\t75 E2\t\tjnz     short loc_40EAC6   \n   \t\t*/   \n      \n   \tstrings:   \n   \t\t$stype = \"stype=info&data=\"   \n   \t\t$mmid = \"?mmid=\"   \n   \t\t$status = \"&status=run succeed\"   \n   \t\t$mutex = \"_KB10B2D1_CIlFD2C\"   \n   \t\t$decode = {8B 1A 8A 1B 80 EB 02 8B 74 24 08 32 1E 8B 31 88 1E 8B 1A 43}   \n   \t   \n   \tcondition:   \n   \t\t$stype or ($mmid and $status) or $mutex or $decode   \n   }",
			"type": "YARA",
			"id": 29315714
		},
		{
			"indicator": "e4cb8411c5edf69857da92a1ea492a629e2ea470",
			"description": "",
			"title": "",
			"content": "rule explosive_exe   \n   {   \n    meta:   \n    author = \"Check Point Software Technologies Inc.\"   \n    info = \"Explosive EXE\"   \n    strings:   \n    $MZ = \"MZ\"   \n    $DLD_S = \"DLD-S:\"   \n    $DLD_E = \"DLD-E:\"   \n    condition:   \n    $MZ at 0 and all of them   \n   }",
			"type": "YARA",
			"id": 29315715
		},
		{
			"indicator": "afb1a838b028133de2e69b6b24cc85997e632881",
			"description": "",
			"title": "",
			"content": "rule buhtrapknock {   \n      \n   meta:   \n      \n    author = \"Curt Wilson\"   \n    org    = \"Arbor Networks ASERT\"   \n    hash   = \"a0c428ae70bfc7fff66845698fb8ce045bffb3114dde4ea2eac19561a619c6c8\"   \n    desc   = \"connects to C2 and issues HTTP client request for knock.html\"   \n      \n   strings:   \n      \n    $s1 = \"C:\\\\Users\\\\dev\\\\Documents\\\\Visual Studio 2015\\\\Projects\\\\knock\\\\Release\\\\knock.pdb\" ascii wide   \n    $s2 = \"User-Agent: Mozilla/5.0 (compatible; MSIE 273.0; Windows NT 6.1; WOW64; Trident/5.0; MASP)\" ascii wide   \n    $s3 = \"/knock.html\" ascii wide   \n      \n   condition:   \n      \n   uint16(0) == 0x5a4d and 2 of ($s*)   \n      \n   }",
			"type": "YARA",
			"id": 29315716
		},
		{
			"indicator": "0094832c064bd6527549a4de9209969a2028b4f2",
			"description": "",
			"title": "",
			"content": "rule ramFS   \n   {   \n       meta:   \n           Author      = \"Joan Calvet\"   \n           Date        = \"2015/07/14\"   \n           Description = \"RamFS -- custom file system used by Animal Farm malware\"   \n           Reference   = \"http://www.welivesecurity.com/2015/06/30/dino-spying-malware-analyzed/\"   \n           Source = \"https://github.com/eset/malware-ioc/\"   \n           Contact = \"github@eset.com\"   \n           License = \"BSD 2-Clause\"   \n      \n       strings:   \n           $mz = { 4d 5a }   \n      \n           // Debug strings in RamFS   \n           $s01 = \"Check: Error in File_List\"   \n           $s02 = \"Check: Error in FreeFileHeader_List\"   \n           $s03 = \"CD-->[%s]\"   \n           $s04 = \"!!!EXTRACT ERROR!!!File Does Not Exists-->[%s]\"   \n           // RamFS parameters stored in the configuration   \n           $s05 = \"tr4qa589\" fullword   \n           $s06 = \"xT0rvwz\" fullword   \n      \n           // RamFS commands   \n           $c01 = \"INSTALL\" fullword   \n           $c02 = \"EXTRACT\" fullword   \n           $c03 = \"DELETE\" fullword   \n           $c04 = \"EXEC\" fullword   \n           $c05 = \"INJECT\" fullword   \n           $c06 = \"SLEEP\" fullword   \n           $c07 = \"KILL\" fullword   \n           $c08 = \"AUTODEL\" fullword   \n           $c09 = \"CD\" fullword   \n           $c10 = \"MD\" fullword           \n      \n       condition:   \n           ( $mz at 0 ) and   \n               ((1 of ($s*)) or (all of ($c*)))   \n   }",
			"type": "YARA",
			"id": 29315717
		},
		{
			"indicator": "5008a94060b083197d2b08da21e7b7c7432a7dac",
			"description": "",
			"title": "",
			"content": "rule dino   \n   {   \n       meta:   \n           Author      = \"Joan Calvet\"   \n           Date        = \"2015/07/14\"   \n           Description = \"Dino backdoor\"   \n           Reference   = \"http://www.welivesecurity.com/2015/06/30/dino-spying-malware-analyzed/\"   \n           Source = \"https://github.com/eset/malware-ioc/\"   \n           Contact = \"github@eset.com\"   \n           License = \"BSD 2-Clause\"   \n      \n       strings:   \n           $ = \"PsmIsANiceM0du1eWith0SugarInsideA\"   \n           $ = \"destroyPSM\"   \n           $ = \"FM_PENDING_DOWN_%X\"   \n           $ = \"%s was canceled after %d try (reached MaxTry parameter)\"   \n           $ = \"you forgot value name\"   \n           $ = \"wakeup successfully scheduled in %d minutes\"   \n           $ = \"BD started at %s\"   \n           $ = \"decyphering failed on bd\"   \n      \n       condition:   \n           any of them   \n   }",
			"type": "YARA",
			"id": 29315718
		},
		{
			"indicator": "d6e519b7bc1fb81e6f2663db2767091b204d2455",
			"description": "",
			"title": "",
			"content": "rule moose   \n   {   \n       meta:   \n           Author      = \"Thomas Dupuy\"   \n           Date        = \"2015/04/21\"   \n           Description = \"Linux/Moose malware\"   \n           Reference   = \"http://www.welivesecurity.com/wp-content/uploads/2015/05/Dissecting-LinuxMoose.pdf\"   \n           Source = \"https://github.com/eset/malware-ioc/\"   \n           Contact = \"github@eset.com\"   \n           License = \"BSD 2-Clause\"   \n      \n       strings:   \n       \t$header = { 7F 45 4C 46 }   \n           $s0 = \"Status: OK\"   \n           $s1 = \"--scrypt\"   \n           $s2 = \"stratum+tcp://\"   \n           $s3 = \"cmd.so\"   \n           $s4 = \"/Challenge\"   \n           $s7 = \"processor\"   \n           $s9 = \"cpu model\"   \n           $s21 = \"password is wrong\"   \n           $s22 = \"password:\"   \n           $s23 = \"uthentication failed\"   \n           $s24 = \"sh\"   \n           $s25 = \"ps\"   \n           $s26 = \"echo -n -e \"   \n           $s27 = \"chmod\"   \n           $s28 = \"elan2\"   \n           $s29 = \"elan3\"   \n           $s30 = \"chmod: not found\"   \n           $s31 = \"cat /proc/cpuinfo\"   \n           $s32 = \"/proc/%s/cmdline\"   \n           $s33 = \"kill %s\"   \n      \n       condition:   \n           $header at 0 and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 29315721
		},
		{
			"indicator": "4448ef95886d3c2dbc06607be4e7650850977ee2",
			"description": "",
			"title": "",
			"content": "rule mumblehard_packer   \n   {   \n       meta:   \n           description = \"Mumblehard i386 assembly code responsible for decrypting Perl code\"   \n           author = \"Marc-Etienne M.Lveill\"   \n           date = \"2015-04-07\"   \n           reference = \"http://www.welivesecurity.com\"   \n           version = \"1\"   \n      \n       strings:   \n           $decrypt = { 31 db  [1-10]  ba ?? 00 00 00  [0-6]  (56 5f |  89 F7)   \n                        39 d3 75 13 81 fa ?? 00 00 00 75 02 31 d2 81 c2 ?? 00 00   \n                        00 31 db 43 ac 30 d8 aa 43 e2 e2 }   \n       condition:   \n           $decrypt   \n   }",
			"type": "YARA",
			"id": 29374369
		},
		{
			"indicator": "64bbe4d4dbaa44dde407876bcc2d5122495b9373",
			"description": "",
			"title": "",
			"content": "rule NaikonCode : Naikon Family    \n   {   \n       meta:   \n           description = \"Naikon code features\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-06-25\"   \n          \n       strings:   \n           // decryption   \n           $ = { 0F AF C1 C1 E0 1F } // imul eax, ecx; shl eah, 1fh   \n           $ = { 35 5A 01 00 00} // xor eax, 15ah   \n           $ = { 81 C2 7F 14 06 00 } // add edx, 6147fh   \n          \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 29374370
		},
		{
			"indicator": "c9e314bc216ed73b6c88292329772a56300f6558",
			"description": "",
			"title": "",
			"content": "rule NaikonStrings : Naikon Family   \n   {   \n       meta:   \n           description = \"Naikon Identifying Strings\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-06-25\"   \n              \n       strings:   \n           $ = \"NOKIAN95/WEB\"   \n           $ = \"/tag=info&id=15\"   \n           $ = \"skg(3)=&3.2d_u1\"   \n           $ = \"\\\\Temp\\\\iExplorer.exe\"   \n           $ = \"\\\\Temp\\\\\\\"TSG\\\"\"   \n              \n       condition:   \n          any of them   \n   }",
			"type": "YARA",
			"id": 29374371
		},
		{
			"indicator": "645d9460ac149ad3c8fea84719795a1ae1f21750",
			"description": "",
			"title": "",
			"content": "rule glassRAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \"RSA RESEARCH\"   \n   \t\tdate = \"3 Nov 2015\"   \n         description = \"Detects GlassRAT by RSA (modified by Florian Roth - speed improvements)\"   \n   \t\tInfo = \"GlassRat\"   \n   \t\t/* MD5s   \n   \t\t\t37adc72339a0c2c755e7fef346906330   \n   \t\t\t59b404076e1af7d0faae4a62fa41b69f   \n   \t\t\t5c17395731ec666ad0056d3c88e99c4d   \n   \t\t\te98027f502f5acbcb5eda17e67a21cdc   \n   \t\t\t87a965cf75b2da112aea737220f2b5c2   \n   \t\t\t22e01495b4419b564d5254d2122068d9   \n   \t\t\t42b57c0c4977a890ecb0ea9449516075   \n   \t\t\tb7f2020208ebd137616dadb60700b847\t*/   \n   \tstrings:   \n   \t\t$bin1 = {85 C0 B3 01} \t\t/* \ttest    eax, eax   \n   \t\t\t\t\t\t\t\t\t\t  mov     bl, 1 */   \n   \t\t// $bin2 = {34 02}\t\t\t\t// xor     al, 2 ---> XOR key for rundll32.exe   \n   \t\t$bin3 = {68 4C 50 00 10}\t// push    offset KeyName  ; \"2\"   \n   \t\t$bin4 = {68 48 50 00 10}\t// push    offset a3       ; \"3\"   \n   \t\t$bin5 = {68 44 50 00 10}\t// push    offset a4       ; \"4\"   \n   \t\t$hs = {CB FF 5D C9 AD 3F 5B A1 54 13 FE FB 05 C6 22}  // Initial Handshake ---> can be added or removed for hunting for different variants   \n   \t\t//$re1  = {50 00 00 00}   \n   \t\t//$re2  = {BB 01 00 00}   \n   \t\t// Dwords of C2 Ports (80 | 443 | 53) 2 -3 times   \n   \t\t$s1 = \"pwlfnn10,gzg\" // rundll32.exe XOR 02   \n   \t\t$s2 = \"AddNum\"   \n   \t\t$s3 = \"ServiceMain\"   \n   \t\t$s4 = \"The Window\"   \n   \t\t$s5 = \"off.dat\"   \n   \tcondition:   \n   \t\tall of ($bin*) and $hs and 3 of ($s*) //The conditions can be adjusted for hunting for different variants   \n   }",
			"type": "YARA",
			"id": 29374372
		},
		{
			"indicator": "b16d085de9d4b7355886daaf57a46ab5f42ad4ba",
			"description": "",
			"title": "",
			"content": "rule onimiki   \n   {   \n     meta:   \n       description = \"Linux/Onimiki malicious DNS server\"   \n       malware = \"Linux/Onimiki\"   \n       operation = \"Windigo\"   \n       author = \"Olivier Bilodeau <bilodeau@eset.com>\"   \n       created = \"2014-02-06\"   \n       reference = \"http://www.welivesecurity.com/wp-content/uploads/2014/03/operation_windigo.pdf\"   \n       contact = \"windigo@eset.sk\"   \n       source = \"https://github.com/eset/malware-ioc/\"   \n       license = \"BSD 2-Clause\"   \n      \n     strings:   \n       // code from offset: 0x46CBCD   \n       $a1 = {43 0F B6 74 2A 0E 43 0F  B6 0C 2A 8D 7C 3D 00 8D}   \n       $a2 = {74 35 00 8D 4C 0D 00 89  F8 41 F7 E3 89 F8 29 D0}   \n       $a3 = {D1 E8 01 C2 89 F0 C1 EA  04 44 8D 0C 92 46 8D 0C}   \n       $a4 = {8A 41 F7 E3 89 F0 44 29  CF 29 D0 D1 E8 01 C2 89}   \n       $a5 = {C8 C1 EA 04 44 8D 04 92  46 8D 04 82 41 F7 E3 89}   \n       $a6 = {C8 44 29 C6 29 D0 D1 E8  01 C2 C1 EA 04 8D 04 92}   \n       $a7 = {8D 04 82 29 C1 42 0F B6  04 21 42 88 84 14 C0 01}   \n       $a8 = {00 00 42 0F B6 04 27 43  88 04 32 42 0F B6 04 26}   \n       $a9 = {42 88 84 14 A0 01 00 00  49 83 C2 01 49 83 FA 07}   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 29374373
		},
		{
			"indicator": "aa409a76c644b3b56b37c223a86699015020b32a",
			"description": "",
			"title": "",
			"content": "rule APT17_Sample_FXSST_DLL    \n   {   \n          \n       meta:   \n           description = \"Detects Samples related to APT17 activity - file FXSST.DLL\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/ZiJyQv\"   \n           date = \"2015-05-14\"   \n           hash = \"52f1add5ad28dc30f68afda5d41b354533d8bce3\"   \n              \n       strings:   \n           $x1 = \"Microsoft? Windows? Operating System\" fullword wide   \n           $x2 = \"fxsst.dll\" fullword ascii   \n           $y1 = \"DllRegisterServer\" fullword ascii   \n           $y2 = \".cSV\" fullword ascii   \n           $s1 = \"GetLastActivePopup\"   \n           $s2 = \"Sleep\"   \n           $s3 = \"GetModuleFileName\"   \n           $s4 = \"VirtualProtect\"   \n           $s5 = \"HeapAlloc\"   \n           $s6 = \"GetProcessHeap\"   \n           $s7 = \"GetCommandLine\"   \n         \n      condition:   \n           uint16(0) == 0x5a4d and filesize < 800KB and ( 1 of ($x*) or all of ($y*) ) and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 30285297
		},
		{
			"indicator": "e970b17014fa4a2d0a8b233355095c5fcf714e14",
			"description": "",
			"title": "",
			"content": "rule WebShell_PHP_Web_Kit_v4   \n   {   \n      \n      meta:   \n         description = \"Detects PAS Tool PHP Web Kit\"   \n         reference = \"https://github.com/wordfence/grizzly\"   \n         author = \"Florian Roth\"   \n         date = \"2016/01/01\"   \n      \n      strings:   \n         $php = \"<?php $\"   \n         $s1 = \"(StR_ReplAcE(\\\"\\\\n\\\",'',\"   \n         $s2 = \";if(PHP_VERSION<'5'){\" ascii   \n         $s3 = \"=SuBstr_rePlACe(\" ascii   \n      \n      condition:   \n         $php at 0 and filesize > 8KB and filesize < 100KB and 2 of ($s*)   \n   }",
			"type": "YARA",
			"id": 30285300
		},
		{
			"indicator": "cd6bd57f8bc62459dc51fad08d43f70355f699db",
			"description": "",
			"title": "",
			"content": "rule GRIZZLY_STEPPE_Malware_1   \n   {   \n      \n      meta:   \n         description = \"Auto-generated rule - file HRDG022184_certclint.dll\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/WVflzO\"   \n         date = \"2016-12-29\"   \n         hash1 = \"9f918fb741e951a10e68ce6874b839aef5a26d60486db31e509f8dcaa13acec5\"   \n      \n      strings:   \n         $s1 = \"S:\\\\Lidstone\\\\renewing\\\\HA\\\\disable\\\\In.pdb\" fullword ascii   \n         $s2 = \"Repeat last find command)Replace specific text with different text\" fullword wide   \n         $s3 = \"l\\\\Processor(0)\\\\% Processor Time\" fullword wide   \n         $s6 = \"Self Process\" fullword wide   \n         $s7 = \"Default Process\" fullword wide   \n         $s8 = \"Star Polk.exe\" fullword wide   \n      \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and 4 of them )   \n   }",
			"type": "YARA",
			"id": 30285301
		},
		{
			"indicator": "4b254e81b009973f78e0504cda17b08e59eda3aa",
			"description": "",
			"title": "",
			"content": "rule GRIZZLY_STEPPE_Malware_2   \n   {   \n      \n      meta:   \n         description = \"Auto-generated rule - file 9acba7e5f972cdd722541a23ff314ea81ac35d5c0c758eb708fb6e2cc4f598a0\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/WVflzO\"   \n         date = \"2016-12-29\"   \n         hash1 = \"9acba7e5f972cdd722541a23ff314ea81ac35d5c0c758eb708fb6e2cc4f598a0\"   \n         hash2 = \"55058d3427ce932d8efcbe54dccf97c9a8d1e85c767814e34f4b2b6a6b305641\"   \n            \n      strings:   \n         $x1 = \"GoogleCrashReport.dll\" fullword ascii   \n         $s1 = \"CrashErrors\" fullword ascii   \n         $s2 = \"CrashSend\" fullword ascii   \n         $s3 = \"CrashAddData\" fullword ascii   \n         $s4 = \"CrashCleanup\" fullword ascii   \n         $s5 = \"CrashInit\" fullword ascii   \n      \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 1000KB and $x1 ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30285302
		},
		{
			"indicator": "bf44b070aec6efbdca062061c80fd488b0c191aa",
			"description": "",
			"title": "",
			"content": "rule PAS_TOOL_PHP_WEB_KIT_mod    \n   {   \n         \n      meta:   \n         description = \"Detects PAS Tool PHP Web Kit\"   \n         reference = \"https://www.us-cert.gov/security-publications/GRIZZLY-STEPPE-Russian-Malicious-Cyber-Activity\"   \n         author = \"US CERT - modified by Florian Roth due to performance reasons\"   \n         date = \"2016/12/29\"   \n         \n      strings:   \n         $php = \"<?php\"   \n         $base64decode1 = \"='base'.(\"   \n         $strreplace = \"str_replace(\\\"\\\\n\\\", ''\"   \n         $md5 = \".substr(md5(strrev(\"   \n         $gzinflate = \"gzinflate\"   \n         $cookie = \"_COOKIE\"   \n         $isset = \"isset\"   \n         \n      condition:   \n         $php at 0 and (filesize > 10KB and filesize < 30KB) and #cookie == 2 and #isset == 3 and all of them   \n   }",
			"type": "YARA",
			"id": 30285303
		},
		{
			"indicator": "e772889fbfc4fc08ddbebd6d62f12c00459d01e4",
			"description": "",
			"title": "",
			"content": "rule WebShell_PHP_Web_Kit_v3   \n   {   \n      \n      meta:   \n         description = \"Detects PAS Tool PHP Web Kit\"   \n         reference = \"https://github.com/wordfence/grizzly\"   \n         author = \"Florian Roth\"   \n         date = \"2016/01/01\"   \n      \n      strings:   \n         $php = \"<?php $\"   \n         $php2 = \"@assert(base64_decode($_REQUEST[\"   \n         $s1 = \"(str_replace(\\\"\\\\n\\\", '', '\"   \n         $s2 = \"(strrev($\" ascii   \n         $s3 = \"de'.'code';\" ascii   \n      \n      condition:   \n         ( $php at 0 or $php2 ) and filesize > 8KB and filesize < 100KB and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 30285304
		},
		{
			"indicator": "78b6f93e4d09591725f872b61beb296b7bc6bb47",
			"description": "",
			"title": "",
			"content": "rule apt_backspace   \n   {   \n      \n       meta:   \n           description = \"Detects APT backspace\"   \n           author = \"Bit Byte Bitten\"   \n           date = \"2015-05-14\"   \n           hash = \"6cbfeb7526de65eb2e3c848acac05da1e885636d17c1c45c62ad37e44cd84f99\"   \n              \n       strings:   \n           $s1 = \"!! Use Splice Socket !!\"   \n           $s2 = \"User-Agent: SJZJ (compatible; MSIE 6.0; Win32)\"   \n           $s3 = \"g_nAV=%d,hWnd:0x%X,className:%s,Title:%s,(%d,%d,%d,%d),BOOL=%d\"   \n      \n       condition:   \n           uint16(0) == 0x5a4d and all of them   \n   }",
			"type": "YARA",
			"id": 30285311
		},
		{
			"indicator": "6d6108228aa0373185cbeb03970b46dfb9f10a72",
			"description": "",
			"title": "",
			"content": "rule BlackEnergy_VBS_Agent    \n   {   \n      \n       meta:   \n           description = \"Detects VBS Agent from BlackEnergy Report - file Dropbearrun.vbs\"   \n           author = \"Florian Roth\"   \n           reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"   \n           date = \"2016-01-03\"   \n           hash = \"b90f268b5e7f70af1687d9825c09df15908ad3a6978b328dc88f96143a64af0f\"   \n          \n       strings:   \n           $s0 = \"WshShell.Run \\\"dropbear.exe -r rsa -d dss -a -p 6789\\\", 0, false\" fullword ascii   \n           $s1 = \"WshShell.CurrentDirectory = \\\"C:\\\\WINDOWS\\\\TEMP\\\\Dropbear\\\\\\\"\" fullword ascii   \n           $s2 = \"Set WshShell = CreateObject(\\\"WScript.Shell\\\")\" fullword ascii /* Goodware String - occured 1 times */   \n         \n       condition:   \n           filesize < 1KB and 2 of them   \n   }",
			"type": "YARA",
			"id": 30285313
		},
		{
			"indicator": "0e2c1d1a837be6b0a53d1769db1faeaefb724919",
			"description": "",
			"title": "",
			"content": "rule BlackEnergy_KillDisk_1    \n   {   \n      \n       meta:   \n           description = \"Detects KillDisk malware from BlackEnergy\"   \n           author = \"Florian Roth\"   \n           reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"   \n           date = \"2016-01-03\"   \n           score = 80   \n           super_rule = 1   \n           hash1 = \"11b7b8a7965b52ebb213b023b6772dd2c76c66893fc96a18a9a33c8cf125af80\"   \n           hash2 = \"5d2b1abc7c35de73375dd54a4ec5f0b060ca80a1831dac46ad411b4fe4eac4c6\"   \n           hash3 = \"c7536ab90621311b526aefd56003ef8e1166168f038307ae960346ce8f75203d\"   \n           hash4 = \"f52869474834be5a6b5df7f8f0c46cbc7e9b22fa5cb30bee0f363ec6eb056b95\"   \n      \n       strings:   \n           $s0 = \"system32\\\\cmd.exe\" fullword ascii   \n           $s1 = \"system32\\\\icacls.exe\" fullword wide   \n           $s2 = \"/c del /F /S /Q %c:\\\\*.*\" fullword ascii   \n           $s3 = \"shutdown /r /t %d\" fullword ascii   \n           $s4 = \"/C /Q /grant \" fullword wide   \n           $s5 = \"%08X.tmp\" fullword ascii   \n           $s6 = \"/c format %c: /Y /X /FS:NTFS\" fullword ascii   \n           $s7 = \"/c format %c: /Y /Q\" fullword ascii   \n           $s8 = \"taskhost.exe\" fullword wide /* Goodware String - occured 1 times */   \n           $s9 = \"shutdown.exe\" fullword wide /* Goodware String - occured 1 times */   \n       \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 500KB and 8 of them   \n   }",
			"type": "YARA",
			"id": 30285314
		},
		{
			"indicator": "1e820cbab6c737941995c1b3744162622edeecc5",
			"description": "",
			"title": "",
			"content": "rule BlackEnergy_BackdoorPass_DropBear_SSH    \n   {   \n          \n       meta:   \n           description = \"Detects the password of the backdoored DropBear SSH Server - BlackEnergy\"   \n           author = \"Florian Roth\"   \n           reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"   \n           date = \"2016-01-03\"   \n           hash = \"0969daac4adc84ab7b50d4f9ffb16c4e1a07c6dbfc968bd6649497c794a161cd\"   \n          \n       strings:   \n           $s1 = \"passDs5Bu9Te7\" fullword ascii   \n          \n       condition:   \n           uint16(0) == 0x5a4d and $s1   \n   }",
			"type": "YARA",
			"id": 30285315
		},
		{
			"indicator": "66043586815367cfaec4e2c3432c8c838e474f64",
			"description": "",
			"title": "",
			"content": "rule BlackEnergy_BE_2    \n   {   \n         \n      meta:   \n         description = \"Detects BlackEnergy 2 Malware\"   \n         author = \"Florian Roth\"   \n         reference = \"http://goo.gl/DThzLz\"   \n         date = \"2015/02/19\"   \n         hash = \"983cfcf3aaaeff1ad82eb70f77088ad6ccedee77\"   \n         \n      strings:   \n         $s0 = \"<description> Windows system utility service  </description>\" fullword ascii   \n         $s1 = \"WindowsSysUtility - Unicode\" fullword wide   \n         $s2 = \"msiexec.exe\" fullword wide   \n         $s3 = \"WinHelpW\" fullword ascii   \n         $s4 = \"ReadProcessMemory\" fullword ascii   \n         \n      condition:   \n         uint16(0) == 0x5a4d and filesize < 250KB and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 30285316
		},
		{
			"indicator": "b735c599888bdee0f53e9b04b1bb8402009e6f44",
			"description": "",
			"title": "",
			"content": "rule BlackEnergy_Driver_USBMDM    \n   {   \n      \n       meta:   \n           description = \"Auto-generated rule - from files 7874a10e551377d50264da5906dc07ec31b173dee18867f88ea556ad70d8f094, b73777469f939c331cbc1c9ad703f973d55851f3ad09282ab5b3546befa5b54a, edb16d3ccd50fc8f0f77d0875bf50a629fa38e5ba1b8eeefd54468df97eba281\"   \n           author = \"Florian Roth\"   \n           reference = \"http://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/\"   \n           date = \"2016-01-04\"   \n           super_rule = 1   \n           hash1 = \"7874a10e551377d50264da5906dc07ec31b173dee18867f88ea556ad70d8f094\"   \n           hash2 = \"b73777469f939c331cbc1c9ad703f973d55851f3ad09282ab5b3546befa5b54a\"   \n           hash3 = \"edb16d3ccd50fc8f0f77d0875bf50a629fa38e5ba1b8eeefd54468df97eba281\"   \n           hash4 = \"ac13b819379855af80ea3499e7fb645f1c96a4a6709792613917df4276c583fc\"   \n           hash5 = \"7a393b3eadfc8938cbecf84ca630e56e37d8b3d23e084a12ea5a7955642db291\"   \n           hash6 = \"405013e66b6f137f915738e5623228f36c74e362873310c5f2634ca2fda6fbc5\"   \n           hash7 = \"244dd8018177ea5a92c70a7be94334fa457c1aab8a1c1ea51580d7da500c3ad5\"   \n           hash8 = \"edcd1722fdc2c924382903b7e4580f9b77603110e497393c9947d45d311234bf\"   \n          \n       strings:   \n           $s1 = \"USB MDM Driver\" fullword wide   \n           $s2 = \"KdDebuggerNotPresent\" fullword ascii /* Goodware String - occured 50 times */   \n           $s3 = \"KdDebuggerEnabled\" fullword ascii /* Goodware String - occured 69 times */   \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 180KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285317
		},
		{
			"indicator": "e4e7ba3ae0e9a3e0350f60efd7c6dd8fc79dd8b7",
			"description": "",
			"title": "",
			"content": "rule DropBear_SSH_Server   \n    {   \n      \n       meta:   \n           description = \"Detects DropBear SSH Server (not a threat but used to maintain access)\"   \n           author = \"Florian Roth\"   \n           reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"   \n           date = \"2016-01-03\"   \n           score = 50   \n           hash = \"0969daac4adc84ab7b50d4f9ffb16c4e1a07c6dbfc968bd6649497c794a161cd\"   \n          \n       strings:   \n           $s1 = \"Dropbear server v%s https://matt.ucc.asn.au/dropbear/dropbear.html\" fullword ascii   \n           $s2 = \"Badly formatted command= authorized_keys option\" fullword ascii   \n           $s3 = \"This Dropbear program does not support '%s' %s algorithm\" fullword ascii   \n           $s4 = \"/etc/dropbear/dropbear_dss_host_key\" fullword ascii   \n           $s5 = \"/etc/dropbear/dropbear_rsa_host_key\" fullword ascii   \n          \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 1000KB and 2 of them   \n   }",
			"type": "YARA",
			"id": 30285318
		},
		{
			"indicator": "1027f34d054d2cf40e547d7d143791339248f51f",
			"description": "",
			"title": "",
			"content": "rule BlackEnergy_Driver_AMDIDE    \n   {   \n      \n       meta:   \n           description = \"Auto-generated rule - from files 32d3121135a835c3347b553b70f3c4c68eef711af02c161f007a9fbaffe7e614, 3432db9cb1fb9daa2f2ac554a0a006be96040d2a7776a072a8db051d064a8be2, 90ba78b6710462c2d97815e8745679942b3b296135490f0095bdc0cd97a34d9c, 97be6b2cec90f655ef11ed9feef5b9ef057fd8db7dd11712ddb3702ed7c7bda1\"   \n           author = \"Florian Roth\"   \n           reference = \"http://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/\"   \n           date = \"2016-01-04\"   \n           super_rule = 1   \n           hash1 = \"32d3121135a835c3347b553b70f3c4c68eef711af02c161f007a9fbaffe7e614\"   \n           hash2 = \"3432db9cb1fb9daa2f2ac554a0a006be96040d2a7776a072a8db051d064a8be2\"   \n           hash3 = \"90ba78b6710462c2d97815e8745679942b3b296135490f0095bdc0cd97a34d9c\"   \n           hash4 = \"97be6b2cec90f655ef11ed9feef5b9ef057fd8db7dd11712ddb3702ed7c7bda1\"   \n           hash5 = \"5111de45210751c8e40441f16760bf59856ba798ba99e3c9532a104752bf7bcc\"   \n           hash6 = \"cbc4b0aaa30b967a6e29df452c5d7c2a16577cede54d6d705ca1f095bd6d4988\"   \n           hash7 = \"1ce0dfe1a6663756a32c69f7494ad082d293d32fe656d7908fb445283ab5fa68\"   \n         \n       strings:   \n           $s1 = \" AMD IDE driver\" fullword wide   \n           $s2 = \"SessionEnv\" fullword wide   \n           $s3 = \"\\\\DosDevices\\\\{C9059FFF-1C49-4445-83E8-\" wide   \n           $s4 = \"\\\\Device\\\\{C9059FFF-1C49-4445-83E8-\" wide   \n          \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 150KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285319
		},
		{
			"indicator": "5b4a6920875c9696d053891f8ef3df1355c09869",
			"description": "",
			"title": "",
			"content": "rule BlackEnergy_KillDisk_2    \n   {   \n      \n       meta:   \n           description = \"Detects KillDisk malware from BlackEnergy\"   \n           author = \"Florian Roth\"   \n           reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"   \n           date = \"2016-01-03\"   \n           score = 80   \n           super_rule = 1   \n           hash1 = \"11b7b8a7965b52ebb213b023b6772dd2c76c66893fc96a18a9a33c8cf125af80\"   \n           hash2 = \"5d2b1abc7c35de73375dd54a4ec5f0b060ca80a1831dac46ad411b4fe4eac4c6\"   \n           hash3 = \"f52869474834be5a6b5df7f8f0c46cbc7e9b22fa5cb30bee0f363ec6eb056b95\"   \n      \n       strings:   \n           $s0 = \"%c:\\\\~tmp%08X.tmp\" fullword ascii   \n           $s1 = \"%s%08X.tmp\" fullword ascii   \n           $s2 = \".exe.sys.drv.doc.docx.xls.xlsx.mdb.ppt.pptx.xml.jpg.jpeg.ini.inf.ttf\" fullword wide   \n           $s3 = \"%ls_%ls_%ls_%d.~tmp\" fullword wide   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 500KB and 3 of them   \n   }",
			"type": "YARA",
			"id": 30285320
		},
		{
			"indicator": "85b23f66e974a1216c9f02d8fbf8f4fe57cc56f4",
			"description": "",
			"title": "",
			"content": "rule Emdivi_Gen3    \n   {   \n      \n       meta:   \n           description = \"Detects Emdivi Malware\"   \n           author = \"Florian Roth @Cyber0ps\"   \n           reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"   \n           date = \"2015-08-20\"   \n           super_rule = 1   \n           score = 80   \n           hash1 = \"008f4f14cf64dc9d323b6cb5942da4a99979c4c7d750ec1228d8c8285883771e\"   \n           hash2 = \"a94bf485cebeda8e4b74bbe2c0a0567903a13c36b9bf60fab484a9b55207fe0d\"   \n        \n       strings:   \n           $x1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727.42)\" fullword ascii   \n           $s2 = \"\\\\Mozilla\\\\Firefox\\\\Profiles\\\\\" fullword ascii   \n           $s4 = \"\\\\auto.cfg\" fullword ascii   \n           $s5 = \"/ncsi.txt\" fullword ascii   \n           $s6 = \"/en-us/default.aspx\" fullword ascii   \n           $s7 = \"cmd /c\" fullword ascii   \n           $s9 = \"APPDATA\" fullword ascii /* Goodware String - occured 25 times */   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 850KB and (( $x1 and 1 of ($s*)) or ( 4 of ($s*)))   \n   }",
			"type": "YARA",
			"id": 30285343
		},
		{
			"indicator": "f85f3cda7468b770698a944c683a92a4a12917be",
			"description": "",
			"title": "",
			"content": "rule Emdivi_Gen2    \n   {   \n      \n       meta:   \n           description = \"Detects Emdivi Malware\"   \n           author = \"Florian Roth @Cyber0ps\"   \n           reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"   \n           date = \"2015-08-20\"   \n           super_rule = 1   \n           score = 80   \n           hash1 = \"9a351885bf5f6fec466f30021088504d96e9db10309622ed198184294717add1\"   \n           hash2 = \"a5be7cb1f37030c9f9211c71e0fbe01dae19ff0e6560c5aab393621f18a7d012\"   \n           hash3 = \"9183abb9b639699cd2ad28d375febe1f34c14679b7638d1a79edb49d920524a4\"   \n          \n       strings:   \n           $s1 = \"%TEMP%\\\\IELogs\\\\\" fullword ascii   \n           $s2 = \"MSPUB.EXE\" fullword ascii   \n           $s3 = \"%temp%\\\\\" fullword ascii   \n           $s4 = \"\\\\NOTEPAD.EXE\" fullword ascii   \n           $s5 = \"%4d-%02d-%02d %02d:%02d:%02d \" fullword ascii   \n           $s6 = \"INTERNET_OPEN_TYPE_PRECONFIG\" fullword ascii   \n           $s7 = \"%4d%02d%02d%02d%02d%02d\" fullword ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 1300KB and 6 of them   \n   }",
			"type": "YARA",
			"id": 30285344
		},
		{
			"indicator": "18ec811869134258c04445b09f703b0ead543ea9",
			"description": "",
			"title": "",
			"content": "rule Emdivi_Gen1    \n   {   \n      \n       meta:   \n           description = \"Detects Emdivi Malware\"   \n           author = \"Florian Roth @Cyber0ps\"   \n           reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"   \n           date = \"2015-08-20\"   \n           score = 80   \n           super_rule = 1   \n           hash1 = \"17e646ca2558a65ffe7aa185ba75d5c3a573c041b897355c2721e9a8ca5fee24\"   \n           hash2 = \"3553c136b4eba70eec5d80abe44bd7c7c33ab1b65de617dbb7be5025c9cf01f1\"   \n           hash3 = \"6a331c4e654dd8ddaa2c69d260aa5f4f76f243df8b5019d62d4db5ae5c965662\"   \n           hash4 = \"90d07ea2bb80ed52b007f57d0d9a79430cd50174825c43d5746a16ee4f94ea86\"   \n          \n       strings:   \n           $x1 = \"wmic nteventlog where filename=\\\"SecEvent\\\" call cleareventlog\" fullword wide   \n           $s0 = \"del %Temp%\\\\*.exe %Temp%\\\\*.dll %Temp%\\\\*.bat %Temp%\\\\*.ps1 %Temp%\\\\*.cmd /f /q\" fullword wide   \n           $x3 = \"userControl-v80.exe\" fullword ascii   \n           $s1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727.42)\" fullword wide   \n           $s2 = \"http://www.msftncsi.com\" fullword wide   \n           $s3 = \"net use | find /i \\\"c$\\\"\" fullword wide   \n           $s4 = \" /del /y & \" fullword wide   \n           $s5 = \"\\\\auto.cfg\" fullword wide   \n           $s6 = \"/ncsi.txt\" fullword wide   \n           $s7 = \"Dcmd /c\" fullword wide   \n           $s8 = \"/PROXY\" fullword wide   \n          \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 800KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285345
		},
		{
			"indicator": "6018f8b1477219c6cbd8a7bab89549b933e05e68",
			"description": "",
			"title": "",
			"content": "rule Emdivi_Gen4   \n    {   \n      \n       meta:   \n           description = \"Detects Emdivi Malware\"   \n           author = \"Florian Roth @Cyber0ps\"   \n           reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"   \n           date = \"2015-08-20\"   \n           super_rule = 1   \n           score = 80   \n           hash1 = \"008f4f14cf64dc9d323b6cb5942da4a99979c4c7d750ec1228d8c8285883771e\"   \n           hash2 = \"17e646ca2558a65ffe7aa185ba75d5c3a573c041b897355c2721e9a8ca5fee24\"   \n           hash3 = \"3553c136b4eba70eec5d80abe44bd7c7c33ab1b65de617dbb7be5025c9cf01f1\"   \n           hash4 = \"6a331c4e654dd8ddaa2c69d260aa5f4f76f243df8b5019d62d4db5ae5c965662\"   \n           hash5 = \"90d07ea2bb80ed52b007f57d0d9a79430cd50174825c43d5746a16ee4f94ea86\"   \n           hash6 = \"a94bf485cebeda8e4b74bbe2c0a0567903a13c36b9bf60fab484a9b55207fe0d\"   \n        \n       strings:   \n           $s1 = \".http_port\\\", \" fullword wide   \n           $s2 = \"UserAgent: \" fullword ascii   \n           $s3 = \"AUTH FAILED\" fullword ascii   \n           $s4 = \"INVALID FILE PATH\" fullword ascii   \n           $s5 = \".autoconfig_url\\\", \\\"\" fullword wide   \n           $s6 = \"FAILED TO WRITE FILE\" fullword ascii   \n           $s7 = \".proxy\" fullword wide   \n           $s8 = \"AuthType: \" fullword ascii   \n           $s9 = \".no_proxies_on\\\", \\\"\" fullword wide   \n        \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 853KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285346
		},
		{
			"indicator": "8ac0119f94ed2fbc1ea4c5a97c0d3579aa49a798",
			"description": "",
			"title": "",
			"content": "rule Emdivi_SFX   \n    {   \n      \n       meta:   \n           description = \"Detects Emdivi malware in SFX Archive\"   \n           author = \"Florian Roth @Cyber0ps\"   \n           reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"   \n           date = \"2015-08-20\"   \n           score = 70   \n           hash1 = \"7a3c81b2b3c14b9cd913692347019887b607c54152b348d6d3ccd3ecfd406196\"   \n           hash2 = \"8c3df4e4549db3ce57fc1f7b1b2dfeedb7ba079f654861ca0b608cbfa1df0f6b\"   \n          \n       strings:   \n           $x1 = \"Setup=unsecess.exe\" fullword ascii   \n           $x2 = \"Setup=leassnp.exe\" fullword ascii   \n           $s1 = \"&Enter password for the encrypted file:\" fullword wide   \n           $s2 = \";The comment below contains SFX script commands\" fullword ascii   \n           $s3 = \"Path=%temp%\" fullword ascii   \n          \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 740KB and (1 of ($x*) and all of ($s*))   \n   }",
			"type": "YARA",
			"id": 30285347
		},
		{
			"indicator": "003b258e5799ba416dda06ef49f8b38f2fd4142e",
			"description": "",
			"title": "",
			"content": "rule apt_c16_win64_dropper   \n   {   \n      \n       meta:   \n           author = \"@dragonthreatlab\"   \n           date = \"2015/01/11\"   \n           description = \"APT malware used to drop PcClient RAT\"   \n           reference = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"   \n      \n       strings:   \n           $mz = { 4D 5A }   \n           $str1 = \"clbcaiq.dll\" ascii   \n           $str2 = \"profapi_104\" ascii   \n           $str3 = \"\\\\Microsoft\\\\wuauclt\\\\wuauclt.dat\" ascii   \n           $str4 = { 0F B6 0A 48 FF C2 80 E9 03 80 F1 03 49 FF C8 88 4A FF 75 EC }   \n      \n       condition:   \n           $mz at 0 and all of ($str*)   \n   }",
			"type": "YARA",
			"id": 30285359
		},
		{
			"indicator": "dd8eb52c9a2c81612f284d72f17f522a946067eb",
			"description": "",
			"title": "",
			"content": "rule apt_c16_win_swisyn   \n   {   \n      \n     meta:   \n       author = \"@dragonthreatlab\"   \n       md5 = \"a6a18c846e5179259eba9de238f67e41\"   \n       description = \"File matching the md5 above tends to only live in memory, hence the lack of MZ header check.\"   \n       date = \"2015/01/11\"   \n       reference = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"   \n      \n     strings:   \n       $mz = {4D 5A}   \n       $str1 = \"/ShowWU\" ascii   \n       $str2 = \"IsWow64Process\"   \n       $str3 = \"regsvr32 \"   \n       $str4 = {8A 11 2A 55 FC 8B 45 08 88 10 8B 4D 08 8A 11 32 55 FC 8B 45 08 88 10}   \n      \n     condition:   \n       $mz at 0 and all of ($str*)   \n   }",
			"type": "YARA",
			"id": 30285360
		},
		{
			"indicator": "c4f30302edd977741927cce4a946be55cac91ef2",
			"description": "",
			"title": "",
			"content": "rule apt_c16_win_memory_pcclient   \n   {   \n      \n     meta:   \n       author = \"@dragonthreatlab\"   \n       md5 = \"ec532bbe9d0882d403473102e9724557\"   \n       description = \"File matching the md5 above tends to only live in memory, hence the lack of MZ header check.\"   \n       date = \"2015/01/11\"   \n       reference = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"   \n      \n     strings:   \n       $str1 = \"Kill You\" ascii   \n       $str2 = \"%4d-%02d-%02d %02d:%02d:%02d\" ascii   \n       $str3 = \"%4.2f  KB\" ascii   \n       $encodefunc = {8A 08 32 CA 02 CA 88 08 40 4E 75 F4}   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30285361
		},
		{
			"indicator": "e5120d2f7a15fbd4fc05250d24de7b7871098b8d",
			"description": "",
			"title": "",
			"content": "rule apt_c16_win_wateringhole   \n   {   \n      \n     meta:   \n       author = \"@dragonthreatlab\"   \n       description = \"Detects code from APT wateringhole\"   \n       date = \"2015/01/11\"   \n       reference = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"   \n      \n     strings:   \n       $str1 = \"function runmumaa()\"   \n       $str2 = \"Invoke-Expression $(New-Object IO.StreamReader ($(New-Object IO.Compression.DeflateStream ($(New-Object IO.MemoryStream (,$([Convert]::FromBase64String(\"   \n       $str3 = \"function MoSaklgEs7(k)\"   \n      \n     condition:   \n       any of ($str*)   \n   }",
			"type": "YARA",
			"id": 30285362
		},
		{
			"indicator": "f50d46712b7c6b773389d7a0c816a04dc9a57a34",
			"description": "",
			"title": "",
			"content": "rule apt_c16_win32_dropper   \n   {   \n      \n     meta:   \n       author = \"@dragonthreatlab\"   \n       md5 = \"ad17eff26994df824be36db246c8fb6a\"   \n       description = \"APT malware used to drop PcClient RAT\"   \n       date = \"2015/01/11\"   \n       reference = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"   \n      \n     strings:   \n       $mz = {4D 5A}   \n       $str1 = \"clbcaiq.dll\" ascii   \n       $str2 = \"profapi_104\" ascii   \n       $str3 = \"/ShowWU\" ascii   \n       $str4 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\\" ascii   \n       $str5 = {8A 08 2A CA 32 CA 88 08 40 4E 75 F4 5E}   \n      \n     condition:   \n       $mz at 0 and all of ($str*)   \n   }",
			"type": "YARA",
			"id": 30285363
		},
		{
			"indicator": "0f8bbd6b5687e26ae9bbdfacae4c0d79f4503d10",
			"description": "",
			"title": "",
			"content": "rule apt_c16_win_disk_pcclient   \n   {   \n      \n     meta:   \n       author = \"@dragonthreatlab\"   \n       md5 = \"55f84d88d84c221437cd23cdbc541d2e\"   \n       description = \"Encoded version of pcclient found on disk\"   \n       date = \"2015/01/11\"   \n       reference = \"http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html\"   \n      \n     strings:   \n       $header = {51 5C 96 06 03 06 06 06 0A 06 06 06 FF FF 06 06 BE 06 06 06 06 06 06 06 46 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 EE 06 06 06 10 1F BC 10 06 BA 0D D1 25 BE 05 52 D1 25 5A 6E 6D 73 26 76 74 6F 67 74 65 71 26 63 65 70 70 6F 7A 26 64 69 26 74 79 70 26 6D 70 26 4A 4F 53 26 71 6F 6A 69 30 11 11 0C 2A 06 06 06 06 06 06 06 73 43 96 1B 37 24 00 4E 37 24 00 4E 37 24 00 4E BA 40 F6 4E 39 24 00 4E 5E 41 FA 4E 33 24 00 4E 5E 41 FC 4E 39 24 00 4E 37 24 FF 4E 0D 24 00 4E FA 31 A3 4E 40 24 00 4E DF 41 F9 4E 36 24 00 4E F6 2A FE 4E 38 24 00 4E DF 41 FC 4E 38 24 00 4E 54 6D 63 6E 37 24 00 4E 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 56 49 06 06 52 05 09 06 5D 87 8C 5A 06 06 06 06 06 06 06 06 E6 06 10 25 0B 05 08 06 06 1C 06 06 06 1A 06 06 06 06 06 06 E5 27 06 06 06 16 06 06 06 36 06 06 06 06 06 16 06 16 06 06 06 04 06 06 0A 06 06 06 06 06 06 06 0A 06 06 06 06 06 06 06 06 76 06 06 06 0A 06 06 06 06 06 06 04 06 06 06 06 06 16 06 06 16 06 06}   \n      \n     condition:   \n       $header at 0   \n   }",
			"type": "YARA",
			"id": 30285364
		},
		{
			"indicator": "f4498958e90780e3b4d1bc1582022ddab92477b6",
			"description": "",
			"title": "",
			"content": "rule Carbanak_0915_1   \n   {   \n      \n       meta:   \n           description = \"Carbanak Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.csis.dk/en/csis/blog/4710/\"   \n           date = \"2015-09-03\"   \n           score = 70   \n      \n       strings:   \n           $s1 = \"evict1.pdb\" fullword ascii   \n           $s2 = \"http://testing.corp 0\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 100KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30285369
		},
		{
			"indicator": "907fcd2eb041563d29662c37e181a023c147e96f",
			"description": "",
			"title": "",
			"content": "rule Carbanak_0915_3   \n   {   \n      \n       meta:   \n           description = \"Carbanak Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.csis.dk/en/csis/blog/4710/\"   \n           date = \"2015-09-03\"   \n           score = 70   \n      \n       strings:   \n           $s1 = \"wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww\" fullword ascii   \n           $s2 = \"SHInvokePrinterCommandA\" fullword ascii   \n           $s3 = \"Ycwxnkaj\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 700KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285370
		},
		{
			"indicator": "5bfaee4b7379bcf4d9228af708490b82db851a28",
			"description": "",
			"title": "",
			"content": "rule Carbanak_0915_2   \n   {   \n      \n       meta:   \n           description = \"Carbanak Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.csis.dk/en/csis/blog/4710/\"   \n           date = \"2015-09-03\"   \n           score = 70   \n      \n       strings:   \n           $x1 = \"8Rkzy.exe\" fullword wide   \n           $s1 = \"Export Template\" fullword wide   \n           $s2 = \"Session folder with name '%s' already exists.\" fullword ascii   \n           $s3 = \"Show Unconnected Endpoints (Ctrl+U)\" fullword ascii   \n           $s4 = \"Close All Documents\" fullword wide   \n           $s5 = \"Add &Resource\" fullword ascii   \n           $s6 = \"PROCEXPLORER\" fullword wide /* Goodware String - occured 1 times */   \n           $s7 = \"AssocQueryKeyA\" fullword ascii /* Goodware String - occured 4 times */   \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 500KB and ( $x1 or all of ($s*) )   \n   }",
			"type": "YARA",
			"id": 30285371
		},
		{
			"indicator": "e4ecb3e313aa8ad1d3e4ecd258e8e9e2a50e9cf8",
			"description": "",
			"title": "",
			"content": "rule Casper_Backdoor_x86   \n   {   \n      \n       meta:   \n           description = \"Casper French Espionage Malware - Win32/ProxyBot.B - x86 Payload http://goo.gl/VRJNLo\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/VRJNLo\"   \n           date = \"2015/03/05\"   \n           hash = \"f4c39eddef1c7d99283c7303c1835e99d8e498b0\"   \n           score = 80   \n      \n       strings:   \n           $s1 = \"\\\"svchost.exe\\\"\" fullword wide   \n           $s2 = \"firefox.exe\" fullword ascii   \n           $s3 = \"\\\"Host Process for Windows Services\\\"\" fullword wide   \n           $x1 = \"\\\\Users\\\\*\" fullword ascii   \n           $x2 = \"\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\\\\*\" fullword ascii   \n           $x3 = \"\\\\Mozilla\\\\Firefox\\\\Profiles\\\\*\" fullword ascii   \n           $x4 = \"\\\\Documents and Settings\\\\*\" fullword ascii   \n           $y1 = \"%s; %S=%S\" fullword wide   \n           $y2 = \"%s; %s=%s\" fullword ascii   \n           $y3 = \"Cookie: %s=%s\" fullword ascii   \n           $y4 = \"http://%S:%d\" fullword wide   \n           $z1 = \"http://google.com/\" fullword ascii   \n           $z2 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; MALC)\" fullword ascii   \n           $z3 = \"Operating System\\\"\" fullword wide   \n      \n       condition:   \n           ( all of ($s*) ) or ( 3 of ($x*) and 2 of ($y*) and 2 of ($z*) )   \n   }",
			"type": "YARA",
			"id": 30285372
		},
		{
			"indicator": "4e09abd2a5ec0eb5d10ae4dcfe9d48c487e2bea2",
			"description": "",
			"title": "",
			"content": "rule Casper_SystemInformation_Output   \n   {   \n      \n       meta:   \n           description = \"Casper French Espionage Malware - System Info Output - http://goo.gl/VRJNLo\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/VRJNLo\"   \n           date = \"2015/03/06\"   \n           score = 70   \n      \n       strings:   \n           $a0 = \"***** SYSTEM INFORMATION ******\"   \n           $a1 = \"***** SECURITY INFORMATION ******\"   \n           $a2 = \"Antivirus: \"   \n           $a3 = \"Firewall: \"   \n           $a4 = \"***** EXECUTION CONTEXT ******\"   \n           $a5 = \"Identity: \"   \n           $a6 = \"<CONFIG TIMESTAMP=\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285373
		},
		{
			"indicator": "3d3f06a8522822eded5a371e6a8f61391afe71c2",
			"description": "",
			"title": "",
			"content": "rule Casper_EXE_Dropper   \n   {   \n      \n       meta:   \n           description = \"Casper French Espionage Malware - Win32/ProxyBot.B - Dropper http://goo.gl/VRJNLo\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/VRJNLo\"   \n           date = \"2015/03/05\"   \n           hash = \"e4cc35792a48123e71a2c7b6aa904006343a157a\"   \n           score = 80   \n      \n       strings:   \n           $s0 = \"<Command>\" fullword ascii   \n           $s1 = \"</Command>\" fullword ascii   \n           $s2 = \"\\\" /d \\\"\" fullword ascii   \n           $s4 = \"'%s' %s\" fullword ascii   \n           $s5 = \"nKERNEL32.DLL\" fullword wide   \n           $s6 = \"@ReturnValue\" fullword wide   \n           $s7 = \"ID: 0x%x\" fullword ascii   \n           $s8 = \"Name: %S\" fullword ascii   \n      \n       condition:   \n           7 of them   \n   }",
			"type": "YARA",
			"id": 30285374
		},
		{
			"indicator": "420b245aee66578451d20b2b2ee431b09f460107",
			"description": "",
			"title": "",
			"content": "rule Casper_Included_Strings   \n   {   \n      \n       meta:   \n           description = \"Casper French Espionage Malware - String Match in File - http://goo.gl/VRJNLo\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/VRJNLo\"   \n           date = \"2015/03/06\"   \n           score = 50   \n      \n       strings:   \n           $a0 = \"cmd.exe /C FOR /L %%i IN (1,1,%d) DO IF EXIST\"   \n           $a1 = \"& SYSTEMINFO) ELSE EXIT\"   \n           $mz = { 4d 5a }   \n           $c1 = \"domcommon.exe\" wide fullword                         // File Name   \n           $c2 = \"jpic.gov.sy\" fullword                                // C2 Server   \n           $c3 = \"aiomgr.exe\" wide fullword                            // File Name   \n           $c4 = \"perfaudio.dat\" fullword                              // Temp File Name   \n           $c5 = \"Casper_DLL.dll\" fullword                             // Name   \n           $c6 = { 7B 4B 59 DE 37 4A 42 26 59 98 63 C6 2D 0F 57 40 }   // Decryption Key   \n           $c7 = \"{4216567A-4512-9825-7745F856}\" fullword              // Mutex   \n      \n       condition:   \n           all of ($a*) or ( $mz at 0 ) and ( 1 of ($c*) )   \n   }",
			"type": "YARA",
			"id": 30285375
		},
		{
			"indicator": "0a301a6448ff1a2af33b6b9aed7145d47cab172f",
			"description": "",
			"title": "",
			"content": "rule SFXRAR_Acrotray   \n   {   \n      \n       meta:   \n           description = \"Most likely a malicious file acrotray in SFX RAR / CloudDuke APT 5442.1.exe, 5442.2.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.f-secure.com/weblog/archives/00002822.html\"   \n           date = \"2015-07-22\"   \n           super_rule = 1   \n           score = 70   \n           hash1 = \"51e713c7247f978f5836133dd0b8f9fb229e6594763adda59951556e1df5ee57\"   \n           hash2 = \"5d695ff02202808805da942e484caa7c1dc68e6d9c3d77dc383cfa0617e61e48\"   \n           hash3 = \"56531cc133e7a760b238aadc5b7a622cd11c835a3e6b78079d825d417fb02198\"   \n      \n       strings:   \n           $s1 = \"winrarsfxmappingfile.tmp\" fullword wide /* PEStudio Blacklist: strings */   \n           $s2 = \"GETPASSWORD1\" fullword wide /* PEStudio Blacklist: strings */   \n           $s3 = \"acrotray.exe\" fullword ascii   \n           $s4 = \"CryptUnprotectMemory failed\" fullword wide /* PEStudio Blacklist: strings */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 2449KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285378
		},
		{
			"indicator": "0c6f5e93f51550d08546d1988a98b3ae69fbc379",
			"description": "",
			"title": "",
			"content": "rule CloudDuke_Malware   \n   {   \n      \n       meta:   \n           description = \"Detects CloudDuke Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.f-secure.com/weblog/archives/00002822.html\"   \n           date = \"2015-07-22\"   \n           score = 60   \n           hash1 = \"97d8725e39d263ed21856477ed09738755134b5c0d0b9ae86ebb1cdd4cdc18b7\"   \n           hash2 = \"88a40d5b679bccf9641009514b3d18b09e68b609ffaf414574a6eca6536e8b8f\"   \n           hash3 = \"1d4ac97d43fab1d464017abb5d57a6b4601f99eaa93b01443427ef25ae5127f7\"   \n           hash4 = \"97d8725e39d263ed21856477ed09738755134b5c0d0b9ae86ebb1cdd4cdc18b7\"   \n           hash5 = \"1d4ac97d43fab1d464017abb5d57a6b4601f99eaa93b01443427ef25ae5127f7\"   \n           hash6 = \"88a40d5b679bccf9641009514b3d18b09e68b609ffaf414574a6eca6536e8b8f\"   \n           hash7 = \"ed7abf93963395ce9c9cba83a864acb4ed5b6e57fd9a6153f0248b8ccc4fdb46\"   \n           hash8 = \"97d8725e39d263ed21856477ed09738755134b5c0d0b9ae86ebb1cdd4cdc18b7\"   \n           hash9 = \"ed7abf93963395ce9c9cba83a864acb4ed5b6e57fd9a6153f0248b8ccc4fdb46\"   \n           hash10 = \"ee5eb9d57c3611e91a27bb1fc2d0aaa6bbfa6c69ab16e65e7123c7c49d46f145\"   \n           hash11 = \"a713982d04d2048a575912a5fc37c93091619becd5b21e96f049890435940004\"   \n           hash12 = \"56ac764b81eb216ebed5a5ad38e703805ba3e1ca7d63501ba60a1fb52c7ebb6e\"   \n           hash13 = \"ee5eb9d57c3611e91a27bb1fc2d0aaa6bbfa6c69ab16e65e7123c7c49d46f145\"   \n           hash14 = \"a713982d04d2048a575912a5fc37c93091619becd5b21e96f049890435940004\"   \n           hash15 = \"56ac764b81eb216ebed5a5ad38e703805ba3e1ca7d63501ba60a1fb52c7ebb6e\"   \n      \n       strings:   \n           $s1 = \"ProcDataWrap\" fullword ascii   \n           $s2 = \"imagehlp.dll\" fullword ascii   \n           $s3 = \"dnlibsh\" fullword ascii   \n           $s4 = \"%ws_out%ws\" fullword wide   \n           $s5 = \"Akernel32.dll\" fullword wide   \n           $op0 = { 0f b6 80 68 0e 41 00 0b c8 c1 e1 08 0f b6 c2 8b } /* Opcode */   \n           $op1 = { 8b ce e8 f8 01 00 00 85 c0 74 41 83 7d f8 00 0f } /* Opcode */   \n           $op2 = { e8 2f a2 ff ff 83 20 00 83 c8 ff 5f 5e 5d c3 55 } /* Opcode */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 720KB and 4 of ($s*) and 1 of ($op*)   \n   }",
			"type": "YARA",
			"id": 30285379
		},
		{
			"indicator": "daf1c614dc6ce0b5f223780299bb7aa7cc4af612",
			"description": "",
			"title": "",
			"content": "rule Codoso_CustomTCP   \n   {   \n      \n       meta:   \n           description = \"Codoso CustomTCP Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           hash = \"b95d7f56a686a05398198d317c805924c36f3abacbb1b9e3f590ec0d59f845d8\"   \n      \n       strings:   \n           $s4 = \"wnyglw\" fullword ascii   \n           $s5 = \"WorkerRun\" fullword ascii   \n           $s7 = \"boazdcd\" fullword ascii   \n           $s8 = \"wayflw\" fullword ascii   \n           $s9 = \"CODETABL\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 405KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285390
		},
		{
			"indicator": "c0a0bf386e0ff52cd76cf3445ca471b378564d10",
			"description": "",
			"title": "",
			"content": "rule Codoso_PlugX_3   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT PlugX Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           hash = \"74e1e83ac69e45a3bee78ac2fac00f9e897f281ea75ed179737e9b6fe39971e3\"   \n      \n       strings:   \n           $s1 = \"Cannot create folder %sDCRC failed in the encrypted file %s. Corrupt file or wrong password.\" fullword wide   \n           $s2 = \"mcs.exe\" fullword ascii   \n           $s3 = \"McAltLib.dll\" fullword ascii   \n           $s4 = \"WinRAR self-extracting archive\" fullword wide   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 1200KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285391
		},
		{
			"indicator": "664f8978ee0dfa5898c0f395f9ffb7c55cd5f2d2",
			"description": "",
			"title": "",
			"content": "rule Codoso_PGV_PVID_6   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT PGV_PVID Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           hash = \"4b16f6e8414d4192d0286b273b254fa1bd633f5d3d07ceebd03dfdfc32d0f17f\"   \n      \n       strings:   \n           $s0 = \"rundll32 \\\"%s\\\",%s\" fullword ascii   \n           $s1 = \"/c ping 127.%d & del \\\"%s\\\"\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 6000KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285392
		},
		{
			"indicator": "3952d0b01e1e32b01e93b5b14fb0f6eadeb393e6",
			"description": "",
			"title": "",
			"content": "rule Codoso_PGV_PVID_5   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT PGV PVID Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           super_rule = 1   \n           hash1 = \"13bce64b3b5bdfd24dc6f786b5bee08082ea736be6536ef54f9c908fd1d00f75\"   \n           hash2 = \"bc0b885cddf80755c67072c8b5961f7f0adcaeb67a1a5c6b3475614fd51696fe\"   \n      \n       strings:   \n           $s1 = \"/c del %s >> NUL\" fullword ascii   \n           $s2 = \"%s%s.manifest\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 500KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285393
		},
		{
			"indicator": "327ccb62f6c43eb39a9f04d4ca12ff74450aad34",
			"description": "",
			"title": "",
			"content": "rule Codoso_PGV_PVID_4   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT PlugX Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           super_rule = 1   \n           hash1 = \"13bce64b3b5bdfd24dc6f786b5bee08082ea736be6536ef54f9c908fd1d00f75\"   \n           hash2 = \"8a56b476d792983aea0199ee3226f0d04792b70a1c1f05f399cb6e4ce8a38761\"   \n           hash3 = \"b2950f2e09f5356e985c38b284ea52175d21feee12e582d674c0da2233b1feb1\"   \n           hash4 = \"b631553421aa17171cc47248adc110ca2e79eff44b5e5b0234d69b30cab104e3\"   \n           hash5 = \"bc0b885cddf80755c67072c8b5961f7f0adcaeb67a1a5c6b3475614fd51696fe\"   \n      \n       strings:   \n           $x1 = \"dropper, Version 1.0\" fullword wide   \n           $x2 = \"dropper\" fullword wide   \n           $x3 = \"DROPPER\" fullword wide   \n           $x4 = \"About dropper\" fullword wide   \n           $s1 = \"Microsoft Windows Manager Utility\" fullword wide   \n           $s2 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\\" fullword ascii /* Goodware String - occured 9 times */   \n           $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify\" fullword ascii /* Goodware String - occured 10 times */   \n           $s4 = \"<assembly xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\" manifestVersion=\\\"1.0\\\"><trustInfo xmlns=\\\"urn:schemas-microsoft-com:asm.v3\" ascii /* Goodware String - occured 46 times */   \n           $s5 = \"<supportedOS Id=\\\"{e2011457-1546-43c5-a5fe-008deee3d3f0}\\\"></supportedOS>\" fullword ascii /* Goodware String - occured 65 times */   \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 900KB and 1 of ($x*) and 2 of ($s*)   \n   }",
			"type": "YARA",
			"id": 30285394
		},
		{
			"indicator": "c5a6377c52bddde5554553c497682db106c78ffd",
			"description": "",
			"title": "",
			"content": "rule Codoso_PlugX_1   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT PlugX Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           super_rule = 1   \n           hash1 = \"0b8cbc9b4761ab35acce2aa12ba2c0a283afd596b565705514fd802c8b1e144b\"   \n           hash2 = \"448711bd3f689ceebb736d25253233ac244d48cb766834b8f974c2e9d4b462e8\"   \n           hash3 = \"fd22547497ce52049083092429eeff0599d0b11fe61186e91c91e1f76b518fe2\"   \n      \n       strings:   \n           $s1 = \"GETPASSWORD1\" fullword ascii   \n           $s2 = \"NvSmartMax.dll\" fullword ascii   \n           $s3 = \"LICENSEDLG\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 800KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285395
		},
		{
			"indicator": "b3d771613011c3ac9f490a09f7b5fb997b00032d",
			"description": "",
			"title": "",
			"content": "rule Codoso_PGV_PVID_1   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT PGV PVID Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           super_rule = 1   \n           hash1 = \"41a936b0d1fd90dffb2f6d0bcaf4ad0536f93ca7591f7b75b0cd1af8804d0824\"   \n           hash2 = \"58334eb7fed37e3104d8235d918aa5b7856f33ea52a74cf90a5ef5542a404ac3\"   \n           hash3 = \"934b87ddceabb2063b5e5bc4f964628fe0c63b63bb2346b105ece19915384fc7\"   \n           hash4 = \"ce91ea20aa2e6af79508dd0a40ab0981f463b4d2714de55e66d228c579578266\"   \n           hash5 = \"e770a298ae819bba1c70d0c9a2e02e4680d3cdba22d558d21caaa74e3970adf1\"   \n      \n       strings:   \n           $x1 = \"Cookie: pgv_pvid=\" ascii   \n           $x2 = \"DRIVERS\\\\ipinip.sys\" fullword wide   \n           $s1 = \"TsWorkSpaces.dll\" fullword ascii   \n           $s2 = \"%SystemRoot%\\\\System32\\\\wiaservc.dll\" fullword wide   \n           $s3 = \"/selfservice/microsites/search.php?%016I64d\" fullword ascii   \n           $s4 = \"/solutions/company-size/smb/index.htm?%016I64d\" fullword ascii   \n           $s5 = \"Microsoft Chart ActiveX Control\" fullword wide   \n           $s6 = \"MSChartCtrl.ocx\" fullword wide   \n           $s7 = \"{%08X-%04X-%04x-%02X%02X-%02X%02X%02X%02X%02X%02X}\" fullword ascii   \n           $s8 = \"WUServiceMain\" fullword ascii /* Goodware String - occured 2 times */   \n       condition:   \n           ( uint16(0) == 0x5a4d and ( 1 of ($x*) or 3 of them ) ) or 5 of them   \n   }",
			"type": "YARA",
			"id": 30285396
		},
		{
			"indicator": "003c2b6781d152d90d7a7a51649b63a39e99aff6",
			"description": "",
			"title": "",
			"content": "rule Codoso_CustomTCP_2   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT CustomTCP Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           hash = \"3577845d71ae995762d4a8f43b21ada49d809f95c127b770aff00ae0b64264a3\"   \n      \n       strings:   \n           $s1 = \"varus_service_x86.dll\" fullword ascii   \n           $s2 = \"/s %s /p %d /st %d /rt %d\" fullword ascii   \n           $s3 = \"net start %%1\" fullword ascii   \n           $s4 = \"ping 127.1 > nul\" fullword ascii   \n           $s5 = \"McInitMISPAlertEx\" fullword ascii   \n           $s6 = \"sc start %%1\" fullword ascii   \n           $s7 = \"B_WKNDNSK^\" fullword ascii   \n           $s8 = \"net stop %%1\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 406KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285397
		},
		{
			"indicator": "f9ab0f6e308c504bcc48b8e60d6d282beb6a16a7",
			"description": "",
			"title": "",
			"content": "rule Codoso_Gh0st_1   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT Gh0st Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           super_rule = 1   \n           hash1 = \"5402c785037614d09ad41e41e11093635455b53afd55aa054a09a84274725841\"   \n           hash2 = \"7dc7cec2c3f7e56499175691f64060ebd955813002d4db780e68a8f6e7d0a8f8\"   \n           hash3 = \"d7004910a87c90ade7e5ff6169f2b866ece667d2feebed6f0ec856fb838d2297\"   \n      \n       strings:   \n           $x1 = \"cmd.exe /c ping 127.0.0.1 && ping 127.0.0.1 && sc start %s && ping 127.0.0.1 && sc start %s\" fullword ascii   \n           $x2 = \"rundll32.exe \\\"%s\\\", RunMeByDLL32\" fullword ascii   \n           $x3 = \"Elevation:Administrator!new:{3ad05575-8857-4850-9277-11b85bdb8e09}\" fullword wide   \n           $x4 = \"\\\\\\\\.\\\\keymmdrv1\" fullword ascii   \n           $s1 = \"spideragent.exe\" fullword ascii   \n           $s2 = \"AVGIDSAgent.exe\" fullword ascii   \n           $s3 = \"kavsvc.exe\" fullword ascii   \n           $s4 = \"mspaint.exe\" fullword ascii   \n           $s5 = \"kav.exe\" fullword ascii   \n           $s6 = \"avp.exe\" fullword ascii   \n           $s7 = \"NAV.exe\" fullword ascii   \n           $c1 = \"Elevation:Administrator!new:\" wide   \n           $c2 = \"Global\\\\RUNDLL32EXITEVENT_NAME{12845-8654-543}\" fullword ascii   \n           $c3 = \"\\\\sysprep\\\\sysprep.exe\" fullword wide   \n           $c4 = \"\\\\sysprep\\\\CRYPTBASE.dll\" fullword wide   \n           $c5 = \"Global\\\\TERMINATEEVENT_NAME{12845-8654-542}\" fullword ascii   \n           $c6 = \"ConsentPromptBehaviorAdmin\" fullword ascii   \n           $c7 = \"\\\\sysprep\" fullword wide   \n           $c8 = \"Global\\\\UN{5FFC0C8B-8BE5-49d5-B9F2-BCDC8976EE10}\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 1000KB and ( 4 of ($s*) or 4 of ($c*) ) or 1 of ($x*) or 6 of ($c*)   \n   }",
			"type": "YARA",
			"id": 30285398
		},
		{
			"indicator": "c6b62055000c6bdd78f1e440e5ce52ffaea61659",
			"description": "",
			"title": "",
			"content": "rule Codoso_PGV_PVID_3   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT PGV PVID Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           super_rule = 1   \n           hash1 = \"126fbdcfed1dfb31865d4b18db2fb963f49df838bf66922fea0c37e06666aee1\"   \n           hash2 = \"13bce64b3b5bdfd24dc6f786b5bee08082ea736be6536ef54f9c908fd1d00f75\"   \n           hash3 = \"8a56b476d792983aea0199ee3226f0d04792b70a1c1f05f399cb6e4ce8a38761\"   \n           hash4 = \"b2950f2e09f5356e985c38b284ea52175d21feee12e582d674c0da2233b1feb1\"   \n           hash5 = \"b631553421aa17171cc47248adc110ca2e79eff44b5e5b0234d69b30cab104e3\"   \n           hash6 = \"bc0b885cddf80755c67072c8b5961f7f0adcaeb67a1a5c6b3475614fd51696fe\"   \n      \n       strings:   \n           $x1 = \"Copyright (C) Microsoft Corporation.  All rights reserved.(C) 2012\" fullword wide   \n      \n       condition:   \n           $x1   \n   }",
			"type": "YARA",
			"id": 30285399
		},
		{
			"indicator": "906fbd7e5b8d09c3e60a13b0ecb913cf00bc60f1",
			"description": "",
			"title": "",
			"content": "rule Codoso_Gh0st_2   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT Gh0st Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           hash = \"5402c785037614d09ad41e41e11093635455b53afd55aa054a09a84274725841\"   \n      \n       strings:   \n           $s0 = \"cmd.exe /c ping 127.0.0.1 && ping 127.0.0.1 && sc start %s && ping 127.0.0.1 && sc start %s\" fullword ascii   \n           $s1 = \"rundll32.exe \\\"%s\\\", RunMeByDLL32\" fullword ascii   \n           $s13 = \"Elevation:Administrator!new:{3ad05575-8857-4850-9277-11b85bdb8e09}\" fullword wide   \n           $s14 = \"%s -r debug 1\" fullword ascii   \n           $s15 = \"\\\\\\\\.\\\\keymmdrv1\" fullword ascii   \n           $s17 = \"RunMeByDLL32\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 500KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30285400
		},
		{
			"indicator": "a2e534c94a563991c628c927474a70ef822e7897",
			"description": "",
			"title": "",
			"content": "rule Codoso_PlugX_2   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT PlugX Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           hash = \"b9510e4484fa7e3034228337768176fce822162ad819539c6ca3631deac043eb\"   \n      \n       strings:   \n           $s1 = \"%TEMP%\\\\HID\" fullword wide   \n           $s2 = \"%s\\\\hid.dll\" fullword wide   \n           $s3 = \"%s\\\\SOUNDMAN.exe\" fullword wide   \n           $s4 = \"\\\"%s\\\\SOUNDMAN.exe\\\" %d %d\" fullword wide   \n           $s5 = \"%s\\\\HID.dllx\" fullword wide   \n      \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 400KB and 3 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30285401
		},
		{
			"indicator": "16df60bb9170b1efff749d48d98ba3de5941fd59",
			"description": "",
			"title": "",
			"content": "rule Codoso_CustomTCP_4   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT CustomTCP Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           hash1 = \"ea67d76e9d2e9ce3a8e5f80ff9be8f17b2cd5b1212153fdf36833497d9c060c0\"   \n           hash2 = \"130abb54112dd47284fdb169ff276f61f2b69d80ac0a9eac52200506f147b5f8\"   \n           hash3 = \"3ea6b2b51050fe7c07e2cf9fa232de6a602aa5eff66a2e997b25785f7cf50daa\"   \n           hash4 = \"02cf5c244aebaca6195f45029c1e37b22495609be7bdfcfcd79b0c91eac44a13\"   \n      \n       strings:   \n           $x1 = \"varus_service_x86.dll\" fullword ascii   \n           $s1 = \"/s %s /p %d /st %d /rt %d\" fullword ascii   \n           $s2 = \"net start %%1\" fullword ascii   \n           $s3 = \"ping 127.1 > nul\" fullword ascii   \n           $s4 = \"McInitMISPAlertEx\" fullword ascii   \n           $s5 = \"sc start %%1\" fullword ascii   \n           $s6 = \"net stop %%1\" fullword ascii   \n           $s7 = \"WorkerRun\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 400KB and 5 of them ) or ( $x1 and 2 of ($s*) )   \n   }",
			"type": "YARA",
			"id": 30285402
		},
		{
			"indicator": "e379868637313a8016b21ea98489217f966b9ead",
			"description": "",
			"title": "",
			"content": "rule Codoso_PGV_PVID_2   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT PGV PVID Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           super_rule = 1   \n           hash1 = \"13bce64b3b5bdfd24dc6f786b5bee08082ea736be6536ef54f9c908fd1d00f75\"   \n           hash2 = \"b631553421aa17171cc47248adc110ca2e79eff44b5e5b0234d69b30cab104e3\"   \n           hash3 = \"bc0b885cddf80755c67072c8b5961f7f0adcaeb67a1a5c6b3475614fd51696fe\"   \n      \n       strings:   \n           $s0 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SvcHost\" fullword ascii   \n           $s1 = \"regsvr32.exe /s \\\"%s\\\"\" fullword ascii   \n           $s2 = \"Help and Support\" fullword ascii   \n           $s3 = \"netsvcs\" fullword ascii   \n           $s9 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k netsvcs\" fullword ascii /* Goodware String - occured 4 times */   \n           $s10 = \"winlogon\" fullword ascii /* Goodware String - occured 4 times */   \n           $s11 = \"System\\\\CurrentControlSet\\\\Services\" fullword ascii /* Goodware String - occured 11 times */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 907KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285403
		},
		{
			"indicator": "544a0d31fe6e13157941d1a5fda25476ba8983f2",
			"description": "",
			"title": "",
			"content": "rule Codoso_Gh0st_3   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT Gh0st Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           hash = \"bf52ca4d4077ae7e840cf6cd11fdec0bb5be890ddd5687af5cfa581c8c015fcd\"   \n      \n       strings:   \n           $x1 = \"RunMeByDLL32\" fullword ascii   \n           $s1 = \"svchost.dll\" fullword wide   \n           $s2 = \"server.dll\" fullword ascii   \n           $s3 = \"Copyright ? 2008\" fullword wide   \n           $s4 = \"testsupdate33\" fullword ascii   \n           $s5 = \"Device Protect Application\" fullword wide   \n           $s6 = \"MSVCP60.DLL\" fullword ascii /* Goodware String - occured 1 times */   \n           $s7 = \"\u001fmail-news.eicp.net\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 195KB and $x1 or 4 of them   \n   }",
			"type": "YARA",
			"id": 30285404
		},
		{
			"indicator": "629c1de77c6bc6f76a69d4153ab90fce2721e0bf",
			"description": "",
			"title": "",
			"content": "rule Codoso_CustomTCP_3   \n   {   \n      \n       meta:   \n           description = \"Detects Codoso APT CustomTCP Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"   \n           date = \"2016-01-30\"   \n           hash = \"d66106ec2e743dae1d71b60a602ca713b93077f56a47045f4fc9143aa3957090\"   \n      \n       strings:   \n           $s1 = \"DnsApi.dll\" fullword ascii   \n           $s2 = \"softWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap\\\\Domains\\\\%s\" ascii   \n           $s3 = \"CONNECT %s:%d hTTP/1.1\" ascii   \n           $s4 = \"CONNECT %s:%d HTTp/1.1\" ascii   \n           $s5 = \"Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/4.0;)\" ascii   \n           $s6 = \"iphlpapi.dll\" ascii   \n           $s7 = \"%systemroot%\\\\Web\\\\\" ascii   \n           $s8 = \"Proxy-Authorization: Negotiate %s\" ascii   \n           $s9 = \"CLSID\\\\{%s}\\\\InprocServer32\" ascii   \n      \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 500KB and 5 of them ) or 7 of them   \n   }",
			"type": "YARA",
			"id": 30285405
		},
		{
			"indicator": "ae7f60ede2f4ad6567224efc2d2b10cb685530d2",
			"description": "",
			"title": "",
			"content": "rule Anthem_DeepPanda_lot1   \n   {   \n      \n       meta:   \n           description = \"Anthem Hack Deep Panda - lot1.tmp-pwdump\"   \n           author = \"Florian Roth\"   \n           date = \"2015/02/08\"   \n           hash = \"5d201a0fb0f4a96cefc5f73effb61acff9c818e1\"   \n      \n       strings:   \n           $s0 = \"Unable to open target process: %d, pid %d\" fullword ascii   \n           $s1 = \"Couldn't delete target executable from remote machine: %d\" fullword ascii   \n           $s2 = \"Target: Failed to load SAM functions.\" fullword ascii   \n           $s5 = \"Error writing the test file %s, skipping this share\" fullword ascii   \n           $s6 = \"Failed to create service (%s/%s), error %d\" fullword ascii   \n           $s8 = \"Service start failed: %d (%s/%s)\" fullword ascii   \n           $s12 = \"PwDump.exe\" fullword ascii   \n           $s13 = \"GetAvailableWriteableShare returned an error of %ld\" fullword ascii   \n           $s14 = \":\\\\\\\\.\\\\pipe\\\\%s\" fullword ascii   \n           $s15 = \"Couldn't copy %s to destination %s. (Error %d)\" fullword ascii   \n           $s16 = \"dump logon session\" fullword ascii   \n           $s17 = \"Timed out waiting to get our pipe back\" fullword ascii   \n           $s19 = \"SetNamedPipeHandleState failed, error %d\" fullword ascii   \n           $s20 = \"%s\\\\%s.exe\" fullword ascii   \n      \n       condition:   \n           10 of them   \n   }",
			"type": "YARA",
			"id": 30285435
		},
		{
			"indicator": "13518b0620a55bc2a4b97ec9a07fa7acc09d9560",
			"description": "",
			"title": "",
			"content": "rule Anthem_DeepPanda_htran_exe   \n   {   \n      \n       meta:   \n           description = \"Anthem Hack Deep Panda - htran-exe\"   \n           author = \"Florian Roth\"   \n           date = \"2015/02/08\"   \n           hash = \"38e21f0b87b3052b536408fdf59185f8b3d210b9\"   \n      \n       strings:   \n           $s0 = \"%s -<listen|tran|slave> <option> [-log logfile]\" fullword ascii   \n           $s1 = \"[-] Gethostbyname(%s) error:%s\" fullword ascii   \n           $s2 = \"e:\\\\VS 2008 Project\\\\htran\\\\Release\\\\htran.pdb\" fullword ascii   \n           $s3 = \"[SERVER]connection to %s:%d error\" fullword ascii   \n           $s4 = \"-tran  <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii   \n           $s5 = \"[-] ERROR: Must supply logfile name.\" fullword ascii   \n           $s6 = \"[-] There is a error...Create a new connection.\" fullword ascii   \n           $s7 = \"[+] Accept a Client on port %d from %s\" fullword ascii   \n           $s8 = \"======================== htran V%s =======================\" fullword ascii   \n           $s9 = \"[-] Socket Listen error.\" fullword ascii   \n           $s10 = \"[-] ERROR: open logfile\" fullword ascii   \n           $s11 = \"-slave  <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii   \n           $s12 = \"[+] Make a Connection to %s:%d ......\" fullword ascii   \n           $s14 = \"Recv %5d bytes from %s:%d\" fullword ascii   \n           $s15 = \"[+] OK! I Closed The Two Socket.\" fullword ascii   \n           $s16 = \"[+] Waiting another Client on port:%d....\" fullword ascii   \n           $s17 = \"[+] Accept a Client on port %d from %s ......\" fullword ascii   \n           $s20 = \"-listen <ConnectPort> <TransmitPort>\" fullword ascii   \n      \n       condition:   \n           10 of them   \n   }",
			"type": "YARA",
			"id": 30285436
		},
		{
			"indicator": "130ce7146596c5896cc060510bec2c2d2a4dfdfa",
			"description": "",
			"title": "",
			"content": "rule Anthem_DeepPanda_sl_txt_packed   \n   {   \n      \n       meta:   \n           description = \"Anthem Hack Deep Panda - ScanLine sl-txt-packed\"   \n           author = \"Florian Roth\"   \n           date = \"2015/02/08\"   \n           hash = \"ffb1d8ea3039d3d5eb7196d27f5450cac0ea4f34\"   \n      \n       strings:   \n           $s0 = \"Command line port scanner\" fullword wide   \n           $s1 = \"sl.exe\" fullword wide   \n           $s2 = \"CPports.txt\" fullword ascii   \n           $s3 = \",GET / HTTP/.}\" fullword ascii   \n           $s4 = \"Foundstone Inc.\" fullword wide   \n           $s9 = \" 2002 Foundstone Inc.\" fullword wide   \n           $s15 = \", Inc. 2002\" fullword ascii   \n           $s20 = \"ICMP Time\" fullword ascii   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285437
		},
		{
			"indicator": "a72bbda5b897993d87dfa427740ffa5945ba61b3",
			"description": "",
			"title": "",
			"content": "rule Anthem_DeepPanda_Trojan_Kakfum   \n   {   \n      \n       meta:   \n           description = \"Anthem Hack Deep Panda - Trojan.Kakfum sqlsrv32.dll\"   \n           author = \"Florian Roth\"   \n           date = \"2015/02/08\"   \n           hash1 = \"ab58b6aa7dcc25d8f6e4b70a24e0ccede0d5f6129df02a9e61293c1d7d7640a2\"   \n           hash2 = \"c6c3bb72896f8f0b9a5351614fd94e889864cf924b40a318c79560bbbcfa372f\"   \n      \n       strings:   \n           $s0 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k sqlserver\" fullword ascii   \n           $s1 = \"%s\\\\sqlsrv32.dll\" fullword ascii   \n           $s2 = \"%s\\\\sqlsrv64.dll\" fullword ascii   \n           $s3 = \"%s\\\\%d.tmp\" fullword ascii   \n           $s4 = \"ServiceMaix\" fullword ascii   \n           $s15 = \"sqlserver\" fullword ascii   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285438
		},
		{
			"indicator": "8227115158f78bee270ef654355ce3a64ee2ef30",
			"description": "",
			"title": "",
			"content": "rule APT_Derusbi_DeepPanda   \n   {   \n      \n   meta:   \n       author = \"ThreatConnect Intelligence Research Team\"   \n       reference = \"http://www.crowdstrike.com/sites/default/files/AdversaryIntelligenceReport_DeepPanda_0.pdf\"   \n      \n   strings:   \n       $D = \"Dom4!nUserP4ss\" wide ascii   \n      \n   condition:   \n       $D   \n   }",
			"type": "YARA",
			"id": 30285445
		},
		{
			"indicator": "71679572d21f3feeb2eb5af800bfb1f2588ca760",
			"description": "",
			"title": "",
			"content": "rule Derusbi_Kernel_Driver_WD_UDFS   \n   {   \n      \n       meta:   \n           description = \"Detects Derusbi Kernel Driver\"   \n           author = \"Florian Roth\"   \n           reference = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"   \n           date = \"2015-12-15\"   \n           score = 80   \n           hash1 = \"1b449121300b0188ff9f6a8c399fb818d0cf53fd36cf012e6908a2665a27f016\"   \n           hash2 = \"50174311e524b97ea5cb4f3ea571dd477d1f0eee06cd3ed73af39a15f3e6484a\"   \n           hash3 = \"6cdb65dbfb2c236b6d149fd9836cb484d0608ea082cf5bd88edde31ad11a0d58\"   \n           hash4 = \"e27fb16dce7fff714f4b05f2cef53e1919a34d7ec0e595f2eaa155861a213e59\"   \n      \n       strings:   \n           $x1 = \"\\\\\\\\.\\\\pipe\\\\usbpcex%d\" fullword wide   \n           $x2 = \"\\\\\\\\.\\\\pipe\\\\usbpcg%d\" fullword wide   \n           $x3 = \"\\\\??\\\\pipe\\\\usbpcex%d\" fullword wide   \n           $x4 = \"\\\\??\\\\pipe\\\\usbpcg%d\" fullword wide   \n           $x5 = \"$$$--Hello\" fullword ascii   \n           $x6 = \"Wrod--$$$\" fullword ascii   \n           $s1 = \"\\\\Registry\\\\User\\\\%s\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\" fullword wide   \n           $s2 = \"Update.dll\" fullword ascii   \n           $s3 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\" fullword wide   \n           $s4 = \"\\\\Driver\\\\nsiproxy\" fullword wide   \n           $s5 = \"HOST: %s\" fullword ascii   \n      \n   condition:   \n           uint16(0) == 0x5a4d and filesize < 800KB and (2 of ($x*) or all of ($s*))   \n   }",
			"type": "YARA",
			"id": 30285446
		},
		{
			"indicator": "c321b5011655df9cc1ac7826d13e11b3f0df7729",
			"description": "",
			"title": "",
			"content": "rule apt_nix_elf_Derusbi_Linux_Strings   \n   {   \n      \n       meta:   \n           Author = \"@seifreed\"   \n      \n       strings:   \n           $a1 = \"loadso\" wide ascii fullword   \n           $a2 = \"\\nuname -a\\n\\n\" wide ascii   \n           $a3 = \"/dev/shm/.x11.id\" wide ascii   \n           $a4 = \"LxMain64\" wide ascii nocase   \n           $a5 = \"# \\\\u@\\\\h:\\\\w \\\\$ \" wide ascii   \n           $b1 = \"0123456789abcdefghijklmnopqrstuvwxyz\" wide   \n           $b2 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\" wide   \n           $b3 = \"ret %d\" wide fullword   \n           $b4 = \"uname -a\\n\\n\" wide ascii   \n           $b5 = \"/proc/%u/cmdline\" wide ascii   \n           $b6 = \"/proc/self/exe\" wide ascii   \n           $b7 = \"cp -a %s %s\" wide ascii   \n           $c1 = \"/dev/pts/4\" wide ascii fullword   \n           $c2 = \"/tmp/1408.log\" wide ascii fullword   \n      \n       condition:   \n           uint32(0) == 0x464C457F and ((1 of ($a*) and 4 of ($b*)) or (1 of ($a*) and 1 of ($c*)) or 2 of ($a*) or all of ($b*))   \n   }",
			"type": "YARA",
			"id": 30285447
		},
		{
			"indicator": "386a35acd1db1b7d6bd5505d8497a57e48823145",
			"description": "",
			"title": "",
			"content": "rule derusbi_kernel   \n   {   \n      \n       meta:   \n           description = \"Derusbi Driver version\"   \n           date = \"2015-12-09\"   \n           author = \"Airbus Defence and Space Cybersecurity CSIRT - Fabien Perigaud\"   \n      \n       strings:   \n           $token1 = \"$$$--Hello\"   \n           $token2 = \"Wrod--$$$\"   \n           $cfg = \"XXXXXXXXXXXXXXX\"   \n           $class = \".?AVPCC_BASEMOD@@\"   \n           $MZ = \"MZ\"   \n      \n       condition:   \n           $MZ at 0 and $token1 and $token2 and $cfg and $class   \n   }",
			"type": "YARA",
			"id": 30285448
		},
		{
			"indicator": "23459a1f9266dd650feabf6b8caeb067837ad9f6",
			"description": "",
			"title": "",
			"content": "rule APT_Derusbi_Gen   \n   {   \n      \n   meta:   \n       author = \"ThreatConnect Intelligence Research Team\"   \n      \n   strings:   \n       $2 = \"273ce6-b29f-90d618c0\" wide ascii   \n       $A = \"Ace123dx\" fullword wide ascii   \n       $A1 = \"Ace123dxl!\" fullword wide ascii   \n       $A2 = \"Ace123dx!@#x\" fullword wide ascii   \n       $C = \"/Catelog/login1.asp\" wide ascii   \n       $DF = \"~DFTMP$$$$$.1\" wide ascii   \n       $G = \"GET /Query.asp?loginid=\" wide ascii   \n       $L = \"LoadConfigFromReg failded\" wide ascii   \n       $L1 = \"LoadConfigFromBuildin success\" wide ascii   \n       $ph = \"/photoe/photo.asp HTTP\" wide ascii   \n       $PO = \"POST /photos/photo.asp\" wide ascii   \n       $PC = \"PCC_IDENT\" wide ascii   \n      \n   condition:   \n       any of them   \n   }",
			"type": "YARA",
			"id": 30285449
		},
		{
			"indicator": "d1ab25712ffd414907c64c8bd3e2cb24eb83b22f",
			"description": "",
			"title": "",
			"content": "rule apt_nix_elf_derusbi_kernelModule   \n   {   \n      \n       meta:   \n           Author = \"@seifreed\"   \n      \n       strings:   \n           $ = \"__this_module\"   \n           $ = \"init_module\"   \n           $ = \"unhide_pid\"   \n           $ = \"is_hidden_pid\"   \n           $ = \"clear_hidden_pid\"   \n           $ = \"hide_pid\"   \n           $ = \"license\"   \n           $ = \"description\"   \n           $ = \"srcversion=\"   \n           $ = \"depends=\"   \n           $ = \"vermagic=\"   \n           $ = \"current_task\"   \n           $ = \"sock_release\"   \n           $ = \"module_layout\"   \n           $ = \"init_uts_ns\"   \n           $ = \"init_net\"   \n           $ = \"init_task\"   \n           $ = \"filp_open\"   \n           $ = \"__netlink_kernel_create\"   \n           $ = \"kfree_skb\"   \n      \n       condition:   \n           (uint32(0) == 0x4464c457f) and (all of them)   \n   }",
			"type": "YARA",
			"id": 30285450
		},
		{
			"indicator": "7ba91752e5bfd65c21bb1c9ee222dd866d6d4ba4",
			"description": "",
			"title": "",
			"content": "rule apt_win32_dll_bergard_pgv_pvid_variant   \n   {   \n      \n       meta:   \n           copyright = \"Fidelis Cybersecurity\"   \n           reference = \"http://www.threatgeek.com/2016/05/turbo-twist-two-64-bit-derusbi-strains-converge.html\"   \n      \n       strings:   \n           $ = \"Accept:\"   \n           $ = \"User-Agent: %s\"   \n           $ = \"Host: %s:%d\"   \n           $ = \"Cache-Control: no-cache\"   \n           $ = \"Connection: Keep-Alive\"   \n           $ = \"Cookie: pgv_pvid=\"   \n           $ = \"Content-Type: application/x-octet-stream\"   \n           $ = \"User-Agent: %s\"   \n           $ = \"Host: %s:%d\"   \n           $ = \"Pragma: no-cache\"   \n           $ = \"Connection: Keep-Alive\"   \n           $ = \"HTTP/1.0\"   \n      \n       condition:   \n           (uint16(0) == 0x5A4D) and (all of them)   \n   }",
			"type": "YARA",
			"id": 30285451
		},
		{
			"indicator": "68721692a0cd290ff7857c34208d8b1b037a146d",
			"description": "",
			"title": "",
			"content": "rule apt_win_exe_trojan_derusbi   \n   {   \n      \n      meta:   \n           Author = \"@seifreed\"   \n      \n      strings:   \n           $sa_1 = \"USB\" wide ascii   \n           $sa_2 = \"RAM\" wide ascii   \n           $sa_3 = \"SHARE\" wide ascii   \n           $sa_4 = \"HOST: %s:%d\"   \n           $sa_5 = \"POST\"   \n           $sa_6 = \"User-Agent: Mozilla\"   \n           $sa_7 = \"Proxy-Connection: Keep-Alive\"   \n           $sa_8 = \"Connection: Keep-Alive\"   \n           $sa_9 = \"Server: Apache\"   \n           $sa_10 = \"HTTP/1.1\"   \n           $sa_11 = \"ImagePath\"   \n           $sa_12 = \"ZwUnloadDriver\"   \n           $sa_13 = \"ZwLoadDriver\"   \n           $sa_14 = \"ServiceMain\"   \n           $sa_15 = \"regsvr32.exe\"   \n           $sa_16 = \"/s /u\" wide ascii   \n           $sa_17 = \"rand\"   \n           $sa_18 = \"_time64\"   \n           $sa_19 = \"DllRegisterServer\"   \n           $sa_20 = \"DllUnregisterServer\"   \n           $sa_21 = { 8b [5] 8b ?? d3 ?? 83 ?? 08 30 [5] 40 3b [5] 72 } // Decode Driver   \n           $sb_1 = \"PCC_CMD_PACKET\"   \n           $sb_2 = \"PCC_CMD\"   \n           $sb_3 = \"PCC_BASEMOD\"   \n           $sb_4 = \"PCC_PROXY\"   \n           $sb_5 = \"PCC_SYS\"   \n           $sb_6 = \"PCC_PROCESS\"   \n           $sb_7 = \"PCC_FILE\"   \n           $sb_8 = \"PCC_SOCK\"   \n           $sc_1 = \"bcdedit -set testsigning\" wide ascii   \n           $sc_2 = \"update.microsoft.com\" wide ascii   \n           $sc_3 = \"_crt_debugger_hook\" wide ascii   \n           $sc_4 = \"ue8G5\" wide ascii   \n           $sd_1 = \"NET\" wide ascii   \n           $sd_2 = \"\\\\\\\\.\\\\pipe\\\\%s\" wide ascii   \n           $sd_3 = \".dat\" wide ascii   \n           $sd_4 = \"CONNECT %s:%d\" wide ascii   \n           $sd_5 = \"\\\\Device\\\\\" wide ascii   \n           $se_1 = \"-%s-%04d\" wide ascii   \n           $se_2 = \"-%04d\" wide ascii   \n           $se_3 = \"FAL\" wide ascii   \n           $se_4 = \"OK\" wide ascii   \n           $se_5 = \"2.03\" wide ascii   \n           $se_6 = \"XXXXXXXXXXXXXXX\" wide ascii   \n      \n      condition:   \n         (uint16(0) == 0x5A4D) and ( (all of ($sa_*)) or ((13 of ($sa_*)) and ( (5 of ($sb_*)) or (3 of ($sc_*)) or (all of ($sd_*)) or ( (1 of ($sc_*)) and (all of ($se_*)) ) ) ) )   \n   }",
			"type": "YARA",
			"id": 30285452
		},
		{
			"indicator": "82cde43eef2b058dafccf84edc57cd0cab7b4d6f",
			"description": "",
			"title": "",
			"content": "rule XOR_4byte_Key   \n   {   \n      \n       meta:   \n           description = \"Detects an executable encrypted with a 4 byte XOR (also used for Derusbi Trojan)\"   \n           author = \"Florian Roth\"   \n           reference = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"   \n           date = \"2015-12-15\"   \n           score = 60   \n      \n      strings:   \n         /* Op Code */   \n         $s1 = { 85 C9 74 0A 31 06 01 1E 83 C6 04 49 EB F2 }   \n         /*   \n         test    ecx, ecx   \n         jz      short loc_590170   \n         xor     [esi], eax   \n         add     [esi], ebx   \n         add     esi, 4   \n         dec     ecx   \n         jmp     short loc_590162   \n         */   \n      \n      condition:   \n         uint16(0) == 0x5a4d and filesize < 900KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285453
		},
		{
			"indicator": "d32e2027813fe5f315a34e596f1c0b36a7d00071",
			"description": "",
			"title": "",
			"content": "rule apt_nix_elf_Derusbi_Linux_SharedMemCreation   \n   {   \n      \n       meta:   \n           Author = \"@seifreed\"   \n      \n       strings:   \n           $byte1 = { B6 03 00 00 ?? 40 00 00 00 ?? 0D 5F 01 82 }   \n      \n       condition:   \n           (uint32(0) == 0x464C457F) and (any of them)   \n   }",
			"type": "YARA",
			"id": 30285454
		},
		{
			"indicator": "a356d10da9cfaa35fe10333513729969b3e86a81",
			"description": "",
			"title": "",
			"content": "rule Trojan_Derusbi   \n   {   \n      \n       meta:   \n           Author = \"RSA_IR\"   \n           Date     = \"4Sept13\"   \n           File     = \"derusbi_variants v 1.3\"   \n           MD5      = \" c0d4c5b669cc5b51862db37e972d31ec \"   \n      \n       strings:   \n           $b1 = {8b 15 ?? ?? ?? ?? 8b ce d3 ea 83 c6 ?? 30 90 ?? ?? ?? ?? 40 3b 05 ?? ?? ?? ?? 72 ??}   \n           $b2 = {F3 5D 88 2E ?? ?? 00 00 BE 07 18 2E F0 5D 88 2E F7 5D 88 2E 0C A2 88 2E 4B 5D 88 2E F3 5D 88 2E}   \n           $b3 = {4E E6 40 BB}   \n           $b4 = {B1 19 BF 44}   \n           $b5 = {6A F5 44 3D ?? ?? 00 00 27 AF D4 3D 69 F5 44 3D 6E F5 44 3D 95 0A 44 3D D2 F5 44 3D 6A F5 44 3D}   \n           $b6 = {F3 5D 88 2E ?? ?? 00 00 BE 07 18 2E F0 5D 88 2E}   \n           $b7 = {D6 D5 A4 A3 ?? ?? 00 00 9B 8F 34 A3 D5 D5 A4 A3 D2 D5 A4 A3 29 2A A4 A3}   \n           $b8 = {C3 76 33 9F ?? ?? 00 00 8E 2C A3 9F C0 76 33 9F C7 76 33 9F 3C 89 33 9F}   \n      \n       condition:   \n           2 of ($b1, $b2, $b3, $b4) and 1 of ($b5, $b6, $b7, $b8)   \n   }",
			"type": "YARA",
			"id": 30285455
		},
		{
			"indicator": "eae3dd657b51d78c17459f733d40317a04c816f3",
			"description": "",
			"title": "",
			"content": "rule apt_nix_elf_derusbi   \n   {   \n      \n       meta:   \n           Author = \"@seifreed\"   \n      \n       strings:   \n           $ = \"LxMain\"   \n           $ = \"execve\"   \n           $ = \"kill\"   \n           $ = \"cp -a %s %s\"   \n           $ = \"%s &\"   \n           $ = \"dbus-daemon\"   \n           $ = \"--noprofile\"   \n           $ = \"--norc\"   \n           $ = \"TERM=vt100\"   \n           $ = \"/proc/%u/cmdline\"   \n           $ = \"loadso\"   \n           $ = \"/proc/self/exe\"   \n           $ = \"Proxy-Connection: Keep-Alive\"   \n           $ = \"Connection: Keep-Alive\"   \n           $ = \"CONNECT %s\"   \n           $ = \"HOST: %s:%d\"   \n           $ = \"User-Agent: Mozilla/4.0\"   \n           $ = \"Proxy-Authorization: Basic %s\"   \n           $ = \"Server: Apache\"   \n           $ = \"Proxy-Authenticate\"   \n           $ = \"gettimeofday\"   \n           $ = \"pthread_create\"   \n           $ = \"pthread_join\"   \n           $ = \"pthread_mutex_init\"   \n           $ = \"pthread_mutex_destroy\"   \n           $ = \"pthread_mutex_lock\"   \n           $ = \"getsockopt\"   \n           $ = \"socket\"   \n           $ = \"setsockopt\"   \n           $ = \"select\"   \n           $ = \"bind\"   \n           $ = \"shutdown\"   \n           $ = \"listen\"   \n           $ = \"opendir\"   \n           $ = \"readdir\"   \n           $ = \"closedir\"   \n           $ = \"rename\"   \n      \n       condition:   \n           (uint32(0) == 0x4464c457f) and (all of them)   \n   }",
			"type": "YARA",
			"id": 30285456
		},
		{
			"indicator": "7bf47909f6a4f03a87008a7fe497601610040ce8",
			"description": "",
			"title": "",
			"content": "rule derusbi_linux   \n   {   \n      \n       meta:   \n           description = \"Derusbi Server Linux version\"   \n           date = \"2015-12-09\"   \n           author = \"Airbus Defence and Space Cybersecurity CSIRT - Fabien Perigaud\"   \n      \n       strings:   \n           $PS1 = \"PS1=RK# \\\\u@\\\\h:\\\\w \\\\$\"   \n           $cmd = \"unset LS_OPTIONS;uname -a\"   \n           $pname = \"[diskio]\"   \n           $rkfile = \"/tmp/.secure\"   \n           $ELF = \"\\x7fELF\"   \n      \n       condition:   \n           $ELF at 0 and $PS1 and $cmd and $pname and $rkfile   \n   }",
			"type": "YARA",
			"id": 30285457
		},
		{
			"indicator": "ec2f8937a4ef1951fdd1bbda2efde88746b24405",
			"description": "",
			"title": "",
			"content": "rule Derusbi_Code_Signing_Cert   \n   {   \n      \n       meta:   \n           description = \"Detects an executable signed with a certificate also used for Derusbi Trojan - suspicious\"   \n           author = \"Florian Roth\"   \n           reference = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"   \n           date = \"2015-12-15\"   \n           score = 40   \n      \n      strings:   \n         $s1 = \"Fuqing Dawu Technology Co.,Ltd.0\" fullword ascii   \n         $s2 = \"XL Games Co.,Ltd.0\" fullword ascii   \n         $s3 = \"Wemade Entertainment co.,Ltd0\" fullword ascii   \n      \n      condition:   \n         uint16(0) == 0x5a4d and filesize < 800KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30285458
		},
		{
			"indicator": "7f22bf9bffcc966738fab0c27faf1cbec58a36a3",
			"description": "",
			"title": "",
			"content": "rule Dubnium_Sample_6   \n   {   \n      \n       meta:   \n           description = \"Detects sample mentioned in the Dubnium Report\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/AW9Cuu\"   \n           date = \"2016-06-10\"   \n           super_rule = 1   \n           hash1 = \"5246899b8c74a681e385cbc1dd556f9c73cf55f2a0074c389b3bf823bfc6ce4b\"   \n           hash2 = \"5f07b074414513b73e202d7f77ec4bcf048f13dd735c9be3afcf25be818dc8e0\"   \n           hash3 = \"839baf85de657b6d6503b6f94054efa8841f667987a9c805eab94a85a859e1ba\"   \n      \n       strings:   \n           $s1 = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&()`~-_=+[{]{;',.\" fullword ascii   \n           $s2 = \"e_$0[bW\\\\RZY\\\\jb\\\\ZY[nimiRc[jRZ]\" fullword ascii   \n           $s3 = \"f_RIdJ0W9RFb[$Fbc9[k_?Wn\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 4000KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285464
		},
		{
			"indicator": "5b97711616e89383a27380bb3d6a7ee6aba5243d",
			"description": "",
			"title": "",
			"content": "rule Dubnium_Sample_7   \n   {   \n      \n       meta:   \n           description = \"Detects sample mentioned in the Dubnium Report\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/AW9Cuu\"   \n           date = \"2016-06-10\"   \n           super_rule = 1   \n           hash1 = \"16f0b05d5e8546ab1504b07b0eaa0e8de14bca7c1555fd114c4c1c51d5a4c06b\"   \n           hash2 = \"1feaad03f6c0b57f5f5b02aef668e26001e5a7787bb51966d50c8fcf344fb4e8\"   \n           hash3 = \"41ecd81bc7df4b47d713e812f2b7b38d3ac4b9dcdc13dd5ca61763a4bf300dcf\"   \n           hash4 = \"5246899b8c74a681e385cbc1dd556f9c73cf55f2a0074c389b3bf823bfc6ce4b\"   \n           hash5 = \"5f07b074414513b73e202d7f77ec4bcf048f13dd735c9be3afcf25be818dc8e0\"   \n           hash6 = \"a25715108d2859595959879ff50085bc85969e9473ecc3d26dda24c4a17822c9\"   \n           hash7 = \"bd780f4d56214c78045454d31d83ae18ed209cc138e75d138e72976a7ef9803f\"   \n           hash8 = \"e0918072d427d12b43f436bf0797a361996ae436047d4ef8277f11caf2dd481b\"   \n      \n       strings:   \n           $s1 = \"hWI[$lZ![nJ_[[lk[8Ihlo8ZiIl[[[$Ynk[f_8[88WWWJW[YWnl$$Z[ilf!$IZ$!W>Wl![W!k!$l!WoW8$nj8![8n_I^$[>_n[ZY[[Xhn_c!nnfK[!Z\" fullword ascii   \n           $s2 = \"[i_^])[$n!]Wj^,h[,!WZmk^o$dZ[h[e!&W!l[$nd[d&)^Z\\\\^[[iWh][[[jPYO[g$$e&n\\\\,Wfg$[<g$[[ninn:j!!)Wk[nj[[o!!Y\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 9000KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285465
		},
		{
			"indicator": "6d1428b6522af706d849cb0908eb2e776d41e52b",
			"description": "",
			"title": "",
			"content": "rule Dubnium_Sample_5   \n   {   \n      \n       meta:   \n           description = \"Detects sample mentioned in the Dubnium Report\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/AW9Cuu\"   \n           date = \"2016-06-10\"   \n           super_rule = 1   \n           hash1 = \"16f0b05d5e8546ab1504b07b0eaa0e8de14bca7c1555fd114c4c1c51d5a4c06b\"   \n           hash2 = \"1feaad03f6c0b57f5f5b02aef668e26001e5a7787bb51966d50c8fcf344fb4e8\"   \n           hash3 = \"41ecd81bc7df4b47d713e812f2b7b38d3ac4b9dcdc13dd5ca61763a4bf300dcf\"   \n           hash4 = \"5246899b8c74a681e385cbc1dd556f9c73cf55f2a0074c389b3bf823bfc6ce4b\"   \n           hash5 = \"5f07b074414513b73e202d7f77ec4bcf048f13dd735c9be3afcf25be818dc8e0\"   \n           hash6 = \"839baf85de657b6d6503b6f94054efa8841f667987a9c805eab94a85a859e1ba\"   \n           hash7 = \"a25715108d2859595959879ff50085bc85969e9473ecc3d26dda24c4a17822c9\"   \n           hash8 = \"bd780f4d56214c78045454d31d83ae18ed209cc138e75d138e72976a7ef9803f\"   \n           hash9 = \"e0918072d427d12b43f436bf0797a361996ae436047d4ef8277f11caf2dd481b\"   \n      \n       strings:   \n           $s1 = \"$innn[i$[i$^i[e[mdi[m$jf1Wehn[^Whl[^iin_hf$11mahZijnjbi[^[W[f1n$dej$[hn]1[W1ni1l[ic1j[mZjchl$$^he[[j[a[1_iWc[e[\" fullword ascii   \n           $s2 = \"h$YWdh[$ij7^e$n[[_[h[i[[[\\\\][1$1[[j1W1[1cjm1[$[k1ZW_$$ncn[[Inbnnc[I9enanid[fZCX\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 9000KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285466
		},
		{
			"indicator": "8ccf5383fa397ede11491dfdf8e53f1bc6af9891",
			"description": "",
			"title": "",
			"content": "rule Dubnium_Sample_SSHOpenSSL   \n   {   \n      \n       meta:   \n           description = \"Detects sample mentioned in the Dubnium Report\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/AW9Cuu\"   \n           date = \"2016-06-10\"   \n           hash1 = \"6f0b05d5e8546ab1504b07b0eaa0e8de14bca7c1555fd114c4c1c51d5a4c06b\"   \n           hash2 = \"feaad03f6c0b57f5f5b02aef668e26001e5a7787bb51966d50c8fcf344fb4e8\"   \n           hash3 = \"41ecd81bc7df4b47d713e812f2b7b38d3ac4b9dcdc13dd5ca61763a4bf300dcf\"   \n           hash4 = \"bd780f4d56214c78045454d31d83ae18ed209cc138e75d138e72976a7ef9803f\"   \n           hash5 = \"a25715108d2859595959879ff50085bc85969e9473ecc3d26dda24c4a17822c9\"   \n           hash6 = \"e0918072d427d12b43f436bf0797a361996ae436047d4ef8277f11caf2dd481b\"   \n      \n       strings:   \n           $s1 = \"sshkeypairgen.exe\" fullword wide   \n           $s2 = \"OpenSSL: FATAL\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 9000KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285467
		},
		{
			"indicator": "d0385e9d52df25083a3213c98efd18fed6e3fa09",
			"description": "",
			"title": "",
			"content": "rule Dubnium_Sample_1   \n   {   \n      \n       meta:   \n           description = \"Detects sample mentioned in the Dubnium Report\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/AW9Cuu\"   \n           date = \"2016-06-10\"   \n           hash1 = \"839baf85de657b6d6503b6f94054efa8841f667987a9c805eab94a85a859e1ba\"   \n      \n       strings:   \n           $key1 = \"3b840e20e9555e9fb031c4ba1f1747ce25cc1d0ff664be676b9b4a90641ff194\" fullword ascii   \n           $key2 = \"90631f686a8c3dbc0703ffa353bc1fdf35774568ac62406f98a13ed8f47595fd\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 2000KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285468
		},
		{
			"indicator": "6b89a0cfbc59838b4aa306c1c51eb6fd1caa6d27",
			"description": "",
			"title": "",
			"content": "rule Dubnium_Sample_2   \n   {   \n      \n       meta:   \n           description = \"Detects sample mentioned in the Dubnium Report\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/AW9Cuu\"   \n           date = \"2016-06-10\"   \n           hash1 = \"5246899b8c74a681e385cbc1dd556f9c73cf55f2a0074c389b3bf823bfc6ce4b\"   \n      \n       strings:   \n           $x1 = \":*:::D:\\\\:c:~:\" fullword ascii   \n           $s2 = \"SPMUVR\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 2000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30285469
		},
		{
			"indicator": "d46835a390ead4d7c5001e7ffef1cdc49a8af8c2",
			"description": "",
			"title": "",
			"content": "rule Dubnium_Sample_3   \n   {   \n      \n       meta:   \n           description = \"Detects sample mentioned in the Dubnium Report\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/AW9Cuu\"   \n           date = \"2016-06-10\"   \n           hash1 = \"caefcdf2b4e5a928cdf9360b70960337f751ec4a5ab8c0b75851fc9a1ab507a8\"   \n           hash2 = \"e0362d319a8d0e13eda782a0d8da960dd96043e6cc3500faeae521d1747576e5\"   \n           hash3 = \"a77d1c452291a6f2f6ed89a4bac88dd03d38acde709b0061efd9f50e6d9f3827\"   \n      \n       strings:   \n           $x1 = \"copy /y \\\"%s\\\" \\\"%s\\\" \" fullword ascii   \n           $x2 = \"del /f \\\"%s\\\" \" fullword ascii   \n           $s1 = \"del /f /ah \\\"%s\\\" \" fullword ascii   \n           $s2 = \"if exist \\\"%s\\\" goto Rept \" fullword ascii   \n           $s3 = \"\\\\*.*.lnk\" fullword ascii   \n           $s4 = \"Dropped\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 2000KB and 5 of them   \n   }",
			"type": "YARA",
			"id": 30285470
		},
		{
			"indicator": "8069a7f6ea03ccd005f9d59a7a5dc7a33ea97c2e",
			"description": "",
			"title": "",
			"content": "rule apt_duqu2_drivers    \n   {    \n      \n       meta:   \n   \t\tcopyright = \"Kaspersky Lab\"   \n   \t\tdescription = \"Rule to detect Duqu 2.0 drivers\"   \n   \t\tlast_modified = \"2015-06-09\"   \n   \t\tversion = \"1.0\"   \n   \t   \n       strings:   \n   \t\t$a1 = \"\\\\DosDevices\\\\port_optimizer\" wide nocase    \n   \t\t$a2 = \"romanian.antihacker\"    \n   \t\t$a3 = \"PortOptimizerTermSrv\" wide    \n   \t\t$a4 = \"ugly.gorilla1\"   \n   \t\t$b1 = \"NdisIMCopySendCompletePerPacketInfo\"    \n   \t\t$b2 = \"NdisReEnumerateProtocolBindings\"   \n   \t\t$b3 = \"NdisOpenProtocolConfiguration\"   \n   \tcondition:   \n   \t\tuint16(0) == 0x5A4D and (any of ($a*) ) and (2 of ($b*)) and filesize < 100000   \n   }",
			"type": "YARA",
			"id": 30285485
		},
		{
			"indicator": "ec6450c2a5e93025dd200f62c4b4fcb4d0236eb2",
			"description": "",
			"title": "",
			"content": "rule apt_duqu2_loaders    \n   {    \n      \n       meta:   \n   \t\tcopyright = \"Kaspersky Lab\"   \n   \t\tdescription = \"Rule to detect Duqu 2.0 samples\"   \n   \t\tlast_modified = \"2015-06-09\"   \n   \t\tversion = \"1.0\"   \n      \n       strings:   \n   \t\t$a1 = \"{AAFFC4F0-E04B-4C7C-B40A-B45DE971E81E}\" wide    \n   \t\t$a2 = \"\\\\\\\\.\\\\pipe\\\\{AAFFC4F0-E04B-4C7C-B40A-B45DE971E81E}\" wide   \n   \t\t$a4 = \"\\\\\\\\.\\\\pipe\\\\{AB6172ED-8105-4996-9D2A-597B5F827501}\" wide   \n   \t\t$a5 = \"Global\\\\{B54E3268-DE1E-4c1e-A667-2596751403AD}\" wide   \n   \t\t$a8 = \"SELECT `Data` FROM `Binary` WHERE `Name`='%s%i'\" wide   \n   \t\t$a9 = \"SELECT `Data` FROM `Binary` WHERE `Name`='CryptHash%i'\" wide   \n   \t\t$a7 = \"SELECT `%s` FROM `%s` WHERE `%s`='CAData%i'\" wide   \n   \t\t$b1 = \"MSI.dll\"   \n   \t\t$b2 = \"msi.dll\"   \n   \t\t$b3 = \"StartAction\"   \n   \t\t$c1 = \"msisvc_32@\" wide   \n   \t\t$c2 = \"PROP=\" wide   \n   \t\t$c3 = \"-Embedding\" wide   \n   \t\t$c4 = \"S:(ML;;NW;;;LW)\" wide   \n   \t\t$d1 = \"NameTypeBinaryDataCustomActionActionSourceTargetInstallExecuteSequenceConditionSequencePropertyValueMicrosoftManufacturer\" nocase   \n   \t\t$d2 = {2E 3F 41 56 3F 24 5F 42 69 6E 64 40 24 30 30 58 55 3F 24 5F 50 6D 66 5F 77 72 61 70 40 50 38 43 4C 52 ?? 40 40 41 45 58 58 5A 58 56 31 40 24 24 24 56 40 73 74 64 40 40 51 41 56 43 4C 52 ?? 40 40 40 73 74 64 40 40}   \n   \t   \n       condition:   \n   \t\t( (uint16(0) == 0x5a4d) and ( (any of ($a*)) or (all of ($b*)) or (all of ($c*)) ) and filesize < 100000 ) or ( (uint32(0) == 0xe011cfd0) and ( (any of ($a*)) or (all of ($b*)) or (all of ($c*)) or (any of ($d*)) ) and filesize < 20000000 )   \n   }",
			"type": "YARA",
			"id": 30285486
		},
		{
			"indicator": "e156ef843ef84ae907983275d6af39d47ae8dd38",
			"description": "",
			"title": "",
			"content": "rule APT_Kaspersky_Duqu2_msi3_32    \n   {   \n      \n       meta:   \n   \t\tdescription = \"Kaspersky APT Report - Duqu2 Sample - file d8a849654ab97debaf28ae5b749c3b1ff1812ea49978713853333db48c3972c3\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"https://goo.gl/7yKyOj\"   \n   \t\tdate = \"2015-06-10\"   \n   \t\thash = \"53d9ef9e0267f10cc10f78331a9e491b3211046b\"   \n   \t   \n       strings:   \n   \t\t$s0 = \"ProcessUserAccounts\" fullword ascii /* PEStudio Blacklist: strings */   \n   \t\t$s1 = \"SELECT `UserName`, `Password`, `Attributes` FROM `CustomUserAccounts`\" fullword wide /* PEStudio Blacklist: strings */   \n   \t\t$s2 = \"SELECT `UserName` FROM `CustomUserAccounts`\" fullword wide /* PEStudio Blacklist: strings */   \n   \t\t$s3 = \"SELECT `Data` FROM `Binary` WHERE `Name`='CryptHash%i'\" fullword wide   \n   \t\t$s4 = \"msi3_32.dll\" fullword wide   \n   \t\t$s5 = \"RunDLL\" fullword ascii   \n   \t\t$s6 = \"MSI Custom Action v3\" fullword wide   \n   \t\t$s7 = \"msi3_32\" fullword wide   \n   \t\t$s8 = \"Operating System\" fullword wide /* PEStudio Blacklist: strings */ /* Goodware String - occured 9203 times */   \n   \t   \n       condition:   \n   \t\tuint16(0) == 0x5a4d and filesize < 72KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285487
		},
		{
			"indicator": "dd1f185e5b8c0623ab27ab549761ba66fb8983fc",
			"description": "",
			"title": "",
			"content": "rule APT_Kaspersky_Duqu2_procexp    \n   {   \n      \n       meta:   \n   \t\tdescription = \"Kaspersky APT Report - Duqu2 Sample - Malicious MSI\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"https://goo.gl/7yKyOj\"   \n   \t\tdate = \"2015-06-10\"   \n   \t\thash1 = \"2422835716066b6bcecb045ddd4f1fbc9486667a\"   \n   \t\thash2 = \"b120620b5d82b05fee2c2153ceaf305807fa9f79\"   \n   \t\thash3 = \"288ebfe21a71f83b5575dfcc92242579fb13910d\"   \n   \t   \n       strings:   \n   \t\t$x1 = \"svcmsi_32.dll\" fullword wide   \n   \t\t$x2 = \"msi3_32.dll\" fullword wide   \n   \t\t$x3 = \"msi4_32.dll\" fullword wide   \n   \t\t$x4 = \"MSI.dll\" fullword ascii   \n   \t\t$s1 = \"SELECT `Data` FROM `Binary` WHERE `Name`='%s%i'\" fullword wide   \n   \t\t$s2 = \"Sysinternals installer\" fullword wide /* PEStudio Blacklist: strings */   \n   \t\t$s3 = \"Process Explorer\" fullword wide /* PEStudio Blacklist: strings */ /* Goodware String - occured 5 times */   \n   \t   \n       condition:   \n   \t\tuint16(0) == 0x5a4d and filesize < 100KB and ( 1 of ($x*) ) and ( all of ($s*) )   \n   }",
			"type": "YARA",
			"id": 30285488
		},
		{
			"indicator": "c8212fbc2f00ea7537b633fc22bf7cabe6cdfad2",
			"description": "",
			"title": "",
			"content": "rule Duqu2_Generic1    \n   {   \n      \n       meta:   \n   \t\tdescription = \"Kaspersky APT Report - Duqu2 Sample - Generic Rule\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"https://goo.gl/7yKyOj\"   \n   \t\tdate = \"2015-06-10\"   \n   \t\tsuper_rule = 1   \n   \t\thash0 = \"3f9168facb13429105a749d35569d1e91465d313\"   \n   \t\thash1 = \"0a574234615fb2382d85cd6d1a250d6c437afecc\"   \n   \t\thash2 = \"38447ed1d5e3454fe17699f86c0039f30cc64cde\"   \n   \t\thash3 = \"5282d073ee1b3f6ce32222ccc2f6066e2ca9c172\"   \n   \t\thash4 = \"edfca3f0196788f7fde22bd92a8817a957c10c52\"   \n   \t\thash5 = \"6a4ffa6ca4d6fde8a30b6c8739785f4bd2b5c415\"   \n   \t\thash6 = \"00170bf9983e70e8dd4f7afe3a92ce1d12664467\"   \n   \t\thash7 = \"32f8689fd18c723339414618817edec6239b18f3\"   \n   \t\thash8 = \"f860acec9920bc009a1ad5991f3d5871c2613672\"   \n   \t\thash9 = \"413ba509e41c526373f991d1244bc7c7637d3e13\"   \n   \t\thash10 = \"29cd99a9b6d11a09615b3f9ef63f1f3cffe7ead8\"   \n   \t\thash11 = \"dfe1cb775719b529138e054e7246717304db00b1\"   \n   \t   \n       strings:   \n   \t\t$s0 = \"Global\\\\{B54E3268-DE1E-4c1e-A667-2596751403AD}\" fullword wide   \n   \t\t$s1 = \"SetSecurityDescriptorSacl\" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 189 times */   \n   \t\t$s2 = \"msisvc_32@\" fullword wide   \n   \t\t$s3 = \"CompareStringA\" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 1392 times */   \n   \t\t$s4 = \"GetCommandLineW\" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 1680 times */   \n   \t   \n       condition:   \n   \t\tuint16(0) == 0x5a4d and filesize < 150KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285489
		},
		{
			"indicator": "7ab072585466a1c596930a2f3e8f8e894ae3adfa",
			"description": "",
			"title": "",
			"content": "rule APT_Kaspersky_Duqu2_SamsungPrint    \n   {   \n      \n       meta:   \n   \t\tdescription = \"Kaspersky APT Report - Duqu2 Sample - file 2a9a5afc342cde12c6eb9a91ad29f7afdfd8f0fb17b983dcfddceccfbc17af69\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"https://goo.gl/7yKyOj\"   \n   \t\tdate = \"2015-06-10\"   \n   \t\thash = \"ce39f41eb4506805efca7993d3b0b506ab6776ca\"   \n   \t   \n       strings:   \n   \t\t$s0 = \"Installer for printer drivers and applications\" fullword wide /* PEStudio Blacklist: strings */   \n   \t\t$s1 = \"msi4_32.dll\" fullword wide   \n   \t\t$s2 = \"HASHVAL\" fullword wide   \n   \t\t$s3 = \"SELECT `%s` FROM `%s` WHERE `%s`='CAData%i'\" fullword wide   \n   \t\t$s4 = \"ca.dll\" fullword ascii   \n   \t\t$s5 = \"Samsung Electronics Co., Ltd.\" fullword wide   \n   \t   \n       condition:   \n   \t\tuint16(0) == 0x5a4d and filesize < 82KB and all of them   \n   }",
			"type": "YARA",
			"id": 30285490
		},
		{
			"indicator": "f32bbd544700652bd05cc18fce5bcbe1c5ad1a1b",
			"description": "",
			"title": "",
			"content": "rule EQGRP_create_http_injection    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file create_http_injection.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"de52f5621b4f3896d4bd1fb93ee8be827e71a2b189a9f8552b68baed062a992d\"   \n      \n       strings:   \n           $x1 = \"required by SECONDDATE\" fullword ascii   \n           $s1 = \"help='Output file name (optional). By default the resulting data is written to stdout.')\" fullword ascii   \n           $s2 = \"data = '<html><body onload=\\\"location.reload(true)\\\"><iframe src=\\\"%s\\\" height=\\\"1\\\" width=\\\"1\\\" scrolling=\\\"no\\\" frameborder=\\\"\" ascii   \n           $s3 = \"version='%prog 1.0',\" fullword ascii   \n           $s4 = \"usage='%prog [ ... options ... ] url',\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x2123 and filesize < 3KB and ( $x1 or 2 of them ) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30285510
		},
		{
			"indicator": "ea01898ce59de88349285e940e22882e3a288776",
			"description": "",
			"title": "",
			"content": "rule EQGRP_false    \n   {   \n      \n       meta:   \n           description = \"Detects tool from EQGRP toolset - file false.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-15\"   \n      \n       strings:   \n           $s1 = { 00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00   \n               00 25 6C 75 2E 25 6C 75 2E 25 6C 75 2E 25 6C 75   \n               00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00   \n               00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00   \n               00 25 32 2E 32 58 20 00 00 0A 00 00 00 25 64 20   \n               2D 20 25 64 20 25 64 0A 00 25 64 0A 00 25 64 2E   \n               0A 00 00 00 00 25 64 2E 0A 00 00 00 00 25 64 2E   \n               0A 00 00 00 00 25 64 20 2D 20 25 64 0A 00 00 00   \n               00 25 64 20 2D 20 25 64 }   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 50KB and $s1   \n   }",
			"type": "YARA",
			"id": 30285511
		},
		{
			"indicator": "fc00f041730af45a0cd3a7e02cf571d4c2e98042",
			"description": "",
			"title": "",
			"content": "rule install_get_persistent_filenames    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file install_get_persistent_filenames\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"4a50ec4bf42087e932e9e67e0ea4c09e52a475d351981bb4c9851fda02b35291\"   \n      \n       strings:   \n           $s1 = \"Generates the persistence file name and prints it out.\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and all of them )   \n   }",
			"type": "YARA",
			"id": 30285512
		},
		{
			"indicator": "d7cc88ed1e895294654dab365bf49a47e4e96a71",
			"description": "",
			"title": "",
			"content": "rule EQGRP_noclient_3_0_5    \n   {   \n       meta:   \n           description = \"Detects tool from EQGRP toolset - file noclient-3.0.5.3\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-15\"   \n      \n       strings:   \n           $x1 = \"-C %s 127.0.0.1\\\" scripme -F -t JACKPOPIN4 '&\" fullword ascii   \n           $x2 = \"Command too long!  What the HELL are you trying to do to me?!?!  Try one smaller than %d bozo.\" fullword ascii   \n           $x3 = \"sh -c \\\"ping -c 2 %s; grep %s /proc/net/arp >/tmp/gx \\\"\" fullword ascii   \n           $x4 = \"Error from ourtn, did not find keys=target in tn.spayed\" fullword ascii   \n           $x5 = \"ourtn -d -D %s -W 127.0.0.1:%d  -i %s -p %d %s %s\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 700KB and 1 of them ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30285513
		},
		{
			"indicator": "988658e684b3f62970b6c9c14fe01e3efb55346b",
			"description": "",
			"title": "",
			"content": "rule EQGRP_SecondDate_2211    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file SecondDate-2211.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"2337d0c81474d03a02c404cada699cf1b86c3c248ea808d4045b86305daa2607\"   \n      \n       strings:   \n           $s1 = \"SD_processControlPacket\" fullword ascii   \n           $s2 = \"Encryption_rc4SetKey\" fullword ascii   \n           $s3 = \".got_loader\" fullword ascii   \n           $s4 = \"^GET.*(?:/ |\\\\.(?:htm|asp|php)).*\\\\r\\\\n\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 200KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30285514
		},
		{
			"indicator": "aa43b37e793b447c8c49d6d4a262f4b8e7279e52",
			"description": "",
			"title": "",
			"content": "rule EQGRP_teflonhandle    \n   {   \n      \n       meta:   \n           description = \"Detects tool from EQGRP toolset - file teflonhandle.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-15\"   \n      \n       strings:   \n           $s1 = \"%s [infile] [outfile] /k 0x[%i character hex key] </g>\" fullword ascii   \n           $s2 = \"File %s already exists.  Overwrite? (y/n) \" fullword ascii   \n           $s3 = \"Random Key : 0x\" fullword ascii   \n           $s4 = \"done (%i bytes written).\" fullword ascii   \n           $s5 = \"%s --> %s...\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 20KB and 2 of them   \n   }",
			"type": "YARA",
			"id": 30285515
		},
		{
			"indicator": "5f448ac402eabfca604ccb01073f5e373e062f49",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BARPUNCH_BPICKER    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files BARPUNCH-3110, BPICKER-3100\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           super_rule = 1   \n           hash1 = \"830538fe8c981ca386c6c7d55635ac61161b23e6e25d96280ac2fc638c2d82cc\"   \n           hash2 = \"d859ce034751cac960825268a157ced7c7001d553b03aec54e6794ff66185e6f\"   \n      \n       strings:   \n           $x1 = \"--cmd %x --idkey %s --sport %i --dport %i --lp %s --implant %s --bsize %hu --logdir %s --lptimeout %u\" fullword ascii   \n           $x2 = \"%s -c <cmdtype> -l <lp> -i <implant> -k <ikey> -s <port> -d <port> [operation] [options]\" fullword ascii   \n           $x3 = \"* [%lu] 0x%x is marked as stateless (the module will be persisted without its configuration)\" fullword ascii   \n           $x4 = \"%s version %s already has persistence installed. If you want to uninstall,\" fullword ascii   \n           $x5 = \"The active module(s) on the target are not meant to be persisted\" fullword ascii   \n         \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 6000KB and 1 of them ) or ( 3 of them )   \n   }",
			"type": "YARA",
			"id": 30285516
		},
		{
			"indicator": "e80441486a077b254950c0796bbd3900f6e52439",
			"description": "",
			"title": "",
			"content": "rule EQGRP_config_jp1_UA    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file config_jp1_UA.pl\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"2f50b6e9891e4d7fd24cc467e7f5cfe348f56f6248929fec4bbee42a5001ae56\"   \n      \n       strings:   \n           $x1 = \"This program will configure a JETPLOW Userarea file.\" fullword ascii   \n           $x2 = \"Error running config_implant.\" fullword ascii   \n           $x3 = \"NOTE:  IT ASSUMES YOU ARE OPERATING IN THE INSTALL/LP/JP DIRECTORY. THIS ASSUMPTION \" fullword ascii   \n           $x4 = \"First IP address for beacon destination [127.0.0.1]\" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285517
		},
		{
			"indicator": "fc0b1d98def3b827bd80faa644d7213c0d0cce31",
			"description": "",
			"title": "",
			"content": "rule EQGRP_tinyhttp_setup    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file tinyhttp_setup.sh\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"3d12c83067a9f40f2f5558d3cf3434bbc9a4c3bb9d66d0e3c0b09b9841c766a0\"   \n          \n       strings:   \n           $x1 = \"firefox http://127.0.0.1:8000/$_name\" fullword ascii   \n           $x2 = \"What is the name of your implant:\" fullword ascii /* it's called conscience */   \n           $x3 = \"killall thttpd\" fullword ascii   \n           $x4 = \"copy http://<IP>:80/$_name flash:/$_name\" fullword ascii   \n          \n       condition:   \n           ( uint16(0) == 0x2123 and filesize < 2KB and 1 of ($x*) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30285518
		},
		{
			"indicator": "d28b6b6c6486bf8c9e9644c196f8ce4dc926fd7d",
			"description": "",
			"title": "",
			"content": "rule EQGRP_1212_dehex    \n   {   \n      \n       meta:   \n           description = \"Detects tool from EQGRP toolset - from files 1212.pl, dehex.pl\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-15\"   \n      \n       strings:   \n           $s1 = \"return \\\"ERROR:$line is not a valid address\\\";\" fullword ascii   \n           $s2 = \"print \\\"ERROR: the filename or hex representation needs to be one argument try using \\\\\\\"'s\\\\n\\\";\" fullword ascii   \n           $s3 = \"push(@octets,$byte_table{$tempi});\" fullword ascii   \n           $s4 = \"$byte_table{\\\"$chars[$sixteens]$chars[$ones]\\\"}=$i;\" fullword ascii   \n           $s5 = \"print hextoIP($ARGV[0]);\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x2123 and filesize < 6KB and ( 5 of ($s*) ) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30285519
		},
		{
			"indicator": "0ecc57d8c2b5b92a88005deda21814d8f5dadba2",
			"description": "",
			"title": "",
			"content": "rule EQGRP_MixText    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file MixText.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"e4d24e30e6cc3a0aa0032dbbd2b68c60bac216bef524eaf56296430aa05b3795\"   \n      \n       strings:   \n           $s1 = \"BinStore enabled implants.\" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285520
		},
		{
			"indicator": "ed2d2604dadd0a4ade6a765ed493135fcf013373",
			"description": "",
			"title": "",
			"content": "rule EQGRP_extrabacon    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file extrabacon_1.1.0.1.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"59d60835fe200515ece36a6e87e642ee8059a40cb04ba5f4b9cce7374a3e7735\"   \n      \n       strings:   \n           $x1 = \"To disable password checking on target:\" fullword ascii   \n           $x2 = \"[-] target is running\" fullword ascii   \n           $x3 = \"[-] problem importing version-specific shellcode from\" fullword ascii   \n           $x4 = \"[+] importing version-specific shellcode\" fullword ascii   \n           $s5 = \"[-] unsupported target version, abort\" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285521
		},
		{
			"indicator": "0073b9434016f8df82d25047e5c0df0cea36a4ee",
			"description": "",
			"title": "",
			"content": "rule EQGRP_bc_parser    \n   {   \n      \n       meta:   \n           description = \"Detects tool from EQGRP toolset - file bc-parser\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-15\"   \n           hash1 = \"879f2f1ae5d18a3a5310aeeafec22484607649644e5ecb7d8a72f0877ac19cee\"   \n      \n       strings:   \n           $s1 = \"*** Target may be susceptible to FALSEMOREL      ***\" fullword ascii   \n           $s2 = \"*** Target is susceptible to FALSEMOREL          ***\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x457f and 1 of them   \n   }",
			"type": "YARA",
			"id": 30285522
		},
		{
			"indicator": "11556cc1121fcb38a491ee60eed77293b3c59969",
			"description": "",
			"title": "",
			"content": "rule EQGRP_morel    \n   {   \n      \n       meta:   \n           description = \"Detects tool from EQGRP toolset - file morel.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-15\"   \n           hash1 = \"a9152e67f507c9a179bb8478b58e5c71c444a5a39ae3082e04820a0613cd6d9f\"   \n      \n       strings:   \n           $s1 = \"%d - %d, %d\" fullword ascii   \n           $s2 = \"%d - %lu.%lu %d.%lu\" fullword ascii   \n           $s3 = \"%d - %d %d\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 60KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30285523
		},
		{
			"indicator": "87b60e3a9d45066816cba7aa69f008bdd0c6e893",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BBALL_M50FW08_2201    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file BBALL_M50FW08-2201.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"80c0b68adb12bf3c15eff9db70a57ab999aad015da99c4417fdfd28156d8d3f7\"   \n      \n       strings:   \n           $s1 = \".got_loader\" fullword ascii   \n           $s2 = \"LOADED\" fullword ascii   \n           $s3 = \"pageTable.c\" fullword ascii   \n           $s4 = \"_start_text\" fullword ascii   \n           $s5 = \"handler_readBIOS\" fullword ascii   \n           $s6 = \"KEEPGOING\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 40KB and 5 of ($s*) )   \n   }",
			"type": "YARA",
			"id": 30285524
		},
		{
			"indicator": "f703533aacc7d602aec29258081d70590d2e70a6",
			"description": "",
			"title": "",
			"content": "rule EQGRP_payload    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file payload.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"21bed6d699b1fbde74cbcec93575c9694d5bea832cd191f59eb3e4140e5c5e07\"   \n      \n       strings:   \n           $s1 = \"can't find target version module!\" fullword ascii   \n           $s2 = \"class Payload:\" fullword ascii   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285525
		},
		{
			"indicator": "834f3fef6f702848df01055dde276dc5c0d899e1",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BpfCreator_RHEL4    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file BpfCreator-RHEL4\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"bd7303393409623cabf0fcf2127a0b81fae52fe40a0d2b8db0f9f092902bbd92\"   \n      \n       strings:   \n           $s1 = \"usage %s \\\"<tcpdump pcap string>\\\" <outfile>\" fullword ascii   \n           $s2 = \"error reading dump file: %s\" fullword ascii   \n           $s3 = \"truncated dump file; tried to read %u captured bytes, only got %lu\" fullword ascii   \n           $s4 = \"%s: link-layer type %d isn't supported in savefiles\" fullword ascii   \n           $s5 = \"DLT %d is not one of the DLTs supported by this device\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 2000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30285526
		},
		{
			"indicator": "c81d7902d368d4cca0a7d769c391942e63e01fd3",
			"description": "",
			"title": "",
			"content": "rule EQGRP_epicbanana_2_1_0_1    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file epicbanana_2.1.0.1.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"4b13cc183c3aaa8af43ef3721e254b54296c8089a0cd545ee3b867419bb66f61\"   \n      \n       strings:   \n           $s1 = \"failed to create version-specific payload\" fullword ascii   \n           $s2 = \"(are you sure you did \\\"make [version]\\\" in versions?)\" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285527
		},
		{
			"indicator": "dcf4179f6ed64edebcb36fd67aa5f6d2ac12516a",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BUSURPER_2211_724    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file BUSURPER-2211-724.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"d809d6ff23a9eee53d2132d2c13a9ac5d0cb3037c60e229373fc59a4f14bc744\"   \n      \n       strings:   \n           $s1 = \".got_loader\" fullword ascii   \n           $s2 = \"_start_text\" fullword ascii   \n           $s3 = \"IMPLANT\" fullword ascii   \n           $s4 = \"KEEPGOING\" fullword ascii   \n           $s5 = \"upgrade_implant\" fullword ascii   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285528
		},
		{
			"indicator": "28710ce48fc68474b2d25cd1fb6f9256bd714aa9",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BBALL    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file BBALL_E28F6-2201.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"498fc9f20b938b8111adfa3ca215325f265a08092eefd5300c4168876deb7bf6\"   \n      \n       strings:   \n           $s1 = \"Components/Modules/BiosModule/Implant/E28F6/../e28f640j3_asm.S\" fullword ascii   \n           $s2 = \".got_loader\" fullword ascii   \n           $s3 = \"handler_readBIOS\" fullword ascii   \n           $s4 = \"cmosReadByte\" fullword ascii   \n           $s5 = \"KEEPGOING\" fullword ascii   \n           $s6 = \"checksumAreaConfirmed.0\" fullword ascii   \n           $s7 = \"writeSpeedPlow.c\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 40KB and 4 of ($s*) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30285529
		},
		{
			"indicator": "f61a4bd36dcaa3132e48e6f5412aa4f6df64e622",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BBANJO    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file BBANJO-3011.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"f09c2f90464781a08436321f6549d350ecef3d92b4f25b95518760f5d4c9b2c3\"   \n      \n       strings:   \n           $s1 = \"get_lsl_interfaces\" fullword ascii   \n           $s2 = \"encryptFC4Payload\" fullword ascii   \n           $s3 = \".got_loader\" fullword ascii   \n           $s4 = \"beacon_getconfig\" fullword ascii   \n           $s5 = \"LOADED\" fullword ascii   \n           $s6 = \"FormBeaconPacket\" fullword ascii   \n           $s7 = \"beacon_reconfigure\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 50KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30285530
		},
		{
			"indicator": "09da18c33d8ed74b1c4f6cd34efaa8d8dbc4d768",
			"description": "",
			"title": "",
			"content": "rule EQGRP_workit    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file workit.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"fb533b4d255b4e6072a4fa2e1794e38a165f9aa66033340c2f4f8fd1da155fac\"   \n      \n       strings:   \n           $s1 = \"macdef init > /tmp/.netrc;\" fullword ascii   \n           $s2 = \"/usr/bin/wget http://\" fullword ascii   \n           $s3 = \"HOME=/tmp ftp\" fullword ascii   \n           $s4 = \" >> /tmp/.netrc;\" fullword ascii   \n           $s5 = \"/usr/rapidstream/bin/tftp\" fullword ascii   \n           $s6 = \"created shell_command:\" fullword ascii   \n           $s7 = \"rm -f /tmp/.netrc;\" fullword ascii   \n           $s8 = \"echo quit >> /tmp/.netrc;\" fullword ascii   \n           $s9 = \"echo binary >> /tmp/.netrc;\" fullword ascii   \n           $s10 = \"chmod 600 /tmp/.netrc;\" fullword ascii   \n           $s11 = \"created cli_command:\" fullword ascii   \n         \n       condition:   \n           6 of them   \n   }",
			"type": "YARA",
			"id": 30285531
		},
		{
			"indicator": "1a3097ada1870d8542f70aca7b91c2dacef8db2f",
			"description": "",
			"title": "",
			"content": "rule EQGRP_EPBA    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file EPBA.script\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"53e1af1b410ace0934c152b5df717d8a5a8f5fdd8b9eb329a44d94c39b066ff7\"   \n      \n       strings:   \n           $x1 = \"./epicbanana_2.0.0.1.py -t 127.0.0.1 --proto=ssh --username=cisco --password=cisco --target_vers=asa804 --mem=NA -p 22 \" fullword ascii   \n           $x2 = \"-t TARGET_IP, --target_ip=TARGET_IP -- Either 127.0.0.1 or Win Ops IP\" fullword ascii   \n           $x3 = \"./bride-1100 --lp 127.0.0.1 --implant 127.0.0.1 --sport RHP --dport RHP\" fullword ascii   \n           $x4 = \"--target_vers=TARGET_VERS    target Pix version (pix712, asa804) (REQUIRED)\" fullword ascii   \n           $x5 = \"-p DEST_PORT, --dest_port=DEST_PORT defaults: telnet=23, ssh=22 (optional) - Change to LOCAL redirect port\" fullword ascii   \n           $x6 = \"this operation is complete, BananaGlee will\" fullword ascii   \n           $x7 = \"cd /current/bin/FW/BGXXXX/Install/LP\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x2023 and filesize < 7KB and 1 of ($x*) ) or ( 3 of them )   \n   }",
			"type": "YARA",
			"id": 30285532
		},
		{
			"indicator": "74b4ae3af3898b57b79248ecf38746476ec8b50a",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BLIAR_BLIQUER    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files BLIAR-2110, BLIQUER-2230\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           super_rule = 1   \n           hash1 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"   \n           hash2 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"   \n      \n       strings:   \n           $x1 = \"Do you wish to activate the implant that is already on the firewall? (y/n): \" fullword ascii   \n           $x2 = \"There is no implant present on the firewall.\" fullword ascii   \n           $x3 = \"Implant Version :%lx%lx%lx\" fullword ascii   \n           $x4 = \"You may now connect to the implant using the pbd idkey\" fullword ascii   \n           $x5 = \"No reply from persistant back door.\" fullword ascii   \n           $x6 = \"rm -rf pbd.wc; wc -c %s > pbd.wc\" fullword ascii   \n           $p1 = \"PBD_GetVersion\" fullword ascii   \n           $p2 = \"pbd/pbdEncrypt.bin\" fullword ascii   \n           $p3 = \"pbd/pbdGetVersion.pkt\" fullword ascii   \n           $p4 = \"pbd/pbdStartWrite.bin\" fullword ascii   \n           $p5 = \"pbd/pbd_setNewHookPt.pkt\" fullword ascii   \n           $p6 = \"pbd/pbd_Upload_SinglePkt.pkt\" fullword ascii   \n           $s1 = \"Unable to fetch hook and jmp addresses for this OS version\" fullword ascii   \n           $s2 = \"Could not get hook and jump addresses\" fullword ascii   \n           $s3 = \"Enter the name of a clean implant binary (NOT an image):\" fullword ascii   \n           $s4 = \"Unable to read dat file for OS version 0x%08lx\" fullword ascii   \n           $s5 = \"Invalid implant file\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 3000KB and ( 1 of ($x*) or 1 of ($p*) ) ) or ( 3 of them )   \n   }",
			"type": "YARA",
			"id": 30285533
		},
		{
			"indicator": "7b3383e6f328c79a7ed9b278756813288a2231e5",
			"description": "",
			"title": "",
			"content": "rule EQGRP_eligiblebombshell_generic    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files eligiblebombshell_1.2.0.1.py, eligiblebombshell_1.2.0.1.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           super_rule = 1   \n           hash1 = \"dd0e3ae6e1039a755bf6cb28bf726b4d6ab4a1da2392ba66d114a43a55491eb1\"   \n           hash2 = \"dd0e3ae6e1039a755bf6cb28bf726b4d6ab4a1da2392ba66d114a43a55491eb1\"   \n        \n       strings:   \n           $s1 = \"logging.error(\\\"       Perhaps you should run with --scan?\\\")\" fullword ascii   \n           $s2 = \"logging.error(\\\"ERROR: No entry for ETag [%s] in %s.\\\" %\" fullword ascii   \n           $s3 = \"\\\"be supplied\\\")\" fullword ascii   \n        \n       condition:   \n           ( filesize < 70KB and 2 of ($s*) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30285534
		},
		{
			"indicator": "ae1b41261dcd8f1d636464a21eb183b5ebb44725",
			"description": "",
			"title": "",
			"content": "rule EQGRP_bo    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file bo\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"aa8b363073e8ae754b1836c30f440d7619890ded92fb5b97c73294b15d22441d\"   \n      \n       strings:   \n           $s1 = \"ERROR: failed to open %s: %d\" fullword ascii   \n           $s2 = \"__libc_start_main@@GLIBC_2.0\" fullword ascii   \n           $s3 = \"serial number: %s\" fullword ascii   \n           $s4 = \"strerror@@GLIBC_2.0\" fullword ascii   \n           $s5 = \"ERROR: mmap failed: %d\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 20KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30285535
		},
		{
			"indicator": "18ae1e571f08b3788b36c5e18c90945b48d13427",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BananaUsurper_writeJetPlow   \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, writeJetPlow-2130\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           super_rule = 1   \n           hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"   \n           hash2 = \"464b4c01f93f31500d2d770360d23bdc37e5ad4885e274a629ea86b2accb7a5c\"   \n       \n       strings:   \n           $x1 = \"Implant Version-Specific Values:\" fullword ascii   \n           $x2 = \"This function should not be used with a Netscreen, something has gone horribly wrong\" fullword ascii   \n           $s1 = \"createSendRecv: recv'd an error from the target.\" fullword ascii   \n           $s2 = \"Error: WatchDogTimeout read returned %d instead of 4\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 2000KB and 1 of ($x*) ) or ( 3 of them )   \n   }",
			"type": "YARA",
			"id": 30285536
		},
		{
			"indicator": "e9230b6e33a7d663d89165de57d5127a8c4d8740",
			"description": "",
			"title": "",
			"content": "rule EQGRP_callbacks    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - Callback addresses\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n      \n       strings:   \n           $s1 = \"30.40.50.60:9342\" fullword ascii wide /* DoD */   \n          \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285537
		},
		{
			"indicator": "375fbfc3b9445d3c90f71196512223ec71a91fc1",
			"description": "",
			"title": "",
			"content": "rule EQGRP_hexdump    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file hexdump.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"95a9a6a8de60d3215c1c9f82d2d8b2640b42f5cabdc8b50bd1f4be2ea9d7575a\"   \n      \n       strings:   \n           $s1 = \"def hexdump(x,lead=\\\"[+] \\\",out=sys.stdout):\" fullword ascii   \n           $s2 = \"print >>out, \\\"%s%04x  \\\" % (lead,i),\" fullword ascii   \n           $s3 = \"print >>out, \\\"%02X\\\" % ord(x[i+j]),\" fullword ascii   \n           $s4 = \"print >>out, sane(x[i:i+16])\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x2123 and filesize < 1KB and 2 of ($s*) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30285538
		},
		{
			"indicator": "97672043102388a86d4db5f1e449f1c33486e97c",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BPIE    \n   {   \n       meta:   \n           description = \"EQGRP Toolset Firewall - file BPIE-2201.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"697e80cf2595c85f7c931693946d295994c55da17a400f2c9674014f130b4688\"   \n      \n       strings:   \n           $s1 = \"profProcessPacket\" fullword ascii   \n           $s2 = \".got_loader\" fullword ascii   \n           $s3 = \"getTimeSlotCmdHandler\" fullword ascii   \n           $s4 = \"getIpIpCmdHandler\" fullword ascii   \n           $s5 = \"LOADED\" fullword ascii   \n           $s6 = \"profStartScan\" fullword ascii   \n           $s7 = \"tmpData.1\" fullword ascii   \n           $s8 = \"resetCmdHandler\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 70KB and 6 of ($s*) )   \n   }",
			"type": "YARA",
			"id": 30285539
		},
		{
			"indicator": "d98c43678de5f5c801f7f55ed6858c9078536078",
			"description": "",
			"title": "",
			"content": "rule EQGRP_jetplow_SH    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file jetplow.sh\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"ee266f84a1a4ccf2e789a73b0a11242223ed6eba6868875b5922aea931a2199c\"   \n      \n       strings:   \n           $s1 = \"cd /current/bin/FW/BANANAGLEE/$bgver/Install/LP/jetplow\" fullword ascii   \n           $s2 = \"***** Please place your UA in /current/bin/FW/OPS *****\" fullword ascii   \n           $s3 = \"ln -s ../jp/orig_code.bin orig_code_pixGen.bin\" fullword ascii   \n           $s4 = \"*****             Welcome to JetPlow              *****\" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285540
		},
		{
			"indicator": "5f0a4f582d8a002cceb8d8d04dc7d3d884ff1677",
			"description": "",
			"title": "",
			"content": "rule EQGRP_Implants_Gen1    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, lpexe, writeJetPlow-2130\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           super_rule = 1   \n           hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"   \n           hash2 = \"830538fe8c981ca386c6c7d55635ac61161b23e6e25d96280ac2fc638c2d82cc\"   \n           hash3 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"   \n           hash4 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"   \n           hash5 = \"8e4a76c4b50350b67cabbb2fed47d781ee52d8d21121647b0c0356498aeda2a2\"   \n           hash6 = \"6059bec5cf297266079d52dbb29ab9b9e0b35ce43f718022b5b5f760c1976ec3\"   \n           hash7 = \"d859ce034751cac960825268a157ced7c7001d553b03aec54e6794ff66185e6f\"   \n           hash8 = \"ee3e3487a9582181892e27b4078c5a3cb47bb31fc607634468cc67753f7e61d7\"   \n           hash9 = \"464b4c01f93f31500d2d770360d23bdc37e5ad4885e274a629ea86b2accb7a5c\"   \n         \n       strings:   \n           $s1 = \"WARNING:  Session may not have been closed!\" fullword ascii   \n           $s2 = \"EXEC Packet Processed\" fullword ascii   \n           $s3 = \"Failed to insert the command into command list.\" fullword ascii   \n           $s4 = \"Send_Packet: Trying to send too much data.\" fullword ascii   \n           $s5 = \"payloadLength >= MAX_ALLOW_SIZE.\" fullword ascii   \n           $s6 = \"Wrong Payload Size\" fullword ascii   \n           $s7 = \"Unknown packet received......\" fullword ascii   \n           $s8 = \"Returned eax = %08x\" fullword ascii   \n          \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 6000KB and ( 2 of ($s*) ) ) or ( 5 of them )   \n   }",
			"type": "YARA",
			"id": 30285541
		},
		{
			"indicator": "b734f2f1e7d2515203c53a2edb43c21d5f81798e",
			"description": "",
			"title": "",
			"content": "rule EQGRP_sniffer_xml2pcap    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file sniffer_xml2pcap\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"f5e5d75cfcd86e5c94b0e6f21bbac886c7e540698b1556d88a83cc58165b8e42\"   \n      \n       strings:   \n           $x1 = \"-s/--srcip <sourceIP>  Use given source IP (if sniffer doesn't collect source IP)\" fullword ascii   \n           $x2 = \"convert an XML file generated by the BLATSTING sniffer module into a pcap capture file.\" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285542
		},
		{
			"indicator": "fef93d9350ebd71a6e127ef7c338f068f1d13bd8",
			"description": "",
			"title": "",
			"content": "rule EQGRP_bc_genpkt    \n   {   \n      \n       meta:   \n           description = \"Detects tool from EQGRP toolset - file bc-genpkt\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-15\"   \n      \n       strings:   \n           $x1 = \"load auxiliary object=%s requested by file=%s\" fullword ascii   \n           $x2 = \"size of new packet, should be %d <= size <= %d bytes\" fullword ascii   \n           $x3 = \"verbosity - show lengths, packet dumps, etc\" fullword ascii   \n           $s1 = \"%s: error while loading shared libraries: %s%s%s%s%s\" fullword ascii   \n           $s2 = \"cannot dynamically load executable\" fullword ascii   \n           $s3 = \"binding file %s to %s: %s symbol `%s' [%s]\" fullword ascii   \n           $s4 = \"randomize the initiator cookie\" fullword ascii   \n          \n       condition:   \n           uint16(0) == 0x457f and filesize < 1000KB and ( 1 of ($s*) and 3 of them )   \n   }",
			"type": "YARA",
			"id": 30285543
		},
		{
			"indicator": "f1912921c836a8d2342ec682ffc6d2a3bd5af9fe",
			"description": "",
			"title": "",
			"content": "rule EQGRP_RC5_RC6_Opcode   \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - RC5 / RC6 opcode\"   \n           author = \"Florian Roth\"   \n           reference = \"https://securelist.com/blog/incidents/75812/the-equation-giveaway/\"   \n           date = \"2016-08-17\"   \n      \n       strings:   \n           /*   \n               mov     esi, [ecx+edx*4-4]   \n               sub     esi, 61C88647h   \n               mov     [ecx+edx*4], esi   \n               inc     edx   \n               cmp     edx, 2Bh   \n           */   \n           $s1 = { 8B 74 91 FC 81 EE 47 86 C8 61 89 34 91 42 83 FA 2B }   \n          \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285544
		},
		{
			"indicator": "45ba28f82c816ab40f407bd7b235f2da711ec224",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BICECREAM    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file BICECREAM-2140\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"4842076af9ba49e6dfae21cf39847b4172c06a0bd3d2f1ca6f30622e14b77210\"   \n      \n       strings:   \n           $s1 = \"Could not connect to target device: %s:%d. Please check IP address.\" fullword ascii   \n           $s2 = \"command data size is invalid for an exec cmd\" fullword ascii   \n           $s3 = \"A script was specified but target is not a PPC405-based NetScreen (NS5XT, NS25, and NS50). Executing scripts is supported but ma\" ascii   \n           $s4 = \"Execute 0x%08x with args (%08x, %08x, %08x, %08x): [y/n]\" fullword ascii   \n           $s5 = \"Execute 0x%08x with args (%08x, %08x, %08x): [y/n]\" fullword ascii   \n           $s6 = \"[%d] Execute code.\" fullword ascii   \n           $s7 = \"Execute 0x%08x with args (%08x): [y/n]\" fullword ascii   \n           $s8 = \"dump_value_LHASH_DOALL_ARG\" fullword ascii   \n           $s9 = \"Eggcode is complete. Pass execution to it? [y/n]\" fullword ascii   \n          \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 5000KB and 2 of them ) or ( 5 of them )   \n   }",
			"type": "YARA",
			"id": 30285545
		},
		{
			"indicator": "f3b2ddf68e4c1c6a1416413199f3846102248e92",
			"description": "",
			"title": "",
			"content": "rule EQGRP_ssh_telnet_29    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files ssh.py, telnet.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           super_rule = 1   \n           hash1 = \"630d464b1d08c4dfd0bd50552bee2d6a591fb0b5597ecebaa556a3c3d4e0aa4e\"   \n           hash2 = \"07f4c60505f4d5fb5c4a76a8c899d9b63291444a3980d94c06e1d5889ae85482\"   \n          \n       strings:   \n           $s1 = \"received prompt, we're in\" fullword ascii   \n           $s2 = \"failed to login, bad creds, abort\" fullword ascii   \n           $s3 = \"sending command \\\" + str(n) + \\\"/\\\" + str(tot) + \\\", len \\\" + str(len(chunk) + \" fullword ascii   \n           $s4 = \"received nat - EPBA: ok, payload: mangled, did not run\" fullword ascii   \n           $s5 = \"no status returned from target, could be an exploit failure, or this is a version where we don't expect a stus return\" ascii   \n           $s6 = \"received arp - EPBA: ok, payload: fail\" fullword ascii   \n           $s7 = \"chopped = string.rstrip(payload, \\\"\\\\x0a\\\")\" fullword ascii   \n         \n       condition:   \n           ( filesize < 10KB and 2 of them ) or ( 3 of them )   \n   }",
			"type": "YARA",
			"id": 30285546
		},
		{
			"indicator": "62e79e07d8afdaaaed10a6a5bbda76444e050ff7",
			"description": "",
			"title": "",
			"content": "rule EQGRP_Implants_Gen3    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           super_rule = 1   \n           hash1 = \"830538fe8c981ca386c6c7d55635ac61161b23e6e25d96280ac2fc638c2d82cc\"   \n           hash2 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"   \n           hash3 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"   \n           hash4 = \"8e4a76c4b50350b67cabbb2fed47d781ee52d8d21121647b0c0356498aeda2a2\"   \n           hash5 = \"6059bec5cf297266079d52dbb29ab9b9e0b35ce43f718022b5b5f760c1976ec3\"   \n           hash6 = \"d859ce034751cac960825268a157ced7c7001d553b03aec54e6794ff66185e6f\"   \n      \n       strings:   \n           $x1 = \"incomplete and must be removed manually.)\" fullword ascii   \n           $s1 = \"%s: recv'd an error from the target.\" fullword ascii   \n           $s2 = \"Unable to fetch the address to the get_uptime_secs function for this OS version\" fullword ascii   \n           $s3 = \"upload/activate/de-activate/remove/cmd function failed\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 6000KB and 2 of them ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30285547
		},
		{
			"indicator": "80760dd2c9ddc5708e4a873859303e2c06411a04",
			"description": "",
			"title": "",
			"content": "rule EQGRP_StoreFc    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file StoreFc.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"f155cce4eecff8598243a721389046ae2b6ca8ba6cb7b4ac00fd724601a56108\"   \n      \n       strings:   \n           $x1 = \"Usage: StoreFc.py --configFile=<path to xml file> --implantFile=<path to BinStore implant> [--outputFile=<file to write the conf\" ascii   \n           $x2 = \"raise Exception, \\\"Must supply both a config file and implant file.\\\"\" fullword ascii   \n           $x3 = \"This is wrapper for Store.py that FELONYCROWBAR will use. This\" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285548
		},
		{
			"indicator": "7f53644c6ae1c6576a0e0cbf47e6972d04c26582",
			"description": "",
			"title": "",
			"content": "rule EQGRP_eligiblecandidate    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file eligiblecandidate.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"c4567c00734dedf1c875ecbbd56c1561a1610bedb4621d9c8899acec57353d86\"   \n      \n       strings:   \n           $o1 = \"Connection timed out. Only a problem if the callback was not received.\" fullword ascii   \n           $o2 = \"Could not reliably detect cookie. Using 'session_id'...\" fullword ascii   \n           $c1 = \"def build_exploit_payload(self,cmd=\\\"/tmp/httpd\\\"):\" fullword ascii   \n           $c2 = \"self.build_exploit_payload(cmd)\" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285549
		},
		{
			"indicator": "7c22e401ea404a358332444ffbb48b695cdf5806",
			"description": "",
			"title": "",
			"content": "rule EQGRP_shellcode    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file shellcode.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"ac9decb971dd44127a6ca0d35ac153951f0735bb4df422733046098eca8f8b7f\"   \n      \n       strings:   \n           $s1 = \"execute_post = '\\\\xe8\\\\x00\\\\x00\\\\x00\\\\x00\\\\x5d\\\\xbe\\\\xef\\\\xbe\\\\xad\\\\xde\\\\x89\\\\xf7\\\\x89\\\\xec\\\\x29\\\\xf4\\\\xb8\\\\x03\\\\x00\\\\x00\\\\x00\" ascii   \n           $s2 = \"tiny_exec = '\\\\x7f\\\\x45\\\\x4c\\\\x46\\\\x01\\\\x01\\\\x01\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x02\\\\x00\\\\x03\\\\x00\\\\x01\\\\x00\\\\x00\" ascii   \n           $s3 = \"auth_id = '\\\\x31\\\\xc0\\\\xb0\\\\x03\\\\x31\\\\xdb\\\\x89\\\\xe1\\\\x31\\\\xd2\\\\xb6\\\\xf0\\\\xb2\\\\x0d\\\\xcd\\\\x80\\\\x3d\\\\xff\\\\xff\\\\xff\\\\xff\\\\x75\\\\x07\" ascii   \n      \n           $c1 = { e8 00 00 00 00 5d be ef be ad de 89 f7 89 ec 29 f4 b8 03 00 00 00 }   \n           /* $c2 = { 7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 02 00 03 00 01 00 00 }  too many fps */   \n           $c3 = { 31 c0 b0 03 31 db 89 e1 31 d2 b6 f0 b2 0d cd 80 3d ff ff ff ff 75 07 }   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285550
		},
		{
			"indicator": "19107973c237881c9ad5108794e98d40f6065d5e",
			"description": "",
			"title": "",
			"content": "rule EQGRP_Unique_Strings    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - Unique strings\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n      \n       strings:   \n           $s1 = \"/BananaGlee/ELIGIBLEBOMB\" ascii   \n           $s2 = \"Protocol must be either http or https (Ex: https://1.2.3.4:1234)\"   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285551
		},
		{
			"indicator": "1a795b6917b39a9c605f5b0bf73384e3c2ceae0c",
			"description": "",
			"title": "",
			"content": "rule EQGRP_Extrabacon_Output    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - Extrabacon exploit output\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n      \n       strings:   \n           $s1 = \"|###[ SNMPresponse ]###\" fullword ascii   \n           $s2 = \"[+] generating exploit for exec mode pass-disable\" fullword ascii   \n           $s3 = \"[+] building payload for mode pass-disable\" fullword ascii   \n           $s4 = \"[+] Executing:  extrabacon\" fullword ascii   \n           $s5 = \"appended AAAADMINAUTH_ENABLE payload\" fullword ascii   \n         \n       condition:   \n           2 of them   \n   }",
			"type": "YARA",
			"id": 30285552
		},
		{
			"indicator": "4cb7e8c70517e1d79c98af49979981ef4a71f354",
			"description": "",
			"title": "",
			"content": "rule EQGRP_tinyexec    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files tinyexec\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n      \n       strings:   \n           $s1 = { 73 68 73 74 72 74 61 62 00 2E 74 65 78 74 }   \n           $s2 = { 5A 58 55 52 89 E2 55 50 89 E1 }   \n      \n       condition:   \n           uint32(0) == 0x464c457f and filesize < 270 and all of them   \n   }",
			"type": "YARA",
			"id": 30285553
		},
		{
			"indicator": "251a3ff6f8f0f0a564769e3310157396532ed7f8",
			"description": "",
			"title": "",
			"content": "rule EQGRP_pandarock    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files pandarock_v1.11.1.1.bin, pit\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           super_rule = 1   \n           hash1 = \"1214e282ac7258e616ebd76f912d4b2455d1b415b7216823caa3fc0d09045a5f\"   \n           hash2 = \"c8a151df7605cb48feb8be2ab43ec965b561d2b6e2a837d645fdf6a6191ab5fe\"   \n        \n       strings:   \n           $x1 = \"* Not attempting to execute \\\"%s\\\" command\" fullword ascii   \n           $x2 = \"TERMINATING SCRIPT (command error or \\\"quit\\\" encountered)\" fullword ascii   \n           $x3 = \"execute code in <file> passing <argX> (HEX)\" fullword ascii   \n           $x4 = \"* Use arrow keys to scroll through command history\" fullword ascii   \n           $s1 = \"pitCmd_processCmdLine\" fullword ascii   \n           $s2 = \"execute all commands in <file>\" fullword ascii   \n           $s3 = \"__processShellCmd\" fullword ascii   \n           $s4 = \"pitTarget_getDstPort\" fullword ascii   \n           $s5 = \"__processSetTargetIp\" fullword ascii   \n           $o1 = \"Logging commands and output - ON\" fullword ascii   \n           $o2 = \"This command is too dangerous.  If you'd like to run it, contact the development team\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 3000KB and 1 of ($x*) ) or ( 4 of them ) or 1 of ($o*)   \n   }",
			"type": "YARA",
			"id": 30285554
		},
		{
			"indicator": "00a666e047c001fb69f9f4a7808080759dfaabd4",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BananaAid    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file BananaAid\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"7a4fb825e63dc612de81bc83313acf5eccaa7285afc05941ac1fef199279519f\"   \n      \n       strings:   \n           $x1 = \"(might have to delete key in ~/.ssh/known_hosts on linux box)\" fullword ascii   \n           $x2 = \"scp BGLEE-\" ascii   \n           $x3 = \"should be 4bfe94b1 for clean bootloader version 3.0; \" fullword ascii   \n           $x4 = \"scp <configured implant> <username>@<IPaddr>:onfig\" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285555
		},
		{
			"indicator": "7d4aa5be577a09ea4d0af1278734c1dd9afd475b",
			"description": "",
			"title": "",
			"content": "rule EQGRP_Implants_Gen6    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, writeJetPlow-2130\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           super_rule = 1   \n           hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"   \n           hash2 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"   \n           hash3 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"   \n           hash4 = \"8e4a76c4b50350b67cabbb2fed47d781ee52d8d21121647b0c0356498aeda2a2\"   \n           hash5 = \"6059bec5cf297266079d52dbb29ab9b9e0b35ce43f718022b5b5f760c1976ec3\"   \n           hash6 = \"d859ce034751cac960825268a157ced7c7001d553b03aec54e6794ff66185e6f\"   \n           hash7 = \"464b4c01f93f31500d2d770360d23bdc37e5ad4885e274a629ea86b2accb7a5c\"   \n      \n       strings:   \n           $s1 = \"LP.c:pixSecurity - Improper number of bytes read in Security/Interface Information\" fullword ascii   \n           $s2 = \"LP.c:pixSecurity - Not in Session\" fullword ascii   \n           $s3 = \"getModInterface__preloadedModules\" fullword ascii   \n           $s4 = \"showCommands\" fullword ascii   \n           $s5 = \"readModuleInterface\" fullword ascii   \n           $s6 = \"Wrapping_Not_Necessary_Or_Wrapping_Ok\" fullword ascii   \n           $s7 = \"Get_CMD_List\" fullword ascii   \n           $s8 = \"LP_Listen2\" fullword ascii   \n           $s9 = \"killCmdList\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 6000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30285556
		},
		{
			"indicator": "42744a9f5f2b7890bdadd53b0fc445910920772d",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BUSURPER_3001_724    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file BUSURPER-3001-724.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"6b558a6b8bf3735a869365256f9f2ad2ed75ccaa0eefdc61d6274df4705e978b\"   \n      \n       strings:   \n           $s1 = \"IMPLANT\" fullword ascii   \n           $s2 = \"KEEPGOING\" fullword ascii   \n           $s3 = \"upgrade_implant\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 200KB and 2 of them ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30285557
		},
		{
			"indicator": "ec8593aac6bb1793a76578acc513813e48f0b4f2",
			"description": "",
			"title": "",
			"content": "rule EQGRP_userscript    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file userscript.FW\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"5098ff110d1af56115e2c32f332ff6e3973fb7ceccbd317637c9a72a3baa43d7\"   \n      \n       strings:   \n           $x1 = \"Are you sure? Don't forget that NETSCREEN firewalls require BANANALIAR!! \" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285558
		},
		{
			"indicator": "c9b533919b553ce2140410e56d857e5d8a7cba89",
			"description": "",
			"title": "",
			"content": "rule EQGRP_tunnel_state_reader    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file tunnel_state_reader\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"49d48ca1ec741f462fde80da68b64dfa5090855647520d29e345ef563113616c\"   \n      \n       strings:   \n           $s1 = \"Active connections will be maintained for this tunnel. Timeout:\" fullword ascii   \n           $s5 = \"%s: compatible with BLATSTING version 1.2\" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285559
		},
		{
			"indicator": "6c04b9825c4f6adacb63ffe888da5a1cd449e887",
			"description": "",
			"title": "",
			"content": "rule EQGRP_teflondoor    \n   {   \n      \n       meta:   \n           description = \"Detects tool from EQGRP toolset - file teflondoor.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-15\"   \n      \n       strings:   \n           $x1 = \"%s: abort.  Code is %d.  Message is '%s'\" fullword ascii   \n           $x2 = \"%s: %li b (%li%%)\" fullword ascii   \n           $s1 = \"no winsock\" fullword ascii   \n           $s2 = \"%s: %s file '%s'\" fullword ascii   \n           $s3 = \"peer: connect\" fullword ascii   \n           $s4 = \"read: write\" fullword ascii   \n           $s5 = \"%s: done!\" fullword ascii   \n           $s6 = \"%s: %li b\" fullword ascii   \n          \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 30KB and 1 of ($x*) and 3 of them   \n   }",
			"type": "YARA",
			"id": 30285560
		},
		{
			"indicator": "48d8e6d80427e42c42c108b708c5c2afb9aff42d",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BFLEA_2201    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file BFLEA-2201.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"15e8c743770e44314496c5f27b6297c5d7a4af09404c4aa507757e0cc8edc79e\"   \n      \n       strings:   \n           $s1 = \".got_loader\" fullword ascii   \n           $s2 = \"LOADED\" fullword ascii   \n           $s3 = \"readFlashHandler\" fullword ascii   \n           $s4 = \"KEEPGOING\" fullword ascii   \n           $s5 = \"flashRtnsPix6x.c\" fullword ascii   \n           $s6 = \"fix_ip_cksum_incr\" fullword ascii   \n           $s7 = \"writeFlashHandler\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 30KB and 5 of them ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30285561
		},
		{
			"indicator": "7b42a6fbf2802f8c9565cc357d1dd1bc4607d081",
			"description": "",
			"title": "",
			"content": "rule EQGRP_sploit_py    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file sploit.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"0316d70a5bbf068a7fc791e08e816015d04ec98f088a7ff42af8b9e769b8d1f6\"   \n      \n       strings:   \n           $x1 = \"the --spoof option requires 3 or 4 fields as follows redir_ip\" ascii   \n           $x2 = \"[-] timeout waiting for response - target may have crashed\" fullword ascii   \n           $x3 = \"[-] no response from health check - target may have crashed\" fullword ascii   \n          \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285562
		},
		{
			"indicator": "4397bfaa530c3856239433023df0bacfd1b62dde",
			"description": "",
			"title": "",
			"content": "rule EQGRP_BPATROL_2201    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file BPATROL-2201.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"aa892750b893033eed2fedb2f4d872f79421174eb217f0c34a933c424ae66395\"   \n      \n       strings:   \n           $s1 = \"dumpConfig\" fullword ascii   \n           $s2 = \"getstatusHandler\" fullword ascii   \n           $s3 = \".got_loader\" fullword ascii   \n           $s4 = \"xtractdata\" fullword ascii   \n           $s5 = \"KEEPGOING\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 40KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30285563
		},
		{
			"indicator": "a0566e65beadc89453ba6dd860d8f35cd6d4d08b",
			"description": "",
			"title": "",
			"content": "rule EQGRP_create_dns_injection   \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file create_dns_injection.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"488f3cc21db0688d09e13eb85a197a1d37902612c3e302132c84e07bc42b1c32\"   \n      \n       strings:   \n           $s1 = \"Name:   A hostname: 'host.network.com', a decimal numeric offset within\" fullword ascii   \n           $s2 = \"-a www.badguy.net,CNAME,1800,host.badguy.net \\\\\\\\\" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285564
		},
		{
			"indicator": "8841d8292c48397afc3d7112fe17ec8610e0e7eb",
			"description": "",
			"title": "",
			"content": "rule EQGRP_screamingplow    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file screamingplow.sh\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"c7f4104c4607a03a1d27c832e1ebfc6ab252a27a1709015b5f1617b534f0090a\"   \n      \n       strings:   \n           $s1 = \"What is the name of your PBD:\" fullword ascii   \n           $s2 = \"You are now ready for a ScreamPlow\" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285565
		},
		{
			"indicator": "67e411b2b1da4c8917c20f9feb14831afc4b3748",
			"description": "",
			"title": "",
			"content": "rule EQGRP_Implants_Gen4    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           super_rule = 1   \n           hash1 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"   \n           hash2 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"   \n           hash3 = \"8e4a76c4b50350b67cabbb2fed47d781ee52d8d21121647b0c0356498aeda2a2\"   \n           hash4 = \"6059bec5cf297266079d52dbb29ab9b9e0b35ce43f718022b5b5f760c1976ec3\"   \n      \n       strings:   \n           $s1 = \"Command has not yet been coded\" fullword ascii   \n           $s2 = \"Beacon Domain  : www.%s.com\" fullword ascii   \n           $s3 = \"This command can only be run on a PIX/ASA\" fullword ascii   \n           $s4 = \"Warning! Bad or missing Flash values (in section 2 of .dat file)\" fullword ascii   \n           $s5 = \"Printing the interface info and security levels. PIX ONLY.\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 3000KB and 3 of them ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30285566
		},
		{
			"indicator": "ceca032a35b0249e5ab730fc89bf957644ccf98c",
			"description": "",
			"title": "",
			"content": "rule EQGRP_dn_1_0_2_1    \n   {   \n      \n       meta:   \n           description = \"Detects tool from EQGRP toolset - file dn.1.0.2.1.linux\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-15\"   \n      \n       strings:   \n           $s1 = \"Valid commands are: SMAC, DMAC, INT, PACK, DONE, GO\" fullword ascii   \n           $s2 = \"invalid format suggest DMAC=00:00:00:00:00:00\" fullword ascii   \n           $s3 = \"SMAC=%02x:%02x:%02x:%02x:%02x:%02x\" fullword ascii   \n           $s4 = \"Not everything is set yet\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 30KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30285567
		},
		{
			"indicator": "a3a7ceb8c01217346a83cc3f746cfc3e191a6a06",
			"description": "",
			"title": "",
			"content": "rule EQGRP_networkProfiler_orderScans    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file networkProfiler_orderScans.sh\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"ea986ddee09352f342ac160e805312e3a901e58d2beddf79cd421443ba8c9898\"   \n      \n       strings:   \n           $x1 = \"Unable to save off predefinedScans directory\" fullword ascii   \n           $x2 = \"Re-orders the networkProfiler scans so they show up in order in the LP\" fullword ascii   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30285568
		},
		{
			"indicator": "54dd15dfa46394921e89110300168c89b2c595dc",
			"description": "",
			"title": "",
			"content": "rule EQGRP_uninstallPBD    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - file uninstallPBD.bat\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           hash1 = \"692fdb449f10057a114cf2963000f52ce118d9a40682194838006c66af159bd0\"   \n      \n       strings:   \n           $s1 = \"memset 00e9a05c 4 38845b88\" fullword ascii   \n           $s2 = \"_hidecmd\" fullword ascii   \n           $s3 = \"memset 013abd04 1 0d\" fullword ascii   \n          \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285569
		},
		{
			"indicator": "29825e3bddb6e65ae47a5754677be02f6d3dc10e",
			"description": "",
			"title": "",
			"content": "rule EQGRP_Implants_Gen5    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, writeJetPlow-2130\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           super_rule = 1   \n           hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"   \n           hash2 = \"830538fe8c981ca386c6c7d55635ac61161b23e6e25d96280ac2fc638c2d82cc\"   \n           hash3 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"   \n           hash4 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"   \n           hash5 = \"8e4a76c4b50350b67cabbb2fed47d781ee52d8d21121647b0c0356498aeda2a2\"   \n           hash6 = \"6059bec5cf297266079d52dbb29ab9b9e0b35ce43f718022b5b5f760c1976ec3\"   \n           hash7 = \"d859ce034751cac960825268a157ced7c7001d553b03aec54e6794ff66185e6f\"   \n           hash8 = \"464b4c01f93f31500d2d770360d23bdc37e5ad4885e274a629ea86b2accb7a5c\"   \n         \n       strings:   \n           $x1 = \"Module and Implant versions do not match.  This module is not compatible with the target implant\" fullword ascii   \n           $s1 = \"%s/BF_READ_%08x_%04d%02d%02d_%02d%02d%02d.log\" fullword ascii   \n           $s2 = \"%s/BF_%04d%02d%02d.log\" fullword ascii   \n           $s3 = \"%s/BF_READ_%08x_%04d%02d%02d_%02d%02d%02d.bin\" fullword ascii   \n          \n       condition:   \n           ( uint16(0) == 0x457f and 1 of ($x*) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30285570
		},
		{
			"indicator": "0a88444f25182047fa8a3735d639256b65891c2b",
			"description": "",
			"title": "",
			"content": "rule EQGRP_Implants_Gen2    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, writeJetPlow-2130\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           super_rule = 1   \n           hash1 = \"3366b4bbf265716869a487203a8ac39867920880990493dd4dd8385e42b0c119\"   \n           hash2 = \"05031898f3d52a5e05de119868c0ec7caad3c9f3e9780e12f6f28b02941895a4\"   \n           hash3 = \"d9756e3ba272cd4502d88f4520747e9e69d241dee6561f30423840123c1a7939\"   \n           hash4 = \"8e4a76c4b50350b67cabbb2fed47d781ee52d8d21121647b0c0356498aeda2a2\"   \n           hash5 = \"6059bec5cf297266079d52dbb29ab9b9e0b35ce43f718022b5b5f760c1976ec3\"   \n           hash6 = \"464b4c01f93f31500d2d770360d23bdc37e5ad4885e274a629ea86b2accb7a5c\"   \n          \n       strings:   \n           $x1 = \"Modules persistence file written successfully\" fullword ascii   \n           $x2 = \"Modules persistence data successfully removed\" fullword ascii   \n           $x3 = \"No Modules are active on the firewall, nothing to persist\" fullword ascii   \n           $s1 = \"--cmd %x --idkey %s --sport %i --dport %i --lp %s --implant %s --bsize %hu --logdir %s \" fullword ascii   \n           $s2 = \"Error while attemping to persist modules:\" fullword ascii   \n           $s3 = \"Error while reading interface info from PIX\" fullword ascii   \n           $s4 = \"LP.c:pixFree - Failed to get response\" fullword ascii   \n           $s5 = \"WARNING: LP Timeout specified (%lu seconds) less than default (%u seconds).  Setting default\" fullword ascii   \n           $s6 = \"Unable to fetch config address for this OS version\" fullword ascii   \n           $s7 = \"LP.c: interface information not available for this session\" fullword ascii   \n           $s8 = \"[%s:%s:%d] ERROR: \" fullword ascii   \n           $s9 = \"extract_fgbg\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 3000KB and 1 of ($x*) ) or ( 5 of them )   \n   }",
			"type": "YARA",
			"id": 30285571
		},
		{
			"indicator": "0532278cf15e2c911f9bbbac147b419670749467",
			"description": "",
			"title": "",
			"content": "rule EQGRP_sploit    \n   {   \n      \n       meta:   \n           description = \"EQGRP Toolset Firewall - from files sploit.py, sploit.py\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-16\"   \n           super_rule = 1   \n           hash1 = \"0316d70a5bbf068a7fc791e08e816015d04ec98f088a7ff42af8b9e769b8d1f6\"   \n           hash2 = \"0316d70a5bbf068a7fc791e08e816015d04ec98f088a7ff42af8b9e769b8d1f6\"   \n      \n       strings:   \n           $s1 = \"print \\\"[+] Connecting to %s:%s\\\" % (self.params.dst['ip'], self.params.dst['port'])\" fullword ascii   \n           $s2 = \"@overridable(\\\"Must be overriden if the target will be touched.  Base implementation should not be called.\\\")\" fullword ascii   \n           $s3 = \"@overridable(\\\"Must be overriden.  Base implementation should not be called.\\\")\" fullword ascii   \n           $s4 = \"exp.load_vinfo()\" fullword ascii   \n           $s5 = \"if not okay and self.terminateFlingOnException:\" fullword ascii   \n           $s6 = \"print \\\"[-] keyboard interrupt before response received\\\"\" fullword ascii   \n           $s7 = \"if self.terminateFlingOnException:\" fullword ascii   \n           $s8 = \"print 'Debug info ','='*40\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x2123 and filesize < 90KB and 1 of ($s*) ) or ( 4 of them )   \n   }",
			"type": "YARA",
			"id": 30285572
		},
		{
			"indicator": "b3115b8e6a56dfa04eacd4dd3edfcd9c835a5dfb",
			"description": "",
			"title": "",
			"content": "rule EQGRP_durablenapkin_solaris_2_0_1    \n   {   \n      \n       meta:   \n           description = \"Detects tool from EQGRP toolset - file durablenapkin.solaris.2.0.1.1\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-15\"   \n      \n       strings:   \n           $s1 = \"recv_ack: %s: Service not supplied by provider\" fullword ascii   \n           $s2 = \"send_request: putmsg \\\"%s\\\": %s\" fullword ascii   \n           $s3 = \"port undefined\" fullword ascii   \n           $s4 = \"recv_ack: %s getmsg: %s\" fullword ascii   \n           $s5 = \">> %d -- %d\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 40KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30285573
		},
		{
			"indicator": "1f796c47c663ab99d492c96ac7b92d18524baf16",
			"description": "",
			"title": "",
			"content": "rule EQGRP_installdate    \n   {   \n      \n       meta:   \n           description = \"Detects tool from EQGRP toolset - file installdate.pl\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-15\"   \n      \n       strings:   \n           $x1 = \"#Provide hex or EP log as command-line argument or as input\" fullword ascii   \n           $x2 = \"print \\\"Gimme hex: \\\";\" fullword ascii   \n           $x3 = \"if ($line =~ /Reg_Dword:  (\\\\d\\\\d:\\\\d\\\\d:\\\\d\\\\d.\\\\d+ \\\\d+ - )?(\\\\S*)/) {\" fullword ascii   \n           $s1 = \"if ($_ =~ /InstallDate/) {\" fullword ascii   \n           $s2 = \"if (not($cmdInput)) {\" fullword ascii   \n           $s3 = \"print \\\"$hex in decimal=$dec\\\\n\\\\n\\\";\" fullword ascii   \n      \n       condition:   \n           filesize < 2KB and ( 1 of ($x*) or 3 of them )   \n   }",
			"type": "YARA",
			"id": 30285574
		},
		{
			"indicator": "a6abbf8ce15d538a0e5596fbad0811979c97acd3",
			"description": "",
			"title": "",
			"content": "rule EQGRP_1212    \n   {   \n      \n       meta:   \n           description = \"Detects tool from EQGRP toolset - file 1212.pl\"   \n           author = \"Florian Roth\"   \n           reference = \"Research\"   \n           date = \"2016-08-15\"   \n      \n       strings:   \n           $s1 = \"if (!(($srcip,$dstip,$srcport,$dstport) = ($line=~/^([a-f0-9]{8})([a-f0-9]{8})([a-f0-9]{4})([a-f0-9]{4})$/)))\" fullword ascii   \n           $s2 = \"$ans=\\\"$srcip:$srcport -> $dstip:$dstport\\\";\" fullword ascii   \n           $s3 = \"return \\\"ERROR:$line is not a valid port\\\";\" fullword ascii   \n           $s4 = \"$dstport=hextoPort($dstport);\" fullword ascii   \n           $s5 = \"sub hextoPort\" fullword ascii   \n           $s6 = \"$byte_table{\\\"$chars[$sixteens]$chars[$ones]\\\"}=$i;\" fullword ascii   \n      \n       condition:   \n           filesize < 6KB and 4 of them   \n   }",
			"type": "YARA",
			"id": 30285575
		},
		{
			"indicator": "76f22bb4698a6be489c82fb6c40b2ee87f482161",
			"description": "",
			"title": "",
			"content": "rule Emissary_APT_Malware_1    \n   {   \n      \n       meta:   \n           description = \"Detect Emissary Malware - from samples A08E81B411.DAT, ishelp.dll\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/V0epcf\"   \n           date = \"2016-01-02\"   \n           score = 75   \n           hash1 = \"9420017390c598ee535c24f7bcbd39f40eca699d6c94dc35bcf59ddf918c59ab\"   \n           hash2 = \"70561f58c9e5868f44169854bcc906001947d98d15e9b4d2fbabd1262d938629\"   \n           hash3 = \"0e64e68f6f88b25530699a1cd12f6f2790ea98e6e8fa3b4bc279f8e5c09d7290\"   \n           hash4 = \"69caa2a4070559d4cafdf79020c4356c721088eb22398a8740dea8d21ae6e664\"   \n           hash5 = \"675869fac21a94c8f470765bc6dd15b17cc4492dd639b878f241a45b2c3890fc\"   \n           hash6 = \"e817610b62ccd00bdfc9129f947ac7d078d97525e9628a3aa61027396dba419b\"   \n           hash7 = \"a8b0d084949c4f289beb4950f801bf99588d1b05f68587b245a31e8e82f7a1b8\"   \n           hash8 = \"acf7dc5a10b00f0aac102ecd9d87cd94f08a37b2726cb1e16948875751d04cc9\"   \n           hash9 = \"e21b47dfa9e250f49a3ab327b7444902e545bed3c4dcfa5e2e990af20593af6d\"   \n           hash10 = \"e369417a7623d73346f6dff729e68f7e057f7f6dae7bb03d56a7510cb3bfe538\"   \n           hash11 = \"29d8dc863427c8e37b75eb738069c2172e79607acc7b65de6f8086ba36abf051\"   \n           hash12 = \"98fb1d2975babc18624e3922406545458642e01360746870deee397df93f50e0\"   \n           hash13 = \"fbcb401cf06326ab4bb53fb9f01f1ca647f16f926811ea66984f1a1b8cf2f7bb\"   \n      \n       strings:   \n           $s1 = \"cmd.exe /c %s > %s\" fullword ascii   \n           $s2 = \"execute cmd timeout.\" fullword ascii   \n           $s3 = \"rundll32.exe \\\"%s\\\",Setting\" fullword ascii   \n           $s4 = \"DownloadFile - exception:%s.\" fullword ascii   \n           $s5 = \"CDllApp::InitInstance() - Evnet create successful.\" fullword ascii   \n           $s6 = \"UploadFile - EncryptBuffer Error\" fullword ascii   \n           $s7 = \"WinDLL.dll\" fullword wide   \n           $s8 = \"DownloadFile - exception:%s,code:0x%08x.\" fullword ascii   \n           $s9 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\" fullword ascii   \n           $s10 = \"CDllApp::InitInstance() - Evnet already exists.\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 250KB and 3 of them   \n   }",
			"type": "YARA",
			"id": 30285864
		},
		{
			"indicator": "ceacf7e1f27f331f2a759605ffaf013585c4446e",
			"description": "",
			"title": "",
			"content": "rule Equation_Kaspersky_EquationDrugInstaller   \n   {   \n      \n       meta:   \n           description = \"Equation Group Malware - EquationDrug installer LUTEUSOBSTOS\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/ivt8EW\"   \n           date = \"2015/02/16\"   \n           hash = \"61fab1b8451275c7fd580895d9c68e152ff46417\"   \n      \n       strings:   \n           $mz = { 4d 5a }   \n      \n           $s0 = \"\\\\system32\\\\win32k.sys\" fullword wide   \n           $s1 = \"ALL_FIREWALLS\" fullword ascii   \n           $x1 = \"@prkMtx\" fullword wide   \n           $x2 = \"STATIC\" fullword wide   \n           $x3 = \"windir\" fullword wide   \n           $x4 = \"cnFormVoidFBC\" fullword wide   \n           $x5 = \"CcnFormSyncExFBC\" fullword wide   \n           $x6 = \"WinStaObj\" fullword wide   \n           $x7 = \"BINRES\" fullword wide   \n      \n       condition:   \n           ( $mz at 0 ) and filesize < 500000 and all of ($s*) and 5 of ($x*)   \n   }",
			"type": "YARA",
			"id": 30285878
		},
		{
			"indicator": "350fd19410302129b1ae078456579ef948601dd1",
			"description": "",
			"title": "",
			"content": "rule Equation_Kaspersky_EOP_Package    \n   {   \n      \n       meta:   \n           description = \"Equation Group Malware - EoP package and malware launcher\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/ivt8EW\"   \n           date = \"2015/02/16\"   \n           hash = \"2bd1b1f5b4384ce802d5d32d8c8fd3d1dc04b962\"   \n      \n       strings:   \n           $mz = { 4d 5a }   \n           $s0 = \"abababababab\" fullword ascii   \n           $s1 = \"abcdefghijklmnopq\" fullword ascii   \n           $s2 = \"@STATIC\" fullword wide   \n           $s3 = \"$aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\" fullword ascii   \n           $s4 = \"@prkMtx\" fullword wide   \n           $s5 = \"prkMtx\" fullword wide   \n           $s6 = \"cnFormVoidFBC\" fullword wide   \n      \n       condition:   \n           ( $mz at 0 ) and filesize < 100000 and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 30285879
		},
		{
			"indicator": "d61350e166957687c182582ca30cc61dcf1e5fe3",
			"description": "",
			"title": "",
			"content": "rule EquationDrug_FileSystem_Filter    \n   {   \n      \n       meta:   \n           description = \"EquationDrug - Filesystem filter driver  volrec.sys, scsi2mgr.sys\"   \n           author = \"Florian Roth @4nc4p\"   \n           reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"   \n           date = \"2015/03/11\"   \n           hash = \"57fa4a1abbf39f4899ea76543ebd3688dcc11e13\"   \n      \n       strings:   \n           $s0 = \"volrec.sys\" fullword wide   \n           $s1 = \"volrec.pdb\" fullword ascii   \n           $s2 = \"Volume recognizer driver\" fullword wide   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285880
		},
		{
			"indicator": "0875eb67d2f953ccdb5e2dbf4b42b25c1dded5bb",
			"description": "",
			"title": "",
			"content": "rule EquationDrug_PlatformOrchestrator    \n   {   \n      \n       meta:   \n           description = \"EquationDrug - Platform orchestrator - mscfg32.dll, svchost32.dll\"   \n           author = \"Florian Roth @4nc4p\"   \n           reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"   \n           date = \"2015/03/11\"   \n           hash = \"febc4f30786db7804008dc9bc1cebdc26993e240\"   \n      \n       strings:   \n           $s0 = \"SERVICES.EXE\" fullword wide   \n           $s1 = \"\\\\command.com\" fullword wide   \n           $s2 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide   \n           $s3 = \"LSASS.EXE\" fullword wide   \n           $s4 = \"Windows Configuration Services\" fullword wide   \n           $s8 = \"unilay.dll\" fullword ascii   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285881
		},
		{
			"indicator": "2a8d905fe92c11a931a7a09d96f93c975bc08098",
			"description": "",
			"title": "",
			"content": "rule EquationDrug_NetworkSniffer2    \n   {   \n      \n       meta:   \n           description = \"EquationDrug - Network Sniffer - tdip.sys\"   \n           author = \"Florian Roth @4nc4p\"   \n           reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"   \n           date = \"2015/03/11\"   \n           hash = \"7e3cd36875c0e5ccb076eb74855d627ae8d4627f\"   \n      \n       strings:   \n           $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide   \n           $s1 = \"IP Transport Driver\" fullword wide   \n           $s2 = \"tdip.sys\" fullword wide   \n           $s3 = \"sys\\\\tdip.dbg\" fullword ascii   \n           $s4 = \"dip.sys\" fullword ascii   \n           $s5 = \"\\\\Device\\\\%ws_%ws\" fullword wide   \n           $s6 = \"\\\\DosDevices\\\\%ws\" fullword wide   \n           $s7 = \"\\\\Device\\\\%ws\" fullword wide   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285882
		},
		{
			"indicator": "33092adfaf89a598d4b13264f71965a7dc73cb4b",
			"description": "",
			"title": "",
			"content": "rule EquationDrug_KernelRootkit    \n   {   \n      \n       meta:   \n           description = \"EquationDrug - Kernel mode stage 0 and rootkit (Windows 2000 and above) - msndsrv.sys\"   \n           author = \"Florian Roth @4nc4p\"   \n           reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"   \n           date = \"2015/03/11\"   \n           hash = \"597715224249e9fb77dc733b2e4d507f0cc41af6\"   \n      \n       strings:   \n           $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide   \n           $s1 = \"Parmsndsrv.dbg\" fullword ascii   \n           $s2 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide   \n           $s3 = \"msndsrv.sys\" fullword wide   \n           $s5 = \"\\\\REGISTRY\\\\MACHINE\\\\System\\\\CurrentControlSet\\\\Control\\\\Windows\" fullword wide   \n           $s6 = \"\\\\Device\\\\%ws_%ws\" fullword wide   \n           $s7 = \"\\\\DosDevices\\\\%ws\" fullword wide   \n           $s9 = \"\\\\Device\\\\%ws\" fullword wide   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285883
		},
		{
			"indicator": "a3c5517e3a0a6719d617842a7853dc5262d073e0",
			"description": "",
			"title": "",
			"content": "rule Equation_Kaspersky_HDD_reprogramming_module    \n   {   \n      \n       meta:   \n           description = \"Equation Group Malware - HDD reprogramming module\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/ivt8EW\"   \n           date = \"2015/02/16\"   \n           hash = \"ff2b50f371eb26f22eb8a2118e9ab0e015081500\"   \n          \n       strings:   \n           $mz = { 4d 5a }   \n           $s0 = \"nls_933w.dll\" fullword ascii   \n           $s1 = \"BINARY\" fullword wide   \n           $s2 = \"KfAcquireSpinLock\" fullword ascii   \n           $s3 = \"HAL.dll\" fullword ascii   \n           $s4 = \"READ_REGISTER_UCHAR\" fullword ascii   \n       condition:   \n           ( $mz at 0 ) and filesize < 300000 and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 30285884
		},
		{
			"indicator": "78fc15f95606842b3f889696b657cdbb1f7062ec",
			"description": "",
			"title": "",
			"content": "rule apt_equation_exploitlib_mutexes   \n   {   \n      \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           description = \"Rule to detect Equation group's Exploitation library http://goo.gl/ivt8EW\"   \n           version = \"1.0\"   \n           last_modified = \"2015-02-16\"   \n           reference = \"http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/\"   \n      \n       strings:   \n           $mz=\"MZ\"   \n           $a1=\"prkMtx\" wide   \n           $a2=\"cnFormSyncExFBC\" wide   \n           $a3=\"cnFormVoidFBC\" wide   \n           $a4=\"cnFormSyncExFBC\"   \n           $a5=\"cnFormVoidFBC\"   \n      \n       condition:   \n           (($mz at 0) and any of ($a*))   \n   }",
			"type": "YARA",
			"id": 30285885
		},
		{
			"indicator": "1f8adabe3cdc83e12283941805d5a070f6778629",
			"description": "",
			"title": "",
			"content": "rule EquationDrug_Keylogger    \n   {   \n      \n       meta:   \n           description = \"EquationDrug - Key/clipboard logger driver - msrtvd.sys\"   \n           author = \"Florian Roth @4nc4p\"   \n           reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"   \n           date = \"2015/03/11\"   \n           hash = \"b93aa17b19575a6e4962d224c5801fb78e9a7bb5\"   \n      \n       strings:   \n           $s0 = \"\\\\registry\\\\machine\\\\software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" fullword wide   \n           $s2 = \"\\\\registry\\\\machine\\\\SYSTEM\\\\ControlSet001\\\\Control\\\\Session Manager\\\\En\" wide   \n           $s3 = \"\\\\DosDevices\\\\Gk\" fullword wide   \n           $s5 = \"\\\\Device\\\\Gk0\" fullword wide   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285886
		},
		{
			"indicator": "11c0cf172f8c086ddb1ef8bc0429927b3e519e17",
			"description": "",
			"title": "",
			"content": "rule apt_equation_keyword    \n   {   \n      \n       meta:   \n           description = \"Rule to detect Equation group's keyword in executable file\"   \n           author = \"Florian Roth @4nc4p\"   \n           last_modified = \"2015-09-26\"   \n           reference = \"http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/\"   \n      \n       strings:   \n            $a1 = \"Backsnarf_AB25\" wide   \n            $a2 = \"Backsnarf_AB25\" ascii   \n      \n       condition:   \n            uint16(0) == 0x5a4d and 1 of ($a*)   \n   }",
			"type": "YARA",
			"id": 30285887
		},
		{
			"indicator": "1095e26bed028aa690815e45113c794ca02d1cb0",
			"description": "",
			"title": "",
			"content": "rule apt_equation_cryptotable   \n   {   \n      \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           description = \"Rule to detect the crypto library used in Equation group malware\"   \n           version = \"1.0\"   \n           last_modified = \"2015-02-16\"   \n           reference = \"https://securelist.com/blog/\"   \n      \n       strings:   \n           $a={37 DF E8 B6 C7 9C 0B AE 91 EF F0 3B 90 C6 80 85 5D 19 4B 45 44 12 3C E2 0D 5C 1C 7B C4 FF D6 05 17 14 4F 03 74 1E 41 DA 8F 7D DE 7E 99 F1 35 AC B8 46 93 CE 23 82 07 EB 2B D4 72 71 40 F3 B0 F7 78 D7 4C D1 55 1A 39 83 18 FA E1 9A 56 B1 96 AB A6 30 C5 5F BE 0C 50 C1}   \n      \n       condition:   \n           $a   \n   }",
			"type": "YARA",
			"id": 30285888
		},
		{
			"indicator": "b004afefaa581bfd1e87949d1d9cbbe694e7b6f6",
			"description": "",
			"title": "",
			"content": "rule apt_equation_doublefantasy_genericresource   \n   {   \n      \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           description = \"Rule to detect DoubleFantasy encoded config http://goo.gl/ivt8EW\"   \n           version = \"1.0\"   \n           last_modified = \"2015-02-16\"   \n           reference = \"http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/\"   \n      \n       strings:   \n           $mz=\"MZ\"   \n           $a1={06 00 42 00 49 00 4E 00 52 00 45 00 53 00}   \n           $a2=\"yyyyyyyyyyyyyyyy\"   \n           $a3=\"002\"   \n      \n       condition:   \n           (($mz at 0) and all of ($a*)) and filesize < 500000   \n   }",
			"type": "YARA",
			"id": 30285889
		},
		{
			"indicator": "35813a5e1d9f2037a17ecd00555005c06865a696",
			"description": "",
			"title": "",
			"content": "rule Equation_Kaspersky_FannyWorm   \n   {   \n      \n       meta:   \n           description = \"Equation Group Malware - Fanny Worm\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/ivt8EW\"   \n           date = \"2015/02/16\"   \n           hash = \"1f0ae54ac3f10d533013f74f48849de4e65817a7\"   \n      \n       strings:   \n           $mz = { 4d 5a }   \n           $s1 = \"x:\\\\fanny.bmp\" fullword ascii   \n           $s2 = \"32.exe\" fullword ascii   \n           $s3 = \"d:\\\\fanny.bmp\" fullword ascii   \n           $x1 = \"c:\\\\windows\\\\system32\\\\kernel32.dll\" fullword ascii   \n           $x2 = \"System\\\\CurrentControlSet\\\\Services\\\\USBSTOR\\\\Enum\" fullword ascii   \n           $x3 = \"System\\\\CurrentControlSet\\\\Services\\\\PartMgr\\\\Enum\" fullword ascii   \n           $x4 = \"\\\\system32\\\\win32k.sys\" fullword wide   \n           $x5 = \"\\\\AGENTCPD.DLL\" fullword ascii   \n           $x6 = \"agentcpd.dll\" fullword ascii   \n           $x7 = \"PADupdate.exe\" fullword ascii   \n           $x8 = \"dll_installer.dll\" fullword ascii   \n           $x9 = \"\\\\restore\\\\\" fullword ascii   \n           $x10 = \"Q:\\\\__?__.lnk\" fullword ascii   \n           $x11 = \"Software\\\\Microsoft\\\\MSNetMng\" fullword ascii   \n           $x12 = \"\\\\shelldoc.dll\" fullword ascii   \n           $x13 = \"file size = %d bytes\" fullword ascii   \n           $x14 = \"\\\\MSAgent\" fullword ascii   \n           $x15 = \"Global\\\\RPCMutex\" fullword ascii   \n           $x16 = \"Global\\\\DirectMarketing\" fullword ascii   \n      \n       condition:   \n           ( $mz at 0 ) and filesize < 300000 and (( 2 of ($s*) ) or ( 1 of ($s*) and 6 of ($x*) ) or ( 14 of ($x*)))   \n   }",
			"type": "YARA",
			"id": 30285890
		},
		{
			"indicator": "5195823294985f4e5e2b142e3e2826cfa4b398d8",
			"description": "",
			"title": "",
			"content": "rule Equation_Kaspersky_GreyFishInstaller   \n   {   \n      \n       meta:   \n           description = \"Equation Group Malware - Grey Fish\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/ivt8EW\"   \n           date = \"2015/02/16\"   \n           hash = \"58d15d1581f32f36542f3e9fb4b1fc84d2a6ba35\"   \n      \n       strings:   \n           $s0 = \"DOGROUND.exe\" fullword wide   \n           $s1 = \"Windows Configuration Services\" fullword wide   \n           $s2 = \"GetMappedFilenameW\" fullword ascii   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285891
		},
		{
			"indicator": "6a6dbf0433a20385ce604cc33d2bd1926bdc93b8",
			"description": "",
			"title": "",
			"content": "rule EquationDrug_NetworkSniffer5    \n   {   \n      \n       meta:   \n           description = \"EquationDrug - Network-sniffer/patcher - atmdkdrv.sys\"   \n           author = \"Florian Roth @4nc4p\"   \n           reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"   \n           date = \"2015/03/11\"   \n           hash = \"09399b9bd600d4516db37307a457bc55eedcbd17\"   \n      \n       strings:   \n           $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide   \n           $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide   \n           $s2 = \"atmdkdrv.sys\" fullword wide   \n           $s4 = \"\\\\Device\\\\%ws_%ws\" fullword wide   \n           $s5 = \"\\\\DosDevices\\\\%ws\" fullword wide   \n           $s6 = \"\\\\Device\\\\%ws\" fullword wide   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285892
		},
		{
			"indicator": "b5bb1cd813f7a18c929365e1adec28e1315e70b7",
			"description": "",
			"title": "",
			"content": "rule Equation_Kaspersky_TripleFantasy_1   \n   {   \n      \n       meta:   \n           description = \"Equation Group Malware - TripleFantasy http://goo.gl/ivt8EW\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/ivt8EW\"   \n           date = \"2015/02/16\"   \n           hash = \"b2b2cd9ca6f5864ef2ac6382b7b6374a9fb2cbe9\"   \n      \n       strings:   \n           $mz = { 4d 5a }   \n           $s0 = \"%SystemRoot%\\\\system32\\\\hnetcfg.dll\" fullword wide   \n           $s1 = \"%WINDIR%\\\\System32\\\\ahlhcib.dll\" fullword wide   \n           $s2 = \"%WINDIR%\\\\sjyntmv.dat\" fullword wide   \n           $s3 = \"Global\\\\{8c38e4f3-591f-91cf-06a6-67b84d8a0102}\" fullword wide   \n           $s4 = \"%WINDIR%\\\\System32\\\\owrwbsdi\" fullword wide   \n           $s5 = \"Chrome\" fullword wide   \n           $s6 = \"StringIndex\" fullword ascii   \n           $x1 = \"itemagic.net@443\" fullword wide   \n           $x2 = \"team4heat.net@443\" fullword wide   \n           $x5 = \"62.216.152.69@443\" fullword wide   \n           $x6 = \"84.233.205.37@443\" fullword wide   \n           $z1 = \"www.microsoft.com@80\" fullword wide   \n           $z2 = \"www.google.com@80\" fullword wide   \n           $z3 = \"127.0.0.1:3128\" fullword wide   \n      \n       condition:   \n           ( $mz at 0 ) and filesize < 300000 and (( all of ($s*) and all of ($z*) ) or ( all of ($s*) and 1 of ($x*) ))   \n   }",
			"type": "YARA",
			"id": 30285893
		},
		{
			"indicator": "2b80994cb46e5a29d9fee858def0e5d8bd048bae",
			"description": "",
			"title": "",
			"content": "rule EquationDrug_NetworkSniffer1   \n   {   \n      \n       meta:   \n           description = \"EquationDrug - Backdoor driven by network sniffer - mstcp32.sys, fat32.sys\"   \n           author = \"Florian Roth @4nc4p\"   \n           reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"   \n           date = \"2015/03/11\"   \n           hash = \"26e787997a338d8111d96c9a4c103cf8ff0201ce\"   \n      \n       strings:   \n           $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide   \n           $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide   \n           $s3 = \"sys\\\\mstcp32.dbg\" fullword ascii   \n           $s7 = \"mstcp32.sys\" fullword wide   \n           $s8 = \"p32.sys\" fullword ascii   \n           $s9 = \"\\\\Device\\\\%ws_%ws\" fullword wide   \n           $s10 = \"\\\\DosDevices\\\\%ws\" fullword wide   \n           $s11 = \"\\\\Device\\\\%ws\" fullword wide   \n          \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285894
		},
		{
			"indicator": "57f1b2cd39968cd1b1ef5a4b28a1ff7ec5404c46",
			"description": "",
			"title": "",
			"content": "rule EquationDrug_CompatLayer_UnilayDLL    \n   {   \n      \n       meta:   \n           description = \"EquationDrug - Unilay.DLL\"   \n           author = \"Florian Roth @4nc4p\"   \n           reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"   \n           date = \"2015/03/11\"   \n           hash = \"a3a31937956f161beba8acac35b96cb74241cd0f\"   \n      \n       strings:   \n           $mz = { 4d 5a }   \n           $s0 = \"unilay.dll\" fullword ascii   \n      \n       condition:   \n           ( $mz at 0 ) and $s0   \n   }",
			"type": "YARA",
			"id": 30285895
		},
		{
			"indicator": "ea84200a165ccd201733671136f1579f0c328670",
			"description": "",
			"title": "",
			"content": "rule Equation_Kaspersky_DoubleFantasy_1   \n   {   \n      \n       meta:   \n           description = \"Equation Group Malware - DoubleFantasy\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/ivt8EW\"   \n           date = \"2015/02/16\"   \n           hash = \"d09b4b6d3244ac382049736ca98d7de0c6787fa2\"   \n      \n       strings:   \n           $mz = { 4d 5a }   \n           $z1 = \"msvcp5%d.dll\" fullword ascii   \n           $s0 = \"actxprxy.GetProxyDllInfo\" fullword ascii   \n           $s3 = \"actxprxy.DllGetClassObject\" fullword ascii   \n           $s5 = \"actxprxy.DllRegisterServer\" fullword ascii   \n           $s6 = \"actxprxy.DllUnregisterServer\" fullword ascii   \n           $x1 = \"yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy\" ascii   \n           $x2 = \"191H1a1\" fullword ascii   \n           $x3 = \"November \" fullword ascii   \n           $x4 = \"abababababab\" fullword ascii   \n           $x5 = \"January \" fullword ascii   \n           $x6 = \"October \" fullword ascii   \n           $x7 = \"September \" fullword ascii   \n      \n       condition:   \n           ( $mz at 0 ) and filesize < 350000 and (( $z1 ) or ( all of ($s*) and 6 of ($x*) ))   \n   }",
			"type": "YARA",
			"id": 30285896
		},
		{
			"indicator": "483780b14b2b8e5cbe0421b222809339afd50f50",
			"description": "",
			"title": "",
			"content": "rule EquationDrug_VolRec_Driver    \n   {   \n      \n       meta:   \n           description = \"EquationDrug - Collector plugin for Volrec - msrstd.sys\"   \n           author = \"Florian Roth @4nc4p\"   \n           reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"   \n           date = \"2015/03/11\"   \n           hash = \"ee2b504ad502dc3fed62d6483d93d9b1221cdd6c\"   \n      \n       strings:   \n           $s0 = \"msrstd.sys\" fullword wide   \n           $s1 = \"msrstd.pdb\" fullword ascii   \n           $s2 = \"msrstd driver\" fullword wide   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285897
		},
		{
			"indicator": "6e3779b16f68945b8b756d5daed68734d83574d9",
			"description": "",
			"title": "",
			"content": "rule EquationDrug_NetworkSniffer4    \n   {   \n      \n       meta:   \n           description = \"EquationDrug - Network-sniffer/patcher - atmdkdrv.sys\"   \n           author = \"Florian Roth @4nc4p\"   \n           reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"   \n           date = \"2015/03/11\"   \n           hash = \"cace40965f8600a24a2457f7792efba3bd84d9ba\"   \n      \n       strings:   \n           $s0 = \"Copyright 1999 RAVISENT Technologies Inc.\" fullword wide   \n           $s1 = \"\\\\systemroot\\\\\" fullword ascii   \n           $s2 = \"RAVISENT Technologies Inc.\" fullword wide   \n           $s3 = \"Created by VIONA Development\" fullword wide   \n           $s4 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide   \n           $s5 = \"\\\\device\\\\harddiskvolume\" fullword wide   \n           $s7 = \"ATMDKDRV.SYS\" fullword wide   \n           $s8 = \"\\\\Device\\\\%ws_%ws\" fullword wide   \n           $s9 = \"\\\\DosDevices\\\\%ws\" fullword wide   \n           $s10 = \"CineMaster C 1.1 WDM Main Driver\" fullword wide   \n           $s11 = \"\\\\Device\\\\%ws\" fullword wide   \n           $s13 = \"CineMaster C 1.1 WDM\" fullword wide   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285898
		},
		{
			"indicator": "08a21811d2b6f89e00b6f2c77b93b9da8b40835e",
			"description": "",
			"title": "",
			"content": "rule EquationDrug_HDDSSD_Op    \n   {   \n      \n       meta:   \n           description = \"EquationDrug - HDD/SSD firmware operation - nls_933w.dll\"   \n           author = \"Florian Roth @4nc4p\"   \n           reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"   \n           date = \"2015/03/11\"   \n           hash = \"ff2b50f371eb26f22eb8a2118e9ab0e015081500\"   \n      \n       strings:   \n           $s0 = \"nls_933w.dll\" fullword ascii   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285899
		},
		{
			"indicator": "170738d2f9949dcf4692416756d487375ed4316e",
			"description": "",
			"title": "",
			"content": "rule apt_equation_equationlaser_runtimeclasses   \n   {   \n      \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           description = \"Rule to detect the EquationLaser malware\"   \n           version = \"1.0\"   \n           last_modified = \"2015-02-16\"   \n           reference = \"https://securelist.com/blog/\"   \n      \n       strings:   \n           $a1=\"?a73957838_2@@YAXXZ\"   \n           $a2=\"?a84884@@YAXXZ\"   \n           $a3=\"?b823838_9839@@YAXXZ\"   \n           $a4=\"?e747383_94@@YAXXZ\"   \n           $a5=\"?e83834@@YAXXZ\"   \n           $a6=\"?e929348_827@@YAXXZ\"   \n      \n       condition:   \n           any of them   \n   }",
			"type": "YARA",
			"id": 30285900
		},
		{
			"indicator": "337fe56df7a688caabefe962b192537f9acfdac0",
			"description": "",
			"title": "",
			"content": "rule Equation_Kaspersky_EquationLaserInstaller   \n   {   \n      \n       meta:   \n           description = \"Equation Group Malware - EquationLaser Installer\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/ivt8EW\"   \n           date = \"2015/02/16\"   \n           hash = \"5e1f56c1e57fbff96d4999db1fd6dd0f7d8221df\"   \n      \n       strings:   \n           $mz = { 4d 5a }   \n           $s0 = \"Failed to get Windows version\" fullword ascii   \n           $s1 = \"lsasrv32.dll and lsass.exe\" fullword wide   \n           $s2 = \"\\\\\\\\%s\\\\mailslot\\\\%s\" fullword ascii   \n           $s3 = \"%d-%d-%d %d:%d:%d Z\" fullword ascii   \n           $s4 = \"lsasrv32.dll\" fullword ascii   \n           $s5 = \"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\" fullword ascii   \n           $s6 = \"%s %02x %s\" fullword ascii   \n           $s7 = \"VIEWERS\" fullword ascii   \n           $s8 = \"5.2.3790.220 (srv03_gdr.040918-1552)\" fullword wide   \n      \n       condition:   \n           ( $mz at 0 ) and filesize < 250000 and 6 of ($s*)   \n   }",
			"type": "YARA",
			"id": 30285901
		},
		{
			"indicator": "84334d0ea3f5693b09ea03a8b22462210471c799",
			"description": "",
			"title": "",
			"content": "rule Equation_Kaspersky_GROK_Keylogger   \n   {   \n      \n       meta:   \n           description = \"Equation Group Malware - GROK keylogger\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/ivt8EW\"   \n           date = \"2015/02/16\"   \n           hash = \"50b8f125ed33233a545a1aac3c9d4bb6aa34b48f\"   \n      \n       strings:   \n           $mz = { 4d 5a }   \n           $s0 = \"c:\\\\users\\\\rmgree5\\\\\" ascii   \n           $s1 = \"msrtdv.sys\" fullword wide   \n           $x1 = \"svrg.pdb\" fullword ascii   \n           $x2 = \"W32pServiceTable\" fullword ascii   \n           $x3 = \"In forma\" fullword ascii   \n           $x4 = \"ReleaseF\" fullword ascii   \n           $x5 = \"criptor\" fullword ascii   \n           $x6 = \"astMutex\" fullword ascii   \n           $x7 = \"ARASATAU\" fullword ascii   \n           $x8 = \"R0omp4ar\" fullword ascii   \n           $z1 = \"H.text\" fullword ascii   \n           $z2 = \"\\\\registry\\\\machine\\\\software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" fullword wide   \n           $z4 = \"\\\\registry\\\\machine\\\\SYSTEM\\\\ControlSet001\\\\Control\\\\Session Manager\\\\Environment\" wide fullword   \n      \n       condition:   \n           ( $mz at 0 ) and filesize < 250000 and ($s0 or ( $s1 and 6 of ($x*) ) or ( 6 of ($x*) and all of ($z*) ))   \n   }",
			"type": "YARA",
			"id": 30285902
		},
		{
			"indicator": "714ce52468bfdfedeac6ecfebd338913271271c5",
			"description": "",
			"title": "",
			"content": "rule Equation_Kaspersky_TripleFantasy_Loader    \n   {   \n      \n       meta:   \n           description = \"Equation Group Malware - TripleFantasy Loader\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/ivt8EW\"   \n           date = \"2015/02/16\"   \n           hash = \"4ce6e77a11b443cc7cbe439b71bf39a39d3d7fa3\"   \n          \n       strings:   \n           $mz = { 4d 5a }   \n           $x1 = \"Original Innovations, LLC\" fullword wide   \n           $x2 = \"Moniter Resource Protocol\" fullword wide   \n           $x3 = \"ahlhcib.dll\" fullword wide   \n           $s0 = \"hnetcfg.HNetGetSharingServicesPage\" fullword ascii   \n           $s1 = \"hnetcfg.IcfGetOperationalMode\" fullword ascii   \n           $s2 = \"hnetcfg.IcfGetDynamicFwPorts\" fullword ascii   \n           $s3 = \"hnetcfg.HNetFreeFirewallLoggingSettings\" fullword ascii   \n           $s4 = \"hnetcfg.HNetGetShareAndBridgeSettings\" fullword ascii   \n           $s5 = \"hnetcfg.HNetGetFirewallSettingsPage\" fullword ascii   \n          \n       condition:   \n           ( $mz at 0 ) and filesize < 50000 and ( all of ($x*) and all of ($s*) )   \n   }",
			"type": "YARA",
			"id": 30285903
		},
		{
			"indicator": "1731f5aa086f7bcfd71fccbd6f9db606452c6484",
			"description": "",
			"title": "",
			"content": "rule EquationDrug_NetworkSniffer3    \n   {   \n      \n       meta:   \n           description = \"EquationDrug - Network Sniffer - tdip.sys\"   \n           author = \"Florian Roth @4nc4p\"   \n           reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"   \n           date = \"2015/03/11\"   \n           hash = \"14599516381a9646cd978cf962c4f92386371040\"   \n      \n       strings:   \n           $s0 = \"Corporation. All rights reserved.\" fullword wide   \n           $s1 = \"IP Transport Driver\" fullword wide   \n           $s2 = \"tdip.sys\" fullword wide   \n           $s3 = \"tdip.pdb\" fullword ascii   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30285904
		},
		{
			"indicator": "3dba8b243e1e16b49ac5889f62d02762ef2645dc",
			"description": "",
			"title": "",
			"content": "rule Equation_Kaspersky_SuspiciousString    \n   {   \n        \n       meta:   \n           description = \"Equation Group Malware - suspicious string found in sample\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/ivt8EW\"   \n           date = \"2015/02/17\"   \n           score = 60   \n         \n       strings:   \n           $mz = { 4d 5a }   \n           $s1 = \"i386\\\\DesertWinterDriver.pdb\" fullword   \n           $s2 = \"Performing UR-specific post-install...\"   \n           $s3 = \"Timeout waiting for the \\\"canInstallNow\\\" event from the implant-specific EXE!\"   \n           $s4 = \"STRAITSHOOTER30.exe\"   \n           $s5 = \"standalonegrok_2.1.1.1\"   \n           $s6 = \"c:\\\\users\\\\rmgree5\\\\\"   \n          \n       condition:   \n           ( $mz at 0 ) and filesize < 500000 and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 30285905
		},
		{
			"indicator": "0a2fd56439315775937c35eb4cd7d2e2a0726d5b",
			"description": "",
			"title": "",
			"content": "rule Greenbug_Malware_2 {   \n      meta:   \n         description = \"Detects Backdoor from Greenbug Incident\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/urp4CD\"   \n         date = \"2017-01-25\"   \n         hash1 = \"6b28a43eda5b6f828a65574e3f08a6d00e0acf84cbb94aac5cec5cd448a4649d\"   \n         hash2 = \"21f5e60e9df6642dbbceca623ad59ad1778ea506b7932d75ea8db02230ce3685\"   \n         hash3 = \"319a001d09ee9d754e8789116bbb21a3c624c999dae9cf83fde90a3fbe67ee6c\"   \n      strings:   \n         $x1 = \"|||Command executed successfully\" fullword ascii   \n         $x2 = \"\\\\Release\\\\Bot Fresh.pdb\" ascii   \n         $x3 = \"C:\\\\ddd\\\\a1.txt\" fullword wide   \n         $x4 = \"Bots\\\\Bot5\\\\x64\\\\Release\" ascii   \n         $x5 = \"Bot5\\\\Release\\\\Ism.pdb\" ascii   \n         $x6 = \"Bot\\\\Release\\\\Ism.pdb\" ascii   \n         $x7 = \"\\\\Bot Fresh\\\\Release\\\\Bot\" ascii   \n      \n         $s1 = \"/Home/SaveFile?commandId=CmdResult=\" fullword wide   \n         $s2 = \"raB3G:Sun:Sunday:Mon:Monday:Tue:Tuesday:Wed:Wednesday:Thu:Thursday:Fri:Friday:Sat:Saturday\" fullword ascii   \n         $s3 = \"Set-Cookie:\\\\b*{.+?}\\\\n\" fullword wide   \n         $s4 = \"SELECT * FROM AntiVirusProduct\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 1000KB and ( 1 of ($x*) or 2 of them ) ) or ( 3 of them )   \n   }",
			"type": "YARA",
			"id": 30343090
		},
		{
			"indicator": "9565f436d6c61aba516cb97919372a2fd87960a7",
			"description": "",
			"title": "",
			"content": "rule Greenbug_Malware_3 {   \n      meta:   \n         description = \"Detects Backdoor from Greenbug Incident\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/urp4CD\"   \n         date = \"2017-01-25\"   \n         super_rule = 1   \n         hash1 = \"44bdf5266b45185b6824898664fd0c0f2039cdcb48b390f150e71345cd867c49\"   \n         hash2 = \"7f16824e7ad9ee1ad2debca2a22413cde08f02ee9f0d08d64eb4cb318538be9c\"   \n      strings:   \n         $x1 = \"F:\\\\Projects\\\\Bot\\\\Bot\\\\Release\\\\Ism.pdb\" fullword ascii   \n         $x2 = \"C:\\\\ddd\\\\wer2.txt\" fullword wide   \n         $x3 = \"\\\\Microsoft\\\\Windows\\\\tmp43hh11.txt\" fullword wide   \n      condition:   \n         1 of them   \n   }",
			"type": "YARA",
			"id": 30343091
		},
		{
			"indicator": "0ddce797fb5efecfcbff186088cec698ffe6d253",
			"description": "",
			"title": "",
			"content": "rule Greenbug_Malware_5 {   \n      meta:   \n         description = \"Auto-generated rule - from files 308a646f57c8be78e6a63ffea551a84b0ae877b23f28a660920c9ba82d57748f, 44bdf5266b45185b6824898664fd0c0f2039cdcb48b390f150e71345cd867c49, 7f16824e7ad9ee1ad2debca2a22413cde08f02ee9f0d08d64eb4cb318538be9c, 82beaef407f15f3c5b2013cb25901c9fab27b086cadd35149794a25dce8abcb9\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/urp4CD\"   \n         date = \"2017-01-25\"   \n         super_rule = 1   \n         hash1 = \"308a646f57c8be78e6a63ffea551a84b0ae877b23f28a660920c9ba82d57748f\"   \n         hash2 = \"44bdf5266b45185b6824898664fd0c0f2039cdcb48b390f150e71345cd867c49\"   \n         hash3 = \"7f16824e7ad9ee1ad2debca2a22413cde08f02ee9f0d08d64eb4cb318538be9c\"   \n         hash4 = \"82beaef407f15f3c5b2013cb25901c9fab27b086cadd35149794a25dce8abcb9\"   \n      strings:   \n         $x1 = \"cmd /u /c WMIC /Node:localhost /Namespace:\\\\\\\\root\\\\SecurityCenter\" fullword ascii   \n         $x2 = \"cmd /a /c net user administrator /domain >>\" fullword ascii   \n         $x3 = \"cmd /a /c netstat -ant >>\\\"%localappdata%\\\\Microsoft\\\\\" fullword ascii   \n      \n         $o1 = \"========================== (Net User) ==========================\" ascii fullword   \n      condition:   \n         filesize < 2000KB and (   \n            ( uint16(0) == 0x5a4d and 1 of them ) or   \n            $o1   \n         )   \n   }",
			"type": "YARA",
			"id": 30343092
		},
		{
			"indicator": "95c81465ec240bc0f921da328446e7d0a2a0ba5d",
			"description": "",
			"title": "",
			"content": "rule Greenbug_Malware_1 {   \n      meta:   \n         description = \"Detects Malware from Greenbug Incident\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/urp4CD\"   \n         date = \"2017-01-25\"   \n         hash1 = \"dab460a0b73e79299fbff2fa301420c1d97a36da7426acc0e903c70495db2b76\"   \n      strings:   \n         $s1 = \"vailablez\" fullword ascii   \n         $s2 = \"Sfouglr\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 400KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30343093
		},
		{
			"indicator": "561517a64feff4a4fa499daba5a3aa3fb03add25",
			"description": "",
			"title": "",
			"content": "rule Greenbug_Malware_4 {   \n      meta:   \n         description = \"Detects ISMDoor Backdoor\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/urp4CD\"   \n         date = \"2017-01-25\"   \n         super_rule = 1   \n         hash1 = \"308a646f57c8be78e6a63ffea551a84b0ae877b23f28a660920c9ba82d57748f\"   \n         hash2 = \"82beaef407f15f3c5b2013cb25901c9fab27b086cadd35149794a25dce8abcb9\"   \n      strings:   \n         $s1 = \"powershell.exe -nologo -windowstyle hidden -c \\\"Set-ExecutionPolicy -scope currentuser\" fullword ascii   \n         $s2 = \"powershell.exe -c \\\"Set-ExecutionPolicy -scope currentuser -ExecutionPolicy unrestricted -f; . \\\"\" fullword ascii   \n         $s3 = \"c:\\\\windows\\\\temp\\\\tmp8873\" fullword ascii   \n         $s4 = \"taskkill /im winit.exe /f\" fullword ascii   \n         $s5 = \"invoke-psuacme\"   \n         $s6 = \"-method oobe -payload \\\"\\\"\" fullword ascii   \n         $s7 = \"C:\\\\ProgramData\\\\stat2.dat\" fullword wide   \n         $s8 = \"Invoke-bypassuac\" fullword ascii   \n         $s9 = \"Start Keylog Done\" fullword wide   \n         $s10 = \"Microsoft\\\\Windows\\\\WinIt.exe\" fullword ascii   \n         $s11 = \"Microsoft\\\\Windows\\\\Tmp9932u1.bat\\\"\" fullword ascii   \n         $s12 = \"Microsoft\\\\Windows\\\\tmp43hh11.txt\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them ) or ( 3 of them )   \n   }",
			"type": "YARA",
			"id": 30343094
		},
		{
			"indicator": "59e7b64b578c0aa3252e014c7633073372a70f23",
			"description": "",
			"title": "",
			"content": "rule HackingTeam_Elevator_EXE    \n   {   \n      \n       meta:   \n           description = \"Hacking Team Disclosure Sample - file elevator.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"Hacking Team Disclosure elevator.c\"   \n           date = \"2015-07-07\"   \n           hash1 = \"40a10420b9d49f87527bc0396b19ec29e55e9109e80b52456891243791671c1c\"   \n           hash2 = \"92aec56a859679917dffa44bd4ffeb5a8b2ee2894c689abbbcbe07842ec56b8d\"   \n           hash = \"9261693b67b6e379ad0e57598602712b8508998c0cb012ca23139212ae0009a1\"   \n      \n       strings:   \n           $x1 = \"CRTDLL.DLL\" fullword ascii   \n           $x2 = \"\\\\sysnative\\\\CI.dll\" fullword ascii   \n           $x3 = \"\\\\SystemRoot\\\\system32\\\\CI.dll\" fullword ascii   \n           $x4 = \"C:\\\\\\\\Windows\\\\\\\\Sysnative\\\\\\\\ntoskrnl.exe\" fullword ascii /* PEStudio Blacklist: strings */   \n           $s1 = \"[*] traversing processes\" fullword ascii /* PEStudio Blacklist: strings */   \n           $s2 = \"_getkprocess\" fullword ascii /* PEStudio Blacklist: strings */   \n           $s3 = \"[*] LoaderConfig %p\" fullword ascii /* PEStudio Blacklist: strings */   \n           $s4 = \"loader.obj\" fullword ascii /* PEStudio Blacklist: strings */   \n           $s5 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3\" ascii /* PEStudio Blacklist: strings */   \n           $s6 = \"[*] token restore\" fullword ascii /* PEStudio Blacklist: strings */   \n           $s7 = \"elevator.obj\" fullword ascii   \n           $s8 = \"_getexport\" fullword ascii /* PEStudio Blacklist: strings */   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 3000KB and all of ($x*) and 3 of ($s*)   \n   }",
			"type": "YARA",
			"id": 30343316
		},
		{
			"indicator": "1b6f43d87c1333b4de650e89a469ab063cf179e0",
			"description": "",
			"title": "",
			"content": "rule Hackingteam_Elevator_DLL    \n   {   \n      \n       meta:   \n           description = \"Hacking Team Disclosure Sample - file elevator.dll\"   \n           author = \"Florian Roth\"   \n           reference = \"http://t.co/EG0qtVcKLh\"   \n           date = \"2015-07-07\"   \n           hash = \"b7ec5d36ca702cc9690ac7279fd4fea28d8bd060\"   \n         \n       strings:   \n           $s1 = \"\\\\sysnative\\\\CI.dll\" fullword ascii   \n           $s2 = \"setx TOR_CONTROL_PASSWORD\" fullword ascii   \n           $s3 = \"mitmproxy0\" fullword ascii   \n           $s4 = \"\\\\insert_cert.exe\" fullword ascii   \n           $s5 = \"elevator.dll\" fullword ascii   \n           $s6 = \"CRTDLL.DLL\" fullword ascii   \n           $s7 = \"fail adding cert\" fullword ascii   \n           $s8 = \"DownloadingFile\" fullword ascii   \n           $s9 = \"fail adding cert: %s\" fullword ascii   \n           $s10 = \"InternetOpenA fail\" fullword ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 1000KB and 6 of them   \n   }",
			"type": "YARA",
			"id": 30343317
		},
		{
			"indicator": "e66657036a006065b0ce9a299092832015aab6a0",
			"description": "",
			"title": "",
			"content": "rule bin_ndisk     \n   {   \n          \n       meta:   \n           description = \"Hacking Team Disclosure Sample - file ndisk.sys\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.virustotal.com/en/file/a03a6ed90b89945a992a8c69f716ec3c743fa1d958426f4c50378cca5bef0a01/analysis/1436184181/\"   \n           date = \"2015-07-07\"   \n           hash = \"cf5089752ba51ae827971272a5b761a4ab0acd84\"   \n          \n       strings:   \n           $s1 = \"\\\\Registry\\\\Machine\\\\System\\\\ControlSet00%d\\\\services\\\\ndisk.sys\" fullword wide   \n           $s2 = \"\\\\Registry\\\\Machine\\\\System\\\\ControlSet00%d\\\\Enum\\\\Root\\\\LEGACY_NDISK.SYS\" fullword wide   \n           $s3 = \"\\\\Driver\\\\DeepFrz\" fullword wide   \n           $s4 = \"Microsoft Kernel Disk Manager\" fullword wide   \n           $s5 = \"ndisk.sys\" fullword wide   \n           $s6 = \"\\\\Device\\\\MSH4DEV1\" fullword wide   \n           $s7 = \"\\\\DosDevices\\\\MSH4DEV1\" fullword wide   \n           $s8 = \"built by: WinDDK\" fullword wide   \n          \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 30KB and 6 of them   \n   }",
			"type": "YARA",
			"id": 30343318
		},
		{
			"indicator": "a79eb3523b6c5f53037178ae982e2b8b8f185f72",
			"description": "",
			"title": "",
			"content": "rule RCS_Backdoor   \n   {   \n          \n       meta:   \n           description = \"Hacking Team RCS Backdoor\"   \n           author = \"botherder https://github.com/botherder\"   \n      \n       strings:   \n           $filter1 = \"$debug3\"   \n           $filter2 = \"$log2\"   \n           $filter3 = \"error2\"   \n           $debug1 = /\\- (C)hecking components/ wide ascii   \n           $debug2 = /\\- (A)ctivating hiding system/ wide ascii   \n           $debug3 = /(f)ully operational/ wide ascii   \n           $log1 = /\\- Browser activity \\(FF\\)/ wide ascii   \n           $log2 = /\\- Browser activity \\(IE\\)/ wide ascii   \n           // Cause false positives.   \n           //$log3 = /\\- About to call init routine at %p/ wide ascii   \n           //$log4 = /\\- Calling init routine at %p/ wide ascii   \n           $error1 = /\\[Unable to deploy\\]/ wide ascii   \n           $error2 = /\\[The system is already monitored\\]/ wide ascii   \n      \n       condition:   \n           (2 of ($debug*) or 2 of ($log*) or all of ($error*)) and not any of ($filter*)   \n   }",
			"type": "YARA",
			"id": 30343319
		},
		{
			"indicator": "b3bc003e863814618804083bb87dd5d0fc699d76",
			"description": "",
			"title": "",
			"content": "rule RCS_Scout   \n   {   \n          \n       meta:   \n           description = \"Hacking Team RCS Scout\"   \n           author = \"botherder https://github.com/botherder\"   \n      \n       strings:   \n           $filter1 = \"$engine5\"   \n           $filter2 = \"$start4\"   \n           $filter3 = \"$upd2\"   \n           $filter4 = \"$lookma6\"   \n      \n           $engine1 = /(E)ngine started/ wide ascii   \n           $engine2 = /(R)unning in background/ wide ascii   \n           $engine3 = /(L)ocking doors/ wide ascii   \n           $engine4 = /(R)otors engaged/ wide ascii   \n           $engine5 = /(I)\\'m going to start it/ wide ascii   \n      \n           $start1 = /Starting upgrade\\!/ wide ascii   \n           $start2 = /(I)\\'m going to start the program/ wide ascii   \n           $start3 = /(i)s it ok\\?/ wide ascii   \n           $start4 = /(C)lick to start the program/ wide ascii   \n      \n           $upd1 = /(U)pdJob/ wide ascii   \n           $upd2 = /(U)pdTimer/ wide ascii   \n      \n           $lookma1 = /(O)wning PCI bus/ wide   \n           $lookma2 = /(F)ormatting bios/ wide   \n           $lookma3 = /(P)lease insert a disk in drive A:/ wide   \n           $lookma4 = /(U)pdating CPU microcode/ wide   \n           $lookma5 = /(N)ot sure what's happening/ wide   \n           $lookma6 = /(L)ook ma, no thread id\\! \\\\\\\\o\\// wide   \n      \n       condition:   \n           (all of ($engine*) or all of ($start*) or all of ($upd*) or 4 of ($lookma*)) and not any of ($filter*)   \n   }",
			"type": "YARA",
			"id": 30343320
		},
		{
			"indicator": "4cdf659bf30a859d7f6e0145a40848049ba427b3",
			"description": "",
			"title": "",
			"content": "rule apt_hellsing_proxytool   \n   {   \n          \n       meta:   \n           Author = \"Costin Raiu, Kaspersky Lab\"   \n           Date = \"2015-04-07\"   \n           Description = \"detection for Hellsing proxy testing tool\"   \n           Reference = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"    \n      \n       strings:    \n           $mz=\"MZ\"   \n           $a1=\"PROXY_INFO: automatic proxy url => %s \"    \n           $a2=\"PROXY_INFO: connection type => %d \"    \n           $a3=\"PROXY_INFO: proxy server => %s \"    \n           $a4=\"PROXY_INFO: bypass list => %s \"    \n           $a5=\"InternetQueryOption failed with GetLastError() %d\"    \n           $a6=\"D:\\\\Hellsing\\\\release\\\\exe\\\\exe\\\\\" nocase   \n      \n       condition:   \n           ($mz at 0) and (2 of ($a*)) and filesize < 300000   \n   }",
			"type": "YARA",
			"id": 30343327
		},
		{
			"indicator": "6849e45eb30ea71ea8f99ea18997a66e3b13e0ea",
			"description": "",
			"title": "",
			"content": "rule apt_hellsing_msgertype2   \n   {   \n          \n       meta:   \n           Author = \"Costin Raiu, Kaspersky Lab\"   \n           Date = \"2015-04-07\"   \n           Description = \"detection for Hellsing msger type 2 implants\"   \n           Reference = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"   \n      \n       strings:   \n           $mz=\"MZ\"   \n           $a1=\"%s\\\\system\\\\%d.txt\"   \n           $a2=\"_msger\"   \n           $a3=\"http://%s/lib/common.asp?action=user_login&uid=%s&lan=%s&host=%s&os=%s&proxy=%s\"   \n           $a4=\"http://%s/data/%s.1000001000\"   \n           $a5=\"/lib/common.asp?action=user_upload&file=\"   \n           $a6=\"%02X-%02X-%02X-%02X-%02X-%02X\"   \n          \n       condition:   \n           ($mz at 0) and (4 of ($a*)) and filesize < 500000   \n   }",
			"type": "YARA",
			"id": 30343328
		},
		{
			"indicator": "574eb13e7729e3206a55a82a576a64dd196987ec",
			"description": "",
			"title": "",
			"content": "rule apt_hellsing_irene   \n   {   \n          \n       meta:   \n           Author = \"Costin Raiu, Kaspersky Lab\"   \n           Date = \"2015-04-07\"   \n           Description = \"detection for Hellsing msger irene installer\"   \n           Reference = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"   \n      \n       strings:    \n           $mz=\"MZ\"   \n           $a1=\"\\\\Drivers\\\\usbmgr.tmp\" wide   \n           $a2=\"\\\\Drivers\\\\usbmgr.sys\" wide   \n           $a3=\"common_loadDriver CreateFile error! \"    \n           $a4=\"common_loadDriver StartService error && GetLastError():%d! \"    \n           $a5=\"irene\" wide   \n           $a6=\"aPLib v0.43 - the smaller the better\"    \n      \n       condition:   \n           ($mz at 0) and (4 of ($a*)) and filesize < 500000   \n   }",
			"type": "YARA",
			"id": 30343329
		},
		{
			"indicator": "ec3305fe30ab612eb12907d72ff7ba3fa3a2fb35",
			"description": "",
			"title": "",
			"content": "rule apt_hellsing_implantstrings   \n   {    \n        \n       meta:   \n           Author = \"Costin Raiu, Kaspersky Lab\"   \n           Date = \"2015-04-07\"   \n           Description = \"detection for Hellsing implants\"   \n           Reference = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"   \n      \n       strings:    \n           $mz=\"MZ\"   \n           $a1=\"the file uploaded failed !\"    \n           $a2=\"ping 127.0.0.1\"         \n           $b1=\"the file downloaded failed !\"    \n           $b2=\"common.asp\"   \n           $c=\"xweber_server.exe\"    \n           $d=\"action=\"   \n           $debugpath1=\"d:\\\\Hellsing\\\\release\\\\msger\\\\\" nocase    \n           $debugpath2=\"d:\\\\hellsing\\\\sys\\\\xrat\\\\\" nocase    \n           $debugpath3=\"D:\\\\Hellsing\\\\release\\\\exe\\\\\" nocase    \n           $debugpath4=\"d:\\\\hellsing\\\\sys\\\\xkat\\\\\" nocase    \n           $debugpath5=\"e:\\\\Hellsing\\\\release\\\\clare\" nocase    \n           $debugpath6=\"e:\\\\Hellsing\\\\release\\\\irene\\\\\" nocase    \n           $debugpath7=\"d:\\\\hellsing\\\\sys\\\\irene\\\\\" nocase   \n           $e=\"msger_server.dll\"   \n           $f=\"ServiceMain\"   \n      \n       condition:   \n           ($mz at 0) and (all of ($a*)) or (all of ($b*)) or ($c and $d) or (any of ($debugpath*)) or ($e and $f) and filesize < 500000   \n   }",
			"type": "YARA",
			"id": 30343330
		},
		{
			"indicator": "af56e300499841cd79ffaaad38cf7c37e82d33d4",
			"description": "",
			"title": "",
			"content": "rule apt_hellsing_xkat    \n   {   \n          \n       meta:   \n           Author = \"Costin Raiu, Kaspersky Lab\"   \n           Date = \"2015-04-07\"   \n           Description = \"detection for Hellsing xKat tool\"   \n           Reference = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"   \n      \n       strings:   \n           $mz=\"MZ\"   \n           $a1=\"\\\\Dbgv.sys\"   \n           $a2=\"XKAT_BIN\"   \n           $a3=\"release sys file error.\"   \n           $a4=\"driver_load error. \"   \n           $a5=\"driver_create error.\"   \n           $a6=\"delete file:%s error.\"   \n           $a7=\"delete file:%s ok.\"   \n           $a8=\"kill pid:%d error.\"   \n           $a9=\"kill pid:%d ok.\"   \n           $a10=\"-pid-delete\"   \n           $a11=\"kill and delete pid:%d error.\"   \n           $a12=\"kill and delete pid:%d ok.\"   \n      \n       condition:   \n           ($mz at 0) and (6 of ($a*)) and filesize < 300000   \n   }",
			"type": "YARA",
			"id": 30343331
		},
		{
			"indicator": "34a841ee90543b1feae10a108255f2d8fef302e8",
			"description": "",
			"title": "",
			"content": "rule apt_hellsing_installer   \n   {   \n          \n       meta:   \n           Author = \"Costin Raiu, Kaspersky Lab\"   \n           Date = \"2015-04-07\"   \n           Description = \"detection for Hellsing xweber/msger installers\"   \n           Reference = \"http://securelist.com/analysis/publications/69567/the-chronicles-of-the-hellsing-apt-the-empire-strikes-back\"    \n      \n       strings:    \n           $mz=\"MZ\"   \n           $cmd=\"cmd.exe /c ping 127.0.0.1 -n 5&cmd.exe /c del /a /f \\\"%s\\\"\"   \n           $a1=\"xweber_install_uac.exe\"   \n           $a2=\"system32\\\\cmd.exe\" wide   \n           $a4=\"S11SWFOrVwR9UlpWRVZZWAR0U1aoBHFTUl2oU1Y=\"    \n           $a5=\"S11SWFOrVwR9dnFTUgRUVlNHWVdXBFpTVgRdUlpWRVZZWARdUqhZVlpFR1kEUVNSXahTVgRaU1YEUVNSXahTVl1SWwRZValdVFFZUqgQBF1SWlZFVllYBFRTVqg=\" $a6=\"7dqm2ODf5N/Y2N/m6+br3dnZpunl44g=\"   \n           $a7=\"vd/m7OXd2ai/5u7a59rr7Ki45drcqMPl5t/c5dqIZw==\"    \n           $a8=\"vd/m7OXd2ai/usPl5qjY2uXp69nZqO7l2qjf5u7a59rr7Kjf5tzr2u7n6euo4+Xm39zl2qju5dqo4+Xm39zl2t/m7ajr19vf2OPr39rj5eaZmqbs5OSI Njl2tyI\" $a9=\"C:\\\\Windows\\\\System32\\\\sysprep\\\\sysprep.exe\" wide    \n           $a10=\"%SystemRoot%\\\\system32\\\\cmd.exe\" wide    \n           $a11=\"msger_install.dll\"   \n           $a12={00 65 78 2E 64 6C 6C 00}   \n      \n       condition:   \n           ($mz at 0) and ($cmd and (2 of ($a*))) and filesize < 500000   \n   }",
			"type": "YARA",
			"id": 30343332
		},
		{
			"indicator": "41269562e0aac3079acdb82eb41e86af93d07bf9",
			"description": "",
			"title": "",
			"content": "rule APT_Hikit_msrv   \n   {   \n      \n   meta:   \n       author = \"ThreatConnect Intelligence Research Team\"   \n      \n   strings:   \n       $m = {6D 73 72 76 2E 64 6C 6C 00 44 6C 6C}   \n      \n   condition:   \n       any of them   \n   }",
			"type": "YARA",
			"id": 30343333
		},
		{
			"indicator": "31fefcd742babf146b115f9f718e092c6ae90eca",
			"description": "",
			"title": "",
			"content": "rule IronTiger_PlugX_DosEmulator   \n   {   \n         \n       meta:   \n           author = \"Cyber Safety Solutions, Trend Micro\"   \n           description = \"Iron Tiger Malware - PlugX DosEmulator\"     \n           reference = \"http://goo.gl/T5fSJC\"   \n         \n       strings:   \n           $str1 = \"Dos Emluator Ver\" nocase wide ascii   \n           $str2 = \"\\\\PIPE\\\\FASTDOS\" nocase wide ascii   \n           $str3 = \"FastDos.cpp\" nocase wide ascii   \n           $str4 = \"fail,error code = %d.\" nocase wide ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and (any of ($str*))   \n   }",
			"type": "YARA",
			"id": 30343334
		},
		{
			"indicator": "9a7198c25ef894746896ba4799f921c5f29578f2",
			"description": "",
			"title": "",
			"content": "rule IronPanda_Malware1    \n   {   \n      \n       meta:   \n           description = \"Iron Panda Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/E4qia9\"   \n           date = \"2015-09-16\"   \n           hash = \"a0cee5822ddf254c254a5a0b7372c9d2b46b088a254a1208cb32f5fe7eca848a\"   \n      \n       strings:   \n           $x1 = \"activedsimp.dll\" fullword wide   \n           $s1 = \"get_BadLoginAddress\" fullword ascii   \n           $s2 = \"get_LastFailedLogin\" fullword ascii   \n           $s3 = \"ADS_UF_ENCRYPTED_TEXT_PASSWORD_ALLOWED\" fullword ascii   \n           $s4 = \"get_PasswordExpirationDate\" fullword ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 300KB and all of them   \n   }",
			"type": "YARA",
			"id": 30343335
		},
		{
			"indicator": "2709d92b5599f69a8628e70c22c387bdb7f86db2",
			"description": "",
			"title": "",
			"content": "rule IronPanda_Malware_Htran    \n   {   \n      \n       meta:   \n           description = \"Iron Panda Malware Htran\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/E4qia9\"   \n           date = \"2015-09-16\"   \n           hash = \"7903f94730a8508e9b272b3b56899b49736740cea5037ea7dbb4e690bcaf00e7\"   \n         \n       strings:   \n           $s1 = \"[-] Gethostbyname(%s) error:%s\" fullword ascii   \n           $s2 = \"%s -<listen|tran|slave> <option> [-log logfile]\" fullword ascii   \n           $s3 = \"-slave <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii   \n           $s4 = \"[-] ERROR: Must supply logfile name.\" fullword ascii   \n           $s5 = \"[SERVER]connection to %s:%d error\" fullword ascii   \n           $s6 = \"[+] Make a Connection to %s:%d....\" fullword ascii   \n           $s7 = \"[+] Waiting another Client on port:%d....\" fullword ascii   \n           $s8 = \"[+] Accept a Client on port %d from %s\" fullword ascii   \n           $s9 = \"[+] Make a Connection to %s:%d ......\" fullword ascii   \n           $s10 = \"cmshared_get_ptr_from_atom\" fullword ascii   \n           $s11 = \"_cmshared_get_ptr_from_atom\" fullword ascii   \n           $s12 = \"[+] OK! I Closed The Two Socket.\" fullword ascii   \n           $s13 = \"[-] TransmitPort invalid.\" fullword ascii   \n           $s14 = \"[+] Waiting for Client on port:%d ......\" fullword ascii   \n         \n       condition:   \n            ( uint16(0) == 0x5a4d and filesize < 125KB and 3 of them ) or 5 of them   \n   }",
			"type": "YARA",
			"id": 30343336
		},
		{
			"indicator": "742a6086beeb0a53b3adbc163eedb74c8e476800",
			"description": "",
			"title": "",
			"content": "rule IronTiger_wmiexec   \n   {   \n        \n       meta:   \n           author = \"Cyber Safety Solutions, Trend Micro\"   \n           description = \"Iron Tiger Tool - wmi.vbs detection\"   \n           reference = \"http://goo.gl/T5fSJC\"   \n        \n       strings:   \n           $str1 = \"Temp Result File , Change it to where you like\" nocase wide ascii   \n           $str2 = \"wmiexec\" nocase wide ascii   \n           $str3 = \"By. Twi1ight\" nocase wide ascii   \n           $str4 = \"[both mode] ,delay TIME to read result\" nocase wide ascii   \n           $str5 = \"such as nc.exe or Trojan\" nocase wide ascii   \n           $str6 = \"+++shell mode+++\" nocase wide ascii   \n           $str7 = \"win2008 fso has no privilege to delete file\" nocase wide ascii   \n        \n       condition:   \n           2 of ($str*)   \n   }",
			"type": "YARA",
			"id": 30343337
		},
		{
			"indicator": "2759507ece51c8d0bbe48635bf27014676230fe4",
			"description": "",
			"title": "",
			"content": "rule IronTiger_HTTPBrowser_Dropper    \n   {   \n         \n       meta:   \n           author = \"Cyber Safety Solutions, Trend Micro\"   \n           description = \"Iron Tiger Malware - HTTPBrowser Dropper\"   \n           reference = \"http://goo.gl/T5fSJC\"   \n         \n       strings:   \n           $str1 = \".dllUT\" nocase wide ascii   \n           $str2 = \".exeUT\" nocase wide ascii   \n           $str3 = \".urlUT\" nocase wide ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and (2 of ($str*))   \n   }",
			"type": "YARA",
			"id": 30343338
		},
		{
			"indicator": "0d6fbc1b8c7f66c1b41dcc8a7c2d149afd937bab",
			"description": "",
			"title": "",
			"content": "rule IronTiger_PlugX_Server   \n   {   \n         \n       meta:   \n           author = \"Cyber Safety Solutions, Trend Micro\"   \n           description = \"Iron Tiger Malware - PlugX Server\"   \n           reference = \"http://goo.gl/T5fSJC\"   \n         \n       strings:   \n           $str1 = \"\\\\UnitFrmManagerKeyLog.pas\" nocase wide ascii   \n           $str2 = \"\\\\UnitFrmManagerRegister.pas\" nocase wide ascii   \n           $str3 = \"Input Name...\" nocase wide ascii   \n           $str4 = \"New Value#\" nocase wide ascii   \n           $str5 = \"TThreadRControl.Execute SEH!!!\" nocase wide ascii   \n           $str6 = \"\\\\UnitFrmRControl.pas\" nocase wide ascii   \n           $str7 = \"OnSocket(event is error)!\" nocase wide ascii   \n           $str8 = \"Make 3F Version Ok!!!\" nocase wide ascii   \n           $str9 = \"PELEASE DO NOT CHANGE THE DOCAMENT\" nocase wide ascii   \n           $str10 = \"Press [Ok] Continue Run, Press [Cancel] Exit\" nocase wide ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and (2 of ($str*))   \n   }",
			"type": "YARA",
			"id": 30343339
		},
		{
			"indicator": "3207bb9b1f6184b5c8c431091ec54bff2a91b681",
			"description": "",
			"title": "",
			"content": "rule IronPanda_Malware2    \n   {   \n      \n       meta:   \n           description = \"Iron Panda Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/E4qia9\"   \n           date = \"2015-09-16\"   \n           hash = \"a89c21dd608c51c4bf0323d640f816e464578510389f9edcf04cd34090decc91\"   \n      \n       strings:   \n           $s0 = \"\\\\setup.exe\" fullword ascii   \n           $s1 = \"msi.dll.urlUT\" fullword ascii   \n           $s2 = \"msi.dllUT\" fullword ascii   \n           $s3 = \"setup.exeUT\" fullword ascii   \n           $s4 = \"/c del /q %s\" fullword ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 180KB and all of them   \n   }",
			"type": "YARA",
			"id": 30343340
		},
		{
			"indicator": "cf31f66bcea941218ee452de48398dab13e1305b",
			"description": "",
			"title": "",
			"content": "rule IronPanda_DNSTunClient    \n   {   \n      \n       meta:   \n           description = \"Iron Panda malware DnsTunClient - file named.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/E4qia9\"   \n           date = \"2015-09-16\"   \n           score = 80   \n           hash = \"a08db49e198068709b7e52f16d00a10d72b4d26562c0d82b4544f8b0fb259431\"   \n      \n       strings:   \n           $s1 = \"dnstunclient -d or -domain <domain>\" fullword ascii   \n           $s2 = \"dnstunclient -ip <server ip address>\" fullword ascii   \n           $s3 = \"C:\\\\Windows\\\\System32\\\\cmd.exe /C schtasks /create /tn \\\"\\\\Microsoft\\\\Windows\\\\PLA\\\\System\\\\Microsoft Windows\\\" /tr \" fullword ascii   \n           $s4 = \"C:\\\\Windows\\\\System32\\\\cmd.exe /C schtasks /create /tn \\\"Microsoft Windows\\\" /tr \" fullword ascii   \n           $s5 = \"taskkill /im conime.exe\" fullword ascii   \n           $s6 = \"\\\\dns control\\\\t-DNSTunnel\\\\DnsTunClient\\\\DnsTunClient.cpp\" fullword ascii   \n           $s7 = \"UDP error:can not bing the port(if there is unclosed the bind process?)\" fullword ascii   \n           $s8 = \"use error domain,set domain pls use -d or -domain mark(Current: %s,recv %s)\" fullword ascii   \n           $s9 = \"error: packet num error.the connection have condurt,pls try later\" fullword ascii   \n           $s10 = \"Coversation produce one error:%s,coversation fail\" fullword ascii   \n           $s11 = \"try to add many same pipe to select group(or mark is too easy).\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 400KB and 2 of them ) or 5 of them   \n   }",
			"type": "YARA",
			"id": 30343341
		},
		{
			"indicator": "070be7338df67a96e1a0a1cb0dd30a122b65c462",
			"description": "",
			"title": "",
			"content": "rule IronTiger_HTTP_SOCKS_Proxy_soexe   \n   {   \n         \n       meta:   \n           author = \"Cyber Safety Solutions, Trend Micro\"   \n           description = \"Iron Tiger Toolset - HTTP SOCKS Proxy soexe\"   \n           reference = \"http://goo.gl/T5fSJC\"   \n         \n       strings:   \n           $str1 = \"listen SOCKET error.\" nocase wide ascii   \n           $str2 = \"WSAAsyncSelect SOCKET error.\" nocase wide ascii   \n           $str3 = \"new SOCKETINFO error!\" nocase wide ascii   \n           $str4 = \"Http/1.1 403 Forbidden\" nocase wide ascii   \n           $str5 = \"Create SOCKET error.\" nocase wide ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and (3 of ($str*))   \n   }",
			"type": "YARA",
			"id": 30343342
		},
		{
			"indicator": "885b3458b89246705e08f57fab6333959341d87c",
			"description": "",
			"title": "",
			"content": "rule IronPanda_Malware3    \n   {   \n      \n       meta:   \n           description = \"Iron Panda Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/E4qia9\"   \n           date = \"2015-09-16\"   \n           hash = \"5cd2af844e718570ae7ba9773a9075738c0b3b75c65909437c43201ce596a742\"   \n      \n       strings:   \n           $s0 = \"PluginDeflater.exe\" fullword wide   \n           $s1 = \".Deflated\" fullword wide   \n           $s2 = \"PluginDeflater\" fullword ascii   \n           $s3 = \"DeflateStream\" fullword ascii /* Goodware String - occured 1 times */   \n           $s4 = \"CompressionMode\" fullword ascii /* Goodware String - occured 4 times */   \n           $s5 = \"System.IO.Compression\" fullword ascii /* Goodware String - occured 6 times */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 10KB and all of them   \n   }",
			"type": "YARA",
			"id": 30343343
		},
		{
			"indicator": "329aee4161d906a08ab8f4c80dc65d834b21a072",
			"description": "",
			"title": "",
			"content": "rule IronTiger_ASPXSpy   \n   {   \n          \n       meta:   \n           author = \"Cyber Safety Solutions, Trend Micro\"   \n           description = \"ASPXSpy detection. It might be used by other fraudsters\"   \n           reference = \"http://goo.gl/T5fSJC\"   \n         \n       strings:   \n           $str1 = \"ASPXSpy\" nocase wide ascii   \n           $str2 = \"IIS Spy\" nocase wide ascii   \n           $str3 = \"protected void DGCoW(object sender,EventArgs e)\" nocase wide ascii   \n          \n       condition:   \n           any of ($str*)   \n   }",
			"type": "YARA",
			"id": 30343344
		},
		{
			"indicator": "c0e25dad74c05773862772d5262424c1f4e3f0df",
			"description": "",
			"title": "",
			"content": "rule IronPanda_Webshell_JSP    \n   {   \n      \n       meta:   \n           description = \"Iron Panda Malware JSP\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/E4qia9\"   \n           date = \"2015-09-16\"   \n           hash = \"3be95477e1d9f3877b4355cff3fbcdd3589bb7f6349fd4ba6451e1e9d32b7fa6\"   \n        \n       strings:   \n           $s1 = \"Bin_ExecSql(\\\"exec master..xp_cmdshell'bcp \\\\\\\"select safile from \\\" + db + \\\"..bin_temp\\\\\\\" queryout \\\\\\\"\\\" + Bin_TextBox_SaveP\" ascii   \n           $s2 = \"tc.Text=\\\"<a href=\\\\\\\"javascript:Bin_PostBack('zcg_ClosePM','\\\"+Bin_ToBase64(de.Key.ToString())+\\\"')\\\\\\\">Close</a>\\\";\" fullword ascii   \n           $s3 = \"Bin_ExecSql(\\\"IF OBJECT_ID('bin_temp')IS NOT NULL DROP TABLE bin_temp\\\");\" fullword ascii   \n        \n       condition:   \n           filesize < 330KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30343345
		},
		{
			"indicator": "0f0e485ba0a2ecc5dad45107aa67255c3bbd0c2d",
			"description": "",
			"title": "",
			"content": "rule IronTiger_GetUserInfo   \n   {   \n          \n       meta:   \n           author = \"Cyber Safety Solutions, Trend Micro\"   \n           description = \"Iron Tiger Malware - GetUserInfo\"   \n           reference = \"http://goo.gl/T5fSJC\"   \n          \n       strings:   \n           $str1 = \"getuserinfo username\" nocase wide ascii   \n           $str2 = \"joe@joeware.net\" nocase wide ascii   \n           $str3 = \"If . specified for userid,\" nocase wide ascii   \n          \n       condition:   \n           uint16(0) == 0x5a4d and (any of ($str*))   \n   }",
			"type": "YARA",
			"id": 30343346
		},
		{
			"indicator": "4c25bc00ebe9e5e1ecaf16c5584e06ce3beebb4e",
			"description": "",
			"title": "",
			"content": "rule IronPanda_Malware4    \n   {   \n      \n       meta:   \n           description = \"Iron Panda Malware\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/E4qia9\"   \n           date = \"2015-09-16\"   \n           hash = \"0d6da946026154416f49df2283252d01ecfb0c41c27ef3bc79029483adc2240c\"   \n      \n       strings:   \n           $s0 = \"TestPlugin.dll\" fullword wide   \n           $s1 = \"<a href='http://www.baidu.com'>aasd</a>\" fullword wide   \n           $s2 = \"Zcg.Test.AspxSpyPlugins\" fullword ascii   \n           $s6 = \"TestPlugin\" fullword ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 10KB and all of them   \n   }",
			"type": "YARA",
			"id": 30343347
		},
		{
			"indicator": "f26b6d53c9f2ecf9a9e7d3d5cb9d668919370e23",
			"description": "",
			"title": "",
			"content": "rule rtf_Kaba_jDoe   \n   {   \n      \n   meta:   \n       author = \"@patrickrolsen\"   \n       maltype = \"APT.Kaba\"   \n       filetype = \"RTF\"   \n       version = \"0.1\"   \n       description = \"fe439af268cd3de3a99c21ea40cf493f, d0e0e68a88dce443b24453cc951cf55f, b563af92f144dea7327c9597d9de574e, and def0c9a4c732c3a1e8910db3f9451620\"   \n       date = \"2013-12-10\"   \n      \n   strings:   \n       $magic1 = { 7b 5c 72 74 30 31 } // {\\rt01   \n       $magic2 = { 7b 5c 72 74 66 31 } // {\\rtf1   \n       $magic3 = { 7b 5c 72 74 78 61 33 } // {\\rtxa3   \n       $author1 = { 4A 6F 68 6E 20 44 6F 65 } // \"John Doe\"   \n       $author2 = { 61 75 74 68 6f 72 20 53 74 6f 6e 65 } // \"author Stone\"   \n       $string1 = { 44 30 [16] 43 46 [23] 31 31 45 }   \n      \n   condition:   \n       ($magic1 or $magic2 or $magic3 at 0) and all of ($author*) and $string1   \n   }",
			"type": "YARA",
			"id": 30343368
		},
		{
			"indicator": "c3f27098e7fc4f3b7dcbd77b0f6e14037329029e",
			"description": "",
			"title": "",
			"content": "rule TidePool_Malware   \n   {   \n      \n       meta:   \n           description = \"Detects TidePool malware mentioned in Ke3chang report by Palo Alto Networks\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/m2CXWR\"   \n           date = \"2016-05-24\"   \n           hash1 = \"9d0a47bdf00f7bd332ddd4cf8d95dd11ebbb945dda3d72aac512512b48ad93ba\"   \n           hash2 = \"67c4e8ab0f12fae7b4aeb66f7e59e286bd98d3a77e5a291e8d58b3cfbc1514ed\"   \n           hash3 = \"2252dcd1b6afacde3f94d9557811bb769c4f0af3cb7a48ffe068d31bb7c30e18\"   \n           hash4 = \"38f2c86041e0446730479cdb9c530298c0c4936722975c4e7446544fd6dcac9f\"   \n           hash5 = \"9d0a47bdf00f7bd332ddd4cf8d95dd11ebbb945dda3d72aac512512b48ad93ba\"   \n      \n       strings:   \n           $x1 = \"Content-Disposition: form-data; name=\\\"m1.jpg\\\"\" fullword ascii   \n           $x2 = \"C:\\\\PROGRA~2\\\\IEHelper\\\\mshtml.dll\" fullword wide   \n           $x3 = \"C:\\\\DOCUME~1\\\\ALLUSE~1\\\\IEHelper\\\\mshtml.dll\" fullword wide   \n           $x4 = \"IEComDll.dat\" fullword ascii   \n           $s1 = \"Content-Type: multipart/form-data; boundary=----=_Part_%x\" fullword wide   \n           $s2 = \"C:\\\\Windows\\\\System32\\\\rundll32.exe\" fullword wide   \n           $s3 = \"network.proxy.socks_port\\\", \" fullword ascii   \n          \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 200KB and ( 1 of ($x*) ) ) or ( 4 of them )   \n   }",
			"type": "YARA",
			"id": 30343373
		},
		{
			"indicator": "f29968c1c8ba83a843620b1a32ba257e1edf761b",
			"description": "",
			"title": "",
			"content": "rule new_keyboy_header_codes   \n   {   \n      \n       meta:   \n           author = \"Matt Brooks, @cmatthewbrooks\"   \n           desc = \"Matches the 2016 sample's header codes\"   \n           date = \"2016-08-28\"   \n           md5 = \"495adb1b9777002ecfe22aaf52fcee93\"   \n      \n       strings:   \n           $s1 = \"*l*\" wide fullword   \n           $s2 = \"*a*\" wide fullword   \n           $s3 = \"*s*\" wide fullword   \n           $s4 = \"*d*\" wide fullword   \n           $s5 = \"*f*\" wide fullword   \n           $s6 = \"*g*\" wide fullword   \n           $s7 = \"*h*\" wide fullword   \n      \n       condition:   \n           //MZ header //PE signature   \n           uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and filesize < 200KB and all of them   \n   }",
			"type": "YARA",
			"id": 30343527
		},
		{
			"indicator": "7fdd37ed88229561b0b40e78458ec8bdc9f0ea12",
			"description": "",
			"title": "",
			"content": "rule EliseLotusBlossom   \n   {   \n      \n   meta:   \n       author = \"Jose Ramon Palanco\"   \n       date = \"2015-06-23\"   \n       description = \"Elise Backdoor Trojan\"   \n       ref = \"https://www.paloaltonetworks.com/resources/research/unit42-operation-lotus-blossom.html\"   \n      \n   strings:   \n       $magic = { 4d 5a }   \n       $s1 = \"\\\",Update\" wide   \n       $s2 = \"LoaderDLL.dll\"   \n       $s3 = \"Kernel32.dll\"   \n       $s4 = \"{5947BACD-63BF-4e73-95D7-0C8A98AB95F2}\"   \n       $s5 = \"\\\\Network\\\\\" wide   \n       $s6 = \"0SSSSS\"   \n       $s7 = \"441202100205\"   \n       $s8 = \"0WWWWW\"   \n      \n   condition:   \n       $magic at 0 and all of ($s*)       \n   }",
			"type": "YARA",
			"id": 30344828
		},
		{
			"indicator": "1cb3f2f549f653336273b4bce3403e8c541cf556",
			"description": "",
			"title": "",
			"content": "rule MiniDionis_readerView    \n   {   \n      \n       meta:   \n           description = \"MiniDionis Malware - file readerView.exe / adobe.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950\"   \n           date = \"2015-07-20\"   \n           /* Original Hash */   \n           hash1 = \"ee5eb9d57c3611e91a27bb1fc2d0aaa6bbfa6c69ab16e65e7123c7c49d46f145\"   \n           /* Derived Samples */   \n           hash2 = \"a713982d04d2048a575912a5fc37c93091619becd5b21e96f049890435940004\"   \n           hash3 = \"88a40d5b679bccf9641009514b3d18b09e68b609ffaf414574a6eca6536e8b8f\"   \n           hash4 = \"97d8725e39d263ed21856477ed09738755134b5c0d0b9ae86ebb1cdd4cdc18b7\"   \n           hash5 = \"ed7abf93963395ce9c9cba83a864acb4ed5b6e57fd9a6153f0248b8ccc4fdb46\"   \n           hash6 = \"56ac764b81eb216ebed5a5ad38e703805ba3e1ca7d63501ba60a1fb52c7ebb6e\"   \n      \n       strings:   \n           $s1 = \"%ws_out%ws\" fullword wide /* score: '8.00' */   \n           $s2 = \"dnlibsh\" fullword ascii /* score: '7.00' */   \n      \n           $op0 = { 0f b6 80 68 0e 41 00 0b c8 c1 e1 08 0f b6 c2 8b } /* Opcode */   \n           $op1 = { 8b ce e8 f8 01 00 00 85 c0 74 41 83 7d f8 00 0f } /* Opcode */   \n           $op2 = { e8 2f a2 ff ff 83 20 00 83 c8 ff 5f 5e 5d c3 55 } /* Opcode */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 500KB and all of ($s*) and 1 of ($op*)   \n   }",
			"type": "YARA",
			"id": 30345361
		},
		{
			"indicator": "b670db96a4d4ac687063bbcebc089ca3a4045bc6",
			"description": "",
			"title": "",
			"content": "rule Malicious_SFX1    \n   {   \n      \n       meta:   \n           description = \"SFX with voicemail content\"   \n           author = \"Florian Roth\"   \n           reference = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950\"   \n           date = \"2015-07-20\"   \n           hash = \"c0675b84f5960e95962d299d4c41511bbf6f8f5f5585bdacd1ae567e904cb92f\"   \n         \n       strings:   \n           $s0 = \"voicemail\" ascii /* PEStudio Blacklist: strings */ /* score: '30.00' */   \n           $s1 = \".exe\" ascii   \n         \n       condition:   \n           uint16(0) == 0x4b50 and filesize < 1000KB and $s0 in (3..80) and $s1 in (3..80)    \n   }",
			"type": "YARA",
			"id": 30345362
		},
		{
			"indicator": "fd93a24a91e522d4aa3f1436a8400d5e6a5111f5",
			"description": "",
			"title": "",
			"content": "rule Malicious_SFX2    \n   {   \n      \n       meta:   \n           description = \"SFX with adobe.exe content\"   \n           author = \"Florian Roth\"   \n           reference = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950\"   \n           date = \"2015-07-20\"   \n           hash = \"502e42dc99873c52c3ca11dd3df25aad40d2b083069e8c22dd45da887f81d14d\"   \n      \n       strings:   \n           $s1 = \"adobe.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '27.00' */   \n           $s2 = \"Extracting files to %s folder$Extracting files to temporary folder\" fullword wide /* PEStudio Blacklist: strings */ /* score: '26.00' */   \n           $s3 = \"GETPASSWORD1\" fullword wide /* PEStudio Blacklist: strings */ /* score: '23.00' */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 1000KB and all of them   \n   }",
			"type": "YARA",
			"id": 30345363
		},
		{
			"indicator": "0c4f4af0bb1fb309c83b98042d62676f14f2f9d1",
			"description": "",
			"title": "",
			"content": "rule MiniDionis_VBS_Dropped    \n   {   \n      \n       meta:   \n           description = \"Dropped File - 1.vbs\"   \n           author = \"Florian Roth\"   \n           reference = \"https://malwr.com/analysis/ZDc4ZmIyZDI4MTVjNGY5NWI0YzE3YjIzNGFjZTcyYTY/\"   \n           date = \"2015-07-21\"   \n           hash = \"97dd1ee3aca815eb655a5de9e9e8945e7ba57f458019be6e1b9acb5731fa6646\"   \n      \n       strings:   \n           $s1 = \"Wscript.Sleep 5000\" ascii   \n           $s2 = \"Set FSO = CreateObject(\\\"Scripting.FileSystemObject\\\")\" ascii   \n           $s3 = \"Set WshShell = CreateObject(\\\"WScript.Shell\\\")\" ascii   \n           $s4 = \"If(FSO.FileExists(\\\"\" ascii   \n           $s5 = \"then FSO.DeleteFile(\\\".\\\\\" ascii   \n      \n       condition:   \n           filesize < 1KB and all of them and $s1 in (0..40)   \n   }",
			"type": "YARA",
			"id": 30345364
		},
		{
			"indicator": "6f66604a91fa4ea45bde27ef2dc8250b5f82b27c",
			"description": "",
			"title": "",
			"content": "rule Mirage_APT   \n   {   \n       meta:   \n           Author      = \"Silas Cutler\"   \n           Date        = \"yyyy/mm/dd\"   \n           Description = \"Malware related to APT campaign\"   \n           Reference   = \"Useful link\"   \n          \n       strings:   \n           $a1 = \"welcome to the desert of the real\"   \n           $a2 = \"Mirage\"   \n           $b = \"Encoding: gzip\"   \n           $c = /\\/[A-Za-z]*\\?hl=en/   \n      \n       condition:    \n           (($a1 or $a2) or $b) and $c   \n   }",
			"type": "YARA",
			"id": 30345374
		},
		{
			"indicator": "908f0e4780b37cdd271422bc96c5b6169df9b197",
			"description": "",
			"title": "",
			"content": "rule MirageStrings   \n   {   \n       meta:   \n           description = \"Mirage Identifying Strings\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-06-25\"   \n              \n       strings:   \n           $ = \"Neo,welcome to the desert of real.\" wide ascii   \n           $ = \"/result?hl=en&id=%s\"   \n              \n       condition:   \n          any of them   \n   }",
			"type": "YARA",
			"id": 30345375
		},
		{
			"indicator": "297fad3fa08886c7bf82a5f8e62ed63b351a9301",
			"description": "",
			"title": "",
			"content": "rule MongalCode   \n   {   \n       meta:   \n           description = \"Mongal code features\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-07-15\"   \n          \n       strings:   \n           // gettickcount value checking   \n           $ = { 8B C8 B8 D3 4D 62 10 F7 E1 C1 EA 06 2B D6 83 FA 05 76 EB }   \n              \n       condition:   \n           any of them   \n   }",
			"type": "YARA",
			"id": 30345376
		},
		{
			"indicator": "e6f52bd14e636af456cfc5a6217d3c20ce4fed55",
			"description": "",
			"title": "",
			"content": "rule Backdoor_APT_Mongal   \n   {   \n      \n       meta:   \n           author = \"@patrickrolsen\"   \n           maltype = \"Backdoor.APT.Mongall\"   \n           version = \"0.1\"   \n           reference = \"fd69a799e21ccb308531ce6056944842\"    \n           date = \"01/04/2014\"   \n          \n       strings:   \n           $author  = \"author user\"   \n           $title   = \"title Vjkygdjdtyuj\" nocase   \n           $comp    = \"company ooo\"   \n           $cretime = \"creatim\\\\yr2012\\\\mo4\\\\dy19\\\\hr15\\\\min10\"   \n           $passwd  = \"password 00000000\"   \n          \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345377
		},
		{
			"indicator": "df276dcd7c39f69ff80c68f788e88211d366f1fd",
			"description": "",
			"title": "",
			"content": "rule MongalStrings   \n   {   \n          \n       meta:   \n           description = \"Mongal Identifying Strings\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-07-15\"   \n              \n       strings:   \n           $ = \"NSCortr.dll\"   \n           $ = \"NSCortr1.dll\"   \n           $ = \"Sina.exe\"   \n              \n       condition:   \n           any of them   \n   }",
			"type": "YARA",
			"id": 30345378
		},
		{
			"indicator": "f7974491ff62a3a572d5c5ee30e5d7b7ef82ac32",
			"description": "",
			"title": "",
			"content": "rule loki2crypto {   \n      \n   meta:   \n   \t   \n   \tauthor = \"Costin Raiu, Kaspersky Lab\"   \n   \tdate = \"2017-03-21\"   \n   \tversion = \"1.0\"   \n   \tdescription = \"Rule to detect hardcoded DH modulus used in 1996/1997 Loki2 sourcecode; #ifdef STRONG_CRYPTO /* 384-bit strong prime */\"   \n   \treference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"   \n   \thash = \"19fbd8cbfb12482e8020a887d6427315\"   \n   \thash = \"ea06b213d5924de65407e8931b1e4326\"   \n   \thash = \"14ecd5e6fc8e501037b54ca263896a11\"   \n   \thash = \"e079ec947d3d4dacb21e993b760a65dc\"   \n   \thash = \"edf900cebb70c6d1fcab0234062bfc28\"   \n      \n   strings:   \n      \n   \t$modulus={DA E1 01 CD D8 C9 70 AF C2 E4 F2 7A 41 8B 43 39 52 9B 4B 4D E5 85 F8 49}   \n      \n   condition:   \n      \n   \t(any of them)   \n      \n   }",
			"type": "YARA",
			"id": 30345381
		},
		{
			"indicator": "331fc928053b262f42ac9e2367fb818709161862",
			"description": "",
			"title": "",
			"content": "rule LoggerModule   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"%s-%02d%02d%02d%02d%02d.r\"   \n       $s2 = \"C:\\\\Users\\\\%s\\\\AppData\\\\Cookies\\\\\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345413
		},
		{
			"indicator": "bf6e9353d018cad66aad9bd66897b14eb1ba08e0",
			"description": "",
			"title": "",
			"content": "rule wndTest   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"[Alt]\" wide   \n       $s2 = \"<< %s >>:\" wide   \n       $s3 = \"Content-Disposition: inline; comp=%s; account=%s; product=%d;\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345414
		},
		{
			"indicator": "d5195bff38bce49834f0d041852e6b5811b14e10",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_Parviz_Developer   \n   {   \n      \n       meta:   \n           description = \"Parviz developer known from Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Florian Roth\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"Users\\\\parviz\\\\documents\\\\\" nocase   \n      \n       condition:   \n           $s1   \n   }",
			"type": "YARA",
			"id": 30345415
		},
		{
			"indicator": "8741a7616a292928fcac1f4a9d553bed35c742b4",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_zhmimikatz   \n   {   \n      \n       meta:   \n           description = \"Mimikatz wrapper used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"MimikatzRunner\"   \n           $s2 = \"zhmimikatz\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345416
		},
		{
			"indicator": "8a36897f0e2d7574aa73d9836075dfeae4f4bce9",
			"description": "",
			"title": "",
			"content": "rule pvz_out   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"Network Connectivity Module\" wide   \n       $s2 = \"OSPPSVC\" wide   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345417
		},
		{
			"indicator": "e7ee4311a20e943d659706796873da60bcb09589",
			"description": "",
			"title": "",
			"content": "rule zhLookUp   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"zhLookUp.Properties\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345418
		},
		{
			"indicator": "8c60b0ac193b9847258400b71f7a0aa5444a7d01",
			"description": "",
			"title": "",
			"content": "rule NetC   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"NetC.exe\" wide   \n       $s2 = \"Net Service\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345419
		},
		{
			"indicator": "c04e5505f606bfdba42a423509481be306aa0680",
			"description": "",
			"title": "",
			"content": "rule csext   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"COM+ System Extentions\"   \n       $s2 = \"csext.exe\"   \n       $s3 = \"COM_Extentions_bin\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345420
		},
		{
			"indicator": "ce1934c55a62a5faeec398bca31c0c7b836dc8ff",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_LoggerModule   \n   {   \n      \n       meta:   \n           description = \"Keylogger used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"%s-%02d%02d%02d%02d%02d.r\"   \n           $s2 = \"C:\\\\Users\\\\%s\\\\AppData\\\\Cookies\\\\\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345421
		},
		{
			"indicator": "567fb3a9a9a3092022e870ff5466039209eb3b74",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_SmartCopy2   \n   {   \n      \n       meta:   \n           description = \"Malware or hack tool used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"SmartCopy2.Properties\"   \n           $s2 = \"ZhuFrameWork\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345422
		},
		{
			"indicator": "53e73409b898f408926de44fd24a35f193cfb1f7",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_Jasus   \n   {   \n      \n       meta:   \n           description = \"ARP cache poisoner used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"pcap_dump_open\"   \n           $s2 = \"Resolving IPs to poison...\"   \n           $s3 = \"WARNNING: Gateway IP can not be found\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345423
		},
		{
			"indicator": "214be72aabe2b8015f03694cb2f53b275c3cd5cf",
			"description": "",
			"title": "",
			"content": "rule SynFlooder   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"Unable to resolve [ %s ]. ErrorCode %d\"   \n       $s2 = \"your target's IP is : %s\"   \n       $s3 = \"Raw TCP Socket Created successfully.\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345424
		},
		{
			"indicator": "e33d500fc2a65e85f9035e0ddbbdc049333978ad",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_CCProxy_Config   \n   {   \n      \n       meta:   \n           description = \"CCProxy config known from Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Florian Roth\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"UserName=User-001\" fullword ascii   \n           $s2 = \"Web=1\" fullword ascii   \n           $s3 = \"Mail=1\" fullword ascii   \n           $s4 = \"FTP=0\" fullword ascii   \n           $x1 = \"IPAddressLow=78.109.194.114\" fullword ascii   \n      \n       condition:   \n           all of ($s*) or $x1   \n   }",
			"type": "YARA",
			"id": 30345425
		},
		{
			"indicator": "7bbf1d56bcd4fdb01757bcad877ad940499a2555",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_BackDoorLogger   \n   {   \n      \n       meta:   \n           description = \"Keylogger used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"BackDoorLogger\"   \n           $s2 = \"zhuAddress\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345426
		},
		{
			"indicator": "ce9dc96b229b5274f626d6c7c95496f496413b42",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_pvz_out   \n   {   \n      \n       meta:   \n           description = \"Parviz tool used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"Network Connectivity Module\" wide   \n           $s2 = \"OSPPSVC\" wide   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345427
		},
		{
			"indicator": "21e099b2a9a7f01e3d4f18ae98d5c5efdc3eec89",
			"description": "",
			"title": "",
			"content": "rule Jasus   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"pcap_dump_open\"   \n       $s2 = \"Resolving IPs to poison...\"   \n       $s3 = \"WARNNING: Gateway IP can not be found\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345428
		},
		{
			"indicator": "e05f6cb5e0fc074884249bc30243dfe5ff1acca3",
			"description": "",
			"title": "",
			"content": "rule pvz_in   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"LAST_TIME=00/00/0000:00:00PM$\"   \n       $s2 = \"if %%ERRORLEVEL%% == 1 GOTO line\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345429
		},
		{
			"indicator": "e262baa35af7f9ec16d59dbad618557b47165468",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_antivirusdetector   \n   {   \n      \n       meta:   \n           description = \"Hack tool used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"getShadyProcess\"   \n           $s2 = \"getSystemAntiviruses\"   \n           $s3 = \"AntiVirusDetector\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345430
		},
		{
			"indicator": "86a1fc7eab2e17ec5168a5447cb8eb4f281c080f",
			"description": "",
			"title": "",
			"content": "rule BackDoorLogger   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"BackDoorLogger\"   \n       $s2 = \"zhuAddress\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345431
		},
		{
			"indicator": "65612e632520f00eb4d0b1a5cc57b57ffdee27ca",
			"description": "",
			"title": "",
			"content": "rule TinyZBot   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"NetScp\" wide   \n       $s2 = \"TinyZBot.Properties.Resources.resources\"   \n       $s3 = \"Aoao WaterMark\"   \n       $s4 = \"Run_a_exe\"   \n       $s5 = \"netscp.exe\"   \n       $s6 = \"get_MainModule_WebReference_DefaultWS\"   \n       $s7 = \"remove_CheckFileMD5Completed\"   \n       $s8 = \"http://tempuri.org/\"   \n       $s9 = \"Zhoupin_Cleaver\"   \n      \n     condition:   \n       ($s1 and $s2) or ($s3 and $s4 and $s5) or ($s6 and $s7 and $s8) or ($s9)   \n   }",
			"type": "YARA",
			"id": 30345432
		},
		{
			"indicator": "814370636138667e790e6f87864a4b5570099870",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_NetC   \n   {   \n      \n       meta:   \n           description = \"Net Crawler used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"NetC.exe\" wide   \n           $s2 = \"Net Service\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345433
		},
		{
			"indicator": "8befd724be5f89be575f905752350b56ee867105",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_wndTest   \n   {   \n      \n       meta:   \n           description = \"Backdoor used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"[Alt]\" wide   \n           $s2 = \"<< %s >>:\" wide   \n           $s3 = \"Content-Disposition: inline; comp=%s; account=%s; product=%d;\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345434
		},
		{
			"indicator": "1c1ff570c53f94e86e5b3fc9564ce4c7f69df67d",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_ShellCreator2   \n   {   \n      \n       meta:   \n           description = \"Shell Creator used by attackers in Operation Cleaver to create ASPX web shells\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"ShellCreator2.Properties\"   \n           $s2 = \"set_IV\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345435
		},
		{
			"indicator": "6fd49ad47b940754713aa0e2de79a2a434c5c0dc",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_SynFlooder   \n   {   \n      \n       meta:   \n           description = \"Malware or hack tool used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"Unable to resolve [ %s ]. ErrorCode %d\"   \n           $s2 = \"your targets IP is : %s\"   \n           $s3 = \"Raw TCP Socket Created successfully.\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345436
		},
		{
			"indicator": "53a124296f61d9fa143e5dbadbfc8cff2e92b9c0",
			"description": "",
			"title": "",
			"content": "rule antivirusdetector   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n       strings:   \n           $s1 = \"getShadyProcess\"   \n           $s2 = \"getSystemAntiviruses\"   \n           $s3 = \"AntiVirusDetector\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345437
		},
		{
			"indicator": "9290b164b4da8ae68b4b260ff2e976060de77b48",
			"description": "",
			"title": "",
			"content": "rule zhmimikatz   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"MimikatzRunner\"   \n       $s2 = \"zhmimikatz\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345438
		},
		{
			"indicator": "c747c7ae4dc63695098151cb977642fb13be3eb0",
			"description": "",
			"title": "",
			"content": "rule ShellCreator2   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"ShellCreator2.Properties\"   \n       $s2 = \"set_IV\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345439
		},
		{
			"indicator": "091e89e1849b09eada2f0a93a6993a2075b0a307",
			"description": "",
			"title": "",
			"content": "rule SmartCopy2   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"SmartCopy2.Properties\"   \n       $s2 = \"ZhuFrameWork\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345440
		},
		{
			"indicator": "3f036e2b9a42be7a75f9dadcd2eefcf08b007a25",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_zhCat   \n   {   \n      \n       meta:   \n           description = \"Network tool used by Iranian hackers and used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"Mozilla/4.0 ( compatible; MSIE 7.0; AOL 8.0 )\" ascii fullword   \n           $s2 = \"ABC ( A Big Company )\" wide fullword   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345441
		},
		{
			"indicator": "d8e72b8dba98edf983ea0926b3776c5f4adba6ef",
			"description": "",
			"title": "",
			"content": "rule Zh0uSh311   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"Zh0uSh311\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345442
		},
		{
			"indicator": "3b62196e94f333261960f2f34b44b6122bcb4b6c",
			"description": "",
			"title": "",
			"content": "rule kagent   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"kill command is in last machine, going back\"   \n       $s2 = \"message data length in B64: %d Bytes\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345443
		},
		{
			"indicator": "880b1a95d97c1aa841486ac0a90aecf2bf37e06d",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_kagent   \n   {   \n      \n       meta:   \n           description = \"Backdoor used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"kill command is in last machine, going back\"   \n           $s2 = \"message data length in B64: %d Bytes\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345444
		},
		{
			"indicator": "a271066ea88fdd6aa82f35adb04811ede85594be",
			"description": "",
			"title": "",
			"content": "rule zhCat   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"zhCat -l -h -tp 1234\"   \n       $s2 = \"ABC ( A Big Company )\" wide   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345445
		},
		{
			"indicator": "d7a3f481e45a17cf18036edb586da6c4af4de9d7",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_mimikatzWrapper   \n   {   \n      \n       meta:   \n           description = \"Mimikatz Wrapper used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"mimikatzWrapper\"   \n           $s2 = \"get_mimikatz\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345446
		},
		{
			"indicator": "940081406f0f4f7242c0ae4ff992f4562d87b215",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_ZhoupinExploitCrew   \n   {   \n      \n       meta:   \n           description = \"Keywords used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"zhoupin exploit crew\" nocase   \n           $s2 = \"zhopin exploit crew\" nocase   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30345447
		},
		{
			"indicator": "fb490b0f76e0382303f2768af1a50c213a5b0328",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_csext   \n   {   \n      \n       meta:   \n           description = \"Backdoor used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"COM+ System Extentions\"   \n           $s2 = \"csext.exe\"   \n           $s3 = \"COM_Extentions_bin\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345448
		},
		{
			"indicator": "246497edf31bd02042685803ff2dc1814b4054cd",
			"description": "",
			"title": "",
			"content": "rule mimikatzWrapper : Toolkit   \n   {   \n      \n     meta:   \n       author = \"Cylance\"   \n       date = \"2014-12-02\"   \n       description = \"http://cylance.com/opcleaver\"   \n      \n     strings:   \n       $s1 = \"mimikatzWrapper\"   \n       $s2 = \"get_mimikatz\"   \n      \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30345449
		},
		{
			"indicator": "457f1a2c29a72576e38f523413593f3ac7944d13",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_pvz_in   \n   {   \n      \n       meta:   \n           description = \"Parviz tool used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"LAST_TIME=00/00/0000:00:00PM$\"   \n           $s2 = \"if %%ERRORLEVEL%% == 1 GOTO line\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345450
		},
		{
			"indicator": "1315fe47e2a326258ca2bb0139a7d13735d46fce",
			"description": "",
			"title": "",
			"content": "rule OPCLEAVER_TinyZBot   \n   {   \n      \n       meta:   \n           description = \"Tiny Bot used by attackers in Operation Cleaver\"   \n           reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"   \n           date = \"2014/12/02\"   \n           author = \"Cylance Inc.\"   \n           score = \"70\"   \n      \n       strings:   \n           $s1 = \"NetScp\" wide   \n           $s2 = \"TinyZBot.Properties.Resources.resources\"   \n           $s3 = \"Aoao WaterMark\"   \n           $s4 = \"Run_a_exe\"   \n           $s5 = \"netscp.exe\"   \n           $s6 = \"get_MainModule_WebReference_DefaultWS\"   \n           $s7 = \"remove_CheckFileMD5Completed\"   \n           $s8 = \"http://tempuri.org/\"   \n           $s9 = \"Zhoupin_Cleaver\"   \n      \n       condition:   \n           (($s1 and $s2) or ($s3 and $s4 and $s5) or ($s6 and $s7 and $s8) or $s9)   \n   }",
			"type": "YARA",
			"id": 30345451
		},
		{
			"indicator": "250a0e3c1415085f0dbf4643e3d59c52150c57b2",
			"description": "",
			"title": "",
			"content": "rule OilRig_Malware_Campaign_Gen3    \n   {   \n      \n      meta:   \n         description = \"Detects malware from OilRig Campaign\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/QMRZ8K\"   \n         date = \"2016-10-12\"   \n         hash1 = \"5e9ddb25bde3719c392d08c13a295db418d7accd25d82d020b425052e7ba6dc9\"   \n         hash2 = \"bd0920c8836541f58e0778b4b64527e5a5f2084405f73ee33110f7bc189da7a9\"   \n         hash3 = \"90639c7423a329e304087428a01662cc06e2e9153299e37b1b1c90f6d0a195ed\"   \n      \n      strings:   \n         $x1 = \"source code from https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.htmlrrrr\" fullword ascii   \n         $x2 = \"\\\\Libraries\\\\fireueye.vbs\" fullword ascii   \n         $x3 = \"\\\\Libraries\\\\fireeye.vbs&\" fullword wide   \n      \n      condition:   \n         ( uint16(0) == 0xcfd0 and filesize < 100KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30345452
		},
		{
			"indicator": "675ed58adcfdf26bed82773d5a60454b6be930fa",
			"description": "",
			"title": "",
			"content": "rule OilRig_Malware_Campaign_Gen2    \n   {   \n      \n      meta:   \n         description = \"Detects malware from OilRig Campaign\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/QMRZ8K\"   \n         date = \"2016-10-12\"   \n         hash1 = \"c6437f57a8f290b5ec46b0933bfa8a328b0cb2c0c7fbeea7f21b770ce0250d3d\"   \n         hash2 = \"293522e83aeebf185e653ac279bba202024cedb07abc94683930b74df51ce5cb\"   \n      \n      strings:   \n         $s1 = \"%userprofile%\\\\AppData\\\\Local\\\\Microsoft\\\\ \" fullword ascii   \n         $s2 = \"$fdn=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('\" fullword ascii   \n         $s3 = \"&{$rn = Get-Random; $id = 'TR\" fullword ascii   \n         $s4 = \"') -replace '__',('DNS'+$id) | \" fullword ascii   \n         $s5 = \"\\\\upd.vbs\" fullword ascii   \n         $s6 = \"schtasks /create /F /sc minute /mo \" fullword ascii   \n         $s7 = \"') -replace '__',('HTP'+$id) | \" fullword ascii   \n         $s8 = \"&{$rn = Get-Random -minimum 1 -maximum 10000; $id = 'AZ\" fullword ascii   \n         $s9 = \"http://www.israirairlines.com/?mode=page&page=14635&lang=eng<\" fullword ascii   \n      \n      condition:   \n         ( uint16(0) == 0xcfd0 and filesize < 4000KB and 2 of ($s*) ) or ( 4 of them )   \n   }",
			"type": "YARA",
			"id": 30345453
		},
		{
			"indicator": "d0a25759fb3e845ae4ce20775cc98a44f31ab840",
			"description": "",
			"title": "",
			"content": "rule OilRig_Malware_Campaign_Mal2    \n   {   \n      \n      meta:   \n         description = \"Detects malware from OilRig Campaign\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/QMRZ8K\"   \n         date = \"2016-10-12\"   \n         hash1 = \"65920eaea00764a245acb58a3565941477b78a7bcc9efaec5bf811573084b6cf\"   \n      \n      strings:   \n         $x1 = \"wss.Run \\\"powershell.exe \\\" & Chr(34) & \\\"& {(Get-Content $env:Public\\\\Libraries\\\\update.vbs) -replace '__',(Get-Random) | Set-C\" ascii   \n         $x2 = \"Call Extract(UpdateVbs, wss.ExpandEnvironmentStrings(\\\"%PUBLIC%\\\") & \\\"\\\\Libraries\\\\update.vbs\\\")\" fullword ascii   \n         $x3 = \"mailto:Mohammed.sarah@gratner.com\" fullword wide   \n         $x4 = \"mailto:Tarik.Imam@gartner.com\" fullword wide   \n         $x5 = \"Call Extract(DnsPs1, wss.ExpandEnvironmentStrings(\\\"%PUBLIC%\\\") & \\\"\\\\Libraries\\\\dns.ps1\\\")\" fullword ascii   \n         $x6 = \"2dy53My5vcmcvMjAw\" fullword wide /* base64 encoded string 'w.w3.org/200' */   \n      \n      condition:   \n         ( uint16(0) == 0xcfd0 and filesize < 200KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30345454
		},
		{
			"indicator": "42d7b6dcbd14712a9bdd7d04a29e94cbce7130ba",
			"description": "",
			"title": "",
			"content": "rule OilRig_Campaign_Reconnaissance    \n   {   \n      \n      meta:   \n         description = \"Detects Windows discovery commands - known from OilRig Campaign\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/QMRZ8K\"   \n         date = \"2016-10-12\"   \n         hash1 = \"5893eae26df8e15c1e0fa763bf88a1ae79484cdb488ba2fc382700ff2cfab80c\"   \n      \n      strings:   \n         $s1 = \"whoami & hostname & ipconfig /all\" ascii   \n         $s2 = \"net user /domain 2>&1 & net group /domain 2>&1\" ascii   \n         $s3 = \"net group \\\"domain admins\\\" /domain 2>&1 & \" ascii   \n      \n      condition:   \n         ( filesize < 1KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30345455
		},
		{
			"indicator": "a79c513cba27aaeb8e8d7f229a909bb9a09ed7cf",
			"description": "",
			"title": "",
			"content": "rule OilRig_Malware_Campaign_Gen1    \n   {   \n      \n      meta:   \n         description = \"Detects malware from OilRig Campaign\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/QMRZ8K\"   \n         date = \"2016-10-12\"   \n         hash1 = \"d808f3109822c185f1d8e1bf7ef7781c219dc56f5906478651748f0ace489d34\"   \n         hash2 = \"80161dad1603b9a7c4a92a07b5c8bce214cf7a3df897b561732f9df7920ecb3e\"   \n         hash3 = \"662c53e69b66d62a4822e666031fd441bbdfa741e20d4511c6741ec3cb02475f\"   \n         hash4 = \"903b6d948c16dc92b69fe1de76cf64ab8377893770bf47c29bf91f3fd987f996\"   \n         hash5 = \"c4fbc723981fc94884f0f493cb8711fdc9da698980081d9b7c139fcffbe723da\"   \n         hash6 = \"57efb7596e6d9fd019b4dc4587ba33a40ab0ca09e14281d85716a253c5612ef4\"   \n         hash7 = \"1b2fee00d28782076178a63e669d2306c37ba0c417708d4dc1f751765c3f94e1\"   \n         hash8 = \"9f31a1908afb23a1029c079ee9ba8bdf0f4c815addbe8eac85b4163e02b5e777\"   \n         hash9 = \"0cd9857a3f626f8e0c07495a4799c59d502c4f3970642a76882e3ed68b790f8e\"   \n         hash10 = \"4b5112f0fb64825b879b01d686e8f4d43521252a3b4f4026c9d1d76d3f15b281\"   \n         hash11 = \"4e5b85ea68bf8f2306b6b931810ae38c8dff3679d78da1af2c91032c36380353\"   \n         hash12 = \"c3c17383f43184a29f49f166a92453a34be18e51935ddbf09576a60441440e51\"   \n         hash13 = \"f3856c7af3c9f84101f41a82e36fc81dfc18a8e9b424a3658b6ba7e3c99f54f2\"   \n         hash14 = \"0c64ab9b0c122b1903e8063e3c2c357cbbee99de07dc535e6c830a0472a71f39\"   \n         hash15 = \"d874f513a032ccb6a5e4f0cd55862b024ea0bee4de94ccf950b3dd894066065d\"   \n         hash16 = \"8ee628d46b8af20c4ba70a2fe8e2d4edca1980583171b71fe72455c6a52d15a9\"   \n         hash17 = \"55d0e12439b20dadb5868766a5200cbbe1a06053bf9e229cf6a852bfcf57d579\"   \n         hash18 = \"528d432952ef879496542bc62a5a4b6eee788f60f220426bd7f933fa2c58dc6b\"   \n         hash19 = \"93940b5e764f2f4a2d893bebef4bf1f7d63c4db856877020a5852a6647cb04a0\"   \n         hash20 = \"e2ec7fa60e654f5861e09bbe59d14d0973bd5727b83a2a03f1cecf1466dd87aa\"   \n         hash21 = \"9c0a33a5dc62933f17506f20e0258f877947bdcd15b091a597eac05d299b7471\"   \n         hash22 = \"a787c0e42608f9a69f718f6dca5556607be45ec77d17b07eb9ea1e0f7bb2e064\"   \n         hash23 = \"3772d473a2fe950959e1fd56c9a44ec48928f92522246f75f4b8cb134f4713ff\"   \n         hash24 = \"3986d54b00647b507b2afd708b7a1ce4c37027fb77d67c6bc3c20c3ac1a88ca4\"   \n         hash25 = \"f5a64de9087b138608ccf036b067d91a47302259269fb05b3349964ca4060e7e\"   \n      \n      strings:   \n         $x1 = \"Get-Content $env:Public\\\\Libraries\\\\update.vbs) -replace\" ascii   \n         $x2 = \"wss.Run \\\"powershell.exe \\\" & Chr(34) & \\\"& {waitfor haha /T 2}\\\" & Chr(34), 0\" fullword ascii   \n         $x3 = \"Call Extract(UpdateVbs, wss.ExpandEnvironmentStrings(\\\"%PUBLIC%\\\") & \\\"\\\\Libraries\\\\update.vbs\\\")\" fullword ascii   \n         $s4 = \"CreateObject(\\\"WScript.Shell\\\").Run cmd, 0o\" fullword ascii   \n         /* Base64 encode config */   \n         /* $global:myhost = */   \n         $b1 = \"JGdsb2JhbDpteWhvc3QgP\" ascii   \n         /* HOME=\"%public%\\Libraries\\\" */   \n         $b2 = \"SE9NRT0iJXB1YmxpYyVcTGlicmFyaWVzX\" ascii   \n         /* Set wss = CreateObject(\"wScript.Shell\") */   \n         $b3 = \"U2V0IHdzcyA9IENyZWF0ZU9iamVjdCgid1NjcmlwdC5TaGV\" ascii   \n         /* $scriptdir = Split-Path -Parent -Path $ */   \n         $b4 = \"JHNjcmlwdGRpciA9IFNwbGl0LVBhdGggLVBhcmVudCAtUGF0aCA\" ascii   \n         /* \\x0aSet wss = CreateObject(\"wScript.Shell\") */   \n         $b5 = \"DQpTZXQgd3NzID0gQ3JlYXRlT2JqZWN\" ascii   \n         /* whoami & hostname */   \n         $b6 = \"d2hvYW1pICYgaG9zdG5hb\" ascii   \n       \n      condition:   \n         ( uint16(0) == 0xcfd0 and filesize < 700KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30345456
		},
		{
			"indicator": "9c9a244a4920dc8005be47219ffafeefa69999bd",
			"description": "",
			"title": "",
			"content": "rule OilRig_Malware_Campaign_Mal1    \n   {   \n      \n      meta:   \n         description = \"Detects malware from OilRig Campaign\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/QMRZ8K\"   \n         date = \"2016-10-12\"   \n         hash1 = \"e17e1978563dc10b73fd54e7727cbbe95cc0b170a4e7bd0ab223e059f6c25fcc\"   \n      \n      strings:   \n         $x1 = \"DownloadExecute=\\\"powershell \\\"\\\"&{$r=Get-Random;$wc=(new-object System.Net.WebClient);$wc.DownloadFile(\" ascii   \n         $x2 = \"-ExecutionPolicy Bypass -File \\\"&HOME&\\\"dns.ps1\\\"\" fullword ascii   \n         $x3 = \"CreateObject(\\\"WScript.Shell\\\").Run Replace(DownloadExecute,\\\"-_\\\",\\\"bat\\\")\" fullword ascii   \n         $x4 = \"CreateObject(\\\"WScript.Shell\\\").Run DnsCmd,0\" fullword ascii   \n         $s1 = \"http://winodwsupdates.me\" ascii   \n      \n      condition:   \n         ( uint16(0) == 0x4f48 and filesize < 4KB and 1 of them ) or ( 2 of them )   \n   }",
			"type": "YARA",
			"id": 30345457
		},
		{
			"indicator": "f491aae531b9525d949d39ccfa6e90dfef59e1d5",
			"description": "",
			"title": "",
			"content": "rule OilRig_Malware_Campaign_Mal3    \n   {   \n      \n      meta:   \n         description = \"Detects malware from OilRig Campaign\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/QMRZ8K\"   \n         date = \"2016-10-12\"   \n         hash1 = \"02226181f27dbf59af5377e39cf583db15200100eea712fcb6f55c0a2245a378\"   \n      \n      strings:   \n         $x1 = \"(Get-Content $env:Public\\\\Libraries\\\\dns.ps1) -replace ('#'+'##'),$botid | Set-Content $env:Public\\\\Libraries\\\\dns.ps1\" fullword ascii   \n         $x2 = \"Invoke-Expression ($global:myhome+'tp\\\\'+$global:filename+'.bat > '+$global:myhome+'tp\\\\'+$global:filename+'.txt')\" fullword ascii   \n         $x3 = \"('00000000'+(convertTo-Base36(Get-Random -Maximum 46655)))\" fullword ascii   \n      \n      condition:   \n         ( filesize < 10KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30345458
		},
		{
			"indicator": "281ffd269436154260f1d11261041159556e4516",
			"description": "",
			"title": "",
			"content": "rule OpClandestineWolf    \n   {   \n       \n      meta:   \n           alert_severity = \"HIGH\"   \n           log = \"false\"   \n           author = \"NDF\"   \n           weight = 10   \n           alert = true   \n           source = \" https://www.fireeye.com/blog/threat-research/2015/06/operation-clandestine-wolf-adobe-flash-zero-day.html\"   \n           version = 1   \n           date = \"2015-06-23\"   \n           description = \"Operation Clandestine Wolf signature based on OSINT from 06.23.15\"   \n           hash0 = \"1a4b710621ef2e69b1f7790ae9b7a288\"   \n           hash1 = \"917c92e8662faf96fffb8ffe7b7c80fb\"   \n           hash2 = \"975b458cb80395fa32c9dda759cb3f7b\"   \n           hash3 = \"3ed34de8609cd274e49bbd795f21acc4\"   \n           hash4 = \"b1a55ec420dd6d24ff9e762c7b753868\"   \n           hash5 = \"afd753a42036000ad476dcd81b56b754\"   \n           hash6 = \"fad20abf8aa4eda0802504d806280dd7\"   \n           hash7 = \"ab621059de2d1c92c3e7514e4b51751a\"   \n           hash8 = \"510b77a4b075f09202209f989582dbea\"   \n           hash9 = \"d1b1abfcc2d547e1ea1a4bb82294b9a3\"   \n           hash10 = \"4692337bf7584f6bda464b9a76d268c1\"   \n           hash11 = \"7cae5757f3ba9fef0a22ca0d56188439\"   \n           hash12 = \"1a7ba923c6aa39cc9cb289a17599fce0\"   \n           hash13 = \"f86db1905b3f4447eb5728859f9057b5\"   \n           hash14 = \"37c6d1d3054e554e13d40ea42458ebed\"   \n           hash15 = \"3e7430a09a44c0d1000f76c3adc6f4fa\"   \n           hash16 = \"98eb249e4ddc4897b8be6fe838051af7\"   \n           hash17 = \"1b57a7fad852b1d686c72e96f7837b44\"   \n           hash18 = \"ffb84b8561e49a8db60e0001f630831f\"   \n           hash19 = \"98eb249e4ddc4897b8be6fe838051af7\"   \n           hash20 = \"dfb4025352a80c2d81b84b37ef00bcd0\"   \n           hash21 = \"4457e89f4aec692d8507378694e0a3ba\"   \n           hash22 = \"48de562acb62b469480b8e29821f33b8\"   \n           hash23 = \"7a7eed9f2d1807f55a9308e21d81cccd\"   \n           hash24 = \"6817b29e9832d8fd85dcbe4af176efb6\"   \n      \n      strings:   \n           $s0 = \"flash.Media.Sound()\"   \n           $s1 = \"call Kernel32!VirtualAlloc(0x1f140000hash$=0x10000hash$=0x1000hash$=0x40)\"   \n           $s2 = \"{4D36E972-E325-11CE-BFC1-08002BE10318}\"   \n           $s3 = \"NetStream\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345497
		},
		{
			"indicator": "31e602def7d298c8e3e289782944a594dc1a2740",
			"description": "",
			"title": "",
			"content": "rule PotaoDll   \n   {   \n      \n       strings:   \n           $mz = { 4d 5a }         \n           $dllstr1 = \"?AVCncBuffer@@\"   \n           $dllstr2 = \"?AVCncRequest@@\"   \n           $dllstr3 = \"Petrozavodskaya, 11, 9\"   \n           $dllstr4 = \"_Scan@0\"   \n           $dllstr5 = \"\\x00/sync/document/\"   \n           $dllstr6 = \"\\\\temp.temp\"   \n           $dllname1 = \"node69MainModule.dll\"   \n           $dllname2 = \"node69-main.dll\"   \n           $dllname3 = \"node69MainModuleD.dll\"   \n           $dllname4 = \"task-diskscanner.dll\"   \n           $dllname5 = \"\\x00Screen.dll\"   \n           $dllname6 = \"Poker2.dll\"           \n           $dllname7 = \"PasswordStealer.dll\"   \n           $dllname8 = \"KeyLog2Runner.dll\"    \n           $dllname9 = \"GetAllSystemInfo.dll\"             \n           $dllname10 = \"FilePathStealer.dll\"             \n         \n       condition:   \n           ($mz at 0) and (any of ($dllstr*) and any of ($dllname*))   \n   }",
			"type": "YARA",
			"id": 30345522
		},
		{
			"indicator": "4d6105a98dc695f53870d2a614a40f718acdb45d",
			"description": "",
			"title": "",
			"content": "rule PotaoUSB   \n   {   \n      \n       strings:   \n           $mz = { 4d 5a }    \n           $binary1 = { 33 C0 8B C8 83 E1 03 BA ?? ?? ?? 00 2B D1 8A 0A 32 88 ?? ?? ?? 00 2A C8 FE C9 88 88 ?? ?? ?? 00 40 3D ?? ?? 00 00 7C DA C3 }   \n           $binary2 = { 55 8B EC 51 56 C7 45 FC 00 00 00 00 EB 09 8B 45 FC 83 C0 01 89 45 FC 81 7D FC ?? ?? 00 00 7D 3D 8B 4D FC 0F BE 89 ?? ?? ?? 00 8B 45 FC 33 D2 BE 04 00 00 00 F7 F6 B8 03 00 00 00 2B C2 0F BE 90 ?? ?? ?? 00 33 CA 2B 4D FC 83 E9 01 81 E1 FF 00 00 00 8B 45 FC 88 88 ?? ?? ?? 00 EB B1 5E 8B E5 5D C3}   \n       condition:   \n           ($mz at 0) and any of ($binary*)   \n   }",
			"type": "YARA",
			"id": 30345523
		},
		{
			"indicator": "38288a2290f024bc5b3f93d09147eedc4bcacc82",
			"description": "",
			"title": "",
			"content": "rule PotaoDecoy   \n   {   \n          \n       strings:   \n           $mz = { 4d 5a }   \n           $str1 = \"eroqw11\"   \n           $str2 = \"2sfsdf\"   \n           $str3 = \"RtlDecompressBuffer\"   \n           $wiki_str = \"spanned more than 100 years and ruined three consecutive\" wide   \n           $old_ver1 = {53 68 65 6C 6C 33 32 2E 64 6C 6C 00 64 61 66 73 72 00 00 00 64 61 66 73 72 00 00 00 64 6F 63 (00 | 78)}   \n           $old_ver2 = {6F 70 65 6E 00 00 00 00 64 6F 63 00 64 61 66 73 72 00 00 00 53 68 65 6C 6C 33 32 2E 64 6C 6C 00}          \n          \n       condition:   \n           ($mz at 0) and ( (all of ($str*)) or any of ($old_ver*) or $wiki_str )   \n   }",
			"type": "YARA",
			"id": 30345524
		},
		{
			"indicator": "c292e06024048b058c42e0e2b5d2319c67f522b5",
			"description": "",
			"title": "",
			"content": "rule PotaoSecondStage   \n   {   \n      \n       strings:   \n           $mz = { 4d 5a }   \n           // hash of CryptBinaryToStringA and CryptStringToBinaryA   \n           $binary1 = {51 7A BB 85 [10-180] E8 47 D2 A8}   \n           // old hash of CryptBinaryToStringA and CryptStringToBinaryA   \n           $binary2 = {5F 21 63 DD [10-30] EC FD 33 02}   \n           $binary3 = {CA 77 67 57 [10-30] BA 08 20 7A}           \n           $str1 = \"?AVCrypt32Import@@\"   \n           $str2 = \"%.5llx\"   \n          \n       condition:   \n           ($mz at 0) and any of ($binary*) and any of ($str*)   \n   }",
			"type": "YARA",
			"id": 30345525
		},
		{
			"indicator": "8eac53cff28a98faeb3452524cf5cc8af607615c",
			"description": "",
			"title": "",
			"content": "rule APT_Win_Pipcreat    \n   {    \n      \n     meta:    \n       author = \"chort (@chort0)\"   \n       description = \"APT backdoor Pipcreat\"   \n       filetype = \"pe,dll\"    \n       date = \"2013-03\"   \n       MD5 = \"f09d832bea93cf320986b53fce4b8397\" // (incorrectly?) identified as Hupigon by many AV on VT    \n       Reference = \"http://www.cyberengineeringservices.com/login-exe-analysis-trojan-pipcreat/\"   \n       version = \"1.0\"   \n      \n     strings:    \n       $strA = \"pip creat failed\" wide fullword    \n       $strB = \"CraatePipe\" ascii fullword    \n       $strC = \"are you there? \" wide fullword    \n       $strD = \"success kill process ok\" wide fullword    \n       $strE = \"Vista|08|Win7\" wide fullword    \n       $rut = \"are you there!@#$%^&*()_+\" ascii fullword    \n          \n     condition:    \n       $rut or (2 of ($str*))    \n     }",
			"type": "YARA",
			"id": 30345767
		},
		{
			"indicator": "bd982ccf28ef17faee136cd396ed85f7df169095",
			"description": "",
			"title": "",
			"content": "rule PrikormkaDropper   \n   {   \n          \n       strings:   \n           $mz = { 4D 5A }   \n           $kd1 = \"KDSTORAGE\" wide   \n           $kd2 = \"KDSTORAGE_64\" wide   \n           $kd3 = \"KDRUNDRV32\" wide   \n           $kd4 = \"KDRAR\" wide   \n           $bin1 = {69 65 04 15 00 14 1E 4A 16 42 08 6C 21 61 24 0F}   \n           $bin2 = {76 6F 05 04 16 1B 0D 5E 0D 42 08 6C 20 45 18 16}   \n           $bin3 = {4D 00 4D 00 43 00 00 00 67 00 75 00 69 00 64 00 56 00 47 00 41 00 00 00 5F 00 73 00 76 00 67 00}   \n           $inj1 = \"?AVCinj2008Dlg@@\" ascii   \n           $inj2 = \"?AVCinj2008App@@\" ascii   \n      \n       condition:   \n           ($mz at 0) and ((any of ($bin*)) or (3 of ($kd*)) or (all of ($inj*)))   \n   }",
			"type": "YARA",
			"id": 30345844
		},
		{
			"indicator": "5876bbc2f956425605cb6afd2b1937e5e0cd6b86",
			"description": "",
			"title": "",
			"content": "rule PrikormkaModule   \n   {   \n          \n       strings:   \n           $mz = { 4D 5A }   \n      \n           // binary   \n           $str1 = {6D 70 2E 64 6C 6C 00 53 74 61 72 74 69 6E 67 00}   \n           $str2 = {68 6C 70 75 63 74 66 2E 64 6C 6C 00 43 79 63 6C 65}   \n           $str3 = {00 6B 6C 2E 64 6C 6C 00 53 74 61 72 74 69 6E 67 00}   \n           $str4 = {69 6F 6D 75 73 2E 64 6C 6C 00 53 74 61 72 74 69 6E 67}   \n           $str5 = {61 74 69 6D 6C 2E 64 6C 6C 00 4B 69 63 6B 49 6E 50 6F 69 6E 74}   \n           $str6 = {73 6E 6D 2E 64 6C 6C 00 47 65 74 52 65 61 64 79 46 6F 72 44 65 61 64}   \n           $str7 = {73 63 72 73 68 2E 64 6C 6C 00 47 65 74 52 65 61 64 79 46 6F 72 44 65 61 64}   \n      \n           // encrypted   \n           $str8 = {50 52 55 5C 17 51 58 17 5E 4A}   \n           $str9 = {60 4A 55 55 4E 53 58 4B 17 52 57 17 5E 4A}   \n           $str10 = {55 52 5D 4E 5B 4A 5D 17 51 58 17 5E 4A}   \n           $str11 = {60 4A 55 55 4E 61 17 51 58 17 5E 4A}   \n           $str12 = {39 5D 17 1D 1C 0A 3C 57 59 3B 1C 1E 57 58 4C 54 0F}   \n      \n           // mutex   \n           $str13 = \"ZxWinDeffContex\" ascii wide   \n           $str14 = \"Paramore756Contex43\" wide   \n           $str15 = \"Zw_&one@ldrContext43\" wide   \n      \n           // other   \n           $str16 = \"A95BL765MNG2GPRS\"   \n      \n           // dll names   \n           $str17 = \"helpldr.dll\" wide fullword   \n           $str18 = \"swma.dll\" wide fullword   \n           $str19 = \"iomus.dll\" wide fullword   \n           $str20 = \"atiml.dll\"  wide fullword   \n           $str21 = \"hlpuctf.dll\" wide fullword   \n           $str22 = \"hauthuid.dll\" ascii wide fullword   \n      \n           // rbcon   \n           $str23 = \"[roboconid][%s]\" ascii fullword   \n           $str24 = \"[objectset][%s]\" ascii fullword   \n           $str25 = \"rbcon.ini\" wide fullword   \n      \n           // files and logs   \n           $str26 = \"%s%02d.%02d.%02d_%02d.%02d.%02d.skw\" ascii fullword   \n           $str27 = \"%02d.%02d.%02d_%02d.%02d.%02d.%02d.rem\" wide fullword   \n      \n           // pdb strings   \n           $str28 = \":\\\\!PROJECTS!\\\\Mina\\\\2015\\\\\" ascii   \n           $str29 = \"\\\\PZZ\\\\RMO\\\\\" ascii   \n           $str30 = \":\\\\work\\\\PZZ\" ascii   \n           $str31 = \"C:\\\\Users\\\\mlk\\\\\" ascii   \n           $str32 = \":\\\\W o r k S p a c e\\\\\" ascii   \n           $str33 = \"D:\\\\My\\\\Projects_All\\\\2015\\\\\" ascii   \n           $str34 = \"\\\\TOOLS PZZ\\\\Bezzahod\\\\\" ascii   \n      \n       condition:   \n           ($mz at 0) and (any of ($str*))   \n   }",
			"type": "YARA",
			"id": 30345845
		},
		{
			"indicator": "46f7d1d132371f26f3c44ceb98bbada371bdf067",
			"description": "",
			"title": "",
			"content": "rule PrikormkaEarlyVersion   \n   {   \n          \n       strings:   \n           $mz = { 4D 5A }   \n           $str36 = \"IntelRestore\" ascii fullword   \n           $str37 = \"Resent\" wide fullword   \n           $str38 = \"ocp8.1\" wide fullword   \n           $str39 = \"rsfvxd.dat\" ascii fullword   \n           $str40 = \"tsb386.dat\" ascii fullword   \n           $str41 = \"frmmlg.dat\" ascii fullword   \n           $str42 = \"smdhost.dll\" ascii fullword   \n           $str43 = \"KDLLCFX\" wide fullword   \n           $str44 = \"KDLLRUNDRV\" wide fullword   \n        \n       condition:   \n           ($mz at 0) and (2 of ($str*))   \n   }",
			"type": "YARA",
			"id": 30345846
		},
		{
			"indicator": "f52dd84010080abdbb5291256eae1873a22a26ef",
			"description": "",
			"title": "",
			"content": "rule APT_Malware_PutterPanda_Rel    \n   {   \n      \n       meta:   \n           description = \"Detects an APT malware related to PutterPanda\"   \n           author = \"Florian Roth\"   \n           score = 70   \n           reference = \"VT Analysis\"   \n           date = \"2015-06-03\"   \n           hash = \"5367e183df155e3133d916f7080ef973f7741d34\"   \n      \n       strings:   \n           $x0 = \"app.stream-media.net\" fullword ascii /* score: '12.03' */   \n           $x1 = \"File %s does'nt exist or is forbidden to acess!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '16.035' */   \n           $s6 = \"GetProcessAddresss of pHttpQueryInfoA Failed!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '32.02' */   \n           $s7 = \"Connect %s error!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '16.04' */   \n           $s9 = \"Download file %s successfully!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '14.03' */   \n           $s10 = \"index.tmp\" fullword ascii /* score: '14.03' */   \n           $s11 = \"Execute PE Successfully\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '13.03' */   \n           $s13 = \"aa/22/success.xml\" fullword ascii /* score: '12.005' */   \n           $s16 = \"aa/22/index.asp\" fullword ascii /* score: '11.02' */   \n           $s18 = \"File %s a Non-Pe File\" fullword ascii /* score: '8.04' */   \n           $s19 = \"SendRequset error!\" fullword ascii /* score: '8.04' */   \n           $s20 = \"filelist[%d]=%s\" fullword ascii /* score: '7.015' */   \n      \n       condition:   \n           ( uint16(0) == 0x5a4d and 1 of ($x*) ) or ( 4 of ($s*) )   \n   }",
			"type": "YARA",
			"id": 30345847
		},
		{
			"indicator": "13cb797399ef573d8849c6a4984058252bd938c5",
			"description": "",
			"title": "",
			"content": "rule APT_Malware_PutterPanda_MsUpdater_2    \n   {   \n      \n       meta:   \n           description = \"Detects Malware related to PutterPanda - MSUpdater\"   \n           author = \"Florian Roth\"   \n           score = 70   \n           reference = \"VT Analysis\"   \n           date = \"2015-06-03\"   \n           hash = \"365b5537e3495f8ecfabe2597399b1f1226879b1\"   \n         \n       strings:   \n           $s0 = \"winsta0\\\\default\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.99' */ /* Goodware String - occured 6 times */   \n           $s1 = \"EXPLORER.EXE\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.98' */ /* Goodware String - occured 22 times */   \n           $s2 = \"WNetEnumResourceA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.97' */ /* Goodware String - occured 29 times */   \n           $s3 = \"explorer.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.97' */ /* Goodware String - occured 31 times */   \n           $s4 = \"CreateProcessAsUserA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.91' */ /* Goodware String - occured 86 times */   \n           $s5 = \"HttpSendRequestExA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.91' */ /* Goodware String - occured 87 times */   \n           $s6 = \"HttpEndRequestA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.91' */ /* Goodware String - occured 91 times */   \n           $s7 = \"GetModuleBaseNameA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.88' */ /* Goodware String - occured 121 times */   \n           $s8 = \"GetModuleFileNameExA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.86' */ /* Goodware String - occured 144 times */   \n           $s9 = \"HttpSendRequestA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.85' */ /* Goodware String - occured 154 times */   \n           $s10 = \"HttpOpenRequestA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.84' */ /* Goodware String - occured 159 times */   \n           $s11 = \"InternetConnectA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.82' */ /* Goodware String - occured 183 times */   \n           $s12 = \"Process32Next\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.80' */ /* Goodware String - occured 204 times */   \n           $s13 = \"Process32First\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.79' */ /* Goodware String - occured 210 times */   \n           $s14 = \"CreatePipe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.78' */ /* Goodware String - occured 222 times */   \n           $s15 = \"EnumProcesses\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.73' */ /* Goodware String - occured 273 times */   \n           $s16 = \"LookupPrivilegeValueA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.66' */ /* Goodware String - occured 336 times */   \n           $s17 = \"PeekNamedPipe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.65' */ /* Goodware String - occured 347 times */   \n           $s18 = \"EnumProcessModules\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.59' */ /* Goodware String - occured 410 times */   \n           $s19 = \"PSAPI.DLL\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.58' */ /* Goodware String - occured 420 times */   \n           $s20 = \"SPSSSQ\" fullword ascii /* score: '4.51' */   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 220KB and all of them   \n   }",
			"type": "YARA",
			"id": 30345848
		},
		{
			"indicator": "7b6563e48b8ba262cafb6127ae06c41b9e1de71a",
			"description": "",
			"title": "",
			"content": "rule APT_Malware_PutterPanda_Gen4    \n   {   \n      \n       meta:   \n           description = \"Detects Malware related to PutterPanda\"   \n           author = \"Florian Roth\"   \n           score = 70   \n           reference = \"VT Analysis\"   \n           date = \"2015-06-03\"   \n           super_rule = 1   \n           hash0 = \"71a8378fa8e06bcf8ee9f019c807c6bfc58dca0c\"   \n           hash1 = \"8fdd6e5ed9d69d560b6fdd5910f80e0914893552\"   \n           hash2 = \"3c4a762175326b37035a9192a981f7f4cc2aa5f0\"   \n           hash3 = \"598430b3a9b5576f03cc4aed6dc2cd8a43324e1e\"   \n           hash4 = \"6522b81b38747f4aa09c98fdaedaed4b00b21689\"   \n      \n       strings:   \n           $x1 = \"rz.dat\" fullword ascii /* score: '10.00' */   \n           $s0 = \"Mozilla/4.0 (Compatible; MSIE 6.0;)\" fullword ascii /* PEStudio Blacklist: agent */ /* score: '20.03' */   \n           $s1 = \"Internet connect error:%d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '14.04' */   \n           $s2 = \"Proxy-Authorization:Basic \" fullword ascii /* PEStudio Blacklist: strings */ /* score: '14.02' */   \n           $s5 = \"Invalid url\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '9.03' */   \n           $s6 = \"Create file failed\" fullword ascii /* score: '8.04' */   \n           $s7 = \"myAgent\" fullword ascii /* score: '8.03' */   \n           $z1 = \"%s%s%d%d\" fullword ascii /* score: '8.00' */   \n           $z2 = \"HttpQueryInfo failed:%d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '13.02' */   \n           $z3 = \"read file error:%d\" fullword ascii /* score: '11.04' */   \n           $z4 = \"down file success\" fullword ascii /* score: '7.04' */   \n           $z5 = \"kPStoreCreateInstance\" fullword ascii /* score: '5.03' */   \n           $z6 = \"Avaliable data:%u bytes\" fullword ascii /* score: '5.03' */   \n           $z7 = \"abe2869f-9b47-4cd9-a358-c22904dba7f7\" fullword ascii /* PEStudio Blacklist: guid */ /* score: '5.00' */ /* Goodware String - occured 2 times */   \n      \n       condition:   \n           filesize < 300KB and (( uint16(0) == 0x5a4d and $x1 and 3 of ($s*) ) or ( 3 of ($s*) and 4 of ($z*) ))   \n   }",
			"type": "YARA",
			"id": 30345849
		},
		{
			"indicator": "38d49920704ba298ec314b4bcaa55e33aa98d8b9",
			"description": "",
			"title": "",
			"content": "rule APT_Malware_PutterPanda_Rel_2    \n   {   \n      \n       meta:   \n           description = \"APT Malware related to PutterPanda Group\"   \n           author = \"Florian Roth\"   \n           score = 70   \n           reference = \"VT Analysis\"   \n           date = \"2015-06-03\"   \n           hash = \"f97e01ee04970d1fc4d988a9e9f0f223ef2a6381\"   \n      \n       strings:   \n           $s0 = \"http://update.konamidata.com/test/zl/sophos/td/result/rz.dat?\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '28.01' */   \n           $s1 = \"http://update.konamidata.com/test/zl/sophos/td/index.dat?\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '28.01' */   \n           $s2 = \"Mozilla/4.0 (Compatible; MSIE 6.0;)\" fullword ascii /* PEStudio Blacklist: agent */ /* score: '20.03' */   \n           $s3 = \"Internet connect error:%d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '14.035' */   \n           $s4 = \"Proxy-Authorization:Basic\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '14.02' */   \n           $s5 = \"HttpQueryInfo failed:%d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '13.015' */   \n           $s6 = \"read file error:%d\" fullword ascii /* score: '11.04' */   \n           $s7 = \"downdll.dll\" fullword ascii /* score: '11.025' */   \n           $s8 = \"rz.dat\" fullword ascii /* score: '10.005' */   \n           $s9 = \"Invalid url\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '9.03' */   \n           $s10 = \"Create file failed\" fullword ascii /* score: '8.045' */   \n           $s11 = \"myAgent\" fullword ascii /* score: '8.025' */   \n           $s12 = \"%s%s%d%d\" fullword ascii /* score: '8.005' */   \n           $s13 = \"down file success\" fullword ascii /* score: '7.035' */   \n           $s15 = \"error!\" fullword ascii /* score: '6.04' */   \n           $s18 = \"Avaliable data:%u bytes\" fullword ascii /* score: '5.025' */   \n          \n       condition:   \n           uint16(0) == 0x5a4d and 6 of them   \n   }",
			"type": "YARA",
			"id": 30345850
		},
		{
			"indicator": "56ae7d19a89f2a4cbc2f5d7563e2fab12ec9ac49",
			"description": "",
			"title": "",
			"content": "rule Malware_MsUpdater_String_in_EXE     \n   {   \n      \n       meta:   \n           description = \"MSUpdater String in Executable\"   \n           author = \"Florian Roth\"   \n           score = 50   \n           reference = \"VT Analysis\"   \n           date = \"2015-06-03\"   \n           hash = \"b1a2043b7658af4d4c9395fa77fde18ccaf549bb\"   \n      \n       strings:   \n           $x1 = \"msupdate.exe\" fullword wide /* PEStudio Blacklist: strings */ /* score: '20.01' */   \n           // $x2 = \"msupdate\" fullword wide /* PEStudio Blacklist: strings */ /* score: '13.01' */   \n           $x3 = \"msupdater.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '20.02' */   \n           $x4 = \"msupdater32.exe\" fullword ascii   \n           $x5 = \"msupdater32.exe\" fullword wide   \n           $x6 = \"msupdate.pif\" fullword ascii   \n           $fp1 = \"_msupdate_\" wide /* False Positive */   \n           $fp2 = \"_msupdate_\" ascii /* False Positive */   \n           $fp3 = \"/kies\" wide   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 500KB and ( 1 of ($x*) ) and not ( 1 of ($fp*) )    \n   }",
			"type": "YARA",
			"id": 30345851
		},
		{
			"indicator": "228c36b994dcd5432649c4e8213775bca596b4f1",
			"description": "",
			"title": "",
			"content": "rule APT_Malware_PutterPanda_PSAPI    \n   {   \n      \n       meta:   \n           description = \"Detects a malware related to Putter Panda\"   \n           author = \"Florian Roth\"   \n           score = 70   \n           reference = \"VT Analysis\"   \n           date = \"2015-06-03\"   \n           hash = \"f93a7945a33145bb6c106a51f08d8f44eab1cdf5\"   \n      \n       strings:   \n           $s0 = \"LOADER ERROR\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '12.03' */   \n           $s1 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '8.045' */   \n           $s2 = \"psapi.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 54 times */   \n           $s3 = \"urlmon.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 471 times */   \n           $s4 = \"WinHttpGetProxyForUrl\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 179 times */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 300KB and all of them   \n   }",
			"type": "YARA",
			"id": 30345852
		},
		{
			"indicator": "c375b2b7533c75bff35be152c15bb91ed041062a",
			"description": "",
			"title": "",
			"content": "rule APT_Malware_PutterPanda_MsUpdater_3    \n   {   \n      \n       meta:   \n           description = \"Detects Malware related to PutterPanda - MSUpdater\"   \n           author = \"Florian Roth\"   \n           score = 70   \n           reference = \"VT Analysis\"   \n           date = \"2015-06-03\"   \n           hash = \"464149ff23f9c7f4ab2f5cadb76a4f41f969bed0\"   \n      \n       strings:   \n           $s0 = \"msupdater.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '20.02' */   \n           $s1 = \"Explorer.exe \\\"\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '16.05' */   \n           $s2 = \"FAVORITES.DAT\" fullword ascii /* score: '11.02' */   \n           $s4 = \"COMSPEC\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.82' */ /* Goodware String - occured 178 times */   \n         \n       condition:   \n           uint16(0) == 0x5a4d and 3 of them   \n   }",
			"type": "YARA",
			"id": 30345853
		},
		{
			"indicator": "b1b80c75ee0904c264ed22917c9dc6c1c8d2733f",
			"description": "",
			"title": "",
			"content": "rule APT_Malware_PutterPanda_Gen1    \n   {   \n      \n       meta:   \n           description = \"Detects a malware \"   \n           author = \"YarGen Rule Generator\"   \n           reference = \"not set\"   \n           date = \"2015-06-03\"   \n           super_rule = 1   \n           hash0 = \"bf1d385e637326a63c4d2f253dc211e6a5436b6a\"   \n           hash1 = \"76459bcbe072f9c29bb9703bc72c7cd46a692796\"   \n           hash2 = \"e105a7a3a011275002aec4b930c722e6a7ef52ad\"   \n      \n       strings:   \n           $s1 = \"%s%duserid=%dthreadid=%dgroupid=%d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '22.02' */   \n           $s2 = \"ssdpsvc.dll\" fullword ascii /* score: '11.00' */   \n           $s3 = \"Fail %s \" fullword ascii /* score: '10.04' */   \n           $s4 = \"%s%dpara1=%dpara2=%dpara3=%d\" fullword ascii /* score: '10.01' */   \n           $s5 = \"LsaServiceInit\" fullword ascii /* score: '7.03' */   \n           $s6 = \"%-8d Fs %-12s Bs \" fullword ascii /* score: '5.04' */   \n           $s7 = \"Microsoft DH SChannel Cryptographic Provider\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5.00' */ /* Goodware String - occured 5 times */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 1000KB and 5 of them   \n   }",
			"type": "YARA",
			"id": 30345854
		},
		{
			"indicator": "166d0b028ca71f77def29473348c6edb8ed816a4",
			"description": "",
			"title": "",
			"content": "rule APT_Malware_PutterPanda_MsUpdater_1    \n   {   \n      \n       meta:   \n           description = \"Detects Malware related to PutterPanda - MSUpdater\"   \n           author = \"Florian Roth\"   \n           score = 70   \n           reference = \"VT Analysis\"   \n           date = \"2015-06-03\"   \n           hash = \"b55072b67543f58c096571c841a560c53d72f01a\"   \n      \n       strings:   \n           $x0 = \"msupdate.exe\" fullword wide /* PEStudio Blacklist: strings */ /* score: '20.01' */   \n           $x1 = \"msupdate\" fullword wide /* PEStudio Blacklist: strings */ /* score: '13.01' */   \n           $s1 = \"Microsoft Corporation. All rights reserved.\" fullword wide /* score: '8.04' */   \n           $s2 = \"Automatic Updates\" fullword wide /* PEStudio Blacklist: strings */ /* score: '4.98' */ /* Goodware String - occured 22 times */   \n           $s3 = \"VirtualProtectEx\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.93' */ /* Goodware String - occured 68 times */   \n           $s4 = \"Invalid parameter\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.93' */ /* Goodware String - occured 69 times */   \n           $s5 = \"VirtualAllocEx\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.91' */ /* Goodware String - occured 95 times */   \n           $s6 = \"WriteProcessMemory\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '4.87' */ /* Goodware String - occured 131 times */   \n       condition:   \n           ( uint16(0) == 0x5a4d and 1 of ($x*) and 4 of ($s*) ) or ( 1 of ($x*) and all of ($s*) )    \n   }",
			"type": "YARA",
			"id": 30345855
		},
		{
			"indicator": "2b15865f1f241f7e639087512125ddfe09954a8f",
			"description": "",
			"title": "",
			"content": "rule APT_Malware_PutterPanda_WUAUCLT    \n   {   \n      \n       meta:   \n           description = \"Detects a malware related to Putter Panda\"   \n           author = \"Florian Roth\"   \n           score = 70   \n           reference = \"VT Analysis\"   \n           date = \"2015-06-03\"   \n           hash = \"fd5ca5a2d444865fa8320337467313e4026b9f78\"   \n          \n       strings:   \n           $x0 = \"WUAUCLT.EXE\" fullword wide /* PEStudio Blacklist: strings */ /* score: '20.01' */   \n           $x1 = \"%s\\\\tmp%d.exe\" fullword ascii /* score: '14.01' */      \n           $x2 = \"Microsoft Corporation. All rights reserved.\" fullword wide /* score: '8.04' */   \n           $s1 = \"Microsoft Windows Operating System\" fullword wide /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 4 times */   \n           $s2 = \"InternetQueryOptionA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 166 times */   \n           $s3 = \"LookupPrivilegeValueA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 336 times */   \n           $s4 = \"WNetEnumResourceA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 29 times */   \n           $s5 = \"HttpSendRequestExA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 87 times */   \n           $s6 = \"PSAPI.DLL\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 420 times */   \n           $s7 = \"Microsoft(R) Windows(R) Operating System\" fullword wide /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 128 times */   \n           $s8 = \"CreatePipe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 222 times */   \n           $s9 = \"EnumProcessModules\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '5' */ /* Goodware String - occured 410 times */   \n      \n       condition:   \n           all of ($x*) or (1 of ($x*) and all of ($s*) )   \n   }",
			"type": "YARA",
			"id": 30345856
		},
		{
			"indicator": "faf4eb87e9e4ecb2a924ce3aa31f486995fe01da",
			"description": "",
			"title": "",
			"content": "rule Regin_Sample_1    \n   {   \n      \n       meta:   \n           description = \"Auto-generated rule - file-3665415_sys\"   \n           author = \"@MalwrSignatures\"   \n           date = \"26.11.14\"   \n           hash = \"773d7fab06807b5b1bc2d74fa80343e83593caf2\"   \n      \n       strings:   \n           $s0 = \"Getting PortName/Identifier failed - %x\" fullword ascii   \n           $s1 = \"SerialAddDevice - error creating new devobj [%#08lx]\" fullword ascii   \n           $s2 = \"External Naming Failed - Status %x\" fullword ascii   \n           $s3 = \"------- Same multiport - different interrupts\" fullword ascii   \n           $s4 = \"%x occurred prior to the wait - starting the\" fullword ascii   \n           $s5 = \"'user registry info - userPortIndex: %d\" fullword ascii   \n           $s6 = \"Could not report legacy device - %x\" fullword ascii   \n           $s7 = \"entering SerialGetPortInfo\" fullword ascii   \n           $s8 = \"'user registry info - userPort: %x\" fullword ascii   \n           $s9 = \"IoOpenDeviceRegistryKey failed - %x \" fullword ascii   \n           $s10 = \"Kernel debugger is using port at address %X\" fullword ascii   \n           $s12 = \"Release - freeing multi context\" fullword ascii   \n           $s13 = \"Serial driver will not load port\" fullword ascii   \n           $s14 = \"'user registry info - userAddressSpace: %d\" fullword ascii   \n           $s15 = \"SerialAddDevice: Enumeration request, returning NO_MORE_ENTRIES\" fullword ascii   \n           $s20 = \"'user registry info - userIndexed: %d\" fullword ascii   \n      \n       condition:   \n           all of them and filesize < 110KB and filesize > 80KB   \n   }",
			"type": "YARA",
			"id": 30345880
		},
		{
			"indicator": "56cf5ea6f79923b021acdae40bd4eeb80df9d8c2",
			"description": "",
			"title": "",
			"content": "rule Regin_APT_KernelDriver_Generic_B    \n   {   \n      \n       meta:   \n           description = \"Generic rule for Regin APT kernel driver Malware - Symantec http://t.co/qu53359Cb2\"   \n           author = \"@Malwrsignatures - included in APT Scanner THOR\"   \n           date = \"23.11.14\"   \n           hash1 = \"ffb0b9b5b610191051a7bdf0806e1e47\"   \n           hash2 = \"bfbe8c3ee78750c3a520480700e440f8\"   \n           hash3 = \"b29ca4f22ae7b7b25f79c1d4a421139d\"   \n           hash4 = \"06665b96e293b23acc80451abb413e50\"   \n           hash5 = \"2c8b9d2885543d7ade3cae98225e263b\"   \n           hash6 = \"4b6b86c7fec1c574706cecedf44abded\"   \n           hash7 = \"187044596bc1328efa0ed636d8aa4a5c\"   \n           hash8 = \"d240f06e98c8d3e647cbf4d442d79475\"   \n           hash9 = \"6662c390b2bbbd291ec7987388fc75d7\"   \n           hash10 = \"1c024e599ac055312a4ab75b3950040a\"   \n           hash11 = \"ba7bb65634ce1e30c1e5415be3d1db1d\"   \n           hash12 = \"b505d65721bb2453d5039a389113b566\"   \n           hash13 = \"b269894f434657db2b15949641a67532\"   \n      \n       strings:   \n           $m0 = { 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8 }    \n           $s1 = { 0e 1f ba 0e 00 b4 09 cd 21 b8 01 4c cd 21 54 68 69 73 20 70 72 6f 67 72 61 6d 20 63 61 6e 6e 6f 74 20 62 65 20 72 75 6e 20 69 6e 20 44 4f 53 20 6d 6f 64 65 2e }   \n           $s2 = \"H.data\" fullword ascii nocase   \n           $s3 = \"INIT\" fullword ascii   \n           $s4 = \"ntoskrnl.exe\" fullword ascii   \n           $v1 = \"\\\\system32\" fullword ascii   \n           $v2 = \"\\\\SystemRoot\" fullword ascii   \n           $v3 = \"KeServiceDescriptorTable\" fullword ascii    \n           $w1 = \"\\\\system32\" fullword ascii   \n           $w2 = \"\\\\SystemRoot\" fullword ascii        \n           $w3 = \"LRich6\" fullword ascii           \n           $x1 = \"_snprintf\" fullword ascii   \n           $x2 = \"_except_handler3\" fullword ascii   \n           $y1 = \"mbstowcs\" fullword ascii   \n           $y2 = \"wcstombs\" fullword ascii   \n           $y3 = \"KeGetCurrentIrql\" fullword ascii   \n           $z1 = \"wcscpy\" fullword ascii   \n           $z2 = \"ZwCreateFile\" fullword ascii   \n           $z3 = \"ZwQueryInformationFile\" fullword ascii   \n           $z4 = \"wcslen\" fullword ascii   \n           $z5 = \"atoi\" fullword ascii   \n         \n       condition:   \n           $m0 at 0 and all of ($s*) and ( all of ($v*) or all of ($w*) or all of ($x*) or all of ($y*) or all of ($z*) ) and filesize < 20KB   \n   }",
			"type": "YARA",
			"id": 30345881
		},
		{
			"indicator": "314650529c9fbde8d9c215054ff2d02fa8b6d35a",
			"description": "",
			"title": "",
			"content": "rule apt_regin_hopscotch    \n   {   \n      \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           description = \"Rule to detect Regin's Hopscotch module\"   \n           version = \"1.0\"   \n           last_modified = \"2015-01-22\"   \n           reference = \"https://securelist.com/blog/research/68438/an-analysis-of-regins-hopscotch-and-legspin/\"   \n           md5 = \"6c34031d7a5fc2b091b623981a8ae61c\"   \n      \n       strings:   \n           $mz=\"MZ\"   \n           $a1=\"AuthenticateNetUseIpc\"   \n           $a2=\"Failed to authenticate to\"   \n           $a3=\"Failed to disconnect from\"   \n           $a4=\"%S\\\\ipc$\" wide   \n           $a5=\"Not deleting...\"   \n           $a6=\"CopyServiceToRemoteMachine\"   \n           $a7=\"DH Exchange failed\"   \n           $a8=\"ConnectToNamedPipes\"   \n        \n       condition:   \n           ($mz at 0) and all of ($a*)   \n   }",
			"type": "YARA",
			"id": 30345882
		},
		{
			"indicator": "990a4596724ed6939af90d209c20ead40d7c91a7",
			"description": "",
			"title": "",
			"content": "rule apt_regin_dispatcher_disp_dll    \n   {   \n      \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           author = \"Kaspersky Lab\"   \n           description = \"Rule to detect Regin disp.dll dispatcher\"   \n           version = \"1.0\"   \n           last_modified = \"2014-11-18\"   \n      \n       strings:   \n           $mz=\"MZ\"   \n           $string1=\"shit\"   \n           $string2=\"disp.dll\"   \n           $string3=\"255.255.255.255\"   \n           $string4=\"StackWalk64\"   \n           $string5=\"imagehlp.dll\"   \n          \n       condition:   \n           ($mz at 0) and (all of ($string*))   \n   }",
			"type": "YARA",
			"id": 30345883
		},
		{
			"indicator": "883499249de4259a30453113a09dbd0b7ffd63c8",
			"description": "",
			"title": "",
			"content": "rule Regin_APT_KernelDriver_Generic_A    \n   {   \n      \n       meta:   \n           description = \"Generic rule for Regin APT kernel driver Malware - Symantec http://t.co/qu53359Cb2\"   \n           author = \"@Malwrsignatures - included in APT Scanner THOR\"   \n           date = \"23.11.14\"   \n           hash1 = \"187044596bc1328efa0ed636d8aa4a5c\"   \n           hash2 = \"06665b96e293b23acc80451abb413e50\"   \n           hash3 = \"d240f06e98c8d3e647cbf4d442d79475\"   \n      \n       strings:   \n           $m0 = { 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8 }    \n           $m1 = { 0e 1f ba 0e 00 b4 09 cd 21 b8 01 4c cd 21 54 68 69 73 20 70 72 6f 67 72 61 6d 20 63 61 6e 6e 6f 74 20 62 65 20 72 75 6e 20 69 6e 20 44 4f 53 20 6d 6f 64 65 2e }       \n           $s0 = \"atapi.sys\" fullword wide   \n           $s1 = \"disk.sys\" fullword wide   \n           $s3 = \"h.data\" fullword ascii   \n           $s4 = \"\\\\system32\" fullword ascii   \n           $s5 = \"\\\\SystemRoot\" fullword ascii   \n           $s6 = \"system\" fullword ascii   \n           $s7 = \"temp\" fullword ascii   \n           $s8 = \"windows\" fullword ascii   \n           $x1 = \"LRich6\" fullword ascii   \n           $x2 = \"KeServiceDescriptorTable\" fullword ascii        \n          \n       condition:   \n           $m0 at 0 and $m1 and all of ($s*) and 1 of ($x*)   \n   }",
			"type": "YARA",
			"id": 30345884
		},
		{
			"indicator": "302760187ee77952c6f14f1e98f9bfdf8948adc6",
			"description": "",
			"title": "",
			"content": "rule Regin_Sample_Set_1    \n   {   \n      \n       meta:   \n           description = \"Auto-generated rule - file SHF-000052 and ndisips.sys\"   \n           author = \"@MalwrSignatures\"   \n           date = \"26.11.14\"   \n           hash1 = \"8487a961c8244004c9276979bb4b0c14392fc3b8\"   \n           hash2 = \"bcf3461d67b39a427c83f9e39b9833cfec977c61\"         \n      \n       strings:   \n           $s0 = \"HAL.dll\" fullword ascii   \n           $s1 = \"IoGetDeviceObjectPointer\" fullword ascii   \n           $s2 = \"MaximumPortsServiced\" fullword wide   \n           $s3 = \"KeGetCurrentIrql\" fullword ascii   \n           $s4 = \"ntkrnlpa.exe\" fullword ascii   \n           $s5 = \"\\\\REGISTRY\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\" wide   \n           $s6 = \"ConnectMultiplePorts\" fullword wide   \n           $s7 = \"\\\\SYSTEMROOT\" fullword wide   \n           $s8 = \"IoWriteErrorLogEntry\" fullword ascii   \n           $s9 = \"KeQueryPerformanceCounter\" fullword ascii   \n           $s10 = \"KeServiceDescriptorTable\" fullword ascii   \n           $s11 = \"KeRemoveEntryDeviceQueue\" fullword ascii   \n           $s12 = \"SeSinglePrivilegeCheck\" fullword ascii   \n           $s13 = \"KeInitializeEvent\" fullword ascii   \n           $s14 = \"IoBuildDeviceIoControlRequest\" fullword ascii   \n           $s15 = \"KeRemoveDeviceQueue\" fullword ascii   \n           $s16 = \"IofCompleteRequest\" fullword ascii   \n           $s17 = \"KeInitializeSpinLock\" fullword ascii   \n           $s18 = \"MmIsNonPagedSystemAddressValid\" fullword ascii   \n           $s19 = \"IoCreateDevice\" fullword ascii   \n           $s20 = \"KefReleaseSpinLockFromDpcLevel\" fullword ascii   \n         \n       condition:   \n           all of them and filesize < 40KB and filesize > 30KB   \n   }",
			"type": "YARA",
			"id": 30345885
		},
		{
			"indicator": "db3319416a238aafe28fb3ac1a7028df7b08ff93",
			"description": "",
			"title": "",
			"content": "rule Regin_Sample_3    \n   {   \n      \n       meta:   \n           description = \"Detects Regin Backdoor sample fe1419e9dde6d479bd7cda27edd39fafdab2668d498931931a2769b370727129\"   \n           author = \"@Malwrsignatures\"   \n           date = \"27.11.14\"   \n           hash = \"fe1419e9dde6d479bd7cda27edd39fafdab2668d498931931a2769b370727129\"          \n         \n       strings:   \n           $hd = { fe ba dc fe }   \n           $s0 = \"Service Pack x\" fullword wide   \n           $s1 = \"\\\\REGISTRY\\\\MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" fullword wide   \n           $s2 = \"\\\\REGISTRY\\\\Machine\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\HotFix\" fullword wide   \n           $s3 = \"mntoskrnl.exe\" fullword wide   \n           $s4 = \"\\\\REGISTRY\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Memory Management\" fullword wide   \n           $s5 = \"Memory location: 0x%p, size 0x%08x\" wide fullword   \n           $s6 = \"Service Pack\" fullword wide   \n           $s7 = \".sys\" fullword wide   \n           $s8 = \".dll\" fullword wide         \n           $s10 = \"\\\\REGISTRY\\\\Machine\\\\Software\\\\Microsoft\\\\Updates\" fullword wide   \n           $s11 = \"IoGetRelatedDeviceObject\" fullword ascii   \n           $s12 = \"VMEM.sys\" fullword ascii   \n           $s13 = \"RtlGetVersion\" fullword wide   \n           $s14 = \"ntkrnlpa.exe\" fullword ascii   \n         \n       condition:   \n           ( $hd at 0 ) and all of ($s*) and filesize > 160KB and filesize < 200KB   \n   }",
			"type": "YARA",
			"id": 30345886
		},
		{
			"indicator": "ef0c4afdcd17f4150b8bdc92e524cfae7905ba78",
			"description": "",
			"title": "",
			"content": "rule apt_regin_vfs    \n   {   \n          \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           author = \"Kaspersky Lab\"   \n           description = \"Rule to detect Regin VFSes\"   \n           version = \"1.0\"   \n           last_modified = \"2014-11-18\"   \n          \n       strings:   \n           $a1={00 02 00 08 00 08 03 F6 D7 F3 52}   \n           $a2={00 10 F0 FF F0 FF 11 C7 7F E8 52}   \n           $a3={00 04 00 10 00 10 03 C2 D3 1C 93}   \n           $a4={00 04 00 10 C8 00 04 C8 93 06 D8}   \n          \n       condition:   \n       ($a1 at 0) or ($a2 at 0) or ($a3 at 0) or ($a4 at 0)   \n   }",
			"type": "YARA",
			"id": 30345887
		},
		{
			"indicator": "19c97f98c315c68782d980c76a944a0260f61a92",
			"description": "",
			"title": "",
			"content": "rule apt_regin_legspin    \n   {   \n      \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           description = \"Rule to detect Regin's Legspin module\"   \n           version = \"1.0\"   \n           last_modified = \"2015-01-22\"   \n           reference = \"https://securelist.com/blog/research/68438/an-analysis-of-regins-hopscotch-and-legspin/\"   \n           md5 = \"29105f46e4d33f66fee346cfd099d1cc\"   \n      \n       strings:   \n           $mz=\"MZ\"   \n           $a1=\"sharepw\"   \n           $a2=\"reglist\"   \n           $a3=\"logdump\"   \n           $a4=\"Name:\" wide   \n           $a5=\"Phys Avail:\"   \n           $a6=\"cmd.exe\" wide   \n           $a7=\"ping.exe\" wide   \n           $a8=\"millisecs\"   \n         \n       condition:   \n           ($mz at 0) and all of ($a*)   \n   }",
			"type": "YARA",
			"id": 30345888
		},
		{
			"indicator": "480f70c4858995bb55566eb6cff3ffb51b09b568",
			"description": "",
			"title": "",
			"content": "rule apt_regin_rc5key    \n   {   \n          \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           description = \"Rule to detect Regin RC5 decryption keys\"   \n           version = \"1.0\"   \n           last_modified = \"2014-11-18\"   \n          \n       strings:   \n           $key1={73 23 1F 43 93 E1 9F 2F 99 0C 17 81 5C FF B4 01}   \n           $key2={10 19 53 2A 11 ED A3 74 3F C3 72 3F 9D 94 3D 78}   \n      \n       condition:   \n           any of ($key*)   \n   }",
			"type": "YARA",
			"id": 30345889
		},
		{
			"indicator": "4ee233f27137086de33814d1fce4e0b8fb94ec80",
			"description": "",
			"title": "",
			"content": "rule apt_regin_2013_64bit_stage1    \n   {   \n          \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           description = \"Rule to detect Regin 64 bit stage 1 loaders\"   \n           version = \"1.0\"   \n           last_modified = \"2014-11-18\"   \n           filename=\"wshnetc.dll\"   \n           md5=\"bddf5afbea2d0eed77f2ad4e9a4f044d\"   \n           filename=\"wsharp.dll\"   \n           md5=\"c053a0a3f1edcbbfc9b51bc640e808ce\"   \n      \n       strings:   \n           $mz=\"MZ\"   \n           $a1=\"PRIVHEAD\"   \n           $a2=\"\\\\\\\\.\\\\PhysicalDrive%d\"   \n           $a3=\"ZwDeviceIoControlFile\"   \n      \n       condition:   \n           ($mz at 0) and (all of ($a*)) and filesize < 100000   \n   }",
			"type": "YARA",
			"id": 30345890
		},
		{
			"indicator": "353ae6a4252465295bee8a0efdc77f733cc9abbf",
			"description": "",
			"title": "",
			"content": "rule Regin_Sample_Set_2    \n   {   \n      \n       meta:   \n           description = \"Detects Regin Backdoor sample 4139149552b0322f2c5c993abccc0f0d1b38db4476189a9f9901ac0d57a656be and e420d0cf7a7983f78f5a15e6cb460e93c7603683ae6c41b27bf7f2fa34b2d935\"   \n           author = \"@MalwrSignatures\"   \n           date = \"27.11.14\"   \n           hash1 = \"4139149552b0322f2c5c993abccc0f0d1b38db4476189a9f9901ac0d57a656be\"   \n           hash2 = \"e420d0cf7a7983f78f5a15e6cb460e93c7603683ae6c41b27bf7f2fa34b2d935\"   \n      \n       strings:   \n           $hd = { fe ba dc fe }       \n           $s0 = \"d%ls%ls\" fullword wide   \n           $s1 = \"\\\\\\\\?\\\\UNC\" fullword wide   \n           $s2 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\" fullword wide   \n           $s3 = \"\\\\\\\\?\\\\UNC\\\\\" fullword wide   \n           $s4 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\" fullword wide   \n           $s5 = \"System\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Linkage\" wide fullword   \n           $s6 = \"\\\\\\\\.\\\\Global\\\\%s\" fullword wide   \n           $s7 = \"temp\" fullword wide   \n           $s8 = \"\\\\\\\\.\\\\%s\" fullword wide   \n           $s9 = \"Memory location: 0x%p, size 0x%08x\" fullword wide           \n              \n           $s10 = \"sscanf\" fullword ascii   \n           $s11 = \"disp.dll\" fullword ascii   \n           $s12 = \"%x:%x:%x:%x:%x:%x:%x:%x%c\" fullword ascii   \n           $s13 = \"%d.%d.%d.%d%c\" fullword ascii   \n           $s14 = \"imagehlp.dll\" fullword ascii   \n           $s15 = \"%hd %d\" fullword ascii   \n         \n       condition:   \n           ( $hd at 0 ) and all of ($s*) and filesize < 450KB and filesize > 360KB   \n   }",
			"type": "YARA",
			"id": 30345891
		},
		{
			"indicator": "21f6dbfce85d8e903560d19c56caf6ca20eac435",
			"description": "",
			"title": "",
			"content": "rule Regin_sig_svcsstat    \n   {   \n      \n       meta:   \n           description = \"Detects svcstat from Regin report - file svcsstat.exe_sample\"   \n           author = \"@MalwrSignatures\"   \n           date = \"26.11.14\"   \n           hash = \"5164edc1d54f10b7cb00a266a1b52c623ab005e2\"   \n      \n       strings:   \n           $s0 = \"Service Control Manager\" fullword ascii   \n           $s1 = \"_vsnwprintf\" fullword ascii   \n           $s2 = \"Root Agency\" fullword ascii   \n           $s3 = \"Root Agency0\" fullword ascii   \n           $s4 = \"StartServiceCtrlDispatcherA\" fullword ascii   \n           $s5 = \"\\\\\\\\?\\\\UNC\" fullword wide   \n           $s6 = \"%ls%ls\" fullword wide   \n      \n       condition:   \n           all of them and filesize < 15KB and filesize > 10KB    \n   }",
			"type": "YARA",
			"id": 30345892
		},
		{
			"indicator": "00f636808f97e6788191754bcb1c3f1ea5be23ca",
			"description": "",
			"title": "",
			"content": "rule Regin_APT_KernelDriver_Generic_C    \n   {   \n      \n       meta:   \n           description = \"Generic rule for Regin APT kernel driver Malware - Symantec http://t.co/qu53359Cb2\"   \n           author = \"@Malwrsignatures - included in APT Scanner THOR\"   \n           date = \"23.11.14\"   \n           hash1 = \"e0895336617e0b45b312383814ec6783556d7635\"   \n           hash2 = \"732298fa025ed48179a3a2555b45be96f7079712\"         \n      \n       strings:   \n           $m0 = { 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00 b8 }       \n           $s0 = \"KeGetCurrentIrql\" fullword ascii   \n           $s1 = \"5.2.3790.0 (srv03_rtm.030324-2048)\" fullword wide   \n           $s2 = \"usbclass\" fullword wide   \n           $x1 = \"PADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDING\" ascii   \n           $x2 = \"Universal Serial Bus Class Driver\" fullword wide   \n           $x3 = \"5.2.3790.0\" fullword wide   \n           $y1 = \"LSA Shell\" fullword wide   \n           $y2 = \"0Richw\" fullword ascii          \n          \n       condition:   \n           $m0 at 0 and all of ($s*) and ( all of ($x*) or all of ($y*) )  and filesize < 20KB   \n   }",
			"type": "YARA",
			"id": 30345893
		},
		{
			"indicator": "3a12a0db67ed295e5331558b7fa84f1f4eee13ee",
			"description": "",
			"title": "",
			"content": "rule Regin_Sample_2    \n   {   \n      \n       meta:   \n           description = \"Auto-generated rule - file hiddenmod_hookdisk_and_kdbg_8949d000.bin\"   \n           author = \"@MalwrSignatures\"   \n           date = \"26.11.14\"   \n           hash = \"a7b285d4b896b66fce0ebfcd15db53b3a74a0400\"   \n      \n       strings:   \n           $s0 = \"\\\\SYSTEMROOT\\\\system32\\\\lsass.exe\" fullword wide   \n           $s1 = \"atapi.sys\" fullword wide   \n           $s2 = \"disk.sys\" fullword wide   \n           $s3 = \"IoGetRelatedDeviceObject\" fullword ascii   \n           $s4 = \"HAL.dll\" fullword ascii   \n           $s5 = \"\\\\Registry\\\\Machine\\\\System\\\\CurrentControlSet\\\\Services\" fullword ascii   \n           $s6 = \"PsGetCurrentProcessId\" fullword ascii   \n           $s7 = \"KeGetCurrentIrql\" fullword ascii   \n           $s8 = \"\\\\REGISTRY\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\" wide   \n           $s9 = \"KeSetImportanceDpc\" fullword ascii   \n           $s10 = \"KeQueryPerformanceCounter\" fullword ascii   \n           $s14 = \"KeInitializeEvent\" fullword ascii   \n           $s15 = \"KeDelayExecutionThread\" fullword ascii   \n           $s16 = \"KeInitializeTimerEx\" fullword ascii   \n           $s18 = \"PsLookupProcessByProcessId\" fullword ascii   \n           $s19 = \"ExReleaseFastMutexUnsafe\" fullword ascii   \n           $s20 = \"ExAcquireFastMutexUnsafe\" fullword ascii   \n          \n       condition:   \n           all of them and filesize < 40KB and filesize > 30KB   \n   }",
			"type": "YARA",
			"id": 30345894
		},
		{
			"indicator": "6d3a7566ce588d9e231c835486875aee9f121b4e",
			"description": "",
			"title": "",
			"content": "rule apt_regin_2011_32bit_stage1    \n   {   \n          \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           description = \"Rule to detect Regin 32 bit stage 1 loaders\"   \n           version = \"1.0\"   \n           last_modified = \"2014-11-18\"   \n          \n       strings:   \n           $key1={331015EA261D38A7}   \n           $key2={9145A98BA37617DE}   \n           $key3={EF745F23AA67243D}   \n           $mz=\"MZ\"   \n      \n       condition:   \n           ($mz at 0) and any of ($key*) and filesize < 300000   \n   }",
			"type": "YARA",
			"id": 30345895
		},
		{
			"indicator": "8639c959a1bcc2fc7f056c74341d60c8522e437e",
			"description": "",
			"title": "",
			"content": "rule apt_ProjectSauron_encryption     \n   {   \n      \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           description = \"Rule to detect ProjectSauron string encryption\"   \n           version = \"1.0\"   \n           reference = \"https://securelist.com/blog/\"   \n      \n       strings:   \n           $a1 = {81??02AA02C175??8B??0685}   \n           $a2 = {918D9A94CDCC939A93939BD18B9AB8DE9C908DAF8D9B9BBE8C8C9AFF}   \n           $a3 = {803E225775??807E019F75??807E02BE75??807E0309}   \n      \n       condition:   \n           filesize < 5000000 and any of ($a*)   \n   }",
			"type": "YARA",
			"id": 30345923
		},
		{
			"indicator": "ced8e20e8645d0a707fee95b3765b2a78000245b",
			"description": "",
			"title": "",
			"content": "rule apt_ProjectSauron_generic_pipe_backdoor    \n   {   \n      \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           description = \"Rule to detect ProjectSauron generic pipe backdoors\"   \n           version = \"1.0\"   \n           reference = \"https://securelist.com/blog/\"   \n      \n       strings:   \n           $a = { C7 [2-3] 32 32 32 32 E8 }   \n           $b = { 42 12 67 6B }   \n           $c = { 25 31 5F 73 }   \n           $d = \"rand\"   \n           $e = \"WS2_32\"   \n      \n   condition:   \n       uint16(0) == 0x5A4D and (all of them) and filesize < 400000   \n      \n   }",
			"type": "YARA",
			"id": 30345924
		},
		{
			"indicator": "093819d952cc3bee9ef171a0d3b53a675fc40015",
			"description": "",
			"title": "",
			"content": "rule apt_ProjectSauron_MyTrampoline     \n   {   \n      \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           description = \"Rule to detect ProjectSauron MyTrampoline module\"   \n           version = \"1.0\"   \n           reference = \"https://securelist.com/blog/\"   \n      \n       strings:   \n           $a1 = \":\\\\System Volume Information\\\\{\" wide   \n           $a2 = \"\\\\\\\\.\\\\PhysicalDrive%d\" wide   \n           $a3 = \"DMWndClassX%d\"   \n           $b1 = \"{774476DF-C00F-4e3a-BF4A-6D8618CFA532}\" ascii wide   \n           $b2 = \"{820C02A4-578A-4750-A409-62C98F5E9237}\" ascii wide   \n      \n       condition:   \n           uint16(0) == 0x5A4D and filesize < 5000000 and (all of ($a*) or any of ($b*)) }",
			"type": "YARA",
			"id": 30345925
		},
		{
			"indicator": "dc0a51dba9d05ae73f5f8c9e9fdc538015c7f277",
			"description": "",
			"title": "",
			"content": "rule apt_ProjectSauron_pipe_backdoor     \n   {   \n      \n       meta:   \n           copyright = \"Kaspersky Lab\"   \n           description = \"Rule to detect ProjectSauron pipe backdoors\"   \n           version = \"1.0\"       \n           reference = \"https://securelist.com/blog/\"   \n         \n       strings:   \n           $a1 = \"CreateNamedPipeW\" fullword ascii   \n           $a2 = \"SetSecurityDescriptorDacl\" fullword ascii   \n           $a3 = \"GetOverlappedResult\" fullword ascii   \n           $a4 = \"TerminateThread\" fullword ascii   \n           $a5 = \"%s%s%X\" fullword wide     \n      \n       condition:   \n           uint16(0) == 0x5A4D  and (all of ($a*)) and filesize < 100000   \n   }",
			"type": "YARA",
			"id": 30345926
		},
		{
			"indicator": "f61d609a1b1cbbe2a2f4bda06a94664f8bd9851d",
			"description": "",
			"title": "",
			"content": "rule APT_Project_Sauron_Scripts    \n   {   \n      \n       meta:   \n           description = \"Detects scripts (mostly LUA) from Project Sauron report by Kaspersky\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/eFoP4A\"   \n           date = \"2016-08-08\"   \n      \n       strings:   \n           $x1 = \"local t = w.exec2str(\\\"regedit \"   \n           $x2 = \"local r = w.exec2str(\\\"cat\"   \n           $x3 = \"ap*.txt link*.txt node*.tun VirtualEncryptedNetwork.licence\"   \n           $x4 = \"move O FakeVirtualEncryptedNetwork.dll\"   \n           $x5 = \"sinfo | basex b 32url | dext l 30\"   \n           $x6 = \"w.exec2str(execStr)\"   \n           $x7 = \"netnfo irc | basex b 32url\"   \n           $x8 = \"w.exec(\\\"wfw status\\\")\"   \n           $x9 = \"exec(\\\"samdump\\\")\"   \n           $x10 = \"cat VirtualEncryptedNetwork.ini|grep\"   \n           $x11 = \"if string.lower(k) == \\\"securityproviders\\\" then\"   \n           $x12 = \"exec2str(\\\"plist b | grep netsvcs\\\")\"   \n           $x13 = \".*account.*|.*acct.*|.*domain.*|.*login.*|.*member.*\"   \n           $x14 = \"SAURON_KBLOG_KEY =\"   \n      \n       condition:   \n           1 of them   \n   }",
			"type": "YARA",
			"id": 30345928
		},
		{
			"indicator": "9796744360bba70c36973e6ba9f1c58a5e86cb74",
			"description": "",
			"title": "",
			"content": "rule APT_Project_Sauron_Custom_M2    \n   {   \n      \n       meta:   \n           description = \"Detects malware from Project Sauron APT\"   \n           author = \"FLorian Roth\"   \n           reference = \"https://goo.gl/eFoP4A\"   \n           date = \"2016-08-09\"   \n           hash1 = \"30a824155603c2e9d8bfd3adab8660e826d7e0681e28e46d102706a03e23e3a8\"   \n      \n       strings:   \n           $s2 = \"\\\\*\\\\3vpn\" fullword ascii   \n           $op0 = { 55 8b ec 83 ec 0c 53 56 33 f6 39 75 08 57 89 75 } /* Opcode */   \n           $op1 = { 59 59 c3 8b 65 e8 ff 75 88 ff 15 50 20 40 00 ff } /* Opcode */   \n           $op2 = { 8b 4f 06 85 c9 74 14 83 f9 12 0f 82 a7 } /* Opcode */   \n          \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 400KB and ( all of ($s*) ) and all of ($op*) )   \n   }",
			"type": "YARA",
			"id": 30345929
		},
		{
			"indicator": "42b0bb7cc26c7e758fb2e2e8af7b0b5db0b7ea88",
			"description": "",
			"title": "",
			"content": "rule APT_Project_Sauron_Custom_M7    \n   {   \n      \n       meta:   \n           description = \"Detects malware from Project Sauron APT\"   \n           author = \"FLorian Roth\"   \n           reference = \"https://goo.gl/eFoP4A\"   \n           date = \"2016-08-09\"   \n           hash1 = \"6c8c93069831a1b60279d2b316fd36bffa0d4c407068dbef81b8e2fe8fd8e8cd\"   \n           hash2 = \"7cc0bf547e78c8aaf408495ceef58fa706e6b5d44441fefdce09d9f06398c0ca\"   \n      \n       strings:   \n           $sx1 = \"Default user\" fullword wide   \n           $sx2 = \"Hincorrect header check\" fullword ascii /* Typo */   \n           $sa1 = \"MSAOSSPC.dll\" fullword ascii   \n           $sa2 = \"MSAOSSPC.DLL\" fullword wide   \n           $sa3 = \"MSAOSSPC\" fullword wide   \n           $sa4 = \"AOL Security Package\" fullword wide   \n           $sa5 = \"AOL Security Package\" fullword wide   \n           $sa6 = \"AOL Client for 32 bit platforms\" fullword wide   \n           $op0 = { 8b ce 5b e9 4b ff ff ff 55 8b ec 51 53 8b 5d 08 } /* Opcode */   \n           $op1 = { e8 0a fe ff ff 8b 4d 14 89 46 04 89 41 04 8b 45 } /* Opcode */   \n           $op2 = { e9 29 ff ff ff 83 7d fc 00 0f 84 cf 0a 00 00 8b } /* Opcode */   \n           $op3 = { 83 f8 0c 0f 85 3a 01 00 00 44 2b 41 6c 41 8b c9 } /* Opcode */   \n           $op4 = { 44 39 57 0c 0f 84 d6 0c 00 00 44 89 6f 18 45 89 } /* Opcode */   \n           $op5 = { c1 ed 02 83 c6 fe e9 68 fe ff ff 44 39 57 08 75 } /* Opcode */   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 200KB and (( 3 of ($s*) and 3 of ($op*) ) or ( 1 of ($sx*) and 1 of ($sa*) ))   \n   }",
			"type": "YARA",
			"id": 30345930
		},
		{
			"indicator": "cf3eb13379841bccf9a1ec97a24fd07575d164fa",
			"description": "",
			"title": "",
			"content": "rule APT_Project_Sauron_Custom_M4    \n   {   \n      \n       meta:   \n           description = \"Detects malware from Project Sauron APT\"   \n           author = \"FLorian Roth\"   \n           reference = \"https://goo.gl/eFoP4A\"   \n           date = \"2016-08-09\"   \n           hash1 = \"e12e66a6127cfd2cbb42e6f0d57c9dd019b02768d6f1fb44d91f12d90a611a57\"   \n      \n       strings:   \n           $s1 = \"xpsmngr.dll\" fullword wide   \n           $s2 = \"XPS Manager\" fullword wide   \n           $op0 = { 89 4d e8 89 4d ec 89 4d f0 ff d2 3d 08 00 00 c6 } /* Opcode */   \n           $op1 = { 55 8b ec ff 4d 0c 75 09 ff 75 08 ff 15 04 20 5b } /* Opcode */   \n           $op2 = { 8b 4f 06 85 c9 74 14 83 f9 13 0f 82 b6 } /* Opcode */   \n      \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 90KB and ( all of ($s*) ) and 1 of ($op*) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30345931
		},
		{
			"indicator": "32548d7214ae287b22414ad304a221edaf798e46",
			"description": "",
			"title": "",
			"content": "rule APT_Project_Sauron_dext_module    \n   {   \n      \n       meta:   \n           description = \"Detects strings from dext module - Project Sauron report by Kaspersky\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/eFoP4A\"   \n           date = \"2016-08-08\"   \n          \n       strings:   \n           $x1 = \"Assemble rows of DNS names back to a single string of data\"   \n           $x2 = \"removes checks of DNS names and lengths (during split)\"   \n           $x3 = \"Randomize data lengths (length/2 to length)\"   \n           $x4 = \"This cruft\"   \n          \n       condition:   \n           2 of them   \n   }",
			"type": "YARA",
			"id": 30345932
		},
		{
			"indicator": "a3e04b2691aec335e9e98e7fb9459e772c620819",
			"description": "",
			"title": "",
			"content": "rule Hacktool_This_Cruft    \n   {   \n      \n       meta:   \n           description = \"Detects string 'This cruft' often used in hack tools like netcat or cryptcat and also mentioned in Project Sauron report\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/eFoP4A\"   \n           date = \"2016-08-08\"   \n           score = 60   \n      \n       strings:   \n           $x1 = \"This cruft\" fullword   \n      \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 200KB and $x1 )   \n   }",
			"type": "YARA",
			"id": 30345933
		},
		{
			"indicator": "6a4a616dcf981bf8129d9ad7f3e2babda3d80917",
			"description": "",
			"title": "",
			"content": "rule APT_Project_Sauron_Custom_M3    \n   {   \n      \n       meta:   \n           description = \"Detects malware from Project Sauron APT\"   \n           author = \"FLorian Roth\"   \n           reference = \"https://goo.gl/eFoP4A\"   \n           date = \"2016-08-09\"   \n           hash1 = \"a4736de88e9208eb81b52f29bab9e7f328b90a86512bd0baadf4c519e948e5ec\"   \n         \n       strings:   \n           $s1 = \"ExampleProject.dll\" fullword ascii   \n           $op0 = { 8b 4f 06 85 c9 74 14 83 f9 13 0f 82 ba } /* Opcode */   \n           $op1 = { ff 15 34 20 00 10 85 c0 59 a3 60 30 00 10 75 04 } /* Opcode */   \n           $op2 = { 55 8b ec ff 4d 0c 75 09 ff 75 08 ff 15 00 20 00 } /* Opcode */   \n       \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 1000KB and ( all of ($s*) ) and all of ($op*) )   \n   }",
			"type": "YARA",
			"id": 30345934
		},
		{
			"indicator": "44566fdc7db841f140d981be2db928bff607e780",
			"description": "",
			"title": "",
			"content": "rule APT_Project_Sauron_arping_module    \n   {   \n      \n       meta:   \n           description = \"Detects strings from arping module - Project Sauron report by Kaspersky\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/eFoP4A\"   \n           date = \"2016-08-08\"   \n      \n       strings:   \n           $s1 = \"Resolve hosts that answer\"   \n           $s2 = \"Print only replying Ips\"   \n           $s3 = \"Do not display MAC addresses\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345935
		},
		{
			"indicator": "c566b8ce73cf22772d071b251632ba3c2f437d92",
			"description": "",
			"title": "",
			"content": "rule APT_Project_Sauron_kblogi_module    \n   {   \n      \n       meta:   \n           description = \"Detects strings from kblogi module - Project Sauron report by Kaspersky\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/eFoP4A\"   \n           date = \"2016-08-08\"   \n      \n       strings:   \n           $x1 = \"Inject using process name or pid. Default\"   \n           $s2 = \"Convert mode: Read log from file and convert to text\"   \n           $s3 = \"Maximum running time in seconds\"   \n      \n       condition:   \n           $x1 or 2 of them   \n   }",
			"type": "YARA",
			"id": 30345936
		},
		{
			"indicator": "9c04b9a4ff1c2c5e9a11cc465c01421611d6f4f9",
			"description": "",
			"title": "",
			"content": "rule APT_Project_Sauron_basex_module    \n   {   \n      \n       meta:   \n           description = \"Detects strings from basex module - Project Sauron report by Kaspersky\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/eFoP4A\"   \n           date = \"2016-08-08\"   \n      \n       strings:   \n           $x1 = \"64, 64url, 32, 32url or 16.\"   \n           $s2 = \"Force decoding when input is invalid/corrupt\"   \n           $s3 = \"This cruft\"   \n      \n       condition:   \n           $x1 or 2 of them   \n   }",
			"type": "YARA",
			"id": 30345937
		},
		{
			"indicator": "c50fb644b0e4e8d3486550c7e476ebdf7351abd3",
			"description": "",
			"title": "",
			"content": "rule APT_Project_Sauron_Custom_M1    \n   {   \n      \n       meta:   \n           description = \"Detects malware from Project Sauron APT\"   \n           author = \"FLorian Roth\"   \n           reference = \"https://goo.gl/eFoP4A\"   \n           date = \"2016-08-09\"   \n           hash1 = \"9572624b6026311a0e122835bcd7200eca396802000d0777dba118afaaf9f2a9\"   \n      \n       strings:   \n           $s1 = \"ncnfloc.dll\" fullword wide   \n           $s4 = \"Network Configuration Locator\" fullword wide   \n      \n           $op0 = { 80 75 6e 85 c0 79 6a 66 41 83 38 0a 75 63 0f b7 } /* Opcode */   \n           $op1 = { 80 75 29 85 c9 79 25 b9 01 } /* Opcode */   \n           $op2 = { 2b d8 48 89 7c 24 38 44 89 6c 24 40 83 c3 08 89 } /* Opcode */   \n      \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 200KB and ( all of ($s*) ) and 1 of ($op*) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30345938
		},
		{
			"indicator": "5ddf36faebf850297bd57c315861e5e5a2966599",
			"description": "",
			"title": "",
			"content": "rule APT_Project_Sauron_Custom_M6    \n   {   \n      \n       meta:   \n           description = \"Detects malware from Project Sauron APT\"   \n           author = \"FLorian Roth\"   \n           reference = \"https://goo.gl/eFoP4A\"   \n           date = \"2016-08-09\"   \n           hash1 = \"3782b63d7f6f688a5ccb1b72be89a6a98bb722218c9f22402709af97a41973c8\"   \n      \n       strings:   \n           $s1 = \"rseceng.dll\" fullword wide   \n           $s2 = \"Remote Security Engine\" fullword wide   \n           $op0 = { 8b 0d d5 1d 00 00 85 c9 0f 8e a2 } /* Opcode */   \n           $op1 = { 80 75 6e 85 c0 79 6a 66 41 83 38 0a 75 63 0f b7 } /* Opcode */   \n           $op2 = { 80 75 29 85 c9 79 25 b9 01 } /* Opcode */   \n         \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 200KB and ( all of ($s*) ) and 1 of ($op*) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30345939
		},
		{
			"indicator": "4c2f8c40c131b7db3f96c202a987589ab056e104",
			"description": "",
			"title": "",
			"content": "rule Scieron   \n   {   \n       meta:   \n           author = \"Symantec Security Response\"   \n           ref = \"http://www.symantec.com/connect/tr/blogs/scarab-attackers-took-aim-select-russian-targets-2012\"   \n           date = \"22.01.15\"   \n      \n       strings:   \n           // .text:10002069 66 83 F8 2C                       cmp     ax, ','   \n           // .text:1000206D 74 0C                             jz      short loc_1000207B   \n           // .text:1000206F 66 83 F8 3B                       cmp     ax, ';'   \n           // .text:10002073 74 06                             jz      short loc_1000207B   \n           // .text:10002075 66 83 F8 7C                       cmp     ax, '|'   \n           // .text:10002079 75 05                             jnz     short loc_10002080   \n           $code1 = {66 83 F? 2C 74 0C 66 83 F? 3B 74 06 66 83 F? 7C 75 05}   \n              \n           // .text:10001D83 83 F8 09                          cmp     eax, 9          ; switch 10 cases   \n           // .text:10001D86 0F 87 DB 00 00 00                 ja      loc_10001E67    ; jumptable 10001D8C default case   \n           // .text:10001D8C FF 24 85 55 1F 00+                jmp     ds:off_10001F55[eax*4] ; switch jump   \n           $code2 = {83 F? 09 0F 87 ?? 0? 00 00 FF 24}   \n              \n           $str1  = \"IP_PADDING_DATA\" wide ascii   \n           $str2  = \"PORT_NUM\" wide ascii   \n              \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30345947
		},
		{
			"indicator": "d7e243dd4194396b3292fbcf3f05273f53b1dee7",
			"description": "",
			"title": "",
			"content": "rule SeaDuke_Sample    \n   {   \n      \n       meta:   \n           description = \"SeaDuke Malware - file 3eb86b7b067c296ef53e4857a74e09f12c2b84b666fc130d1f58aec18bc74b0d\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/MJ0c2M\"   \n           date = \"2015-07-14\"   \n           score = 70   \n           hash = \"d2e570129a12a47231a1ecb8176fa88a1bf415c51dabd885c513d98b15f75d4e\"   \n      \n       strings:   \n           $s0 = \"bpython27.dll\" fullword ascii   \n           $s1 = \"email.header(\" fullword ascii /* PEStudio Blacklist: strings */   \n           $s2 = \"LogonUI.exe\" fullword wide /* PEStudio Blacklist: strings */   \n           $s3 = \"Crypto.Cipher.AES(\" fullword ascii /* PEStudio Blacklist: strings */   \n           $s4 = \"mod is NULL - %s\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 4000KB and all of them   \n   }",
			"type": "YARA",
			"id": 30345948
		},
		{
			"indicator": "110cdb226348f9af5c7652aa14c44ed83f6b1d35",
			"description": "",
			"title": "",
			"content": "rule SNOWGLOBE_Babar_Malware    \n   {   \n      \n       meta:   \n           description = \"Detects the Babar Malware used in the SNOWGLOBE attacks - file babar.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"http://motherboard.vice.com/read/meet-babar-a-new-malware-almost-certainly-created-by-france\"   \n           date = \"2015/02/18\"   \n           hash = \"27a0a98053f3eed82a51cdefbdfec7bb948e1f36\"   \n           score = 80   \n      \n       strings:   \n           $mz = { 4d 5a }   \n           $z0 = \"admin\\\\Desktop\\\\Babar64\\\\Babar64\\\\obj\\\\DllWrapper\" ascii fullword   \n           $z1 = \"User-Agent: Mozilla/4.0 (compatible; MSI 6.0;\" ascii fullword   \n           $z2 = \"ExecQueryFailled!\" fullword ascii   \n           $z3 = \"NBOT_COMMAND_LINE\" fullword   \n           $z4 = \"!!!EXTRACT ERROR!!!File Does Not Exists-->[%s]\" fullword   \n           $s1 = \"/s /n %s \\\"%s\\\"\" fullword ascii   \n           $s2 = \"%%WINDIR%%\\\\%s\\\\%s\" fullword ascii   \n           $s3 = \"/c start /wait \" fullword ascii   \n           $s4 = \"(D;OICI;FA;;;AN)(A;OICI;FA;;;BG)(A;OICI;FA;;;SY)(A;OICI;FA;;;LS)\" ascii   \n           $x1 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\\\\\" fullword ascii   \n           $x2 = \"%COMMON_APPDATA%\" fullword ascii   \n           $x4 = \"CONOUT$\" fullword ascii   \n           $x5 = \"cmd.exe\" fullword ascii   \n           $x6 = \"DLLPATH\" fullword ascii   \n          \n       condition:   \n           ( $mz at 0 ) and filesize < 1MB and (( 1 of ($z*) and 1 of ($x*) ) or ( 3 of ($s*) and 4 of ($x*) ) )   \n   }",
			"type": "YARA",
			"id": 30345953
		},
		{
			"indicator": "2c36674e3e5b15a7b8b46400666bafb55264b7fb",
			"description": "",
			"title": "",
			"content": "rule Sofacy_Bundestag_Mal3    \n   {   \n      \n       meta:   \n           description = \"Sofacy Group Malware Sample 3\"   \n           author = \"Florian Roth\"   \n           reference = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"   \n           date = \"2015-06-19\"   \n           hash = \"5f6b2a0d1d966fc4f1ed292b46240767f4acb06c13512b0061b434ae2a692fa1\"   \n           score = 70   \n         \n       strings:   \n           $s1 = \"shell\\\\open\\\\command=\\\"System Volume Information\\\\USBGuard.exe\\\" install\" fullword ascii    \n           $s2 = \".?AVAgentModuleRemoteKeyLogger@@\" fullword ascii    \n           $s3 = \"<font size=4 color=red>process isn't exist</font>\" fullword ascii    \n           $s4 = \"<font size=4 color=red>process is exist</font>\" fullword ascii    \n           $s5 = \".winnt.check-fix.com\" fullword ascii    \n           $s6 = \".update.adobeincorp.com\" fullword ascii    \n           $s7 = \".microsoft.checkwinframe.com\" fullword ascii   \n           $s8 = \"adobeincorp.com\" fullword wide    \n           $s9 = \"# EXC: HttpSender - Cannot create Get Channel!\" fullword ascii    \n           $x1 = \"User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:20.0) Gecko/20100101 Firefox/\" wide    \n           $x2 = \"User-Agent: Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/2\" wide    \n           $x3 = \"C:\\\\Windows\\\\System32\\\\cmd.exe\" fullword wide    \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 300KB and ( 2 of ($s*) or ( 1 of ($s*) and all of ($x*) ))    \n   }",
			"type": "YARA",
			"id": 30357067
		},
		{
			"indicator": "a5847b97c727258d54f1d9e7867d2731df8bf91c",
			"description": "",
			"title": "",
			"content": "rule Sofacy_Bundestag_Batch    \n   {   \n      \n       meta:   \n           description = \"Sofacy Bundestags APT Batch Script\"   \n           author = \"Florian Roth\"   \n           reference = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"   \n           date = \"2015-06-19\"   \n           score = 70   \n       \n       strings:   \n           $s1 = \"for %%G in (.pdf, .xls, .xlsx, .doc, .docx) do (\" ascii    \n           $s2 = \"cmd /c copy\"   \n           $s3 = \"forfiles\"   \n        \n       condition:   \n           filesize < 10KB and all of them   \n   }",
			"type": "YARA",
			"id": 30357068
		},
		{
			"indicator": "43ae9a004ffaa736c2565b7063bb2f3e0304cf55",
			"description": "",
			"title": "",
			"content": "rule Sofacy_Bundestag_Mal2    \n   {   \n      \n       meta:   \n           description = \"Sofacy Group Malware Sample 2\"   \n           author = \"Florian Roth\"   \n           reference = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"   \n           date = \"2015-06-19\"   \n           hash = \"566ab945f61be016bfd9e83cc1b64f783b9b8deb891e6d504d3442bc8281b092\"   \n           score = 70   \n         \n       strings:   \n           $x1 = \"PROJECT\\\\XAPS_OBJECTIVE_DLL\\\\\" ascii   \n           $x2 = \"XAPS_OBJECTIVE.dll\" fullword ascii   \n           $s1 = \"i`m wait\" fullword ascii    \n         \n       condition:   \n           uint16(0) == 0x5a4d and ( 1 of ($x*) ) and $s1   \n   }",
			"type": "YARA",
			"id": 30357069
		},
		{
			"indicator": "456da7fe6aad1eae949f42b6b187fa6616a119f5",
			"description": "",
			"title": "",
			"content": "rule Sofacy_Bundestag_Winexe   \n   {   \n      \n       meta:   \n           description = \"Winexe tool used by Sofacy group in Bundestag APT\"   \n           author = \"Florian Roth\"   \n           reference = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"   \n           date = \"2015-06-19\"   \n           hash = \"5130f600cd9a9cdc82d4bad938b20cbd2f699aadb76e7f3f1a93602330d9997d\"   \n           score = 70   \n        \n       strings:   \n           $s1 = \"\\\\\\\\.\\\\pipe\\\\ahexec\" fullword ascii    \n           $s2 = \"implevel\" fullword ascii   \n        \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 115KB and all of them   \n   }",
			"type": "YARA",
			"id": 30357070
		},
		{
			"indicator": "d2f582c70bb93bf81ff8179513402df63c245ae7",
			"description": "",
			"title": "",
			"content": "rule Sofacy_Fybis_ELF_Backdoor_Gen1   \n   {   \n          \n       meta:   \n           description = \"Detects Sofacy Fysbis Linux Backdoor_Naikon_APT_Sample1\"   \n           author = \"Florian Roth\"   \n           reference = \"http://researchcenter.paloaltonetworks.com/2016/02/a-look-into-fysbis-sofacys-linux-backdoor/\"   \n           date = \"2016-02-13\"   \n           score = 80   \n           hash1 = \"02c7cf55fd5c5809ce2dce56085ba43795f2480423a4256537bfdfda0df85592\"   \n           hash2 = \"8bca0031f3b691421cb15f9c6e71ce193355d2d8cf2b190438b6962761d0c6bb\"   \n          \n       strings:   \n           $x1 = \"Your command not writed to pipe\" fullword ascii   \n           $x2 = \"Terminal don`t started for executing command\" fullword ascii   \n           $x3 = \"Command will have end with \\\\n\" fullword ascii   \n           $s1 = \"WantedBy=multi-user.target' >> /usr/lib/systemd/system/\" fullword ascii   \n           $s2 = \"Success execute command or long for waiting executing your command\" fullword ascii   \n           $s3 = \"ls /etc | egrep -e\\\"fedora*|debian*|gentoo*|mandriva*|mandrake*|meego*|redhat*|lsb-*|sun-*|SUSE*|release\\\"\" fullword ascii   \n           $s4 = \"rm -f /usr/lib/systemd/system/\" fullword ascii   \n           $s5 = \"ExecStart=\" fullword ascii   \n           $s6 = \"<table><caption><font size=4 color=red>TABLE EXECUTE FILES</font></caption>\" fullword ascii   \n      \n       condition:   \n           ( uint16(0) == 0x457f and filesize < 500KB and 1 of ($x*) ) or ( 1 of ($x*) and 3 of ($s*) )   \n   }",
			"type": "YARA",
			"id": 30357077
		},
		{
			"indicator": "55a38e3869f093256fd1deda5bdca6fdfda42905",
			"description": "",
			"title": "",
			"content": "rule Sofacy_Fysbis_ELF_Backdoor_Gen2    \n   {   \n      \n       meta:   \n           description = \"Detects Sofacy Fysbis Linux Backdoor\"   \n           author = \"Florian Roth\"   \n           reference = \"http://researchcenter.paloaltonetworks.com/2016/02/a-look-into-fysbis-sofacys-linux-backdoor/\"   \n           date = \"2016-02-13\"   \n           score = 80   \n           hash1 = \"02c7cf55fd5c5809ce2dce56085ba43795f2480423a4256537bfdfda0df85592\"   \n           hash2 = \"8bca0031f3b691421cb15f9c6e71ce193355d2d8cf2b190438b6962761d0c6bb\"   \n           hash3 = \"fd8b2ea9a2e8a67e4cb3904b49c789d57ed9b1ce5bebfe54fe3d98214d6a0f61\"   \n        \n       strings:   \n           $s1 = \"RemoteShell\" ascii   \n           $s2 = \"basic_string::_M_replace_dispatch\" fullword ascii   \n           $s3 = \"HttpChannel\" ascii   \n        \n       condition:   \n           uint16(0) == 0x457f and filesize < 500KB and all of them   \n   }",
			"type": "YARA",
			"id": 30357078
		},
		{
			"indicator": "f930839e03cb88aadae74de57e372803a161c081",
			"description": "",
			"title": "",
			"content": "rule Sofacy_Jun16_Sample3    \n   {   \n      \n       meta:   \n           description = \"Detects Sofacy Malware mentioned in PaloAltoNetworks APT report\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/mzAa97\"   \n           date = \"2016-06-14\"   \n           score = 85   \n           hash1 = \"c2551c4e6521ac72982cb952503a2e6f016356e02ee31dea36c713141d4f3785\"   \n         \n       strings:   \n           $s1 = \"ASLIiasiuqpssuqkl713h\" fullword wide   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 200KB and $s1   \n   }",
			"type": "YARA",
			"id": 30357082
		},
		{
			"indicator": "426521870157fa9945a6345e236511d544e85ec6",
			"description": "",
			"title": "",
			"content": "rule Sofacy_Jun16_Sample2     \n   {   \n      \n       meta:   \n           description = \"Detects Sofacy Malware mentioned in PaloAltoNetworks APT report\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/mzAa97\"   \n           date = \"2016-06-14\"   \n           score = 85   \n           hash1 = \"57d230ddaf92e2d0504e5bb12abf52062114fb8980c5ecc413116b1d6ffedf1b\"   \n           hash2 = \"69940a20ab9abb31a03fcefe6de92a16ed474bbdff3288498851afc12a834261\"   \n           hash3 = \"aeeab3272a2ed2157ebf67f74c00fafc787a2b9bbaa17a03be1e23d4cb273632\"   \n       \n       strings:   \n           $x1 = \"DGMNOEP\" fullword ascii   \n           $x2 = \"/%s%s%s/?%s=\" fullword ascii   \n           $s1 = \"Control Panel\\\\Dehttps=https://%snetwork.proxy.ht2\" fullword ascii   \n           $s2 = \"http=http://%s:%Control Panel\\\\Denetwork.proxy.ht&ol1mS9\" fullword ascii   \n           $s3 = \"svchost.dll\" fullword wide   \n           $s4 = \"clconfig.dll\" fullword wide   \n          \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 100KB and ( all of ($x*) ) ) or ( 3 of them )   \n   }",
			"type": "YARA",
			"id": 30357083
		},
		{
			"indicator": "c43c25dd70e3026595c15fb49f2b74e32de170d1",
			"description": "",
			"title": "",
			"content": "rule Sofacy_Jun16_Sample1     \n   {   \n      \n       meta:   \n           description = \"Detects Sofacy Malware mentioned in PaloAltoNetworks APT report\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/mzAa97\"   \n           date = \"2016-06-14\"   \n           score = 85   \n           hash1 = \"be1cfa10fcf2668ae01b98579b345ebe87dab77b6b1581c368d1aba9fd2f10a0\"   \n      \n       strings:   \n           $s1 = \"clconfg.dll\" fullword ascii   \n           $s2 = \"ASijnoKGszdpodPPiaoaghj8127391\" fullword wide   \n      \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 200KB and ( 1 of ($s*) ) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30357084
		},
		{
			"indicator": "e63794c2136d405d630d6cb7e940da81263ca59d",
			"description": "",
			"title": "",
			"content": "rule Sphinx_Moth_nvcplex    \n   {    \n      \n       meta:   \n           description = \"sphinx moth threat group file nvcplex.dat\"    \n           author = \"Kudelski Security - Nagravision SA\"   \n           reference = \"www.kudelskisecurity.com\"   \n           date = \"2015-08-06\"   \n      \n       strings:   \n           $s0 = \"mshtaex.exe\" fullword wide   \n           $op0 = { 41 8b cc 44 89 6c 24 28 48 89 7c 24 20 ff 15 d3 } /* Opcode */    \n           $op1 = { 48 3b 0d ad 8f 00 00 74 05 e8 ba f5 ff ff 48 8b } /* Opcode */    \n           $op2 = { 8b ce e8 49 47 00 00 90 8b 43 04 89 05 93 f1 00 } /* Opcode */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 214KB and all of them   \n   }",
			"type": "YARA",
			"id": 30357090
		},
		{
			"indicator": "71002197be0ef4f78441f322370c1c51ca18d3d4",
			"description": "",
			"title": "",
			"content": "rule Sphinx_Moth_cudacrt    \n   {    \n      \n       meta:   \n           description = \"sphinx moth threat group file cudacrt.dll\"    \n           author = \"Kudelski Security - Nagravision SA\"   \n           reference = \"www.kudelskisecurity.com\"   \n           date = \"2015-08-06\"   \n      \n       strings:   \n           $s0 = \"HPSSOEx.dll\" fullword wide   \n           $s1 = \"255.255.255.254\" fullword wide   \n           $s2 = \"SOFTWARE\\\\SsoAuth\\\\Service\" fullword wide   \n           $op0 = { ff 15 5f de 00 00 48 8b f8 48 85 c0 75 0d 48 8b } /* Opcode */    \n           $op1 = { 45 33 c9 4c 8d 05 a7 07 00 00 33 d2 33 c9 ff 15 } /* Opcode */    \n           $op2 = { e8 7a 1c 00 00 83 f8 01 74 17 b9 03 } /* Opcode */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 243KB and all of ($s*) and 1 of ($op*)   \n   }",
			"type": "YARA",
			"id": 30357091
		},
		{
			"indicator": "180c5c80a4f4c7f43f957e6469c7ab50575da146",
			"description": "",
			"title": "",
			"content": "rule Sphinx_Moth_kerberos64    \n   {    \n      \n       meta:   \n           description = \"sphinx moth threat group file kerberos64.dll\"    \n           author = \"Kudelski Security - Nagravision SA (modified by Florian Roth)\"   \n           reference = \"www.kudelskisecurity.com\"   \n           date = \"2015-08-06\"   \n      \n       strings:   \n           $s0 = \"KERBEROS64.dll\" fullword ascii   \n           $s1 = \"zeSecurityDescriptor\" fullword ascii   \n           $s2 = \"SpGetInfo\" fullword ascii   \n           $s3 = \"SpShutdown\" fullword ascii   \n           $op0 = { 75 05 e8 6a c7 ff ff 48 8b 1d 47 d6 00 00 33 ff } /* Opcode */    \n           $op1 = { 48 89 05 0c 2b 01 00 c7 05 e2 29 01 00 09 04 00 } /* Opcode */    \n           $op2 = { 48 8d 3d e3 ee 00 00 ba 58 } /* Opcode */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 406KB and all of ($s*) and 1 of ($op*)   \n   }",
			"type": "YARA",
			"id": 30357092
		},
		{
			"indicator": "3ac8f5db3973b5ca040063141e510ee884c5bfb9",
			"description": "",
			"title": "",
			"content": "rule Sphinx_Moth_iastor32    \n   {    \n      \n       meta:   \n           description = \"sphinx moth threat group file iastor32.exe\"    \n           author = \"Kudelski Security - Nagravision SA\"   \n           reference = \"www.kudelskisecurity.com\"   \n           date = \"2015-08-06\"   \n         \n       strings:   \n           $s0 = \"MIIEpQIBAAKCAQEA4lSvv/W1Mkz38Q3z+EzJBZRANzKrlxeE6/UXWL67YtokF2nN\" fullword ascii /* private key */   \n           $s1 = \"iAeS3CCA4wli6+9CIgX8SAiXd5OezHvI1jza61z/flsqcC1IP//gJVt16nRx3s9z\" fullword ascii /* private key */   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 2000KB and all of them   \n   }",
			"type": "YARA",
			"id": 30357093
		},
		{
			"indicator": "ebccf51f55e652d203d09a55a40b6421cc882703",
			"description": "",
			"title": "",
			"content": "rule Sphinx_Moth_kerberos32    \n   {   \n      \n       meta:   \n           description = \"sphinx moth threat group file kerberos32.dll\"    \n           author = \"Kudelski Security - Nagravision SA (modified by Florian Roth)\"   \n           reference = \"www.kudelskisecurity.com\"   \n           date = \"2015-08-06\"   \n      \n       strings:   \n           $x1 = \"%WINDIR%\\\\ativpsrz.bin\" fullword ascii   \n           $x2 = \"%WINDIR%\\\\ativpsrn.bin\" fullword ascii   \n           $x3 = \"kerberos32.dll\" fullword wide   \n           $x4 = \"KERBEROS64.dll\" fullword ascii   \n           $x5 = \"kerberos%d.dll\" fullword ascii   \n           $s1 = \"\\\\\\\\.\\\\pipe\\\\lsassp\" fullword ascii   \n           $s2 = \"LSASS secure pipe\" fullword ascii /* PEStudio Blacklist: strings */    \n           $s3 = \"NullSessionPipes\" fullword ascii /* PEStudio Blacklist: strings */    \n           $s4 = \"getlog\" fullword ascii   \n           $s5 = \"startlog\" fullword ascii /* PEStudio Blacklist: strings */   \n           $s6 = \"stoplog\" fullword ascii /* PEStudio Blacklist: strings */   \n           $s7 = \"Unsupported OS (%d)\" fullword ascii /* PEStudio Blacklist: strings */    \n           $s8 = \"Unsupported OS (%s)\" fullword ascii /* PEStudio Blacklist: strings */   \n          \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 300KB and (2 of ($x*) or all of ($s*))   \n   }",
			"type": "YARA",
			"id": 30357094
		},
		{
			"indicator": "7512741e5a65036f5b1b9fec1e37280f84c4d6e5",
			"description": "",
			"title": "",
			"content": "rule Sphinx_Moth_h2t    \n   {    \n      \n       meta:   \n           description = \"sphinx moth threat group file h2t.dat\"    \n           author = \"Kudelski Security - Nagravision SA (modified by Florian Roth)\"    \n           reference = \"www.kudelskisecurity.com\"   \n           date = \"2015-08-06\"   \n      \n       strings:   \n           $x1 = \"%s <proxy ip> <proxy port> <target ip> <target port> <cmd> [arg1 cmd] ... [argX cmd]\" fullword ascii    \n           $s1 = \"[-] Error in connection() %d - %s\" fullword ascii   \n           $s2 = \"[-] Child process exit.\" fullword ascii   \n           $s3 = \"POST http://%s:%s/ HTTP/1.1\" fullword ascii   \n           $s4 = \"pipe() to\" fullword ascii   \n           $s5 = \"pipe() from\" fullword ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 156KB and ($x1 or all of ($s*))   \n   }",
			"type": "YARA",
			"id": 30357095
		},
		{
			"indicator": "47ef47c8a2f27b86186334d20c4a85f79f2b1419",
			"description": "",
			"title": "",
			"content": "rule LiuDoor_Malware_2    \n   {   \n      \n       meta:   \n           description = \"Liudoor Trojan used in Terracotta APT\"   \n           author = \"Florian Roth\"   \n           reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"   \n           date = \"2015-08-04\"   \n           score = 70   \n           super_rule = 1   \n           hash1 = \"f3fb68b21490ded2ae7327271d3412fbbf9d705c8003a195a705c47c98b43800\"   \n           hash2 = \"e42b8385e1aecd89a94a740a2c7cd5ef157b091fabd52cd6f86e47534ca2863e\"   \n      \n       strings:   \n           $s0 = \"svchostdllserver.dll\" fullword ascii    \n           $s1 = \"Lpykh~mzCCRv|mplpykCCHvq{phlCC\\\\jmmzqkIzmlvpqCC\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 100KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360118
		},
		{
			"indicator": "5dbf27fa7a2e6cf133e2e18169e195bb7dc5f2f5",
			"description": "",
			"title": "",
			"content": "rule RemoteExec_Tool    \n   {   \n      \n       meta:   \n           description = \"Remote Access Tool used in APT Terracotta\"   \n           author = \"Florian Roth\"   \n           reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"   \n           date = \"2015-08-04\"   \n           hash = \"a550131e106ff3c703666f15d55d9bc8c816d1cb9ac1b73c2e29f8aa01e53b78\"   \n      \n       strings:   \n           $s0 = \"cmd.exe /q /c \\\"%s\\\"\" fullword ascii    \n           $s1 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii    \n           $s2 = \"This is a service executable! Couldn't start directly.\" fullword ascii    \n           $s3 = \"\\\\\\\\.\\\\pipe\\\\TermHlp_communicaton\" fullword ascii    \n           $s4 = \"TermHlp_stdout\" fullword ascii    \n           $s5 = \"TermHlp_stdin\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 75KB and 4 of ($s*)   \n   }",
			"type": "YARA",
			"id": 30360119
		},
		{
			"indicator": "bc23bf7f0cb9f3c47a6609185395e32016d4fb05",
			"description": "",
			"title": "",
			"content": "rule Apolmy_Privesc_Trojan    \n   {   \n      \n       meta:   \n           description = \"Apolmy Privilege Escalation Trojan used in APT Terracotta\"   \n           author = \"Florian Roth\"   \n           reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"   \n           date = \"2015-08-04\"   \n           score = 80   \n           hash = \"d7bd289e6cee228eb46a1be1fcdc3a2bd5251bc1eafb59f8111756777d8f373d\"   \n      \n       strings:   \n           $s1 = \"[%d] Failed, %08X\" fullword ascii   \n           $s2 = \"[%d] Offset can not fetched.\" fullword ascii   \n           $s3 = \"PowerShadow2011\" fullword wide   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 300KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360120
		},
		{
			"indicator": "352206db7d9113cd800707881df6654ee57be82a",
			"description": "",
			"title": "",
			"content": "rule liudoor   \n   {   \n      \n       meta:   \n           author = \"RSA FirstWatch\"   \n           date = \"2015-07-23\"   \n           description = \"Detects Liudoor daemon backdoor\"   \n           hash0 = \"78b56bc3edbee3a425c96738760ee406\"   \n           hash1 = \"5aa0510f6f1b0e48f0303b9a4bfc641e\"   \n           hash2 = \"531d30c8ee27d62e6fbe855299d0e7de\"   \n           hash3 = \"2be2ac65fd97ccc97027184f0310f2f3\"   \n           hash4 = \"6093505c7f7ec25b1934d3657649ef07\"   \n           type = \"Win32 DLL\"   \n      \n       strings:   \n           $string0 = \"Succ\"   \n           $string1 = \"Fail\"   \n           $string2 = \"pass\"   \n           $string3 = \"exit\"   \n           $string4 = \"svchostdllserver.dll\"   \n           $string5 = \"L$,PQR\"   \n           $string6 = \"0/0B0H0Q0W0k0\"   \n           $string7 = \"QSUVWh\"   \n           $string8 = \"Ht Hu[\"   \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30360121
		},
		{
			"indicator": "c29cdf8488ae0d4b717eeb218221ffcaa5434c18",
			"description": "",
			"title": "",
			"content": "rule Mithozhan_Trojan    \n   {   \n      \n       meta:   \n           description = \"Mitozhan Trojan used in APT Terracotta\"   \n           author = \"Florian Roth\"   \n           reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"   \n           date = \"2015-08-04\"   \n           score = 70   \n           hash = \"8553b945e2d4b9f45c438797d6b5e73cfe2899af1f9fd87593af4fd7fb51794a\"   \n          \n       strings:   \n           $s1 = \"adbrowser\" fullword wide    \n           $s2 = \"IJKLlGdmaWhram0vn36BgIOChYR3L45xcHNydXQvhmloa2ptbH8voYCDTw==\" fullword ascii   \n           $s3 = \"EFGHlGdmaWhrL41sf36BgIOCL6R3dk8=\" fullword ascii   \n          \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 300KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360122
		},
		{
			"indicator": "4b80f0fe280e34f80e0b724d59807152ce8d7398",
			"description": "",
			"title": "",
			"content": "rule LiuDoor_Malware_1    \n   {   \n      \n       meta:   \n           description = \"Liudoor Trojan used in Terracotta APT\"   \n           author = \"Florian Roth\"   \n           reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"   \n           date = \"2015-08-04\"   \n           score = 70   \n           super_rule = 1   \n           hash1 = \"deed6e2a31349253143d4069613905e1dfc3ad4589f6987388de13e33ac187fc\"   \n           hash2 = \"4575e7fc8f156d1d499aab5064a4832953cd43795574b4c7b9165cdc92993ce5\"   \n           hash3 = \"ad1a507709c75fe93708ce9ca1227c5fefa812997ed9104ff9adfec62a3ec2bb\"   \n      \n       strings:   \n           $s1 = \"svchostdllserver.dll\" fullword ascii    \n           $s2 = \"SvcHostDLL: RegisterServiceCtrlHandler %S failed\" fullword ascii    \n           $s3 = \"\\\\nbtstat.exe\" fullword ascii   \n           $s4 = \"DataVersionEx\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 150KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360123
		},
		{
			"indicator": "0b8be289a5d4395996b77f451c713e72585339c7",
			"description": "",
			"title": "",
			"content": "rule HttpBrowser_RAT_Sample2     \n   {   \n      \n       meta:   \n           description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Sample\"   \n           author = \"Florian Roth\"   \n           reference = \"http://snip.ly/giNB\"   \n           date = \"2015-08-06\"   \n           score = 80   \n           hash1 = \"c57c5a2c322af2835ae136b75283eaaeeaa6aa911340470182a9983ae47b8992\"   \n         \n       strings:   \n           $s0 = \"nKERNEL32.DLL\" fullword wide   \n           $s1 = \"WUSER32.DLL\" fullword wide   \n           $s2 = \"mscoree.dll\" fullword wide   \n           $s3 = \"VPDN_LU.exeUT\" fullword ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 250KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360137
		},
		{
			"indicator": "867010e0d29b99e3414c242fab9299c77d947f70",
			"description": "",
			"title": "",
			"content": "rule ThreatGroup3390_Strings    \n   {   \n      \n       meta:   \n           description = \"Threat Group 3390 APT - Strings\"   \n           author = \"Florian Roth\"   \n           reference = \"http://snip.ly/giNB\"   \n           date = \"2015-08-06\"   \n           score = 60   \n       \n       strings:   \n           $s1 = \"\\\"cmd\\\" /c cd /d \\\"c:\\\\Windows\\\\Temp\\\\\\\"&copy\" ascii   \n           $s2 = \"svchost.exe a -k -r -s -m5 -v1024000 -padmin-windows2014\"   \n           $s3 = \"ren *.rar *.zip\" fullword ascii   \n           $s4 = \"c:\\\\temp\\\\ipcan.exe\" fullword ascii   \n           $s5 = \"<%eval(Request.Item(\\\"admin-na-google123!@#\" ascii   \n       \n       condition:   \n           1 of them and filesize < 30KB   \n   }",
			"type": "YARA",
			"id": 30360138
		},
		{
			"indicator": "ac7e4bfde09eab9ffa8956fdb4767d2998c2118a",
			"description": "",
			"title": "",
			"content": "rule HttpBrowser_RAT_dropper_Gen2    \n   {   \n      \n       meta:   \n           description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Dropper\"   \n           author = \"Florian Roth\"   \n           reference = \"http://snip.ly/giNB\"   \n           date = \"2015-08-06\"   \n           score = 70   \n           hash1 = \"c57c5a2c322af2835ae136b75283eaaeeaa6aa911340470182a9983ae47b8992\"   \n           hash2 = \"dfa984174268a9f364d856fd47cfaca75804640f849624d69d81fcaca2b57166\"   \n         \n       strings:   \n           $s1 = \"navlu.dll.urlUT\" fullword ascii   \n           $s2 = \"VPDN_LU.exeUT\" fullword ascii   \n           $s3 = \"pnipcn.dllUT\" fullword ascii   \n           $s4 = \"\\\\ssonsvr.exe\" fullword ascii   \n           $s5 = \"/c del /q %s\" fullword ascii   \n           $s6 = \"\\\\setup.exe\" fullword ascii    \n           $s7 = \"msi.dllUT\" fullword ascii   \n           $op0 = { 8b 45 0c 83 38 00 0f 84 98 } /* Opcode */   \n           $op1 = { e8 dd 07 00 00 ff 35 d8 fb 40 00 8b 35 7c a0 40 } /* Opcode */   \n           $op2 = { 83 fb 08 75 2c 8b 0d f8 af 40 00 89 4d dc 8b 0d } /* Opcode */   \n           $op3 = { c7 43 18 8c 69 40 00 e9 da 01 00 00 83 7d f0 00 } /* Opcode */   \n           $op4 = { 6a 01 e9 7c f8 ff ff bf 1a 40 00 96 1b 40 00 01 } /* Opcode */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 400KB and 3 of ($s*) and 1 of ($op*)   \n   }",
			"type": "YARA",
			"id": 30360139
		},
		{
			"indicator": "6ef83dd722f05ac9bc0f273b29d972b407ceb1e4",
			"description": "",
			"title": "",
			"content": "rule PlugX_NvSmartMax_Gen    \n   {   \n      \n       meta:   \n           description = \"Threat Group 3390 APT Sample - PlugX NvSmartMax Generic\"   \n           author = \"Florian Roth\"   \n           reference = \"http://snip.ly/giNB\"   \n           date = \"2015-08-06\"   \n           score = 70   \n           hash1 = \"718fc72942b9b706488575c0296017971170463f6f40fa19b08fc84b79bf0cef\"   \n           hash2 = \"1c0379481d17fc80b3330f148f1b87ff613cfd2a6601d97920a0bcd808c718d0\"   \n           hash3 = \"555952aa5bcca4fa5ad5a7269fece99b1a04816d104ecd8aefabaa1435f65fa5\"   \n           hash4 = \"71f7a9da99b5e3c9520bc2cc73e520598d469be6539b3c243fb435fe02e44338\"   \n           hash5 = \"65bbf0bd8c6e1ccdb60cf646d7084e1452cb111d97d21d6e8117b1944f3dc71e\"   \n          \n       strings:   \n           $s0 = \"NvSmartMax.dll\" fullword ascii   \n           $s1 = \"NvSmartMax.dll.url\" fullword ascii   \n           $s2 = \"Nv.exe\" fullword ascii   \n           $s4 = \"CryptProtectMemory failed\" fullword ascii    \n           $s5 = \"CryptUnprotectMemory failed\" fullword ascii    \n           $s7 = \"r%.*s(%d)%s\" fullword wide   \n           $s8 = \" %s CRC \" fullword wide   \n           $op0 = { c6 05 26 49 42 00 01 eb 4a 8d 85 00 f8 ff ff 50 } /* Opcode */   \n           $op1 = { 8d 85 c8 fe ff ff 50 8d 45 c8 50 c6 45 47 00 e8 } /* Opcode */   \n           $op2 = { e8 e6 65 00 00 50 68 10 43 41 00 e8 56 84 00 00 } /* Opcode */   \n       \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 800KB and all of ($s*) and 1 of ($op*)   \n   }",
			"type": "YARA",
			"id": 30360140
		},
		{
			"indicator": "bfd5db7b32d481de3eefeefac431254eb7710954",
			"description": "",
			"title": "",
			"content": "rule HttpBrowser_RAT_Sample1    \n   {   \n      \n       meta:   \n           description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Sample update.hancominc.com\"   \n           author = \"Florian Roth\"   \n           reference = \"http://snip.ly/giNB\"   \n           date = \"2015-08-06\"   \n           score = 80   \n           hash1 = \"be334d1f8fa65a723af65200a166c2bbdb06690c8b30fafe772600e4662fc68b\"   \n           hash2 = \"1052ad7f4d49542e4da07fa8ea59c15c40bc09a4d726fad023daafdf05866ebb\"   \n         \n       strings:   \n           $s0 = \"update.hancominc.com\" fullword wide    \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 100KB and $s0   \n   }",
			"type": "YARA",
			"id": 30360141
		},
		{
			"indicator": "d6e6e203e3a7398fa95ff107cf34de3c05155d0b",
			"description": "",
			"title": "",
			"content": "rule ThreatGroup3390_C2   \n   {   \n      \n       meta:   \n           description = \"Threat Group 3390 APT - C2 Server\"   \n           author = \"Florian Roth\"   \n           reference = \"http://snip.ly/giNB\"   \n           date = \"2015-08-06\"   \n           score = 60   \n      \n       strings:   \n           $s1 = \"api.apigmail.com\"   \n           $s2 = \"apigmail.com\"   \n           $s3 = \"backup.darkhero.org\"   \n           $s4 = \"bel.updatawindows.com\"   \n           $s5 = \"binary.update-onlines.org\"   \n           $s6 = \"blackcmd.com\"   \n           $s7 = \"castle.blackcmd.com\"   \n           $s8 = \"ctcb.blackcmd.com\"   \n           $s9 = \"darkhero.org\"   \n           $s10 = \"dav.local-test.com\"   \n           $s11 = \"test.local-test.com\"   \n           $s12 = \"dev.local-test.com\"   \n           $s13 = \"ocean.local-test.com\"   \n           $s14 = \"ga.blackcmd.com\"   \n           $s15 = \"helpdesk.blackcmd.com\"   \n           $s16 = \"helpdesk.csc-na.com\"   \n           $s17 = \"helpdesk.hotmail-onlines.com\"   \n           $s18 = \"helpdesk.lnip.org\"   \n           $s19 = \"hotmail-onlines.com\"   \n           $s20 = \"jobs.hotmail-onlines.com\"   \n           $s21 = \"justufogame.com\"   \n           $s22 = \"lnip.org\"   \n           $s23 = \"local-test.com\"   \n           $s24 = \"login.hansoftupdate.com\"   \n           $s25 = \"long.update-onlines.org\"   \n           $s26 = \"longlong.update-onlines.org\"   \n           $s27 = \"longshadow.dyndns.org\"   \n           $s28 = \"longshadow.update-onlines.org\"   \n           $s29 = \"longykcai.update-onlines.org\"   \n           $s30 = \"lostself.update-onlines.org\"   \n           $s31 = \"mac.navydocument.com\"   \n           $s32 = \"mail.csc-na.com\"   \n           $s33 = \"mantech.updatawindows.com\"   \n           $s34 = \"micr0soft.org\"   \n           $s35 = \"microsoft-outlook.org\"   \n           $s36 = \"mtc.navydocument.com\"   \n           $s37 = \"navydocument.com\"   \n           $s38 = \"mtc.update-onlines.org\"   \n           $s39 = \"news.hotmail-onlines.com\"   \n           $s40 = \"oac.3322.org\"   \n           $s41 = \"ocean.apigmail.com\"   \n           $s42 = \"pchomeserver.com\"   \n           $s43 = \"registre.organiccrap.com\"   \n           $s44 = \"security.pomsys.org\"   \n           $s45 = \"services.darkhero.org\"   \n           $s46 = \"sgl.updatawindows.com\"   \n           $s47 = \"shadow.update-onlines.org\"   \n           $s48 = \"sonoco.blackcmd.com\"   \n           $s49 = \"test.logmastre.com\"   \n           $s50 = \"up.gtalklite.com\"   \n           $s51 = \"updatawindows.com\"   \n           $s52 = \"update-onlines.org\"   \n           $s53 = \"update.deepsoftupdate.com\"   \n           $s54 = \"update.hancominc.com\"   \n           $s55 = \"update.micr0soft.org\"   \n           $s56 = \"update.pchomeserver.com\"   \n           $s57 = \"urs.blackcmd.com\"   \n           $s58 = \"wang.darkhero.org\"   \n           $s59 = \"webs.local-test.com\"   \n           $s60 = \"word.apigmail.com\"   \n           $s61 = \"wordpress.blackcmd.com\"   \n           $s62 = \"working.blackcmd.com\"   \n           $s63 = \"working.darkhero.org\"   \n           $s64 = \"working.hotmail-onlines.com\"   \n           $s65 = \"www.trendmicro-update.org\"   \n           $s66 = \"www.update-onlines.org\"   \n           $s67 = \"x.apigmail.com\"   \n           $s68 = \"ykcai.update-onlines.org\"   \n           $s69 = \"ykcailostself.dyndns-free.com\"   \n           $s70 = \"ykcainobody.dyndns.org\"   \n           $s71 = \"zj.blackcmd.com\"   \n           $s72 = \"laxness-lab.com\"   \n           $s73 = \"google-ana1ytics.com\"   \n           $s74 = \"www.google-ana1ytics.com\"   \n           $s75 = \"ftp.google-ana1ytics.com\"   \n           $s76 = \"hotmailcontact.net\"   \n           $s77 = \"208.115.242.36\"   \n           $s78 = \"208.115.242.37\"   \n           $s79 = \"208.115.242.38\"   \n           $s80 = \"66.63.178.142\"   \n           $s81 = \"72.11.148.220\"   \n           $s82 = \"72.11.141.133\"   \n           $s83 = \"74.63.195.236\"   \n           $s84 = \"74.63.195.236\"   \n           $s85 = \"74.63.195.237\"   \n           $s86 = \"74.63.195.238\"   \n           $s87 = \"103.24.0.142\"   \n           $s88 = \"103.24.1.54\"   \n           $s89 = \"106.187.45.162\"   \n           $s90 = \"192.151.236.138\"   \n           $s91 = \"192.161.61.19\"   \n           $s92 = \"192.161.61.20\"   \n           $s93 = \"192.161.61.22\"   \n           $s94 = \"103.24.1.54\"   \n           $s95 = \"67.215.232.179\"   \n           $s96 = \"96.44.177.195\"   \n           $s97 = \"49.143.192.221\"   \n           $s98 = \"67.215.232.181\"   \n           $s99 = \"67.215.232.182\"   \n           $s100 = \"96.44.182.243\"   \n           $s101 = \"96.44.182.245\"   \n           $s102 = \"96.44.182.246\"   \n           $s103 = \"49.143.205.30\"   \n           $s104 = \"working_success@163.com\"   \n           $s105 = \"ykcaihyl@163.com\"   \n           $s106 = \"working_success@163.com\"   \n           $s107 = \"yuming@yinsibaohu.aliyun.com\"   \n         \n       condition:   \n           uint16(0) == 0x5a4d and 1 of them   \n   }",
			"type": "YARA",
			"id": 30360142
		},
		{
			"indicator": "5df22f5aa1e97f6ae44c7d9bf5d67686fecbd4df",
			"description": "",
			"title": "",
			"content": "rule HttpBrowser_RAT_Gen    \n   {   \n      \n       meta:   \n           description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Generic\"   \n           author = \"Florian Roth\"   \n           reference = \"http://snip.ly/giNB\"   \n           date = \"2015-08-06\"   \n           score = 90   \n           hash1 = \"0299493ccb175d452866f5e21d023d3e92cd8d28452517d1d19c0f05f2c5ca27\"   \n           hash2 = \"065d055a90da59b4bdc88b97e537d6489602cb5dc894c5c16aff94d05c09abc7\"   \n           hash3 = \"05c7291db880f94c675eea336ecd66338bd0b1d49ad239cc17f9df08106e6684\"   \n           hash4 = \"07133f291fe022cd14346cd1f0a649aa2704ec9ccadfab809ca9c48b91a7d81b\"   \n           hash5 = \"0f8893e87ddec3d98e39a57f7cd530c28e36d596ea0a1d9d1e993dc2cae0a64d\"   \n           hash6 = \"108e6633744da6efe773eb78bd0ac804920add81c3dde4b26e953056ac1b26c5\"   \n           hash7 = \"1052ad7f4d49542e4da07fa8ea59c15c40bc09a4d726fad023daafdf05866ebb\"   \n           hash8 = \"1277ede988438d4168bb5b135135dd3b9ae7d9badcdf1421132ca4692dd18386\"   \n           hash9 = \"19be90c152f7a174835fd05a0b6f722e29c648969579ed7587ae036679e66a7b\"   \n           hash10 = \"1e7133bf5a9fe5e462321aafc2b7770b8e4183a66c7fef14364a0c3f698a29af\"   \n           hash11 = \"2264e5e8fcbdcb29027798b200939ecd8d1d3ad1ef0aef2b8ce7687103a3c113\"   \n           hash12 = \"2a1bdeb0a021fb0bdbb328bd4b65167d1f954c871fc33359cb5ea472bad6e13e\"   \n           hash13 = \"259a2e0508832d0cf3f4f5d9e9e1adde17102d2804541a9587a9a4b6f6f86669\"   \n           hash14 = \"240d9ce148091e72d8f501dbfbc7963997d5c2e881b4da59a62975ddcbb77ca2\"   \n           hash15 = \"211a1b195cf2cc70a2caf8f1aafb8426eb0e4bae955e85266490b12b5322aa16\"   \n           hash16 = \"2d25c6868c16085c77c58829d538b8f3dbec67485f79a059f24e0dce1e804438\"   \n           hash17 = \"2d932d764dd9b91166361d8c023d64a4480b5b587a6087b0ce3d2ac92ead8a7d\"   \n           hash18 = \"3556722d9aa37beadfa6ba248a66576f767e04b09b239d3fb0479fa93e0ba3fd\"   \n           hash19 = \"365e1d4180e93d7b87ba28ce4369312cbae191151ac23ff4a35f45440cb9be48\"   \n           hash20 = \"36c49f18ce3c205152eef82887eb3070e9b111d35a42b534b2fb2ee535b543c0\"   \n           hash21 = \"3eeb1fd1f0d8ab33f34183893c7346ddbbf3c19b94ba3602d377fa2e84aaad81\"   \n           hash22 = \"3fa8d13b337671323e7fe8b882763ec29b6786c528fa37da773d95a057a69d9a\"   \n        \n       strings:   \n           $s0 = \"%d|%s|%04d/%02d/%02d %02d:%02d:%02d|%ld|%d\" fullword wide    \n           $s1 = \"HttpBrowser/1.0\" fullword wide   \n           $s2 = \"set cmd : %s\" ascii fullword   \n           $s3 = \"\\\\config.ini\" wide fullword   \n        \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 45KB and filesize > 20KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360143
		},
		{
			"indicator": "7abc9dccc3a7d74c056478b936c9022a17682e80",
			"description": "",
			"title": "",
			"content": "rule HttpBrowser_RAT_dropper_Gen1    \n   {   \n      \n       meta:   \n           description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Dropper\"   \n           author = \"Florian Roth\"   \n           reference = \"http://snip.ly/giNB\"   \n           date = \"2015-08-06\"   \n           score = 70   \n           hash1 = \"808de72f1eae29e3c1b2c32be1b84c5064865a235866edf5e790d2a7ba709907\"   \n           hash2 = \"f6f966d605c5e79de462a65df437ddfca0ad4eb5faba94fc875aba51a4b894a7\"   \n           hash3 = \"f424965a35477d822bbadb821125995616dc980d3d4f94a68c87d0cd9b291df9\"   \n           hash4 = \"01441546fbd20487cb2525a0e34e635eff2abe5c3afc131c7182113220f02753\"   \n           hash5 = \"8cd8159f6e4689f572e2087394452e80e62297af02ca55fe221fe5d7570ad47b\"   \n           hash6 = \"10de38419c9a02b80ab7bf2f1f1f15f57dbb0fbc9df14b9171dc93879c5a0c53\"   \n           hash7 = \"c2fa67e970d00279cec341f71577953d49e10fe497dae4f298c2e9abdd3a48cc\"   \n        \n       strings:   \n           $x1 = \"1001=cmd.exe\" fullword ascii    \n           $x2 = \"1003=ShellExecuteA\" fullword ascii    \n           $x3 = \"1002=/c del /q %s\" fullword ascii   \n           $x4 = \"1004=SetThreadPriority\" fullword ascii   \n      \n           /* $s1 = \"pnipcn.dllUT\" fullword ascii   \n           $s2 = \"ssonsvr.exeUT\" fullword ascii   \n           $s3 = \"navlu.dllUT\" fullword ascii   \n           $s4 = \"@CONOUT$\" fullword wide    \n           $s5 = \"VPDN_LU.exeUT\" fullword ascii   \n           $s6 = \"msi.dll.urlUT\" fullword ascii   \n           $s7 = \"setup.exeUT\" fullword ascii    \n           $s8 = \"pnipcn.dll.urlUT\" fullword ascii   \n           $s9 = \"ldvpreg.exeUT\" fullword ascii */   \n      \n           $op0 = { e8 71 11 00 00 83 c4 10 ff 4d e4 8b f0 78 07 8b } /* Opcode */   \n           $op1 = { e8 85 34 00 00 59 59 8b 86 b4 } /* Opcode */   \n           $op2 = { 8b 45 0c 83 38 00 0f 84 97 } /* Opcode */   \n           $op3 = { 8b 45 0c 83 38 00 0f 84 98 } /* Opcode */   \n           $op4 = { 89 7e 0c ff 15 a0 50 40 00 59 8b d8 6a 20 59 8d } /* Opcode */   \n           $op5 = { 56 8d 85 cd fc ff ff 53 50 88 9d cc fc ff ff e8 } /* Opcode */   \n          \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 400KB and all of ($x*) and 1 of ($op*)   \n   }",
			"type": "YARA",
			"id": 30360144
		},
		{
			"indicator": "8a72f3e3bed90e920036f23b2353b142e54db87e",
			"description": "",
			"title": "",
			"content": "rule apt_all_JavaScript_ScanboxFramework_obfuscated   \n      \n   {   \n                 meta:   \n                          \n                       ref = \"https://www.fidelissecurity.com/TradeSecret\"   \n      \n                     strings:   \n      \n                 $sa1 = /(var|new|return)\\s[_\\$]+\\s?/   \n      \n                     $sa2 = \"function\"   \n      \n                     $sa3 = \"toString\"   \n      \n                     $sa4 = \"toUpperCase\"   \n      \n                     $sa5 = \"arguments.length\"   \n      \n                     $sa6 = \"return\"   \n      \n                     $sa7 = \"while\"   \n      \n                     $sa8 = \"unescape(\"   \n      \n                     $sa9 = \"365*10*24*60*60*1000\"   \n      \n                     $sa10 = \">> 2\"   \n      \n                     $sa11 = \"& 3) << 4\"   \n      \n                     $sa12 = \"& 15) << 2\"   \n      \n                     $sa13 = \">> 6) | 192\"   \n      \n                     $sa14 = \"& 63) | 128\"   \n      \n                     $sa15 = \">> 12) | 224\"   \n      \n                     condition:   \n      \n                     all of them   \n      \n   }",
			"type": "YARA",
			"id": 30360245
		},
		{
			"indicator": "eb17ec5c96443482f3ce7789641f727cac5c63e3",
			"description": "",
			"title": "",
			"content": "rule RUAG_Cobra_Malware    \n   {   \n      \n     meta:   \n       description = \"Detects a malware mentioned in the RUAG Case called Carbon/Cobra\"   \n       author = \"Florian Roth\"   \n       reference = \"https://goo.gl/N5MEj0\"   \n       score = 60   \n       \n     strings:   \n       $s1 = \"\\\\Cobra\\\\Release\\\\Cobra.pdb\" ascii   \n        \n     condition:   \n       uint16(0) == 0x5a4d and $s1   \n   }",
			"type": "YARA",
			"id": 30360246
		},
		{
			"indicator": "cdfeeac3f126a63e0b707badcb7a3e9e912fbe15",
			"description": "",
			"title": "",
			"content": "rule RUAG_Bot_Config_File    \n   {   \n      \n     meta:   \n       description = \"Detects a specific config file used by malware in RUAG APT case\"   \n       author = \"Florian Roth\"   \n       reference = \"https://goo.gl/N5MEj0\"   \n       score = 60   \n        \n     strings:   \n       $s1 = \"[CONFIG]\" ascii   \n       $s2 = \"name = \" ascii   \n       $s3 = \"exe = cmd.exe\" ascii   \n        \n     condition:   \n       $s1 at 0 and $s2 and $s3 and filesize < 160    \n   }",
			"type": "YARA",
			"id": 30360247
		},
		{
			"indicator": "6d8ed1edce680f2e5e7a9fa6bd733c49ac49cced",
			"description": "",
			"title": "",
			"content": "rule RUAG_Cobra_Config_File    \n   {   \n      \n     meta:   \n       description = \"Detects a config text file used by malware Cobra in RUAG case\"   \n       author = \"Florian Roth\"   \n       reference = \"https://goo.gl/N5MEj0\"   \n       score = 60   \n      \n     strings:   \n       $h1 = \"[NAME]\" ascii   \n       $s1 = \"object_id=\" ascii   \n       $s2 = \"[TIME]\" ascii fullword   \n       $s3 = \"lastconnect\" ascii    \n       $s4 = \"[CW_LOCAL]\" ascii fullword   \n       $s5 = \"system_pipe\" ascii   \n       $s6 = \"user_pipe\" ascii   \n       $s7 = \"[TRANSPORT]\" ascii   \n       $s8 = \"run_task_system\" ascii   \n       $s9 = \"[WORKDATA]\" ascii    \n       $s10 = \"address1\" ascii   \n        \n     condition:   \n       $h1 at 0 and 8 of ($s*) and filesize < 5KB   \n   }",
			"type": "YARA",
			"id": 30360248
		},
		{
			"indicator": "abd8a63ace4aba3fdd28ddc4d75602d0dfdffa3f",
			"description": "",
			"title": "",
			"content": "rule Turla_APT_Malware_Gen3    \n   {   \n      \n       meta:   \n           description = \"Detects Turla malware (based on sample used in the RUAG APT case)\"   \n           author = \"Florian Roth\"   \n           family = \"Turla\"   \n           reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"   \n           date = \"2016-06-09\"   \n           hash1 = \"c49111af049dd9746c6b1980db6e150b2a79ca1569b23ed2cba81c85c00d82b4\"   \n           hash2 = \"b62a643c96e2e41f639d2a8ce11d61e6b9d7fb3a9baf011120b7fec1b4ee3cf4\"   \n           hash3 = \"edb12790b5cd959bc2e53a4b369a4fd747153e6c9d50f6a69ff047f7857a4348\"   \n           hash4 = \"8f2ea0f916fda1dfb771f5441e919c561da5b6334b9f2fffcbf53db14063b24a\"   \n           hash5 = \"8dddc744bbfcf215346c812aa569e49523996f73a1f22fe4e688084ce1225b98\"   \n           hash6 = \"0c69258adcc97632b729e55664c22cd942812336d41e8ea0cff9ddcafaded20f\"   \n           hash7 = \"2b4fba1ef06f85d1395945db40a9f2c3b3ed81b56fb9c2d5e5bb693c230215e2\"   \n           hash8 = \"7206075cd8f1004e8f1f759d46e98bfad4098b8642412811a214c0155a1f08b9\"   \n           hash9 = \"edb12790b5cd959bc2e53a4b369a4fd747153e6c9d50f6a69ff047f7857a4348\"   \n        \n       strings:   \n           $x1 = \"\\\\\\\\.\\\\pipe\\\\sdlrpc\" fullword ascii   \n           $x2 = \"WaitMutex Abandoned %p\" fullword ascii   \n           $x3 = \"OPER|Wrong config: no port|\" fullword ascii   \n           $x4 = \"OPER|Wrong config: no lastconnect|\" fullword ascii   \n           $x5 = \"OPER|Wrong config: empty address|\" fullword ascii   \n           $x6 = \"Trans task %d obj %s ACTIVE fail robj %s\" fullword ascii   \n           $x7 = \"OPER|Wrong config: no auth|\" fullword ascii   \n           $x8 = \"OPER|Sniffer '%s' running... ooopppsss...|\" fullword ascii   \n           $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\User Agent\\\\Post Platform\" fullword ascii   \n           $s2 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\User Agent\\\\Pre Platform\" fullword ascii   \n           $s3 = \"www.yahoo.com\" fullword ascii   \n           $s4 = \"MSXIML.DLL\" fullword wide   \n           $s5 = \"www.bing.com\" fullword ascii   \n           $s6 = \"%s: http://%s%s\" fullword ascii   \n           $s7 = \"/javascript/view.php\" fullword ascii   \n           $s8 = \"Task %d failed %s,%d\" fullword ascii   \n           $s9 = \"Mozilla/4.0 (compatible; MSIE %d.0; \" fullword ascii   \n         \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 2000KB and ( 1 of ($x*) or 6 of ($s*) ) ) or ( 10 of them )   \n   }",
			"type": "YARA",
			"id": 30360249
		},
		{
			"indicator": "d3df3ca8a207a87c7bb094dd4761ed97fc82d3d0",
			"description": "",
			"title": "",
			"content": "rule Turla_APT_Malware_Gen1    \n   {   \n      \n       meta:   \n           description = \"Detects Turla malware (based on sample used in the RUAG APT case)\"   \n           author = \"Florian Roth\"   \n           family = \"Turla\"   \n           reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"   \n           date = \"2016-06-09\"   \n           hash1 = \"0e1bf347c37fb199886f1e675e372ba55ac4627e8be2f05a76c2c64f9b6ed0e4\"   \n           hash2 = \"7206075cd8f1004e8f1f759d46e98bfad4098b8642412811a214c0155a1f08b9\"   \n           hash3 = \"fe3ffd7438c0d38484bf02a78a19ea81a6f51b4b3f2b2228bd21974c2538bbcd\"   \n           hash4 = \"c49111af049dd9746c6b1980db6e150b2a79ca1569b23ed2cba81c85c00d82b4\"   \n           hash5 = \"b62a643c96e2e41f639d2a8ce11d61e6b9d7fb3a9baf011120b7fec1b4ee3cf4\"   \n           hash6 = \"edb12790b5cd959bc2e53a4b369a4fd747153e6c9d50f6a69ff047f7857a4348\"   \n           hash7 = \"8f2ea0f916fda1dfb771f5441e919c561da5b6334b9f2fffcbf53db14063b24a\"   \n           hash8 = \"8dddc744bbfcf215346c812aa569e49523996f73a1f22fe4e688084ce1225b98\"   \n           hash9 = \"0c69258adcc97632b729e55664c22cd942812336d41e8ea0cff9ddcafaded20f\"   \n           hash10 = \"2b4fba1ef06f85d1395945db40a9f2c3b3ed81b56fb9c2d5e5bb693c230215e2\"   \n          \n       strings:   \n           $x1 = \"too long data for this type of transport\" fullword ascii   \n           $x2 = \"not enough server resources to complete operation\" fullword ascii   \n           $x3 = \"Task not execute. Arg file failed.\" fullword ascii   \n           $x4 = \"Global\\\\MSCTF.Shared.MUTEX.ZRX\" fullword ascii   \n           $s1 = \"peer has closed the connection\" fullword ascii   \n           $s2 = \"tcpdump.exe\" fullword ascii   \n           $s3 = \"windump.exe\" fullword ascii   \n           $s4 = \"dsniff.exe\" fullword ascii   \n           $s5 = \"wireshark.exe\" fullword ascii   \n           $s6 = \"ethereal.exe\" fullword ascii   \n           $s7 = \"snoop.exe\" fullword ascii   \n           $s8 = \"ettercap.exe\" fullword ascii   \n           $s9 = \"miniport.dat\" fullword ascii   \n           $s10 = \"net_password=%s\" fullword ascii   \n          \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 2000KB and ( 2 of ($x*) or 8 of ($s*) ) ) or ( 12 of them )   \n   }",
			"type": "YARA",
			"id": 30360251
		},
		{
			"indicator": "145c970b4f99eef78370ee1cf8d46e98aedc4118",
			"description": "",
			"title": "",
			"content": "rule Turla_APT_srsvc    \n   {   \n      \n       meta:   \n           description = \"Detects Turla malware (based on sample used in the RUAG APT case)\"   \n           author = \"Florian Roth\"   \n           family = \"Turla\"   \n           reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"   \n           date = \"2016-06-09\"   \n           hash1 = \"65996f266166dbb479a42a15a236e6564f0b322d5d68ee546244d7740a21b8f7\"   \n           hash2 = \"25c7ff1eb16984a741948f2ec675ab122869b6edea3691b01d69842a53aa3bac\"   \n        \n       strings:   \n           $x1 = \"SVCHostServiceDll.dll\" fullword ascii   \n           $s2 = \"msimghlp.dll\" fullword wide   \n           $s3 = \"srservice\" fullword wide   \n           $s4 = \"ModStart\" fullword ascii   \n           $s5 = \"ModStop\" fullword ascii   \n          \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 20KB and ( 1 of ($x*) or all of ($s*) ) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30360252
		},
		{
			"indicator": "5160cc5a69b3efa8a5d8ac2ed501b7859508e125",
			"description": "",
			"title": "",
			"content": "rule Turla_APT_Malware_Gen2    \n   {   \n      \n       meta:   \n           description = \"Detects Turla malware (based on sample used in the RUAG APT case)\"   \n           author = \"Florian Roth\"   \n           family = \"Turla\"   \n           reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"   \n           date = \"2016-06-09\"   \n           hash1 = \"0e1bf347c37fb199886f1e675e372ba55ac4627e8be2f05a76c2c64f9b6ed0e4\"   \n           hash2 = \"7206075cd8f1004e8f1f759d46e98bfad4098b8642412811a214c0155a1f08b9\"   \n           hash3 = \"fe3ffd7438c0d38484bf02a78a19ea81a6f51b4b3f2b2228bd21974c2538bbcd\"   \n           hash4 = \"c49111af049dd9746c6b1980db6e150b2a79ca1569b23ed2cba81c85c00d82b4\"   \n        \n       strings:   \n           $x1 = \"Internal command not support =((\" fullword ascii   \n           $x2 = \"L|-1|AS_CUR_USER:OpenProcessToken():%d, %s|\" fullword ascii   \n           $x3 = \"L|-1|CreateProcessAsUser():%d, %s|\" fullword ascii   \n           $x4 = \"AS_CUR_USER:OpenProcessToken():%d\" fullword ascii   \n           $x5 = \"L|-1|AS_CUR_USER:LogonUser():%d, %s|\" fullword ascii   \n           $x6 = \"L|-1|try to run dll %s with user priv|\" fullword ascii   \n           $x7 = \"\\\\\\\\.\\\\Global\\\\PIPE\\\\sdlrpc\" fullword ascii   \n           $x8 = \"\\\\\\\\%s\\\\pipe\\\\comnode\" fullword ascii   \n           $x9 = \"Plugin dll stop failed.\" fullword ascii   \n           $x10 = \"AS_USER:LogonUser():%d\" fullword ascii   \n           $s1 = \"MSIMGHLP.DLL\" fullword wide   \n           $s2 = \"msimghlp.dll\" fullword ascii   \n           $s3 = \"ximarsh.dll\" fullword ascii   \n           $s4 = \"msximl.dll\" fullword ascii   \n           $s5 = \"INTERNAL.dll\" fullword ascii   \n           $s6 = \"\\\\\\\\.\\\\Global\\\\PIPE\\\\\" fullword ascii   \n           $s7 = \"ieuser.exe\" fullword ascii   \n          \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 2000KB and ( 1 of ($x*) or 5 of ($s*) ) ) or ( 10 of them )   \n   }",
			"type": "YARA",
			"id": 30360253
		},
		{
			"indicator": "89bbaa0cb7db0156efee6028c2927016e17770cd",
			"description": "",
			"title": "",
			"content": "rule RUAG_Exfil_Config_File    \n   {   \n      \n     meta:   \n       description = \"Detects a config text file used in data exfiltration in RUAG case\"   \n       author = \"Florian Roth\"   \n       reference = \"https://goo.gl/N5MEj0\"   \n       score = 60   \n      \n     strings:   \n       $h1 = \"[TRANSPORT]\" ascii   \n       $s1 = \"system_pipe\" ascii   \n       $s2 = \"spstatus\" ascii   \n       $s3 = \"adaptable\" ascii    \n       $s4 = \"post_frag\" ascii   \n       $s5 = \"pfsgrowperiod\" ascii   \n        \n     condition:   \n       $h1 at 0 and all of ($s*) and filesize < 1KB   \n   }",
			"type": "YARA",
			"id": 30360254
		},
		{
			"indicator": "d1d8afc7d25fe705d201134d44a301465ccb2136",
			"description": "",
			"title": "",
			"content": "rule RUAG_Tavdig_Malformed_Executable    \n   {   \n      \n     meta:   \n       description = \"Detects an embedded executable with a malformed header - known from Tavdig malware\"   \n       author = \"Florian Roth\"   \n       reference = \"https://goo.gl/N5MEj0\"   \n       score = 60   \n        \n     condition:   \n     /* MZ Header and malformed PE header > 0x0bad */   \n       uint16(0) == 0x5a4d and uint32(uint32(0x3C)) == 0x0000AD0B    \n   }",
			"type": "YARA",
			"id": 30360255
		},
		{
			"indicator": "4017bc33266b5a1ed4118261e9dbaaf08644d33c",
			"description": "",
			"title": "",
			"content": "rule SLServer_command_and_control   \n   {   \n         \n       meta:   \n           author = \"Matt Brooks, @cmatthewbrooks\"   \n           desc = \"Searches for the C2 server.\"   \n           ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"   \n          \n       strings:   \n           $c2 = \"safetyssl.security-centers.com\"   \n              \n       condition:   \n           //MZ header //PE signature   \n           uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $c2   \n   }",
			"type": "YARA",
			"id": 30360268
		},
		{
			"indicator": "02e2b0f5538c7af90757950a42b0f5c1cdf42ffb",
			"description": "",
			"title": "",
			"content": "rule dubseven_dropper_registry_checks   \n   {   \n          \n       meta:   \n           author = \"Matt Brooks, @cmatthewbrooks\"   \n           desc = \"Searches for registry keys checked for by the dropper\"   \n          \n       strings:   \n           $reg1 = \"SOFTWARE\\\\360Safe\\\\Liveup\"   \n           $reg2 = \"Software\\\\360safe\"   \n           $reg3 = \"SOFTWARE\\\\kingsoft\\\\Antivirus\"   \n           $reg4 = \"SOFTWARE\\\\Avira\\\\Avira Destop\"   \n           $reg5 = \"SOFTWARE\\\\rising\\\\RAV\"   \n           $reg6 = \"SOFTWARE\\\\JiangMin\"   \n           $reg7 = \"SOFTWARE\\\\Micropoint\\\\Anti-Attack\"   \n      \n       condition:   \n           //MZ header //PE signature   \n           uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and all of ($reg*)   \n   }",
			"type": "YARA",
			"id": 30360269
		},
		{
			"indicator": "a31ee4415df26fdd47b50e426a39af465719d833",
			"description": "",
			"title": "",
			"content": "rule dubseven_dropper_dialog_remains   \n   {   \n         \n       meta:   \n           author = \"Matt Brooks, @cmatthewbrooks\"   \n           desc = \"Searches for related dialog remnants. How rude.\"   \n          \n       strings:   \n           $dia1 = \"fuckMessageBox 1.0\" wide   \n           $dia2 = \"Rundll 1.0\" wide   \n              \n       condition:   \n           //MZ header //PE signature   \n           uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and any of them   \n   }",
			"type": "YARA",
			"id": 30360270
		},
		{
			"indicator": "b41d1151deaab6b0efbb86d02419ec60c7e4c9fb",
			"description": "",
			"title": "",
			"content": "rule dubseven_file_set   \n   {   \n          \n       meta:   \n           author = \"Matt Brooks, @cmatthewbrooks\"   \n           desc = \"Searches for service files loading UP007\"   \n          \n       strings:   \n           $file1 = \"\\\\Microsoft\\\\Internet Explorer\\\\conhost.exe\"   \n           $file2 = \"\\\\Microsoft\\\\Internet Explorer\\\\dll2.xor\"   \n           $file3 = \"\\\\Microsoft\\\\Internet Explorer\\\\HOOK.DLL\"   \n           $file4 = \"\\\\Microsoft\\\\Internet Explorer\\\\main.dll\"   \n           $file5 = \"\\\\Microsoft\\\\Internet Explorer\\\\nvsvc.exe\"   \n           $file6 = \"\\\\Microsoft\\\\Internet Explorer\\\\SBieDll.dll\"   \n           $file7 = \"\\\\Microsoft\\\\Internet Explorer\\\\mon\"   \n           $file8 = \"\\\\Microsoft\\\\Internet Explorer\\\\runas.exe\"   \n              \n       condition:   \n           //MZ header //PE signature //Just a few of these as they differ   \n      \n           uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and 3 of ($file*)   \n   }",
			"type": "YARA",
			"id": 30360271
		},
		{
			"indicator": "9fe4210e16cbcc67779fcd2cc2bb96dde96f9974",
			"description": "",
			"title": "",
			"content": "rule SLServer_mutex   \n   {   \n          \n       meta:   \n           author = \"Matt Brooks, @cmatthewbrooks\"   \n           desc = \"Searches for the mutex.\"   \n           ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"   \n          \n       strings:   \n           $mutex = \"M&GX^DSF&DA@F\"   \n              \n       condition:   \n           //MZ header //PE signature   \n           uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $mutex   \n   }",
			"type": "YARA",
			"id": 30360272
		},
		{
			"indicator": "7a368f82f617dcf1fe4894ca813c44263e520f1f",
			"description": "",
			"title": "",
			"content": "rule SLServer_campaign_code   \n   {   \n       meta:   \n           author = \"Matt Brooks, @cmatthewbrooks\"   \n           desc = \"Searches for the related campaign code.\"   \n           ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"   \n          \n       strings:   \n           $campaign = \"wthkdoc0106\"   \n              \n       condition:   \n           //MZ header //PE signature   \n           uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $campaign   \n   }",
			"type": "YARA",
			"id": 30360273
		},
		{
			"indicator": "1b43964d7e7395b52b33a333df669baad830aafd",
			"description": "",
			"title": "",
			"content": "rule SLServer_unknown_string   \n   {   \n       meta:   \n           author = \"Matt Brooks, @cmatthewbrooks\"   \n           desc = \"Searches for a unique string.\"   \n           ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"   \n          \n       strings:   \n           $string = \"test-b7fa835a39\"   \n              \n       condition:   \n           //MZ header //PE signature   \n           uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $string   \n   }",
			"type": "YARA",
			"id": 30360274
		},
		{
			"indicator": "f1902146abef3c34f7ec878d9a2c95ee32678bf5",
			"description": "",
			"title": "",
			"content": "rule maindll_mutex   \n   {   \n         \n       meta:   \n           author = \"Matt Brooks, @cmatthewbrooks\"   \n           desc = \"Matches on the maindll mutex\"   \n           ref = \"https://citizenlab.org/2016/04/between-hong-kong-and-burma/\"   \n              \n       strings:   \n           $mutex = \"h31415927tttt\"   \n              \n       condition:   \n           //MZ header  //PE signature   \n           uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $mutex   \n   }",
			"type": "YARA",
			"id": 30360275
		},
		{
			"indicator": "80092af1e74d1d34569ab026a60ab75f92b55855",
			"description": "",
			"title": "",
			"content": "rule Unit78020_Malware_Gen1    \n   {   \n      \n       meta:   \n           description = \"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule\"   \n           author = \"Florian Roth\"   \n           reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"   \n           date = \"2015-09-24\"   \n           hash1 = \"2b15e614fb54bca7031f64ab6caa1f77b4c07dac186826a6cd2e254090675d72\"   \n           hash2 = \"76c586e89c30a97e583c40ebe3f4ba75d5e02e52959184c4ce0a46b3aac54edd\"   \n           hash3 = \"2625a0d91d3cdbbc7c4a450c91e028e3609ff96c4f2a5a310ae20f73e1bc32ac\"   \n           hash4 = \"5c62b1d16e6180f22a0cb59c99a7743f44cb4a41e4e090b9733d1fb687c8efa2\"   \n           hash5 = \"7b73bf2d80a03eb477242967628da79924fbe06cc67c4dcdd2bdefccd6e0e1af\"   \n           hash6 = \"88c5be84afe20c91e4024160303bafb044f98aa5fbf8c9f9997758a014238790\"   \n      \n       strings:   \n           $x1 = \"greensky27.vicp.net\" fullword wide   \n           $x2 = \"POST http://%s:%d/aspxabcdefg.asp?%s HTTP/1.1\" fullword ascii   \n           $x3 = \"GET http://%s:%d/aspxabcdef.asp?%s HTTP/1.1\" fullword ascii   \n           /* additional strings based on PDF report - not found in samples */   \n           $x4 = \"serch.vicp.net\" fullword wide   \n           $x5 = \"greensky27.vicp.net\" fullword wide   \n           $x6 = \"greensky27.vicp.net.as\" fullword wide   \n           $x7 = \"greensky27.vcip.net\" fullword wide   \n           $x8 = \"pnoc-ec.vicp.net\" fullword wide   \n           $x9 = \"aseanph.vicp.net\" fullword wide   \n           $x10 = \"pnoc.vicp.net\" fullword wide   \n           $a1 = \"dMozilla/4.0 (compatible; MSIE 6.0;Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide /* typo */   \n           $a2 = \"User-Agent: Netscape\" fullword ascii /* ;) */   \n           $a3 = \"Accept-Language:En-us/r/n\" fullword wide /* typo */   \n           $a4 = \"\\\\Office Start.lnk\" fullword wide   \n           $a5 = \"\\\\MSN Talk Start.lnk\" fullword wide   \n           $s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide   \n           $s2 = \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7\" fullword ascii   \n           $s3 = \"%USERPROFILE%\\\\Application Data\\\\Mozilla\\\\Firefox\\\\Profiles\" fullword wide   \n           $s4 = \"Content-Type:application/x-www-form-urlencoded/r/n\" fullword wide   \n           $s5 = \"Hello World!\" fullword wide   \n           $s6 = \"Accept-Encoding:gzip,deflate/r/n\" fullword wide   \n           $s7 = \"/%d%s%d\" fullword ascii   \n           $s8 = \"%02d-%02d-%02d %02d:%02d\" fullword wide   \n           $s9 = \"WininetMM Version 1.0\" fullword wide   \n           $s10 = \"WININETMM\" fullword wide   \n           $s11 = \"GET %dHTTP/1.1\" fullword ascii   \n           $s12 = \"POST http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii   \n           $s13 = \"PeekNamePipe\" fullword ascii   \n           $s14 = \"Normal.dot\" fullword ascii   \n           $s15 = \"R_eOR_eOR_eO)CiOS_eO\" fullword ascii   \n           $s16 = \"DRIVE_RAMDISK\" fullword wide   \n           $s17 = \"%s %s %s %s %d %d %d %d \" fullword ascii   \n          \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 250KB and 1 of ($x*) ) or 2 of ($a*) or 6 of ($s*)    \n      \n   }",
			"type": "YARA",
			"id": 30360278
		},
		{
			"indicator": "2fb1ae4926a0c5b5f3e88481b820b1f0060be5a1",
			"description": "",
			"title": "",
			"content": "rule Unit78020_Malware_1     \n   {   \n      \n       meta:   \n           description = \"Detects malware by Chinese APT PLA Unit 78020 - Specific Rule - msictl.exe\"   \n           author = \"Florian Roth\"   \n           reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"   \n           date = \"2015-09-24\"   \n           hash = \"a93d01f1cc2d18ced2f3b2b78319aadc112f611ab8911ae9e55e13557c1c791a\"   \n         \n       strings:   \n           $s1 = \"%ProgramFiles%\\\\Internet Explorer\\\\iexplore.exe\" fullword ascii   \n           $s2 = \"msictl.exe\" fullword ascii   \n           $s3 = \"127.0.0.1:8080\" fullword ascii   \n           $s4 = \"mshtml.dat\" fullword ascii   \n           $s5 = \"msisvc\" fullword ascii   \n           $s6 = \"NOKIAN95/WEB\" fullword ascii   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 160KB and 4 of them   \n   }",
			"type": "YARA",
			"id": 30360279
		},
		{
			"indicator": "25237d983cb386d24d078a2aa45b60a167ad91ad",
			"description": "",
			"title": "",
			"content": "rule Unit78020_Malware_Gen2    \n   {   \n      \n       meta:   \n           description = \"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule\"   \n           author = \"Florian Roth\"   \n           reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"   \n           date = \"2015-09-24\"   \n           super_rule = 1   \n           hash1 = \"76c586e89c30a97e583c40ebe3f4ba75d5e02e52959184c4ce0a46b3aac54edd\"   \n           hash2 = \"7b73bf2d80a03eb477242967628da79924fbe06cc67c4dcdd2bdefccd6e0e1af\"   \n           hash3 = \"981e2fa1ae4145359036b46e8b53cc5da37dd2311204859761bd91572f025e8a\"   \n        \n      strings:   \n           $s0 = \"-GetModuleFileNameExW\" fullword ascii   \n           $s1 = \"\\\\MSN Talk Start.lnk\" fullword wide   \n           $s2 = \":SeDebugPrivilege\" fullword wide   \n           $s3 = \"WinMM Version 1.0\" fullword wide   \n           $s4 = \"dwError1 = %d\" fullword ascii   \n           $s5 = \"*Can't Get\" fullword wide   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 1000KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360280
		},
		{
			"indicator": "5a4e3adceb1b6d3c06c589e814f0c1d7c9c75b4e",
			"description": "",
			"title": "",
			"content": "rule Unit78020_Malware_Gen3    \n   {   \n      \n       meta:   \n           description = \"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule - Chong\"   \n           author = \"Florian Roth\"   \n           reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"   \n           date = \"2015-09-24\"   \n           super_rule = 1   \n           hash1 = \"2625a0d91d3cdbbc7c4a450c91e028e3609ff96c4f2a5a310ae20f73e1bc32ac\"   \n           hash2 = \"5c62b1d16e6180f22a0cb59c99a7743f44cb4a41e4e090b9733d1fb687c8efa2\"   \n         \n       strings:   \n           $x1 = \"GET http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii   \n           $x2 = \"POST http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii   \n           $x3 = \"J:\\\\chong\\\\\" ascii   \n           $s1 = \"User-Agent: Netscape\" fullword ascii   \n           $s2 = \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7\" fullword ascii   \n           $s3 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\explorer\\\\User Shell Folders\" fullword wide   \n           $s4 = \"J:\\\\chong\\\\nod\\\\Release\\\\SslMM.exe\" fullword ascii   \n           $s5 = \"MM.exe\" fullword ascii   \n           $s6 = \"network.proxy.ssl\" fullword wide   \n           $s7 = \"PeekNamePipe\" fullword ascii   \n           $s8 = \"Host: %ws:%d\" fullword ascii   \n           $s9 = \"GET %dHTTP/1.1\" fullword ascii   \n           $s10 = \"SCHANNEL.DLL\" fullword ascii /* Goodware String - occured 6 times */   \n          \n       condition:   \n           ( uint16(0) == 0x5a4d and filesize < 300KB and 1 of ($x*) ) or 4 of ($s*)   \n   }",
			"type": "YARA",
			"id": 30360281
		},
		{
			"indicator": "6ce8d8d04fd4164b4bb2d65bcf3130cf8727b6a5",
			"description": "",
			"title": "",
			"content": "rule WaterBug_wipbot_2013_dll    \n   {   \n      \n       meta:   \n           description = \"Symantec Waterbug Attack - Trojan.Wipbot 2014 Down.dll component\"   \n           author = \"Symantec Security Response\"   \n           date = \"22.01.2015\"   \n           reference = \"http://t.co/rF35OaAXrl\"           \n        \n       strings:   \n           $string1 = \"/%s?rank=%s\"   \n           $string2 = \"ModuleStart\\x00ModuleStop\\x00start\"   \n           $string3 = \"1156fd22-3443-4344-c4ffff\"   \n           //read file... error..   \n           $string4 = \"read\\x20file\\x2E\\x2E\\x2E\\x20error\\x00\\x00\"   \n        \n       condition:   \n           2 of them   \n   }",
			"type": "YARA",
			"id": 30360297
		},
		{
			"indicator": "4c790578d98d48ae86a3b1ebc9c23e728827c2f5",
			"description": "",
			"title": "",
			"content": "rule WaterBug_fa_malware    \n   {    \n      \n       meta:    \n           description = \"Symantec Waterbug Attack - FA malware variant\"   \n           author = \"Symantec Security Response\"   \n           date = \"22.01.2015\"   \n           reference = \"http://t.co/rF35OaAXrl\"   \n      \n       strings:   \n           $mz = \"MZ\"   \n           $string1 = \"C:\\\\proj\\\\drivers\\\\fa _ 2009\\\\objfre\\\\i386\\\\atmarpd.pdb\"   \n           $string2 = \"d:\\\\proj\\\\cn\\\\fa64\\\\\"   \n           $string3 = \"sengoku_Win32.sys\\x00\"   \n           $string4 = \"rk_ntsystem.c\"   \n           $string5 = \"\\\\uroboros\\\\\"   \n           $string6 = \"shell.{F21EDC09-85D3-4eb9-915F-1AFA2FF28153}\"   \n      \n       condition:   \n           ($mz at 0) and (any of ($string*))   \n   }",
			"type": "YARA",
			"id": 30360298
		},
		{
			"indicator": "d408993e89ae915e098f4add190af396ed424842",
			"description": "",
			"title": "",
			"content": "rule WaterBug_sav    \n   {   \n      \n       meta:    \n           description = \"Symantec Waterbug Attack - SAV Malware\"   \n           author = \"Symantec Security Response\"   \n           date = \"22.01.2015\"   \n           reference = \"http://t.co/rF35OaAXrl\"       \n      \n       strings:   \n           $mz = \"MZ\"   \n           $code1a = { 8B 75 18 31 34 81 40 3B C2 72 F5 33 F6 39 7D 14 76 1B 8A 04 0E 88 04 0F 6A 0F 33 D2 8B C7 5B F7 F3 85 D2 75 01 }   \n           $code1b = { 8B 45 F8 40 89 45 F8 8B 45 10 C1 E8 02 39 45 F8 73 17 8B 45 F8 8B 4D F4 8B 04 81 33 45 20 8B 4D F8 8B 55 F4 89 04 8A EB D7 83 65 F8 00 83 65 EC 00 EB 0E 8B 45 F8 40 89 45 F8 8B 45 EC 40 89 45 EC 8B 45 EC 3B 45 10 73 27 8B 45 F4 03 45 F8 8B 4D F4 03 4D EC 8A 09 88 08 8B 45 F8 33 D2 6A 0F 59 F7 F1 85 D2 75 07 }   \n           $code1c = { 8A 04 0F 88 04 0E 6A 0F 33 D2 8B C6 5B F7 F3 85 D2 75 01 47 8B 45 14 46 47 3B F8 72 E3 EB 04 C6 04 08 00 48 3B C6 73 F7 33 C0 C1 EE 02 74 0B 8B 55 18 31 14 81 40 3B C6 72 F5 }   \n           $code2 =  { 29 5D 0C 8B D1 C1 EA 05 2B CA 8B 55 F4 2B C3 3D 00 00 00 01 89 0F 8B 4D 10 8D 94 91 00 03 00 00 73 17 8B 7D F8 8B 4D 0C 0F B6 3F C1 E1 08 0B CF C1 E0 08 FF 45 F8 89 4D 0C 8B 0A 8B F8 C1 EF 0B}   \n         \n       condition:   \n           ($mz at 0) and (($code1a or $code1b or $code1c) and $code2)    \n   }",
			"type": "YARA",
			"id": 30360299
		},
		{
			"indicator": "f9a7abf804ab8a399194b6f17609723f70f30b63",
			"description": "",
			"title": "",
			"content": "rule WaterBug_wipbot_2013_core_PDF    \n   {   \n      \n       meta:   \n           description = \"Symantec Waterbug Attack - Trojan.Wipbot 2014 core PDF\"   \n           author = \"Symantec Security Response\"   \n           date = \"22.01.2015\"   \n           reference = \"http://t.co/rF35OaAXrl\"   \n       \n       strings:   \n           $PDF = \"%PDF-\"   \n           $a = /\\+[A-Za-z]{1}\\. _ _ \\$\\+[A-Za-z]{1}\\. _ \\$ _ \\+/    \n           $b = /\\+[A-Za-z]{1}\\.\\$\\$\\$ _ \\+/   \n       \n       condition:   \n           ($PDF at 0) and #a > 150 and #b > 200   \n   }",
			"type": "YARA",
			"id": 30360300
		},
		{
			"indicator": "eea6496fb733c41747bab2a3249152a6047ef3b2",
			"description": "",
			"title": "",
			"content": "rule WaterBug_wipbot_2013_core    \n   {   \n      \n       meta:   \n           description = \"Symantec Waterbug Attack - Trojan.Wipbot core + core; garbage appended data (PDF Exploit leftovers) + wipbot dropper; fake AdobeRd32 Error\"   \n           author = \"Symantec Security Response\"   \n           date = \"22.01.2015\"   \n           reference = \"http://t.co/rF35OaAXrl\"               \n      \n       strings:   \n           $mz = \"MZ\"   \n           $code1 = { 89 47 0C C7 47 10 90 C2 04 00 C7 47 14 90 C2 10 00 C7 47 18 90 90 60 68 89 4F 1C C7 47 20 90 90 90 B8 89 4F 24 C7 47 28 90 FF D0 61 C7 47 2C 90 C2 04 00}   \n           $code2 = { 85 C0 75 25 8B 0B BF ?? ?? ?? ?? EB 17 69 D7 0D 66 19 00 8D BA 5F F3 6E 3C 89 FE C1 EE 10 89 F2 30 14 01 40 3B 43 04 72 E4}   \n           $code3 = {90 90 90 ?? B9 00 4D 5A 90 00 03 00 00 00 82 04} $code4 = {55 89 E5 5D C3 55 89 E5 83 EC 18 8B 45 08 85 C0}   \n      \n       condition:   \n           $mz at 0 and (($code1 or $code2) or ($code3 and $code4))   \n   }",
			"type": "YARA",
			"id": 30360301
		},
		{
			"indicator": "44469d350582f24359e198d9c85587baf9193700",
			"description": "",
			"title": "",
			"content": "rule WaterBug_turla_dropper    \n   {   \n      \n       meta:   \n           description = \"Symantec Waterbug Attack - Trojan Turla Dropper\"   \n           author = \"Symantec Security Response\"   \n           date = \"22.01.2015\"   \n           reference = \"http://t.co/rF35OaAXrl\"   \n      \n       strings:    \n           $a = {0F 31 14 31 20 31 3C 31 85 31 8C 31 A8 31 B1 31 D1 31 8B 32 91 32 B6 32 C4 32 6C 33 AC 33 10 34}   \n           $b = {48 41 4C 2E 64 6C 6C 00 6E 74 64 6C 6C 00 00 00 57 8B F9 8B 0D ?? ?? ?? ?? ?? C9 75 26 56 0F 20 C6 8B C6 25 FF FF FE FF 0F 22 C0 E8}   \n      \n       condition:    \n           all of them   \n   }",
			"type": "YARA",
			"id": 30360302
		},
		{
			"indicator": "9b86b0f3051c8922ecfb1b07c5fc153d98482efb",
			"description": "",
			"title": "",
			"content": "rule WildNeutron_Sample_7    \n   {   \n      \n       meta:   \n           description = \"Wild Neutron APT Sample Rule - file a14d31eb965ea8a37ebcc3b5635099f2ca08365646437c770212d534d504ff3c\"   \n           author = \"Florian Roth\"   \n           reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"   \n           date = \"2015-07-10\"   \n           score = 60   \n           hash = \"a14d31eb965ea8a37ebcc3b5635099f2ca08365646437c770212d534d504ff3c\"   \n      \n       strings:   \n           $s0 = \"checking match for '%s' user %s host %s addr %s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '24.00' */   \n           $s1 = \"PEM_read_bio_PrivateKey failed\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '23.00' */   \n           $s2 = \"usage: %s [-ehR] [-f log_facility] [-l log_level] [-u umask]\" fullword ascii /* score: '23.00' */   \n           $s3 = \"%s %s for %s%.100s from %.200s port %d%s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '23.00' */   \n           $s4 = \"clapi32.dll\" fullword ascii /* score: '21.00' */   \n           $s5 = \"Connection from %s port %d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '17.00' */   \n           $s6 = \"/usr/etc/ssh_known_hosts\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '16.00' */   \n           $s7 = \"Version: %s - %s %s %s %s\" fullword ascii /* score: '16.00' */   \n           $s8 = \"[-] connect()\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '13.00' */   \n           $s9 = \"/bin/sh /usr/etc/sshrc\" fullword ascii /* score: '12.42' */   \n           $s10 = \"kexecdhs.c\" fullword ascii /* score: '12.00' */   \n           $s11 = \"%s: setrlimit(RLIMIT_FSIZE, { 0, 0 }): %s\" fullword ascii /* score: '11.00' */   \n          \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 5000KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360450
		},
		{
			"indicator": "ba959767a42d81c04c0ab12ac9e30cd5d8461be9",
			"description": "",
			"title": "",
			"content": "rule WildNeutron_Sample_6    \n   {   \n      \n       meta:   \n           description = \"Wild Neutron APT Sample Rule - file 4bd548fe07b19178281edb1ee81c9711525dab03dc0b6676963019c44cc75865\"   \n           author = \"Florian Roth\"   \n           reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"   \n           date = \"2015-07-10\"   \n           score = 60   \n           hash = \"4bd548fe07b19178281edb1ee81c9711525dab03dc0b6676963019c44cc75865\"   \n      \n       strings:   \n           $s0 = \"mshtaex.exe\" fullword wide /* score: '20.00' */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 310KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360451
		},
		{
			"indicator": "ae35c2b77351ba2d8f6e82996ff21cd60055994e",
			"description": "",
			"title": "",
			"content": "rule WildNeutron_Sample_2    \n   {   \n      \n       meta:   \n           description = \"Wild Neutron APT Sample Rule - file 8d80f9ef55324212759f4b6070cb8fce18a008ae9dd8b9598553206654d13a6f\"   \n           author = \"Florian Roth\"   \n           reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"   \n           date = \"2015-07-10\"   \n           score = 60   \n           hash = \"8d80f9ef55324212759f4b6070cb8fce18a008ae9dd8b9598553206654d13a6f\"   \n      \n       strings:   \n           $s0 = \"rundll32.exe \\\"%s\\\",#1\" fullword wide /* PEStudio Blacklist: strings */ /* score: '33.00' */   \n           $s1 = \"IgfxUpt.exe\" fullword wide /* score: '20.00' */   \n           $s2 = \"id-at-postalAddress\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '18.00' */   \n           $s3 = \"Intel(R) Common User Interface\" fullword wide /* PEStudio Blacklist: strings */ /* score: '17.00' */   \n           $s4 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide /* score: '15.00' */   \n           $s11 = \"Key Usage\" fullword ascii /* score: '12.00' */   \n           $s12 = \"Intel Integrated Graphics Updater\" fullword wide /* PEStudio Blacklist: strings */ /* score: '12.00' */   \n           $s13 = \"%sexpires on    : %04d-%02d-%02d %02d:%02d:%02d\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '11.00' */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 600KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360452
		},
		{
			"indicator": "765b9001049e1e8712fbed506b77927f70a7c0a8",
			"description": "",
			"title": "",
			"content": "rule WildNeutron_Sample_4    \n   {   \n      \n       meta:   \n           description = \"Wild Neutron APT Sample Rule - file b4005530193bc523d3e0193c3c53e2737ae3bf9f76d12c827c0b5cd0dcbaae45\"   \n           author = \"Florian Roth\"   \n           reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"   \n           date = \"2015-07-10\"   \n           score = 60   \n           hash = \"b4005530193bc523d3e0193c3c53e2737ae3bf9f76d12c827c0b5cd0dcbaae45\"   \n      \n       strings:   \n           $x1 = \"WinRAT-Win32-Release.exe\" fullword ascii /* score: '22.00' */   \n           $s0 = \"rundll32.exe \\\"%s\\\",#1\" fullword wide /* PEStudio Blacklist: strings */ /* score: '33.00' */   \n           $s1 = \"RtlUpd.EXE\" fullword wide /* score: '20.00' */   \n           $s2 = \"RtlUpd.exe\" fullword wide /* score: '20.00' */   \n           $s3 = \"Driver Update and remove for Windows x64 or x86_32\" fullword wide /* PEStudio Blacklist: strings */ /* score: '17.00' */   \n           $s4 = \"Realtek HD Audio Update and remove driver Tool\" fullword wide /* PEStudio Blacklist: strings */ /* score: '16.00' */   \n           $s5 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide /* score: '15.00' */   \n           $s6 = \"Key Usage\" fullword ascii /* score: '12.00' */   \n           $s7 = \"id-at-serialNumber\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '10.00' */   \n        \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 1240KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360453
		},
		{
			"indicator": "a48a7ba3b4b1ebe56817262eb1696d0d39555cab",
			"description": "",
			"title": "",
			"content": "rule WildNeutron_Sample_10    \n   {   \n      \n       meta:   \n           description = \"Wild Neutron APT Sample Rule - file 1d3bdabb350ba5a821849893dabe5d6056bf7ba1ed6042d93174ceeaa5d6dad7\"   \n           author = \"Florian Roth\"   \n           reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"   \n           date = \"2015-07-10\"   \n           score = 60   \n           hash = \"1d3bdabb350ba5a821849893dabe5d6056bf7ba1ed6042d93174ceeaa5d6dad7\"   \n      \n       strings:   \n           $n1 = \"/c for /L %%i in (1,1,2) DO ping 127.0.0.1 -n 3 & type %%windir%%\\\\notepad.exe > %s & del /f %s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '46.00' */           \n           $s1 = \"%SYSTEMROOT%\\\\temp\\\\_dbg.tmp\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '37.00' */   \n           $s2 = \"%SYSTEMROOT%\\\\SysWOW64\\\\mspool.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.17' */   \n           $s3 = \"%SYSTEMROOT%\\\\System32\\\\dpcore16t.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.17' */   \n           $s4 = \"%SYSTEMROOT%\\\\System32\\\\wdigestEx.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.17' */   \n           $s5 = \"%SYSTEMROOT%\\\\System32\\\\mspool.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.17' */   \n           $s6 = \"%SYSTEMROOT%\\\\System32\\\\kernel32.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '36.00' */   \n           $s7 = \"%SYSTEMROOT%\\\\SysWOW64\\\\iastor32.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.17' */   \n           $s8 = \"%SYSTEMROOT%\\\\System32\\\\msvcse.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.17' */   \n           $s9 = \"%SYSTEMROOT%\\\\System32\\\\mshtaex.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.17' */   \n           $s10 = \"%SYSTEMROOT%\\\\System32\\\\iastor32.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.17' */   \n           $s11 = \"%SYSTEMROOT%\\\\SysWOW64\\\\mshtaex.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '31.17' */   \n           $x1 = \"wdigestEx.dll\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '26.00' */   \n           $x2 = \"dpcore16t.dll\" fullword ascii /* score: '21.00' */   \n           $x3 = \"mspool.dll\" fullword ascii /* score: '21.00' */   \n           $x4 = \"msvcse.exe\" fullword ascii /* score: '20.00' */   \n           $x5 = \"mshtaex.exe\" fullword wide /* score: '20.00' */   \n           $x6 = \"iastor32.exe\" fullword ascii /* score: '20.00' */   \n           $y1 = \"Installer.exe\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '25.00' */   \n           $y2 = \"Info: Process %s\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '21.00' */   \n           $y3 = \"Error: GetFileTime %s 0x%x\" fullword ascii /* score: '17.00' */   \n           $y4 = \"Install succeeded\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '10.00' */   \n           $y5 = \"Error: RegSetValueExA 0x%x\" fullword ascii /* score: '9.00' */   \n         \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 400KB and ( $n1 or ( 1 of ($s*) and 1 of ($x*) and 3 of ($y*)))   \n   }",
			"type": "YARA",
			"id": 30360454
		},
		{
			"indicator": "f9e90099324cff2094bc7e88c587d6d6e9b2a26c",
			"description": "",
			"title": "",
			"content": "rule WildNeutron_Sample_9    \n   {   \n      \n       meta:   \n           description = \"Wild Neutron APT Sample Rule - file 781eb1e17349009fbae46aea5c59d8e5b68ae0b42335cb035742f6b0f4e4087e\"   \n           author = \"Florian Roth\"   \n           reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"   \n           date = \"2015-07-10\"   \n           score = 60   \n           hash = \"781eb1e17349009fbae46aea5c59d8e5b68ae0b42335cb035742f6b0f4e4087e\"   \n       \n       strings:   \n           $s0 = \"http://get.adobe.com/flashplayer/\" fullword wide /* PEStudio Blacklist: strings */ /* score: '30.00' */   \n           $s1 = \"xxxxxxxxxxxxxxxxxxxx\" fullword wide /* reversed goodware string 'xxxxxxxxxxxxxxxxxxxx' */ /* score: '19.00' */   \n           $s4 = \" Player Installer/Uninstaller\" fullword wide /* PEStudio Blacklist: strings */ /* score: '11.42' */   \n           $s5 = \"Adobe Flash Plugin Updater\" fullword wide /* PEStudio Blacklist: strings */ /* score: '11.00' */   \n           $s6 = \"uSOFTWARE\\\\Adobe\" fullword wide /* PEStudio Blacklist: strings */ /* score: '10.42' */   \n           $s11 = \"2008R2\" fullword wide /* PEStudio Blacklist: os */ /* score: '8.00' */   \n           $s12 = \"%02d.%04d.%s\" fullword wide /* score: '7.02' */   \n           $s13 = \"%d -> %d\" fullword wide /* score: '7.00' */   \n       \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 500KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360455
		},
		{
			"indicator": "59c1eb628ecc6a76e4b7c3a1e8d091aba4590536",
			"description": "",
			"title": "",
			"content": "rule WildNeutron_javacpl    \n   {   \n      \n       meta:   \n           description = \"Wild Neutron APT Sample Rule - from files 683f5b476f8ffe87ec22b8bab57f74da4a13ecc3a5c2cbf951999953c2064fc9, 758e6b519f6c0931ff93542b767524fc1eab589feb5cfc3854c77842f9785c92, 8ca7ed720babb32a6f381769ea00e16082a563704f8b672cb21cf11843f4da7a\"   \n           author = \"Florian Roth\"   \n           reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"   \n           date = \"2015-07-10\"   \n           score = 60   \n           super_rule = 1   \n           hash1 = \"683f5b476f8ffe87ec22b8bab57f74da4a13ecc3a5c2cbf951999953c2064fc9\"   \n           hash2 = \"758e6b519f6c0931ff93542b767524fc1eab589feb5cfc3854c77842f9785c92\"   \n           hash3 = \"8ca7ed720babb32a6f381769ea00e16082a563704f8b672cb21cf11843f4da7a\"   \n         \n       strings:   \n           $x1 = \"javacpl.exe\" fullword wide /* score: '3.00' */ /* Goodware String - occured 2 times */   \n           $s0 = \"RunFile: couldn't find ShellExecuteExA/W in SHELL32.DLL!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '35.00' */   \n           $s1 = \"Error executing CreateProcess()!!\" fullword wide /* PEStudio Blacklist: strings */ /* score: '31.00' */   \n           $s2 = \"http://www.java.com/en/download/installed.jsp?detect=jre\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '28.00' */   \n           $s3 = \"RunFile: couldn't load SHELL32.DLL!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '27.00' */   \n           $s4 = \"Process is not running any more\" fullword wide /* PEStudio Blacklist: strings */ /* score: '22.00' */   \n           $s6 = \"Windows NT Version %lu.%lu\" fullword wide /* PEStudio Blacklist: os */ /* score: '19.00' */   \n           $s7 = \"Usage: destination [reference]\" fullword wide /* PEStudio Blacklist: strings */ /* score: '16.00' */   \n           $s8 = \"Invalid input handle!!!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '15.00' */   \n           $s9 = \".com;.exe;.bat;.cmd\" fullword wide /* score: '15.00' */   \n           $s10 = \") -%s-> %s (\" fullword ascii /* score: '14.00' */   \n           $s11 = \"cmdextversion\" fullword wide /* score: '14.00' */   \n           $s12 = \"Invalid pid (%s)\" fullword wide /* PEStudio Blacklist: strings */ /* score: '13.00' */   \n           $s13 = \"\\\"%s\\\" /K %s\" fullword wide /* score: '11.02' */   \n           $s14 = \"Error setting %s (%s)\" fullword wide /* score: '11.00' */   \n           $s16 = \"cmdcmdline\" fullword wide /* score: '11.00' */   \n           $s39 = \"2008R2\" fullword ascii /* PEStudio Blacklist: os */ /* score: '8.00' */   \n        \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 1677KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360456
		},
		{
			"indicator": "ce80ddbc7efc1d32edc5d096339c753bfc651406",
			"description": "",
			"title": "",
			"content": "rule WildNeutron_Sample_1    \n   {   \n      \n       meta:   \n           description = \"Wild Neutron APT Sample Rule - file 2b5065a3d0e0b8252a987ef5f29d9e1935c5863f5718b83440e68dc53c21fa94\"   \n           author = \"Florian Roth\"   \n           reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"   \n           date = \"2015-07-10\"   \n           score = 60   \n           hash = \"2b5065a3d0e0b8252a987ef5f29d9e1935c5863f5718b83440e68dc53c21fa94\"   \n      \n       strings:   \n           $s0 = \"LiveUpdater.exe\" fullword wide /* PEStudio Blacklist: strings */ /* score: '25.00' */   \n           $s1 = \"id-at-postalAddress\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '18.00' */   \n           $s2 = \"%d -> %d (default)\" fullword wide /* PEStudio Blacklist: strings */ /* score: '17.00' */   \n           $s3 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide /* score: '15.00' */   \n           $s8 = \"id-ce-keyUsage\" fullword ascii /* score: '12.00' */   \n           $s9 = \"Key Usage\" fullword ascii /* score: '12.00' */   \n           $s32 = \"UPDATE_ID\" fullword wide /* PEStudio Blacklist: strings */ /* score: '9.00' */   \n           $s37 = \"id-at-commonName\" fullword ascii /* score: '8.00' */   \n           $s38 = \"2008R2\" fullword wide /* PEStudio Blacklist: os */ /* score: '8.00' */   \n           $s39 = \"RSA-alt\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '8.00' */   \n           $s40 = \"%02d.%04d.%s\" fullword wide /* score: '7.02' */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 800KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360457
		},
		{
			"indicator": "f31aa7386347a71c19a6eae1bab0a57f7173e101",
			"description": "",
			"title": "",
			"content": "rule WildNeutron_Sample_5    \n   {   \n      \n       meta:   \n           description = \"Wild Neutron APT Sample Rule - file 1604e36ccef5fa221b101d7f043ad7f856b84bf1a80774aa33d91c2a9a226206\"   \n           author = \"Florian Roth\"   \n           reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"   \n           date = \"2015-07-10\"   \n           score = 60   \n           hash = \"1604e36ccef5fa221b101d7f043ad7f856b84bf1a80774aa33d91c2a9a226206\"   \n      \n       strings:   \n           $s0 = \"LiveUpdater.exe\" fullword wide /* PEStudio Blacklist: strings */ /* score: '25.00' */   \n           $s1 = \"id-at-postalAddress\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '18.00' */   \n           $s2 = \"%d -> %d (default)\" fullword wide /* PEStudio Blacklist: strings */ /* score: '17.00' */   \n           $s3 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide /* score: '15.00' */   \n           $s4 = \"sha-1WithRSAEncryption\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '15.00' */   \n           $s5 = \"Postal code\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '14.00' */   \n           $s6 = \"id-ce-keyUsage\" fullword ascii /* score: '12.00' */   \n           $s7 = \"Key Usage\" fullword ascii /* score: '12.00' */   \n           $s8 = \"TLS-RSA-WITH-3DES-EDE-CBC-SHA\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '11.00' */   \n           $s9 = \"%02d.%04d.%s\" fullword wide /* score: '7.02' */   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 1000KB and all of them   \n   }",
			"type": "YARA",
			"id": 30360458
		},
		{
			"indicator": "a85cb4aade4d2469b1511ee3733dc2f7338564c6",
			"description": "",
			"title": "",
			"content": "rule WildNeutron_Sample_8    \n   {   \n      \n       meta:   \n           description = \"Wild Neutron APT Sample Rule - file 758e6b519f6c0931ff93542b767524fc1eab589feb5cfc3854c77842f9785c92\"   \n           author = \"Florian Roth\"   \n           reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"   \n           date = \"2015-07-10\"   \n           score = 60   \n           hash = \"758e6b519f6c0931ff93542b767524fc1eab589feb5cfc3854c77842f9785c92\"   \n      \n       strings:   \n           $x1 = \"RunFile: couldn't load SHELL32.DLL!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '27.00' */   \n           $x2 = \"RunFile: couldn't find ShellExecuteExA/W in SHELL32.DLL!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '35.00' */   \n           $x3 = \"Error executing CreateProcess()!!\" fullword wide /* PEStudio Blacklist: strings */ /* score: '31.00' */   \n           $x4 = \"cmdcmdline\" fullword wide /* score: '11.00' */   \n           $x5 = \"Invalid input handle!!!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '10.00' */   \n           $s1 = \"Process %d terminated\" fullword wide /* PEStudio Blacklist: strings */ /* score: '24.00' */   \n           $s2 = \"Process is not running any more\" fullword wide /* PEStudio Blacklist: strings */ /* score: '22.00' */   \n           $s3 = \"javacpl.exe\" fullword wide /* score: '3.00' */ /* Goodware String - occured 2 times */   \n           $s4 = \"Windows NT Version %lu.%lu\" fullword wide /* PEStudio Blacklist: os */ /* score: '19.00' */   \n           $s5 = \"Usage: destination [reference]\" fullword wide /* PEStudio Blacklist: strings */ /* score: '16.00' */   \n           $s6 = \".com;.exe;.bat;.cmd\" fullword wide /* score: '15.00' */   \n           $s7 = \") -%s-> %s (\" fullword ascii /* score: '14.00' */   \n           $s8 = \"cmdextversion\" fullword wide /* score: '14.00' */   \n           $s9 = \"Invalid pid (%s)\" fullword wide /* PEStudio Blacklist: strings */ /* score: '13.00' */   \n           $s10 = \"\\\"%s\\\" /K %s\" fullword wide /* score: '11.02' */   \n           $s11 = \"Error setting %s (%s)\" fullword wide /* score: '11.00' */   \n           $s12 = \"DEBUG: Cannot allocate memory for ptrNextNode->ptrNext!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '10.00' */   \n           $s13 = \"Failed to build full directory path\" fullword wide /* score: '10.00' */   \n           $s14 = \"DEBUG: Cannot allocate memory for ptrFileArray!\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '9.00' */   \n           $s15 = \"%-8s %-3s  %*s %s  %s\" fullword wide /* score: '8.00' */   \n           $s16 = \" %%%c in (%s) do \" fullword wide /* score: '8.00' */   \n          \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 1677KB and 2 of ($x*) and 6 of ($s*)   \n   }",
			"type": "YARA",
			"id": 30360459
		},
		{
			"indicator": "a4acc7b763c05016ff8396430749ad00ab02c92f",
			"description": "",
			"title": "",
			"content": "rule WildNeutron_Sample_3    \n   {   \n      \n       meta:   \n           description = \"Wild Neutron APT Sample Rule - file c2c761cde3175f6e40ed934f2e82c76602c81e2128187bab61793ddb3bc686d0\"   \n           author = \"Florian Roth\"   \n           reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"   \n           date = \"2015-07-10\"   \n           score = 60   \n           hash = \"c2c761cde3175f6e40ed934f2e82c76602c81e2128187bab61793ddb3bc686d0\"   \n         \n       strings:   \n           $x1 = \"178.162.197.9\" fullword ascii /* score: '9.00' */   \n           $x2 = \"\\\"http://fw.ddosprotected.eu:80 /opts resolv=drfx.chickenkiller.com\\\"\" fullword wide /* PEStudio Blacklist: strings */ /* score: '33.00' */   \n           $x3 = \".chickenkiller.com\" ascii /* PEStudio Blacklist: strings */ /* score: '28.00' */        \n           $s1 = \"LiveUpdater.exe\" fullword wide /* PEStudio Blacklist: strings */ /* score: '25.00' */   \n           $s2 = \"id-at-postalAddress\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '18.00' */   \n           $s3 = \"%d -> %d (default)\" fullword wide /* PEStudio Blacklist: strings */ /* score: '17.00' */   \n           $s4 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide /* score: '15.00' */   \n           $s5 = \"id-at-serialNumber\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '10.00' */   \n           $s6 = \"ECDSA with SHA256\" fullword ascii /* PEStudio Blacklist: strings */ /* score: '10.00' */   \n           $s7 = \"Acer LiveUpdater\" fullword wide /* PEStudio Blacklist: strings */ /* score: '10.00' */   \n          \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 2020KB and ( 1 of ($x*) or all of ($s*) )   \n   }",
			"type": "YARA",
			"id": 30360460
		},
		{
			"indicator": "91c1c4da10b1d8b1a62583f7b38309d02f035580",
			"description": "",
			"title": "",
			"content": "rule Winnti_malware_UpdateDLL    \n   {   \n      \n       meta:   \n           description = \"Detects a Winnti malware - Update.dll\"   \n           author = \"Florian Roth\"   \n           reference = \"VTI research\"   \n           date = \"2015-10-10\"   \n           score = 75   \n           hash1 = \"1b449121300b0188ff9f6a8c399fb818d0cf53fd36cf012e6908a2665a27f016\"   \n           hash2 = \"50174311e524b97ea5cb4f3ea571dd477d1f0eee06cd3ed73af39a15f3e6484a\"   \n           hash3 = \"6cdb65dbfb2c236b6d149fd9836cb484d0608ea082cf5bd88edde31ad11a0d58\"   \n           hash4 = \"50174311e524b97ea5cb4f3ea571dd477d1f0eee06cd3ed73af39a15f3e6484a\"   \n         \n       strings:   \n           $c1 = \"'Wymajtec$Tima Stempijg Sarviges GA -$G2\" fullword ascii   \n           $c2 = \"AHDNEAFE1.sys\" fullword ascii   \n           $c3 = \"SOTEFEHJ3.sys\" fullword ascii   \n           $c4 = \"MainSYS64.sys\" fullword ascii   \n           $s1 = \"\\\\Registry\\\\User\\\\%s\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\" fullword wide   \n           $s2 = \"Update.dll\" fullword ascii   \n           $s3 = \"\\\\\\\\.\\\\pipe\\\\usbpcex%d\" fullword wide   \n           $s4 = \"\\\\\\\\.\\\\pipe\\\\usbpcg%d\" fullword wide   \n           $s5 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\" fullword wide   \n           $s6 = \"\\\\??\\\\pipe\\\\usbpcg%d\" fullword wide   \n           $s7 = \"\\\\??\\\\pipe\\\\usbpcex%d\" fullword wide   \n           $s8 = \"HOST: %s\" fullword ascii   \n           $s9 = \"$$$--Hello\" fullword ascii   \n          \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 1000KB and ( ( 1 of ($c*) and 3 of ($s*) ) or all of ($s*) )   \n   }",
			"type": "YARA",
			"id": 30362266
		},
		{
			"indicator": "19c8dc358c8baa3ba18d1fcbcd7856769ca6b1a6",
			"description": "",
			"title": "",
			"content": "rule Winnti_signing_cert    \n   {   \n      \n       meta:   \n           description = \"Detects a signing certificate used by the Winnti APT group\"   \n           author = \"Florian Roth\"   \n           reference = \"https://securelist.com/analysis/publications/72275/i-am-hdroot-part-1/\"   \n           date = \"2015-10-10\"   \n           score = 75   \n           hash1 = \"a9a8dc4ae77b1282f0c8bdebd2643458fc1ceb3145db4e30120dd81676ff9b61\"   \n           hash2 = \"9001572983d5b1f99787291edaadbb65eb2701722f52470e89db2c59def24672\"   \n      \n       strings:   \n           $s1 = \"Guangzhou YuanLuo Technology Co.\" ascii   \n           $s2 = \"Guangzhou YuanLuo Technology Co.,Ltd\" ascii   \n           $s3 = \"$Asahi Kasei Microdevices Corporation0\" fullword ascii   \n      \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 700KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30362267
		},
		{
			"indicator": "61683f23f49cf5ce4c962e3bc563d23643384649",
			"description": "",
			"title": "",
			"content": "rule Winnti_malware_StreamPortal_Gen    \n   {   \n      \n       meta:   \n           description = \"Detects a Winnti malware - Streamportal\"   \n           author = \"Florian Roth\"   \n           reference = \"VTI research\"   \n           date = \"2015-10-10\"   \n           score = 75   \n           hash1 = \"326e2cabddb641777d489a9e7a39d52c0dc2dcb1fde1762554ea162792056b6e\"   \n           hash2 = \"9001572983d5b1f99787291edaadbb65eb2701722f52470e89db2c59def24672\"   \n           hash3 = \"aff7c7478fe33c57954b6fec2095efe8f9edf5cdb48a680de9439ba62a77945f\"   \n        \n       strings:   \n           $s0 = \"Proxies destination address/port for TCP\" fullword wide   \n           $s3 = \"\\\\Device\\\\StreamPortal\" fullword wide   \n           $s4 = \"Transport-Data Proxy Sub-Layer\" fullword wide   \n           $s5 = \"Cookie: SN=\" fullword ascii   \n           $s6 = \"\\\\BaseNamedObjects\\\\_transmition_synchronization_\" fullword wide   \n           $s17 = \"NTOSKRNL.EXE\" fullword wide /* Goodware String - occured 4 times */   \n           $s19 = \"FwpsReferenceNetBufferList0\" fullword ascii /* Goodware String - occured 5 times */   \n        \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 275KB and all of them   \n   }",
			"type": "YARA",
			"id": 30362268
		},
		{
			"indicator": "b80945410f6da35823e70d41bd556cb18def9fa3",
			"description": "",
			"title": "",
			"content": "rule Winnti_malware_FWPK    \n   {   \n      \n       meta:   \n           description = \"Detects a Winnti malware - FWPKCLNT.SYS\"   \n           author = \"Florian Roth\"   \n           reference = \"VTI research\"   \n           date = \"2015-10-10\"   \n           score = 75   \n           hash1 = \"1098518786c84b0d31f215122275582bdcd1666653ebc25d50a142b4f5dabf2c\"   \n           hash2 = \"9a684ffad0e1c6a22db1bef2399f839d8eff53d7024fb014b9a5f714d11febd7\"   \n           hash3 = \"a836397817071c35e24e94b2be3c2fa4ffa2eb1675d3db3b4456122ff4a71368\"   \n        \n       strings:   \n           $s0 = \"\\\\Registry\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\\\\\" fullword wide   \n           $s1 = \"%x:%d->%x:%d, Flag %s%s%s%s%s, seq %u, ackseq %u, datalen %u\" fullword ascii   \n           $s2 = \"FWPKCLNT.SYS\" fullword ascii   \n           $s3 = \"Port Layer\" fullword wide   \n           $s4 = \"%x->%x, icmp type %d, code %d\" fullword ascii   \n           $s5 = \"\\\\BaseNamedObjects\\\\{93144EB0-8E3E-4591-B307-8EEBFE7DB28E}\" fullword wide   \n           $s6 = \"\\\\Ndi\\\\Interfaces\" fullword wide   \n           $s7 = \"\\\\Device\\\\{93144EB0-8E3E-4591-B307-8EEBFE7DB28F}\" fullword wide   \n           $s8 = \"Bad packet\" fullword ascii   \n           $s9 = \"\\\\BaseNamedObjects\\\\EKV0000000000\" fullword wide   \n           $s10 = \"%x->%x\" fullword ascii   \n           $s11 = \"IPInjectPkt\" fullword ascii /* Goodware String - occured 6 times */   \n       \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 642KB and all of them   \n   }",
			"type": "YARA",
			"id": 30362269
		},
		{
			"indicator": "6020f01c47c41d29359172e4cad3a95b65383b09",
			"description": "",
			"title": "",
			"content": "rule Winnti_malware_Nsiproxy    \n   {   \n      \n       meta:   \n           description = \"Detects a Winnti rootkit\"   \n           author = \"Florian Roth\"   \n           date = \"2015-10-10\"   \n           score = 75   \n           hash1 = \"9001572983d5b1f99787291edaadbb65eb2701722f52470e89db2c59def24672\"   \n           hash2 = \"cf1e006694b33f27d7c748bab35d0b0031a22d193622d47409b6725b395bffb0\"   \n           hash3 = \"326e2cabddb641777d489a9e7a39d52c0dc2dcb1fde1762554ea162792056b6e\"   \n           hash4 = \"aff7c7478fe33c57954b6fec2095efe8f9edf5cdb48a680de9439ba62a77945f\"   \n           hash5 = \"ba7ccd027fd2c826bbe8f2145d5131eff906150bd98fe25a10fbee2c984df1b8\"   \n         \n       strings:   \n           $x1 = \"\\\\Driver\\\\nsiproxy\" fullword wide   \n           $a1 = \"\\\\Device\\\\StreamPortal\" fullword wide   \n           $a2 = \"\\\\Device\\\\PNTFILTER\" fullword wide   \n           $s1 = \"Cookie: SN=\" fullword ascii   \n           $s2 = \"\\\\BaseNamedObjects\\\\_transmition_synchronization_\" fullword wide   \n           $s3 = \"Winqual.sys\" fullword wide   \n           $s4 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\" fullword wide   \n           $s5 = \"http://www.wasabii.com.tw 0\" fullword ascii   \n          \n       condition:   \n           uint16(0) == 0x5a4d and $x1 and 1 of ($a*) and 2 of ($s*)   \n   }",
			"type": "YARA",
			"id": 30362270
		},
		{
			"indicator": "6ec2988fc21e134177229f9b7c2b44a75ad1e4d8",
			"description": "",
			"title": "",
			"content": "rule WoolenGoldfish_Generic_3    \n   {   \n      \n       meta:   \n           description = \"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/NpJpVZ\"   \n           date = \"2015/03/25\"   \n           score = 90   \n           hash1 = \"86222ef166474e53f1eb6d7e6701713834e6fee7\"   \n           hash2 = \"e8dbcde49c7f760165ebb0cb3452e4f1c24981f5\"   \n          \n       strings:   \n           $x1 = \"... get header FATAL ERROR !!!  %d bytes read > header_size\" fullword ascii   \n           $x2 = \"index.php?c=%S&r=%x&u=1&t=%S\" fullword wide   \n           $x3 = \"connect_back_tcp_channel#do_connect:: Error resolving connect back hostname\" fullword ascii   \n           $s0 = \"kernel32.dll GetProcAddressLoadLibraryAws2_32.dll\" fullword ascii   \n           $s1 = \"Content-Type: multipart/form-data; boundary=%S\" fullword wide   \n           $s2 = \"Attempting to unlock uninitialized lock!\" fullword ascii   \n           $s4 = \"unable to load kernel32.dll\" fullword ascii   \n           $s5 = \"index.php?c=%S&r=%x\" fullword wide   \n           $s6 = \"%s len:%d \" fullword ascii   \n           $s7 = \"Encountered error sending syscall response to client\" fullword ascii   \n           $s9 = \"/info.dat\" fullword ascii   \n           $s10 = \"Error entering thread lock\" fullword ascii   \n           $s11 = \"Error exiting thread lock\" fullword ascii   \n           $s12 = \"connect_back_tcp_channel_init:: socket() failed\" fullword ascii   \n         \n       condition:   \n           ( 1 of ($x*) ) or ( 8 of ($s*) )   \n   }",
			"type": "YARA",
			"id": 30365283
		},
		{
			"indicator": "43a6c64df37052b1b701e12e3b8690ed3428792a",
			"description": "",
			"title": "",
			"content": "rule WoolenGoldfish_Generic_2    \n   {   \n      \n       meta:   \n           description = \"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/NpJpVZ\"   \n           date = \"2015/03/25\"   \n           score = 90   \n           hash1 = \"47b1c9caabe3ae681934a33cd6f3a1b311fd7f9f\"   \n           hash2 = \"62172eee1a4591bde2658175dd5b8652d5aead2a\"   \n           hash3 = \"7fef48e1303e40110798dfec929ad88f1ad4fbd8\"   \n           hash4 = \"c1edf6e3a271cf06030cc46cbd90074488c05564\"   \n         \n       strings:   \n           $s0 = \"modules\\\\exploits\\\\littletools\\\\agent_wrapper\\\\release\" ascii   \n         \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30365284
		},
		{
			"indicator": "31e3fbb10c9b5ae8976ac9225e2b54415a5e32cf",
			"description": "",
			"title": "",
			"content": "rule WoolenGoldfish_Sample_1    \n   {   \n      \n       meta:   \n           description = \"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/NpJpVZ\"   \n           date = \"2015/03/25\"   \n           score = 60   \n           hash = \"7ad0eb113bc575363a058f4bf21dbab8c8f7073a\"   \n          \n       strings:   \n           $s1 = \"Cannot execute (%d)\" fullword ascii   \n           $s16 = \"SvcName\" fullword ascii   \n          \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30365285
		},
		{
			"indicator": "7830ec917360c7b80f2d7c33722c1a708ca201fe",
			"description": "",
			"title": "",
			"content": "rule WoolenGoldfish_Generic_1    \n   {   \n      \n       meta:   \n           description = \"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/NpJpVZ\"   \n           date = \"2015/03/25\"   \n           score = 90   \n           super_rule = 1   \n           hash0 = \"5d334e0cb4ff58859e91f9e7f1c451ffdc7544c3\"   \n           hash1 = \"d5b2b30fe2d4759c199e3659d561a50f88a7fb2e\"   \n           hash2 = \"a42f1ad2360833baedd2d5f59354c4fc3820c475\"   \n          \n       strings:   \n           $x0 = \"Users\\\\Wool3n.H4t\\\\\"   \n           $x1 = \"C-CPP\\\\CWoolger\"   \n           $x2 = \"NTSuser.exe\" fullword wide   \n           $s1 = \"107.6.181.116\" fullword wide   \n           $s2 = \"oShellLink.Hotkey = \\\"CTRL+SHIFT+F\\\"\" fullword   \n           $s3 = \"set WshShell = WScript.CreateObject(\\\"WScript.Shell\\\")\" fullword   \n           $s4 = \"oShellLink.IconLocation = \\\"notepad.exe, 0\\\"\" fullword   \n           $s5 = \"set oShellLink = WshShell.CreateShortcut(strSTUP & \\\"\\\\WinDefender.lnk\\\")\" fullword   \n           $s6 = \"wlg.dat\" fullword   \n           $s7 = \"woolger\" fullword wide   \n           $s8 = \"[Enter]\" fullword   \n           $s9 = \"[Control]\" fullword   \n       condition:   \n           ( 1 of ($x*) and 2 of ($s*) ) or ( 6 of ($s*) )   \n   }",
			"type": "YARA",
			"id": 30365286
		},
		{
			"indicator": "7337bd0f174c2113cca61f0ebb3cf6c639651f67",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_ys_ratload {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file ys.ratload.sh\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"a340e5b5cfd41076bd4d6ad89d7157eeac264db97a9dddaae15d935937f10d75\"   \n      strings:   \n         $x1 = \"echo \\\"example: ${0} -l 192.168.1.1 -p 22222 -x 9999\\\"\" fullword ascii   \n         $x2 = \"-x [ port to start mini X server on DEFAULT = 12121 ]\\\"\" fullword ascii   \n         $x3 = \"CALLBACK_PORT=32177\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x2123 and filesize < 3KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377534
		},
		{
			"indicator": "cf1aeee7d5adb0a8d0f9d3fef60d833ba4ef8f23",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_ActiveDirectory_Target {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"33c1b7fdee7c70604be1e7baa9eea231164e62d5d5090ce7f807f43229fe5c36\"   \n      strings:   \n         $s1 = \"(&(objectCategory=person)(objectClass=user)(cn=\" fullword wide   \n         $s2 = \"(&(objectClass=user)(objectCategory=person)\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377535
		},
		{
			"indicator": "e2c911f1198ad2abb4c549ffbef53f8feca98c4d",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Auditcleaner {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file Auditcleaner\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"8c172a60fa9e50f0df493bf5baeb7cc311baef327431526c47114335e0097626\"   \n      strings:   \n         $x1 = \"> /var/log/audit/audit.log; rm -f .\" ascii   \n         $x2 = \"Pastables to run on target:\" ascii   \n         $x3 = \"cp /var/log/audit/audit.log .tmp\" ascii   \n      \n         $l1 = \"Here is the first good cron session from\" fullword ascii   \n         $l2 = \"No need to clean LOGIN lines.\" fullword ascii   \n      condition:   \n         ( filesize < 300KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377536
		},
		{
			"indicator": "c44f785e7bed70b6656b90afca2cff3e70bdbc35",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__ESKE_RPC2_8 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"   \n         hash2 = \"5c0896dbafc5d8cc19b1bc7924420b20ed5999ac5bee2cb5a91aada0ea01e337\"   \n      strings:   \n         $s4 = \"Fragment: Packet too small to contain RPC header\" fullword ascii   \n         $s5 = \"Fragment pickup: SmbNtReadX failed\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 700KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377537
		},
		{
			"indicator": "d9e4fcf75b2149a15accae187591764faf49cb93",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_DoubleFeatureDll_dll_3 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"515374423b8b132258bd91acf6f29168dcc267a3f45ecb9d1fe18ee3a253195b\"   \n      strings:   \n         $a = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 }   \n         $b = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 }   \n         $c = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 1000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377538
		},
		{
			"indicator": "fef01cb7b9e31cf97e272180b5b82fe809c7c2ff",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_PC_Exploit {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"77486bb828dba77099785feda0ca1d4f33ad0d39b672190079c508b3feb21fb0\"   \n      strings:   \n         $s1 = \"\\\\\\\\.\\\\pipe\\\\pcheap_reuse\" fullword wide   \n         $s2 = \"**** FAILED TO DUPLICATE SOCKET ****\" fullword wide   \n         $s3 = \"**** UNABLE TO DUPLICATE SOCKET TYPE %u ****\" fullword wide   \n         $s4 = \"YOU CAN IGNORE ANY 'ServiceEntry returned error' messages after this...\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 20KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377539
		},
		{
			"indicator": "ee9dbce10307d026f82ceeae31ef6c24dc3d1a9d",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_SetPorts {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"722d3cf03908629bc947c4cca7ce3d6b80590a04616f9df8f05c02de2d482fb2\"   \n      strings:   \n         $s1 = \"USAGE: SetPorts <input file> <output file> <version> <port1> [port2] [port3] [port4] [port5]\" fullword ascii   \n         $s2 = \"Valid versions are:  1 = PC 1.2   2 = PC 1.2 (24 hour)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377540
		},
		{
			"indicator": "d0277e347b5648129046f06b431c2d9f28563c80",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_eh_1_1_0 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file eh.1.1.0.0\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"0f8dd094516f1be96da5f9addc0f97bcac8f2a348374bd9631aa912344559628\"   \n      strings:   \n         $x1 = \"usage: %s -e -v -i target IP [-c Cert File] [-k Key File]\" fullword ascii   \n         $x2 = \"TYPE=licxfer&ftp=%s&source=/var/home/ftp/pub&version=NA&licfile=\" ascii   \n         $x3 = \"[-l Log File] [-m save MAC time file(s)] [-p Server Port]\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 100KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377541
		},
		{
			"indicator": "d48253b9dc39dbf57c823e93aed3cc34dd28a006",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_pclean_v2_1_1_2 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file pclean.v2.1.1.0-linux-i386\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"cdb5b1173e6eb32b5ea494c38764b9975ddfe83aa09ba0634c4bafa41d844c97\"   \n      strings:   \n         $s3 = \"** SIGNIFICANTLY IMPROVE PROCESSING TIME\" fullword ascii   \n         $s6 = \"-c cmd_name:     strncmp() search for 1st %d chars of commands that \" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 40KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377542
		},
		{
			"indicator": "a12975c87c1dec1109ad8bb0da72b655aa357fca",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Eternalromance_2 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"f1ae9fdbb660aae3421fd3e5b626c1e537d8e9ee2f9cd6d56cb70b6878eaca5d\"   \n         hash2 = \"b99c3cc1acbb085c9a895a8c3510f6daaf31f0d2d9ccb8477c7fb7119376f57b\"   \n         hash3 = \"92c6a9e648bfd98bbceea3813ce96c6861487826d6b2c3d462debae73ed25b34\"   \n      strings:   \n         $x1 = \"[+] Backdoor shellcode written\" fullword ascii   \n         $x2 = \"[*] Attempting exploit method %d\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 600KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377543
		},
		{
			"indicator": "b033e0e4f2cb9348f9234fd5f8b05a00209b9c07",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__EAFU_ecwi_ESKE_EVFR_RPC2_4 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"3e181ca31f1f75a6244b8e72afaa630171f182fbe907df4f8b656cc4a31602f6\"   \n         hash2 = \"c4152f65e45ff327dade50f1ac3d3b876572a66c1ce03014f2877cea715d9afd\"   \n         hash3 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"   \n         hash4 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"   \n         hash5 = \"5c0896dbafc5d8cc19b1bc7924420b20ed5999ac5bee2cb5a91aada0ea01e337\"   \n      strings:   \n         $x1 = \"* Listening Post DLL %s() returned error code %d.\" fullword ascii   \n      \n         $s1 = \"WsaErrorTooManyProcesses\" fullword ascii   \n         $s2 = \"NtErrorMoreProcessingRequired\" fullword ascii   \n         $s3 = \"Connection closed by remote host (TCP Ack/Fin)\" fullword ascii   \n         $s4 = \"ServerErrorBadNamePassword\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 2000KB and all of ($s*) or 1 of ($x*) )   \n   }",
			"type": "YARA",
			"id": 30377544
		},
		{
			"indicator": "931fd31cb360e2fcc34663f57b1d55f547114cfb",
			"description": "",
			"title": "",
			"content": "rule EquationGroup__ftshell_ftshell_v3_10_3_0 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- from files ftshell, ftshell.v3.10.3.7\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         super_rule = 1   \n         hash1 = \"9bebeb57f1c9254cb49976cc194da4be85da4eb94475cb8d813821fb0b24f893\"   \n         hash2 = \"0be739024b41144c3b63e40e46bab22ac098ccab44ab2e268efc3b63aea02951\"   \n      strings:   \n         $s1 = \"set uRemoteUploadCommand \\\"[exec cat /current/.ourtn-ftshell-upcommand]\\\"\" fullword ascii   \n         $s2 = \"send \\\"\\\\[ \\\\\\\"\\\\$BASH\\\\\\\" = \\\\\\\"/bin/bash\\\\\\\" -o \\\\\\\"\\\\$SHELL\\\\\\\" = \\\\\\\"/bin/bash\\\\\\\" \\\\] &&\" ascii   \n         $s3 = \"system rm -f /current/tmp/ftshell.latest\" fullword ascii   \n         $s4 = \"# ftshell -- File Transfer Shell\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x2123 and filesize < 100KB and 1 of them ) or ( 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377545
		},
		{
			"indicator": "e44ee5a47d7ac30407996c11fb2adc5a4b32e1c0",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_put_Implant9x {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"8fcc98d63504bbacdeba0c1e8df82f7c4182febdf9b08c578d1195b72d7e3d5f\"   \n      strings:   \n         $s1 = \"3&3.3<3A3F3K3V3c3m3\" fullword ascii   \n      \n         $op1 = { c9 c2 08 00 b8 72 1c 00 68 e8 c9 fb ff ff 51 56 }   \n         $op2 = { 40 1b c9 23 c8 03 c8 38 5d 14 74 05 6a 03 58 eb }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 20KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377546
		},
		{
			"indicator": "6901790bf9a3ec3a706d8a39ddfe883f296f2ebd",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_noclient_3_3_2 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"3cf0eb010c431372af5f32e2ee8c757831215f8836cabc7d805572bb5574fc72\"   \n      strings:   \n         $x1 = \"127.0.0.1 is not advisable as a source. Use -l 127.0.0.1 to override this warning\" fullword ascii   \n         $x2 = \"iptables -%c OUTPUT -p tcp -d 127.0.0.1 --tcp-flags RST RST -j DROP;\" fullword ascii   \n         $x3 = \"noclient: failed to execute %s: %s\" fullword ascii   \n         $x4 = \"sh -c \\\"ping -c 2 %s; grep %s /proc/net/arp >/tmp/gx \\\"\" fullword ascii   \n         $s5 = \"Attempting connection from 0.0.0.0:\" ascii   \n      condition:   \n         ( filesize < 1000KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377547
		},
		{
			"indicator": "574f46b6950a48d76dc7e3dbbf43d7ba7f3e43b7",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_rc5 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"69e2c68c6ea7be338497863c0c5ab5c77d5f522f0a84ab20fe9c75c7f81318eb\"   \n      strings:   \n         $s1 = \"Usage: %s [d|e] session_key ciphertext\" fullword ascii   \n         $s2 = \"where session_key and ciphertext are strings of hex\" fullword ascii   \n         $s3 = \"d = decrypt mode, e = encrypt mode\" fullword ascii   \n         $s4 = \"Bad mode, should be 'd' or 'e'\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377548
		},
		{
			"indicator": "6d8cee5b047ed83a33536d1b2a37cdf495869c24",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_PC_Legacy_dll {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"0cbc5cc2e24f25cb645fb57d6088bcfb893f9eb9f27f8851503a1b33378ff22d\"   \n      strings:   \n         $op1 = { 45 f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 }   \n         $op2 = { 49 c6 45 e1 73 c6 45 e2 57 c6 45 e3 }   \n         $op3 = { 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 6f c6 45 ea }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377549
		},
		{
			"indicator": "d53588ad31a9c9e4920a0e65c0c8dd8a94eee994",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_yak_min_install {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"f67214083d60f90ffd16b89a0ce921c98185b2032874174691b720514b1fe99e\"   \n      strings:   \n         $s1 = \"driver start\" fullword ascii   \n         $s2 = \"DeviceIoControl Error: %d\" fullword ascii   \n         $s3 = \"Phlook\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377550
		},
		{
			"indicator": "063695594d03ad5e527df851e0c2c8f4122ebe9f",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_watcher_linux_i386_v_3_3_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"ce4c9bfa25b8aad8ea68cc275187a894dec5d79e8c0b2f2f3ec4184dc5f402b8\"   \n      strings:   \n         $s1 = \"invalid option `\" fullword ascii   \n         $s8 = \"readdir64\" fullword ascii   \n         $s9 = \"89:z89:%r%opw\" fullword wide   \n         $s13 = \"Ropopoprstuvwypypop\" fullword wide   \n         $s17 = \"Missing argument for `-x'.\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 700KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377551
		},
		{
			"indicator": "5d070ad385d9a0f5d81f150ce7d1ce208c888026",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_ntfltmgr {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"3df61b8ef42a995b8f15a0d38bc51f2f08f8d9a2afa1afc94c6f80671cf4a124\"   \n         hash2 = \"f7a886ee10ee6f9c6be48c20f370514be62a3fd2da828b0dff44ff3d485ff5c5\"   \n         hash3 = \"980954a2440122da5840b31af7e032e8a25b0ce43e071ceb023cca21cedb2c43\"   \n      strings:   \n         $s3 = \"wCw3wDwAw2wNw@wEwZw2wDwEwBwZwFwFw4w2wZw5w1w4wFwZwGwOwGwGwEw5w2wFwGwDwFwOw\" fullword ascii   \n         $s6 = \"w+w;w2w0w6w4w.w(wRw\" fullword ascii   \n      \n         $op1 = { 80 f7 ff ff 49 89 84 34 18 02 00 00 41 83 a4 34 }   \n         $op2 = { ff 15 0b 34 00 00 eb 92 }   \n         $op3 = { 4d 8d b4 34 08 02 00 00 4d 85 f6 0f 84 ae }   \n         $op4 = { 8b ca 2b ce 8d 34 01 0f b7 3e 66 3b 7d f0 89 75 }   \n         $op5 = { 8a 40 01 00 c7 47 70 }   \n         $op6 = { e9 3c ff ff ff 6a ff 8d 45 f0 50 e8 27 11 00 00 }   \n         $op7 = { 8b 45 08 53 57 8b 7d 0c c7 40 34 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and 4 of them )   \n   }",
			"type": "YARA",
			"id": 30377552
		},
		{
			"indicator": "e1c49f0abd9690111e0c9918e92ca310399b0754",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Doublepulsar_1_3_1 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13\"   \n      strings:   \n         $x1 = \"[+] Ping returned Target architecture: %s - XOR Key: 0x%08X\" fullword ascii   \n         $x2 = \". Sending shellcode to inject DLL\" fullword ascii   \n         $x3 = \"[-] Error setting ShellcodeFile name\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377553
		},
		{
			"indicator": "5eb8c2028718042c53c3f07c2c381a5e804d60f8",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_eggbasket {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file eggbasket\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"b078a02963610475217682e6e1d6ae0b30935273ed98743e47cc2553fbfd068f\"   \n      strings:   \n         $x1 = \"# Building Shellcode into exploit.\" fullword ascii   \n         $x2 = \"%s -w /index.html -v 3.5 -t 10 -c \\\"/usr/openwin/bin/xterm -d 555.1.2.2:0&\\\"  -d 10.0.0.1 -p 80\" fullword ascii   \n         $x3 = \"# STARTING EXHAUSTIVE ATTACK AGAINST \" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 90KB and 1 of them ) or ( 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377554
		},
		{
			"indicator": "bbf69e9c0c4f543e54ac4ae626787fc94d93ee4d",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_evolvingstrategy_1_0_1 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file evolvingstrategy.1.0.1.1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"fe70e16715992cc86bbef3e71240f55c7d73815b4247d7e866c845b970233c1b\"   \n      strings:   \n         $s1 = \"chown root sh; chmod 4777 sh;\" fullword ascii   \n         $s2 = \"cp /bin/sh .;chown root sh;\" fullword ascii   \n      \n         $l1 = \"echo clean up when elevated:\" fullword ascii   \n      \n         $x1 = \"EXE=$DIR/sbin/ey_vrupdate\" fullword ascii   \n      condition:   \n         ( filesize < 4KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377555
		},
		{
			"indicator": "e26f1bfa621d1b67cf3bb282f9a6e7cc94bbe1e7",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_epoxyresin_v1_0_0 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file epoxyresin.v1.0.0.1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"eea8a6a674d5063d7d6fc9fe07060f35b16172de6d273748d70576b01bf01c73\"   \n      strings:   \n         $x1 = \"[-] kernel not vulnerable\" fullword ascii   \n      \n         $s1 = \".tmp.%d.XXXXXX\" fullword ascii   \n         $s2 = \"[-] couldn't create temp file\" fullword ascii   \n         $s3 = \"/boot/System.map-%s\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 30KB and $x1 ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30377556
		},
		{
			"indicator": "4fd21f544b66b41eead84ef39ee1a24f08f17730",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_porkclient {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file porkclient\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"5c14e3bcbf230a1d7e2909876b045e34b1486c8df3c85fb582d9c93ad7c57748\"   \n      strings:   \n         $s1 = \"-c COMMAND: shell command string\" fullword ascii   \n         $s2 = \"Cannot combine shell command mode with args to do socket reuse\" fullword ascii   \n         $s3 = \"-r: Reuse socket for Nopen connection (requires -t, -d, -f, -n, NO -c)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 30KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377557
		},
		{
			"indicator": "5f848decc373c3ddd425439d6a27b07692b9c111",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Regread_1_1_1 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"722f034ba634f45c429c7dafdbff413c08976b069a6b30ec91bfa5ce2e4cda26\"   \n      strings:   \n         $s1 = \"[+] Connected to the Registry Service\" fullword ascii   \n         $s2 = \"f08d49ac41d1023d9d462d58af51414daff95a6a\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 80KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377558
		},
		{
			"indicator": "94ff1d180a73a17126c070f0e18925061a8e4d63",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_RemoteExecute_Implant {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"770663c07c519677316934cf482e500a73540d9933342c425f3e56258e6e6d8b\"   \n      strings:   \n         $op1 = { 53 00 63 00 68 00 65 00 64 00 75 00 6C 00 65 00   \n                  00 00 00 00 53 00 65 00 72 00 76 00 69 00 63 00   \n                  65 00 73 00 41 00 63 00 74 00 69 00 76 00 65 00   \n                  00 00 00 00 FF FF FF FF 00 00 00 00 B0 17 00 68   \n                  5C 00 70 00 69 00 70 00 65 00 5C 00 53 00 65 00   \n                  63 00 6F 00 6E 00 64 00 61 00 72 00 79 00 4C 00   \n                  6F 00 67 00 6F 00 6E 00 00 00 00 00 5C 00 00 00   \n                  57 00 69 00 6E 00 53 00 74 00 61 00 30 00 5C 00   \n                  44 00 65 00 66 00 61 00 75 00 6C 00 74 00 00 00   \n                  6E 00 63 00 61 00 63 00 6E 00 5F 00 6E 00 70 00   \n                  00 00 00 00 5C 00 70 00 69 00 70 00 65 00 5C 00   \n                  53 00 45 00 43 00 4C 00 4F 00 47 00 4F 00 4E }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 40KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377559
		},
		{
			"indicator": "d06210968798f281a5c271f5e519b37680200a8e",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__NameProbe_SMBTOUCH_14 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"fbe3a4501654438f502a93f51b298ff3abf4e4cad34ce4ec0fad5cb5c2071597\"   \n         hash2 = \"7da350c964ea43c149a12ac3d2ce4675cedc079ddc10d1f7c464b16688305309\"   \n      strings:   \n         $s1 = \"DEC Pathworks TCPIP service on Windows NT\" fullword ascii   \n         $s2 = \"<\\\\\\\\__MSBROWSE__> G\" fullword ascii   \n         $s3 = \"<IRISNAMESERVER>\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377560
		},
		{
			"indicator": "5185fe1ef4d4c0ba8d6e9cbba3a8d9c8606a987b",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RPC2_15 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"   \n         hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"   \n         hash3 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"   \n         hash4 = \"5c0896dbafc5d8cc19b1bc7924420b20ed5999ac5bee2cb5a91aada0ea01e337\"   \n      strings:   \n         $x1 = \"** SendAndReceive ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii   \n         $s8 = \"Binding to RPC Interface %s over named pipe\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377561
		},
		{
			"indicator": "d43b254d23e710efc6bd14d637c3a6829015d08a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Gen4 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"fe7ce2fdb245c62e4183c728bc97e966a98fdc8ffd795ed09da23f96e85dcdcd\"   \n         hash2 = \"0989bfe351342a7a1150b676b5fd5cbdbc201b66abcb23137b1c4de77a8f61a6\"   \n         hash3 = \"270850303e662be53d90fa60a9e5f4bd2bfb95f92a046c77278257631d9addf4\"   \n         hash4 = \"7a086c0acb6df1fa304c20733f96e898d21ca787661270f919329fadfb930a6e\"   \n         hash5 = \"c236e0d9c5764f223bd3d99f55bd36528dfc0415e14f5fde1e5cdcada14f4ec0\"   \n         hash6 = \"9d98e044eedc7272823ba8ed80dff372fde7f3d1bece4e5affb21e16f7381eb2\"   \n         hash7 = \"dfce29df4d198c669a87366dd56a7426192481d794f71cd5bb525b08132ed4f7\"   \n         hash8 = \"87fdc6c32b9aa8ae97c7efbbd5c9ae8ec5595079fc1488f433beef658efcb4e9\"   \n         hash9 = \"722f034ba634f45c429c7dafdbff413c08976b069a6b30ec91bfa5ce2e4cda26\"   \n         hash10 = \"d94b99908f528fa4deb56b11eac29f6a6e244a7b3aac36b11b807f2f74c6d8be\"   \n         hash11 = \"4b07d9d964b2c0231c1db7526237631bb83d0db80b3c9574cc414463703462d3\"   \n         hash12 = \"30b63abde1e871c90df05137ec08df3fa73dedbdb39cb4bd2a2df4ca65bc4e53\"   \n         hash13 = \"02c1b08224b7ad4ac3a5b7b8e3268802ee61c1ec30e93e392fa597ae3acc45f7\"   \n         hash14 = \"690f09859ddc6cd933c56b9597f76e18b62a633f64193a51f76f52f67bc2f7f0\"   \n      strings:   \n         $x1 = \"[+] \\\"TargetPort\\\"      %hu\" fullword ascii   \n         $x2 = \"---<<<  Complete  >>>---\" fullword ascii   \n         $x3 = \"[+] \\\"NetworkTimeout\\\"  %hu\" fullword ascii   \n      \n         $op1 = { 46 83 c4 0c 83 fe 0c 0f 8c 5e ff ff ff b8 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 150KB and ( 1 of ($x*) or 2 of them ) )   \n   }",
			"type": "YARA",
			"id": 30377562
		},
		{
			"indicator": "eb0ffb6f0cffc82cdb5b02a6bc2fa71f7477c434",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_DoubleFeatureDll_dll_2 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"f265defd87094c95c7d3ddf009d115207cd9d4007cf98629e814eda8798906af\"   \n         hash2 = \"8d62ca9e6d89f2b835d07deb5e684a576607e4fe3740f77c0570d7b16ebc2985\"   \n         hash3 = \"634a80e37e4b32706ad1ea4a2ff414473618a8c42a369880db7cc127c0eb705e\"   \n      strings:   \n         $s1 = \".dllfD\" fullword ascii   \n         $s2 = \"Khsppxu\" fullword ascii   \n         $s3 = \"D$8.exe\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 1000KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377563
		},
		{
			"indicator": "06a80491158f634a0fe46cec10bc75430daaa267",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_porkserver {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file porkserver\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"7b5f86e289047dd673e8a09438d49ec43832b561bac39b95098f5bf4095b8b4a\"   \n      strings:   \n         $s1 = \"%s/%s server failing (looping), service terminated\" fullword ascii   \n         $s2 = \"getpwnam: %s: No such user\" fullword ascii   \n         $s3 = \"execv %s: %m\" fullword ascii   \n         $s4 = \"%s/%s: unknown service\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 70KB and 3 of them )   \n   }",
			"type": "YARA",
			"id": 30377564
		},
		{
			"indicator": "bdc0d4e6ea05ce157b2a1835714390d6f2704e0f",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_DiBa_Target_2000 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"f9ea8ff5985b94f635d03f3aab9ad4fb4e8c2ad931137dba4f8ee8a809421b91\"   \n      strings:   \n         $s1 = \"0M1U1Z1p1\" fullword ascii   \n      \n         $op1 = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 }   \n         $op2 = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 }   \n         $op3 = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 1000KB and 3 of them )   \n   }",
			"type": "YARA",
			"id": 30377565
		},
		{
			"indicator": "043e4a0af166a9224c2f970c008926295251b426",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_orleans_stride_sunos5_9_v_2_4_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"6a30efb87b28e1a136a66c7708178c27d63a4a76c9c839b2fc43853158cb55ff\"   \n      strings:   \n         $s1 = \"_lib_version\" fullword ascii   \n         $s2 = \",%02d%03d\" fullword ascii   \n         $s3 = \"TRANSIT\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 200KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377566
		},
		{
			"indicator": "3bd10382e5d58bd5309558638cdc5e72012d0710",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_cursehelper_win2k_i686_v_2_2_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"5ac6fde8a06f4ade10d672e60e92ffbf78c4e8db6b5152e23171f6f53af0bfe1\"   \n      strings:   \n         $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/{}\" fullword ascii   \n      \n         $op1 = { 8d b5 48 ff ff ff 89 34 24 e8 56 2a 00 00 c7 44 } /* Opcode */   \n         $op2 = { e9 a2 f2 ff ff ff 85 b4 fe ff ff 8b 95 a8 fe ff } /* Opcode */   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 500KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377567
		},
		{
			"indicator": "946b4f3748b3d9e7f926dd5d3eb32cf3a5e1bb56",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_elatedmonkey_1_0_1_1 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file elatedmonkey.1.0.1.1.sh\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"bf7a9dce326604f0681ca9f7f1c24524543b5be8b6fcc1ba427b18e2a4ff9090\"   \n      strings:   \n         $x3 = \"Usage: $0 ( -s IP PORT | CMD )\" fullword ascii   \n         $s5 = \"os.execl(\\\"/bin/sh\\\", \\\"/bin/sh\\\", \\\"-c\\\", \\\"$CMD\\\")\" fullword ascii   \n         $s13 = \"PHP_SCRIPT=\\\"$HOME/public_html/info$X.php\\\"\" fullword ascii   \n         $s15 = \"cat > /dev/tcp/127.0.0.1/80 <<END\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x2123 and filesize < 5KB and ( 1 of ($x*) and 5 of ($s*) ) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30377568
		},
		{
			"indicator": "d34ecc821d2a1e2f9501b01f5be0e2135b191ee3",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_cmsd {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file cmsd\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"634c50614e1f5f132f49ae204c4a28f62a32a39a3446084db5b0b49b564034b8\"   \n      strings:   \n         $x1 = \"usage: %s address [-t][-s|-c command] [-p port] [-v 5|6|7]\" fullword ascii   \n         $x2 = \"error: not vulnerable\" fullword ascii   \n      \n         $s1 = \"port=%d connected! \" fullword ascii   \n         $s2 = \"xxx.XXXXXX\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 30KB and 1 of ($x*) ) or ( 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377569
		},
		{
			"indicator": "d0629b040fa196a56e01b782c928d1ac6f86a46a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_clocksvc {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"c1bcd04b41c6b574a5c9367b777efc8b95fe6cc4e526978b7e8e09214337fac1\"   \n      strings:   \n         $x1 = \"~debl00l.tmp\" fullword ascii   \n         $x2 = \"\\\\\\\\.\\\\mailslot\\\\c54321\" fullword ascii   \n         $x3 = \"\\\\\\\\.\\\\mailslot\\\\c12345\" fullword ascii   \n         $x4 = \"nowMutex\" fullword ascii   \n      \n         $s1 = \"System\\\\CurrentControlSet\\\\Services\\\\MSExchangeIS\\\\ParametersPrivate\" fullword ascii   \n         $s2 = \"000000005017C31B7C7BCF97EC86019F5026BE85FD1FB192F6F4237B78DB12E7DFFB07748BFF6432B3870681D54BEF44077487044681FB94D17ED04217145B98\" ascii   \n         $s3 = \"00000000E2C9ADBD8F470C7320D28000353813757F58860E90207F8874D2EB49851D3D3115A210DA6475CCFC111DCC05E4910E50071975F61972DCE345E89D88\" ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and ( 1 of ($x*) or 2 of ($s*) ) )   \n   }",
			"type": "YARA",
			"id": 30377570
		},
		{
			"indicator": "7dc17dd7391077e7bcf2205f978cfba7e41564d9",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_16 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"   \n         hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"   \n         hash3 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"   \n      strings:   \n         $x1 = \"ERROR: TbMalloc() failed for encoded exploit payload\" fullword ascii   \n         $x2 = \"** EncodeExploitPayload ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii   \n         $x4 = \"** RunExploit ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii   \n         $s6 = \"Sending Implant Payload (%d-bytes)\" fullword ascii   \n         $s7 = \"ERROR: Encoder failed on exploit payload\" fullword ascii   \n         $s11 = \"ERROR: VulnerableOS() != RET_SUCCESS\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377571
		},
		{
			"indicator": "b7272246cbb28c18d2961e637f8704e9725f0e8e",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_GangsterThief_Implant {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"50b269bda5fedcf5a62ee0514c4b14d48d53dd18ac3075dcc80b52d0c2783e06\"   \n      strings:   \n         $s1 = \"\\\\\\\\.\\\\%s:\" fullword wide   \n         $s4 = \"raw_open CreateFile error\" fullword ascii   \n         $s5 = \"-PATHDELETED-\" fullword ascii   \n         $s6 = \"(deleted)\" fullword wide   \n         $s8 = \"NULLFILENAME\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and 3 of them )   \n   }",
			"type": "YARA",
			"id": 30377572
		},
		{
			"indicator": "12a7adbc1bf52948539038ef9cc071825610bbdc",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_AdUser_Implant {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"fd2efb226969bc82e2e38769a10a8a751138db69f4594a8de4b3c0522d4d885f\"   \n      strings:   \n         $s1 = \".?AVFeFinallyFailure@@\" fullword ascii   \n         $s2 = \"(&(objectCategory=person)(objectClass=user)(cn=\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 40KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377573
		},
		{
			"indicator": "8428512fc502bac52f5c79d520728c3c394d8805",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Gen3 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"270850303e662be53d90fa60a9e5f4bd2bfb95f92a046c77278257631d9addf4\"   \n         hash2 = \"7a086c0acb6df1fa304c20733f96e898d21ca787661270f919329fadfb930a6e\"   \n         hash3 = \"c236e0d9c5764f223bd3d99f55bd36528dfc0415e14f5fde1e5cdcada14f4ec0\"   \n         hash4 = \"9d98e044eedc7272823ba8ed80dff372fde7f3d1bece4e5affb21e16f7381eb2\"   \n         hash5 = \"dfce29df4d198c669a87366dd56a7426192481d794f71cd5bb525b08132ed4f7\"   \n         hash6 = \"87fdc6c32b9aa8ae97c7efbbd5c9ae8ec5595079fc1488f433beef658efcb4e9\"   \n         hash7 = \"722f034ba634f45c429c7dafdbff413c08976b069a6b30ec91bfa5ce2e4cda26\"   \n         hash8 = \"d94b99908f528fa4deb56b11eac29f6a6e244a7b3aac36b11b807f2f74c6d8be\"   \n         hash9 = \"4b07d9d964b2c0231c1db7526237631bb83d0db80b3c9574cc414463703462d3\"   \n         hash10 = \"30b63abde1e871c90df05137ec08df3fa73dedbdb39cb4bd2a2df4ca65bc4e53\"   \n         hash11 = \"02c1b08224b7ad4ac3a5b7b8e3268802ee61c1ec30e93e392fa597ae3acc45f7\"   \n         hash12 = \"690f09859ddc6cd933c56b9597f76e18b62a633f64193a51f76f52f67bc2f7f0\"   \n      strings:   \n         $s1 = \"Logon failed.  Kerberos ticket not yet valid (target and KDC times not synchronized)\" fullword ascii   \n         $s2 = \"[-] Could not set \\\"CredentialType\\\"\" fullword ascii   \n      \n         $op1 = { 46 83 c4 0c 83 fe 0c 0f 8c 5e ff ff ff b8 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 150KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377574
		},
		{
			"indicator": "5c8db6f1184eab32926e40bdac7c8eec59be84ff",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_dumppoppy {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file dumppoppy\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"4a5c01590063c78d03c092570b3206fde211daaa885caac2ab0d42051d4fc719\"   \n      strings:   \n         $x1 = \"Unless the -c (clobber) option is used, if two RETR commands of the\" fullword ascii   \n         $x2 = \"mywarn(\\\"End of $destfile determined by \\\\\\\"^Connection closed by foreign host\\\\\\\"\\\")\" fullword ascii   \n      \n         $l1 = \"End of $destfile determined by \\\"^Connection closed by foreign host\"   \n      condition:   \n         ( filesize < 20KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377575
		},
		{
			"indicator": "91069e1c0b56df91c17f504050976469c90cc1eb",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__ELV_ESKE_ETBL_ETRE_EVFR_11 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"   \n         hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"   \n         hash3 = \"70db3ac2c1a10de6ce6b3e7a7890c37bffde006ea6d441f5de6d8329add4d2ef\"   \n         hash4 = \"e0f05f26293e3231e4e32916ad8a6ee944af842410c194fce8a0d8ad2f5c54b2\"   \n         hash5 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"   \n      strings:   \n         $x1 = \"Target is vulnerable\" fullword ascii   \n         $x2 = \"Target is NOT vulnerable\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377576
		},
		{
			"indicator": "edb6e0ce363dabb06670524246be7de29ef99aaf",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_estopmoonlit {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file estopmoonlit\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"707ecc234ed07c16119644742ebf563b319b515bf57fd43b669d3791a1c5e220\"   \n      strings:   \n         $x1 = \"[+] shellcode prepared, re-executing\" fullword ascii   \n         $x2 = \"[-] kernel not vulnerable: prctl\" fullword ascii   \n         $x3 = \"[-] shell failed\" fullword ascii   \n         $x4 = \"[!] selinux apparently enforcing.  Continue [y|n]? \" fullword ascii   \n      condition:   \n         filesize < 250KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30377577
		},
		{
			"indicator": "da0cb178dff7d5eead8341cfab275e633172e8ff",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_GetAdmin_LSADUMP_ModifyPrivilege_Implant {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"c8b354793ad5a16744cf1d4efdc5fe48d5a0cf0657974eb7145e0088fcf609ff\"   \n         hash2 = \"5f06ec411f127f23add9f897dc165eaa68cbe8bb99da8f00a4a360f108bb8741\"   \n      strings:   \n         $s1 = \"\\\\system32\\\\win32k.sys\" fullword wide   \n         $s2 = \"hKeAddSystemServiceTable\" fullword ascii   \n         $s3 = \"hPsDereferencePrimaryToken\" fullword ascii   \n         $s4 = \"CcnFormSyncExFBC\" fullword wide   \n         $s5 = \"hPsDereferencePrimaryToken\" fullword ascii   \n      \n         $op1 = { 0c 2b ca 8a 04 11 3a 02 75 01 47 42 4e 75 f4 8b }   \n         $op2 = { 14 83 c1 05 80 39 85 75 0c 80 79 01 c0 75 06 80 }   \n         $op3 = { eb 3d 83 c0 06 33 f6 80 38 ff 75 2c 80 78 01 15 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 80KB and ( 4 of ($s*) or all of ($op*) ) )   \n   }",
			"type": "YARA",
			"id": 30377578
		},
		{
			"indicator": "fe6a9faf10d4ba3665106005a3d13997ee3dde6a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_xspy {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file xspy\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"841e065c9c340a1e522b281a39753af8b6a3db5d9e7d8f3d69e02fdbd662f4cf\"   \n      strings:   \n         $s1 = \"USAGE: xspy -display <display> -delay <usecs> -up\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 60KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377579
		},
		{
			"indicator": "de22b5df3b12bf11b0ae16674df7f9cd8dc26827",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_DllLoad_Target {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"a42d5201af655e43cefef30d7511697e6faa2469dc4a74bc10aa060b522a1cf5\"   \n      strings:   \n         $s1 = \"BzWKJD+\" fullword ascii   \n      \n         $op1 = { 44 24 6c 6c 88 5c 24 6d }   \n         $op2 = { 44 24 54 63 c6 44 24 55 74 c6 44 24 56 69 }   \n         $op3 = { 44 24 5c 6c c6 44 24 5d 65 c6 44 24 5e }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377580
		},
		{
			"indicator": "7c05cd874b77c554d5efbf00c34d10fbfa0c2d00",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RideArea2_12 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"   \n         hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"   \n         hash3 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"   \n         hash4 = \"e702223ab42c54fff96f198611d0b2e8a1ceba40586d466ba9aadfa2fd34386e\"   \n      strings:   \n         $x2 = \"** CreatePayload ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 2000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377581
		},
		{
			"indicator": "f5b0d9fc14c72f837db463d84d1dfa92cf7958b0",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_smash {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file smash\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"1dc94b46aaff06d65a3bf724c8701e5f095c1c9c131b65b2f667e11b1f0129a6\"   \n      strings:   \n         $x1 = \"T=<target IP> [O=<port>] Y=<target type>\" fullword ascii   \n         $x2 = \"no command given!! bailing...\" fullword ascii   \n         $x3 = \"no port. assuming 22...\" fullword ascii   \n      condition:   \n         filesize < 250KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30377582
		},
		{
			"indicator": "a577933d99754defb6c7cf2c0c1298abc3292c33",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Mcl_NtMemory_Std {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"087db4f2dbf8e0679de421fec8fb2e6dd50625112eb232e4acc1408cc0bcd2d7\"   \n      strings:   \n         $op1 = { 44 24 37 50 c6 44 24 38 72 c6 44 }   \n         $op2 = { 44 24 33 6f c6 44 24 34 77 c6 }   \n         $op3 = { 3b 65 c6 44 24 3c 73 c6 44 24 3d 73 c6 44 24 3e }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377583
		},
		{
			"indicator": "3cc14912c6d08823543e575c2abee1cefcb49dfc",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Gen1 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"1b5b33931eb29733a42d18d8ee85b5cd7d53e81892ff3e60e2e97f3d0b184d31\"   \n         hash2 = \"139697168e4f0a2cc73105205c0ddc90c357df38d93dbade761392184df680c7\"   \n      strings:   \n         $x1 = \"Restart with the new protocol, address, and port as target.\" fullword ascii   \n         $x2 = \"TargetPort      : %s (%u)\" fullword ascii   \n         $x3 = \"Error: strchr() could not find '@' in account name.\" fullword ascii   \n         $x4 = \"TargetAcctPwd   : %s\" fullword ascii   \n         $x5 = \"Creating CURL connection handle...\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 80KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377584
		},
		{
			"indicator": "d48b617d57772173d26ea8918c36b2bc6b409a57",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Mofconfig_1_0_0 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"c67a24fe2380331a101d27d6e69b82d968ccbae54a89a2629b6c135436d7bdb2\"   \n      strings:   \n         $x1 = \"[-] Get RemoteMOFTriggerPath error\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 50KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377585
		},
		{
			"indicator": "c892ee53d7ed83b2c6c9ce0b04022e8644014b59",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_charm_saver_win2k_v_2_0_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"0f7936a37482532a8ba5df4112643ed7579dd0e59181bfca9c641b9ba0a9912f\"   \n      strings:   \n         $s2 = \"0123456789abcdefABCEDF:\" fullword ascii   \n      \n         $op0 = { b8 ff ff ff ff 7f 65 eb 30 8b 55 0c 89 d7 0f b6 } /* Opcode */   \n         $op2 = { ba ff ff ff ff 83 c4 6c 89 d0 5b 5e 5f 5d c3 90 } /* Opcode */   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 400KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377586
		},
		{
			"indicator": "d8e7635412cc095832572b7a48c3beb24474b6df",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_DmGz_Target {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"5964966041f93d5d0fb63ce4a85cf9f7a73845065e10519b0947d4a065fdbdf2\"   \n      strings:   \n         $s1 = \"\\\\\\\\.\\\\%ls\" fullword ascii   \n         $s3 = \"6\\\"6<6C6H6M6Z6f6t6\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 80KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377587
		},
		{
			"indicator": "1c496882314109de4d863d52d8e46d0cf73360ec",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_ParseCapture {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"c732d790088a4db148d3291a92de5a449e409704b12e00c7508d75ccd90a03f2\"   \n      strings:   \n         $x1 = \"* Encrypted log found.  An encryption key must be provided\" fullword ascii   \n         $x2 = \"encryptionkey = e.g., \\\"00 11 22 33 44 55 66 77 88 99 aa bb cc dd ee ff\\\"\" fullword ascii   \n         $x3 = \"Decrypting with key '%02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x'\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 50KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377588
		},
		{
			"indicator": "cc182f7bbabc42a63b640e9ccf488af211778ecf",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Architouch_1_0_0 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"444979a2387530c8fbbc5ddb075b15d6a4717c3435859955f37ebc0f40a4addc\"   \n      strings:   \n         $s1 = \"[+] Target is %s\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377589
		},
		{
			"indicator": "564a303e91c5df82f632d3056a2759019e898605",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_wrap_telnet {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file wrap-telnet.sh\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"4962b307a42ba18e987d82aa61eba15491898978d0e2f0e4beb02371bf0fd5b4\"   \n      strings:   \n         $s1 = \"echo \\\"example: ${0} -l 192.168.1.1 -p 22222 -s 22223 -x 9999\\\"\" fullword ascii   \n         $s2 = \"-x [ port to start mini X server on DEFAULT = 12121 ]\\\"\" fullword ascii   \n         $s3 = \"echo \\\"Call back port2 = ${SPORT}\\\"\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x2123 and filesize < 4KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377590
		},
		{
			"indicator": "a1887dceb2e2367f6d68fd9d35791880d6074e62",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Eclipsedwingtouch_1_0_4 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"46da99d80fc3eae5d1d5ab2da02ed7e61416e1eafeb23f37b180c46e9eff8a1c\"   \n      strings:   \n         $x1 = \"[-] The target is NOT vulnerable\" fullword ascii   \n         $x2 = \"[+] The target IS VULNERABLE\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 50KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377591
		},
		{
			"indicator": "7d8ace51c9ef7d97678f1b8014cbcefdc483a199",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_PacketScan_Implant {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"9b97cac66d73a9d268a15e47f84b3968b1f7d3d6b68302775d27b99a56fbb75a\"   \n      strings:   \n         $op0 = { e9 ef fe ff ff ff b5 c0 ef ff ff 8d 85 c8 ef ff }   \n         $op1 = { c9 c2 04 00 b8 34 26 00 68 e8 40 05 00 00 51 56 }   \n         $op2 = { e9 0b ff ff ff 8b 45 10 8d 4d c0 89 58 08 c6 45 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 30KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377592
		},
		{
			"indicator": "68c0aec6eaa681fa244b09c722f08eef85dee965",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_yak {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"66ff332f84690642f4e05891a15bf0c9783be2a64edb2ef2d04c9205b47deb19\"   \n      strings:   \n         $x1 = \"-xd = dump archive data & store in scancodes.txt\" fullword ascii   \n         $x2 = \"-------- driver start token -------\" fullword wide   \n         $x3 = \"-------- keystart token -------\" fullword wide   \n         $x4 = \"-xta = same as -xt but show special chars & store in keys_all.txt\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 800KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377593
		},
		{
			"indicator": "abbc04b1bd256d81051b0d0e4982f78e20f67055",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Architouch_Eternalsynergy_Smbtouch {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"444979a2387530c8fbbc5ddb075b15d6a4717c3435859955f37ebc0f40a4addc\"   \n         hash2 = \"92c6a9e648bfd98bbceea3813ce96c6861487826d6b2c3d462debae73ed25b34\"   \n         hash3 = \"108243f61c53f00f8f1adcf67c387a8833f1a2149f063dd9ef29205c90a3c30a\"   \n      strings:   \n         $s1 = \"NtErrorMoreProcessingRequired\" fullword ascii   \n         $s2 = \"Command Format Error: Error=%x\" fullword ascii   \n         $s3 = \"NtErrorPasswordRestriction\" fullword ascii   \n      \n         $op0 = { 8a 85 58 ff ff ff 88 43 4d }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 600KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377594
		},
		{
			"indicator": "820950ca0e45d92b4249adb4599a3456c6e25c80",
			"description": "",
			"title": "",
			"content": "rule EquationGroup__funnelout_v4_1_0_1 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- from files funnelout.v4.1.0.1.pl\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         super_rule = 1   \n         hash2 = \"457ed14e806fdbda91c4237c8dc058c55e5678f1eecdd78572eff6ca0ed86d33\"   \n      strings:   \n         $s1 = \"header(\\\"Set-Cookie: bbsessionhash=\\\" . \\\\$hash . \\\"; path=/; HttpOnly\\\");\" fullword ascii   \n         $s2 = \"if ($code =~ /proxyhost/) {\" fullword ascii   \n         $s3 = \"\\\\$rk[1] = \\\\$rk[1] - 1;\" fullword ascii   \n         $s4 = \"#existsUser($u) or die \\\"User '$u' does not exist in database.\\\\n\\\";\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x2123 and filesize < 100KB and 2 of them ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30377595
		},
		{
			"indicator": "973f03ad51831051063a0767bfb825cef0b82250",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_RemoteCommand_Lp {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"57b47613a3b5dd820dae59fc6dc2b76656bd578f015f367675219eb842098846\"   \n      strings:   \n         $s1 = \"Failure parsing command from %hs:%u: os=%u plugin=%u\" fullword wide   \n         $s2 = \"Unable to get TCP listen port: %08x\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377596
		},
		{
			"indicator": "76c35eb2793e17d397103a82bd3643ea5435785a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_GenKey {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"b6f100b21da4f7e3927b03b8b5f0c595703b769d5698c835972ca0c81699ff71\"   \n      strings:   \n         $x1 = \"* PrivateEncrypt -> PublicDecrypt FAILED\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 80KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377597
		},
		{
			"indicator": "5f51e59c3f796150f3aefed13ef32077aaefa460",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_PC_LP {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"3a505c39acd48a258f4ab7902629e5e2efa8a2120a4148511fe3256c37967296\"   \n      strings:   \n         $s1 = \"* Failed to get connection information.  Aborting launcher!\" fullword wide   \n         $s2 = \"Format: <command> <target port> [lp port]\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377598
		},
		{
			"indicator": "7d352e2551659bcf5ef363e7db3f3ff0c8835fc0",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_watcher_linux_x86_64_v_3_3_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"a8d65593f6296d6d06230bcede53b9152842f1eee56a2a72b0a88c4f463a09c3\"   \n      strings:   \n         $s1 = \"forceprismheader\" fullword ascii   \n         $s2 = \"invalid option `\" fullword ascii   \n         $s3 = \"forceprism\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 900KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377599
		},
		{
			"indicator": "a571c6b4af4751cdc1f592fdfc93d5ac3e04ecdb",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_EXPA {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"2017176d3b5731a188eca1b71c50fb938c19d6260c9ff58c7c9534e317d315f8\"   \n      strings:   \n         $x1 = \"* The target is IIS 6.0 but is not running content indexing servicess,\" fullword ascii   \n         $x2 = \"--ver 6 --sp <service_pack> --lang <language> --attack shellcode_option[s]sL\" fullword ascii   \n         $x3 = \"By default, the shellcode will attempt to immediately connect s$\" fullword ascii   \n         $x4 = \"UNEXPECTED SHELLCODE CONFIGURATION ERRORs\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 12000KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377600
		},
		{
			"indicator": "9cc2449d6fac874211b96b2cbb9a826d1bedc11b",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__ELV_ESKE_13 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"f7fad44560bc8cc04f03f1d30b6e1b4c5f049b9a8a45464f43359cbe4d1ce86f\"   \n         hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"   \n      strings:   \n         $x1 = \"Skip call to PackageRideArea().  Payload has already been packaged. Options -x and -q ignored.\" fullword ascii   \n         $s2 = \"ERROR: pGvars->pIntRideAreaImplantPayload is NULL\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 600KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377601
		},
		{
			"indicator": "2a757b7bae63fe57f2b11bcae0c45523e111e419",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_ratload {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file ratload\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"4a4a8f2f90529bee081ce2188131bac4e658a374a270007399f80af74c16f398\"   \n      strings:   \n         $x1 = \"/tmp/ratload.tmp.sh\" fullword ascii   \n         $x2 = \"Remote Usage: /bin/telnet locip locport < /dev/console | /bin/sh\\\"\" fullword ascii   \n         $s6 = \"uncompress -f ${NAME}.Z && PATH=. ${ARGS1} ${NAME} ${ARGS2} && rm -f ${NAME}\" fullword ascii   \n      condition:   \n         filesize < 250KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30377602
		},
		{
			"indicator": "f41201827dd58abd24d82d52d6d92eb6c1b6f175",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_calserver {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file calserver\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"048625e9a0ca46d7fe221e262c8dd05e7a5339990ffae2fb65a9b0d705ad6099\"   \n      strings:   \n         $x1 = \"usage: %s <host> <port> e <contents of a local file to be executed on target>\" fullword ascii   \n         $x2 = \"Writing your %s to target.\" fullword ascii   \n         $x3 = \"(e)xploit, (r)ead, (m)ove and then write, (w)rite\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 30KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377603
		},
		{
			"indicator": "26394f854131563158155433eadea82dd22edc00",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_telex {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file telex\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"e9713b15fc164e0f64783e7a2eac189a40e0a60e2268bd7132cfdc624dfe54ef\"   \n      strings:   \n         $x1 = \"usage: %s -l [ netcat listener ] [ -p optional target port instead of 23 ] <ip>\" fullword ascii   \n         $x2 = \"target is not vulnerable. exiting\" fullword ascii   \n         $s3 = \"Sending final buffer: evil_blocks and shellcode...\" fullword ascii   \n         $s4 = \"Timeout waiting for daemon to die.  Exploit probably failed.\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 50KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377604
		},
		{
			"indicator": "b01a274f09cfb7df97e0a957dbd228059628a1e8",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_ebbisland {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file ebbisland\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"eba07c98c7e960bb6c71dafde85f5da9f74fd61bc87793c87e04b1ae2d77e977\"   \n      strings:   \n         $x1 = \"Usage: %s [-V] -t <target_ip> -p port\" fullword ascii   \n         $x2 = \"error - shellcode not as expected - unable to fix up\" fullword ascii   \n         $x3 = \"WARNING - core wipe mode - this will leave a core file on target\" fullword ascii   \n         $x4 = \"[-C] wipe target core file (leaves less incriminating core on failed target)\" fullword ascii   \n         $x5 = \"-A <jumpAddr> (shellcode address)\" fullword ascii   \n         $x6 = \"*** Insane undocumented incremental port mode!!! ***\" fullword ascii   \n      condition:   \n         filesize < 250KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30377605
		},
		{
			"indicator": "606f8fc6d2e100dc0e9937236a1ad0a51ad871f7",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_morerats_client_addkey {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"6c67c03716d06a99f20c1044585d6bde7df43fee89f38915db0b03a42a3a9f4b\"   \n      strings:   \n         $x1 = \"print '  -s storebin  use storebin as the Store executable\\\\n'\" fullword ascii   \n         $x2 = \"os.system('%s --file=\\\"%s\\\" --wipe > /dev/null' % (storebin, b))\" fullword ascii   \n         $x3 = \"print '  -k keyfile   the key text file to inject'\" fullword ascii   \n      condition:   \n         ( filesize < 20KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377606
		},
		{
			"indicator": "a8a494a37d474c7cd0e0de0bfffa39ec7b333a88",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Erraticgophertouch_1_0_1 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"729eacf20fe71bd74e57a6b829b45113c5d45003933118b53835779f0b049bad\"   \n      strings:   \n         $x1 = \"[-] Unable to connect to broswer named pipe, target is NOT vulnerable\" fullword ascii   \n         $x2 = \"[-] Unable to bind to Dimsvc RPC syntax, target is NOT vulnerable\" fullword ascii   \n         $x3 = \"[+] Bound to Dimsvc, target IS vulnerable\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 30KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377607
		},
		{
			"indicator": "4691f2405b52aa4a729c0167466da5fff2de451a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Gen2 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"7fe425cd040608132d4f4ab2671e04b340a102a20c97ffdcf1b75be43a9369b5\"   \n         hash2 = \"561c0d4fc6e0ff0a78613d238c96aed4226fbb7bb9ceea1d19bc770207a6be1e\"   \n         hash3 = \"f2e90e04ddd05fa5f9b2fec024cd07365aebc098593d636038ebc2720700662b\"   \n         hash4 = \"8f7e10a8eedea37ee3222c447410fd5b949bd352d72ef22ef0b2821d9df2f5ba\"   \n      strings:   \n         $s1 = \"[+] Setting password : (NULL)\" fullword ascii   \n         $s2 = \"[-] TbBuffCpy() failed!\" fullword ascii   \n         $s3 = \"[+] SMB negotiation\" fullword ascii   \n         $s4 = \"12345678-1234-ABCD-EF00-0123456789AB\" fullword ascii   \n         $s5 = \"Value must end with 0000 (2 NULLs)\" fullword ascii   \n         $s6 = \"[*] Configuring Payload\" fullword ascii   \n         $s7 = \"[*] Connecting to listener\" fullword ascii   \n      \n         $op1 = { b0 42 40 00 89 44 24 30 c7 44 24 34 }   \n         $op2 = { eb 59 8b 4c 24 10 68 1c 46 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 80KB and 1 of ($s*) and 1 of ($op*) ) or 3 of them   \n   }",
			"type": "YARA",
			"id": 30377608
		},
		{
			"indicator": "2dda46fa1b8efba12e284897247b73507769a307",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_wmi_Implant {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"de08d6c382faaae2b4b41b448b26d82d04a8f25375c712c12013cb0fac3bc704\"   \n      strings:   \n         $x1 = \"SELECT ProcessId,Description,ExecutablePath FROM Win32_Process\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 50KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377609
		},
		{
			"indicator": "034d493a00a4ef22a65df401634864e2c2fb4ad5",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_envisioncollision {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file envisioncollision\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"75d5ec573afaf8064f5d516ae61fd105012cbeaaaa09c8c193c7b4f9c0646ea1\"   \n      strings:   \n         $x1 = \"mysql \\\\$D --host=\\\\$H --user=\\\\$U --password=\\\\\\\"\\\\$P\\\\\\\" -e \\\\\\\"select * from \\\\$T\" fullword ascii   \n         $x2 = \"Window 3: $0 -Uadmin -Ppassword -i127.0.0.1 -Dipboard -c\\\\\\\"sleep 500|nc\" fullword ascii   \n         $s3 = \"$ua->agent(\\\"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\\\");\" fullword ascii   \n         $s4 = \"$url = $host . \\\"/admin/index.php?adsess=\\\" . $enter . \\\"&app=core&module=applications&section=hooks&do=install_hook\\\";\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x2123 and filesize < 20KB and 1 of ($x*) ) or ( 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377610
		},
		{
			"indicator": "e91d41cdb87edaaabcf8680b31526b94c06a4530",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Educatedscholartouch_1_0_0 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"f4b958a0d3bb52cb34f18ea293d43fa301ceadb4a259d3503db912d0a9a1e4d8\"   \n      strings:   \n         $x1 = \"[!] A vulnerable target will not respond.\" fullword ascii   \n         $x2 = \"[-] Target NOT Vulernable\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 30KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377611
		},
		{
			"indicator": "0ef02080409f3fcfaf04f16d9eb84df6fd83cfae",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_porkserver_v3_0_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"7b5f86e289047dd673e8a09438d49ec43832b561bac39b95098f5bf4095b8b4a\"   \n      strings:   \n         $s1 = \"%s: %s rpcprog=%d, rpcvers = %d/%d, proto=%s, wait.max=%d.%d, user.group=%s.%s builtin=%lx server=%s\" fullword ascii   \n         $s2 = \"%s/%s server failing (looping), service terminated\" fullword ascii   \n         $s3 = \"getpwnam: %s: No such user\" fullword ascii   \n         $s4 = \"execv %s: %m\" fullword ascii   \n         $s5 = \"%s/%s: getsockname: %m\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 70KB and 4 of them )   \n   }",
			"type": "YARA",
			"id": 30377612
		},
		{
			"indicator": "82737ad1575495ae35f3bff718b7d17d9d174d0b",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Namedpipetouch_2_0_0 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"cb5849fcbc473c7df886828d225293ffbd8ee58e221d03b840fd212baeda6e89\"   \n         hash2 = \"043d1c9aae6be65f06ab6f0b923e173a96b536cf84e57bfd7eeb9034cd1df8ea\"   \n      strings:   \n         $s1 = \"[*] Summary: %d pipes found\" fullword ascii   \n         $s3 = \"[+] Testing %d pipes\" fullword ascii   \n         $s6 = \"[-] Error on SMB startup, aborting\" fullword ascii   \n         $s12 = \"92a761c29b946aa458876ff78375e0e28bc8acb0\" fullword ascii   \n      \n         $op1 = { 68 10 10 40 00 56 e8 e1 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 40KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377613
		},
		{
			"indicator": "397547d70864c79ad2db153588dc8da6fd78bbd8",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_SetCallback {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"a8854f6b01d0e49beeb2d09e9781a6837a0d18129380c6e1b1629bc7c13fdea2\"   \n      strings:   \n         $s2 = \"*NOTE: This version of SetCallback does not work with PeddleCheap versions prior\" fullword ascii   \n         $s3 = \"USAGE: SetCallback <input file> <output file>\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377614
		},
		{
			"indicator": "34e6897e10e4896d14f67f2a7e8758acc29db5f2",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_jscan {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file jscan\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"8075f56e44185e1be26b631a2bad89c5e4190c2bfc9fa56921ea3bbc51695dbe\"   \n      strings:   \n         $s1 = \"$scanth = $scanth . \\\" -s \\\" . $scanthreads;\" fullword ascii   \n         $s2 = \"print \\\"java -jar jscanner.jar$scanth$list\\\\n\\\";\" fullword ascii   \n      condition:   \n         filesize < 250KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30377615
		},
		{
			"indicator": "765e0768840bb0c629afd1e615b3dd1a58f4d36e",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_PC_Level_Generic {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"7a6488dd13936e505ec738dcc84b9fec57a5e46aab8aff59b8cfad8f599ea86a\"   \n         hash2 = \"0e3cfd48732d0b301925ea3ec6186b62724ec755ed40ed79e7cd6d3df511b8a0\"   \n         hash3 = \"d1d6e3903b6b92cc52031c963e2031b5956cadc29cc8b3f2c8f38be20f98a4a7\"   \n         hash4 = \"25a2549031cb97b8a3b569b1263c903c6c0247f7fff866e7ec63f0add1b4921c\"   \n         hash5 = \"591abd3d7ee214df25ac25682b673f02219da108d1384261052b5167a36a7645\"   \n         hash6 = \"6b71db2d2721ac210977a4c6c8cf7f75a8f5b80b9dbcece1bede1aec179ed213\"   \n         hash7 = \"7be4c05cecb920f1010fc13086635591ad0d5b3a3a1f2f4b4a9be466a1bd2b76\"   \n         hash8 = \"f9cbccdbdf9ffd2ebf1ee84d0ddddd24a61dbe0858ab7f0131bef6c7b9a19131\"   \n         hash9 = \"3cf7a01bdf8e73769c80b75ca269b506c33464d81f574ded8bb20caec2d4cd13\"   \n         hash10 = \"a87a871fe32c49862ed68fda99d92efd762a33ababcd9b6b2b909f2e01f59c16\"   \n      strings:   \n         $s1 = \"wshtcpip.WSHGetSocketInformation\" fullword ascii   \n         $s2 = \"\\\\\\\\.\\\\%hs\" fullword ascii   \n         $s3 = \".?AVResultIp@Mini_Mcl_Cmd_NetConnections@@\" fullword ascii   \n         $s4 = \"Corporation. All rights reserved.\" fullword wide   \n         $s5 = { 49 83 3c 24 00 75 02 eb 5d 49 8b 34 24 0f b7 46 }   \n      \n         $op1 = { 44 24 57 6f c6 44 24 58 6e c6 44 24 59 }   \n         $op2 = { c6 44 24 56 64 88 5c 24 57 }   \n         $op3 = { 44 24 6d 4c c6 44 24 6e 6f c6 44 24 6f }   \n      condition:   \n         uint16(0) == 0x5a4d and filesize < 400KB and ( 2 of ($s*) or all of ($op*) )   \n   }",
			"type": "YARA",
			"id": 30377616
		},
		{
			"indicator": "6d51494d86047ab20d4b9eb96dca5d2321bfc812",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Processes_Target {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"69cf7643dbecc5f9b4b29edfda6c0295bc782f0e438f19be8338426f30b4cc74\"   \n      strings:   \n         $s1 = \"Select * from Win32_Process\" fullword ascii   \n         $s3 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide   \n         $s5 = \"%4ls%2ls%2ls%2ls%2ls%2ls.%11l[0-9]%1l[+-]%6s\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377617
		},
		{
			"indicator": "d5d78b152d7449b3d7483c8c4688f2f530c55324",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__ETBL_ETRE_SMBTOUCH_17 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"70db3ac2c1a10de6ce6b3e7a7890c37bffde006ea6d441f5de6d8329add4d2ef\"   \n         hash2 = \"e0f05f26293e3231e4e32916ad8a6ee944af842410c194fce8a0d8ad2f5c54b2\"   \n         hash3 = \"7da350c964ea43c149a12ac3d2ce4675cedc079ddc10d1f7c464b16688305309\"   \n      strings:   \n         $x1 = \"ERROR: Connection terminated by Target (TCP Ack/Fin)\" fullword ascii   \n         $s2 = \"Target did not respond within specified amount of time\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377618
		},
		{
			"indicator": "9a8a4da111933dcfd46a062404fa5f890bc9bcd9",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Iistouch_1_2_2 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"c433507d393a8aa270576790acb3e995e22f4ded886eb9377116012e247a07c6\"   \n      strings:   \n         $x1 = \"[-] Are you being redirectect? Need to retarget?\" fullword ascii   \n         $x2 = \"[+] IIS Target OS: %s\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 60KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377619
		},
		{
			"indicator": "468f5f21d3299475c6d7da7e6b8dcdda3e3d7a26",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_mstcp32_DXGHLP16_tdip {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"26215bc56dc31d2466d72f1f4e1b6388e62606e9949bc41c28968fcb9a9d60a6\"   \n         hash2 = \"fcfb56fa79d2383d34c471ef439314edc2239d632a880aa2de3cea430f6b5665\"   \n         hash3 = \"a5ec4d102d802ada7c5083af53fd9d3c9b5aa83be9de58dbb4fac7876faf6d29\"   \n      strings:   \n         $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide   \n         $s2 = \"\\\\DosDevices\\\\%ws\" fullword wide   \n         $s3 = \"\\\\Device\\\\%ws_%ws\" fullword wide   \n         $s4 = \"sys\\\\mstcp32.dbg\" fullword ascii   \n         $s5 = \"%ws%03d%ws%wZ\" fullword wide   \n         $s6 = \"TCP/IP driver\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 4 of them )   \n   }",
			"type": "YARA",
			"id": 30377620
		},
		{
			"indicator": "d8d2bbb79ebafe52ffd112d04614e802547ac9b8",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__ETBL_ETRE_10 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"70db3ac2c1a10de6ce6b3e7a7890c37bffde006ea6d441f5de6d8329add4d2ef\"   \n         hash2 = \"e0f05f26293e3231e4e32916ad8a6ee944af842410c194fce8a0d8ad2f5c54b2\"   \n      strings:   \n         $x1 = \"Probe #2 usage: %s -i TargetIp -p TargetPort -r %d [-o TimeOut] -t Protocol -n IMailUserName -a IMailPassword\" fullword ascii   \n         $x6 = \"** RunExploit ** - EXCEPTION_EXECUTE_HANDLER : 0x%08X\" fullword ascii   \n         $s19 = \"Sending Implant Payload.. cEncImplantPayload size(%d)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377621
		},
		{
			"indicator": "ebf0eb9028d8f23393210db74fc46660bec4e3cf",
			"description": "",
			"title": "",
			"content": "rule EquationGroup__jparsescan_parsescan_5 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- from files jparsescan, parsescan\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         super_rule = 1   \n         hash1 = \"8c248eec0af04300f3ba0188fe757850d283de84cf42109638c1c1280c822984\"   \n         hash2 = \"942c12067b0afe9ebce50aa9dfdbf64e6ed0702d9a3a00d25b4fca62a38369ef\"   \n      strings:   \n         $s1 = \"# default is to dump out all scanned hosts found\" fullword ascii   \n         $s2 = \"$bool .= \\\" -r \\\" if (/mibiisa.* -r/);\" fullword ascii   \n         $s3 = \"sadmind is available on two ports, this also works)\" fullword ascii   \n         $s4 = \"-x IP      gives \\\\\\\"hostname:# users:load ...\\\\\\\" if positive xwin scan\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x2123 and filesize < 40KB and 1 of them ) or ( 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377622
		},
		{
			"indicator": "e480da0fd4e811f20053e984371eaec05d2bdd43",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_elgingamble {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file elgingamble\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"0573e12632e6c1925358f4bfecf8c263dd13edf52c633c9109fe3aae059b49dd\"   \n      strings:   \n         $x1 = \"* * * * * root chown root %s; chmod 4755 %s; %s\" fullword ascii   \n         $x2 = \"[-] kernel not vulnerable\" fullword ascii   \n         $x3 = \"[-] failed to spawn shell: %s\" fullword ascii   \n         $x4 = \"-s shell           Use shell instead of %s\" fullword ascii   \n      condition:   \n         1 of them   \n   }",
			"type": "YARA",
			"id": 30377623
		},
		{
			"indicator": "370558a3e19803e23302e2bd41e83a743ca4e0d2",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_msgks_mskgu {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"7b4986aee8f5c4dca255431902907b36408f528f6c0f7d7fa21f079fa0a42e09\"   \n         hash2 = \"ef906b8a8ad9dca7407e0a467b32d7f7cf32814210964be2bfb5b0e6d2ca1998\"   \n      strings:   \n         $op1 = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 }   \n         $op2 = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 }   \n         $op3 = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377624
		},
		{
			"indicator": "3115a6d1e2681c2880010a86ac03899fcfa8a9e2",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_gr {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"d3cd725affd31fa7f0e2595f4d76b09629918612ef0d0307bb85ade1c3985262\"   \n      strings:   \n         $s1 = \"if [ -f /tmp/tmpwatch ] ; then\" fullword ascii   \n         $s2 = \"echo \\\"bailing. try a different name\\\"\" fullword ascii   \n      condition:   \n         ( filesize < 1KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377625
		},
		{
			"indicator": "53a5a6c5825242a713e13fe0fd2ecbc3d43496da",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_estesfox {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file estesfox\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"33530cae130ee9d9deeee60df9292c00242c0fe6f7b8eedef8ed09881b7e1d5a\"   \n      strings:   \n         $x1 = \"chown root:root x;chmod 4777 x`' /tmp/logwatch.$2/cron\" fullword ascii   \n      condition:   \n         all of them   \n   }",
			"type": "YARA",
			"id": 30377626
		},
		{
			"indicator": "9c73289497405e3476ef339fca25ef406c7cc83e",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_promptkill {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file promptkill\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"b448204503849926be249a9bafbfc1e36ef16421c5d3cfac5dac91f35eeaa52d\"   \n      strings:   \n         $x1 = \"exec(\\\"xterm $xargs -e /current/tmp/promptkill.kid.$tag $pid\\\");\" fullword ascii   \n         $x2 = \"$xargs=\\\"-title \\\\\\\"Kill process $pid?\\\\\\\" -name \\\\\\\"Kill process $pid?\\\\\\\" -bg white -fg red -geometry 202x19+0+0\\\" ;\" fullword ascii   \n      condition:   \n         filesize < 250KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30377627
		},
		{
			"indicator": "8db0c327bdf93d44aa4c76d6b69ed48cc5c91077",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_KisuComms_Target_2000 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"94eea1bad534a1dc20620919de8046c9966be3dd353a50f25b719c3662f22135\"   \n      strings:   \n         $s1 = \"363<3S3c3l3q3v3{3\" fullword ascii   \n         $s2 = \"3!3%3)3-3135393@5\" fullword ascii   \n      \n         /* Recommendation - verify the opcodes on Binarly : http://www.binar.ly */   \n         /* Test each of them in the search field & reduce length until it generates matches */   \n         $op0 = { eb 03 89 46 54 47 83 ff 1a 0f 8c 40 ff ff ff 8b }   \n         $op1 = { 8b 46 04 85 c0 74 0f 50 e8 34 fb ff ff 83 66 04 }   \n         $op2 = { c6 45 fc 02 8d 8d 44 ff ff ff e8 d2 2f 00 00 eb }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and ( all of ($s*) or all of ($op*) ) )   \n   }",
			"type": "YARA",
			"id": 30377628
		},
		{
			"indicator": "ef3e459c9dda54870bd8d3ae9d33b353550125b7",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Explodingcantouch_1_2_1 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"0cdde7472b077610d0068aa7e9035da89fe5d435549749707cae24495c8d8444\"   \n      strings:   \n         $x1 = \"[-] Connection closed by remote host (TCP Ack/Fin)\" fullword ascii   \n         $s2 = \"[!]Warning: Error on first request - path size may actually be larger than indicated.\" fullword ascii   \n         $s4 = \"<http://%s/%s> (Not <locktoken:write1>) <http://%s/>\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 150KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377629
		},
		{
			"indicator": "3eed23cd1d29d83ea7aeb018150132061e6487e4",
			"description": "",
			"title": "",
			"content": "rule EquationGroup__magicjack_v1_1_0_0_client {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- from files magicjack_v1.1.0.0_client-1.1.0.0.py\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         super_rule = 1   \n         hash1 = \"63292a2353275a3bae012717bb500d5169cd024064a1ce8355ecb4e9bfcdfdd1\"   \n      strings:   \n         $s1 = \"temp = ((left >> 1) ^ right) & 0x55555555\" fullword ascii   \n         $s2 = \"right ^= (temp <<  16) & 0xffffffff\" fullword ascii   \n         $s3 = \"tempresult = \\\"\\\"\" fullword ascii   \n         $s4 = \"num = self.bytes2long(data)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x2123 and filesize < 80KB and 3 of them ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30377630
		},
		{
			"indicator": "c1de344b28bd87608d2502d4cff4813a7da236c6",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_jparsescan {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file jparsescan\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"8c248eec0af04300f3ba0188fe757850d283de84cf42109638c1c1280c822984\"   \n      strings:   \n         $s1 = \"Usage:  $prog [-f directory] -p prognum [-V ver] [-t proto] -i IPadr\" fullword ascii   \n         $s2 = \"$gotsunos = ($line =~ /program version netid     address             service         owner/ );\" fullword ascii   \n      condition:   \n         ( filesize < 40KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377631
		},
		{
			"indicator": "cf876d489c49d6a0123ecfc370fc4e70581c4169",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_curseyo_win2k_v_1_0_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"5dc77614764b23a38610fdd8abe5b2274222f206889e4b0974a3fea569055ed6\"   \n      strings:   \n         $s1 = \"0123456789abcdefABCEDF:\" fullword ascii   \n      \n         $op0 = { c6 06 5b 8b bd 70 ff ff ff 8b 9d 64 ff ff ff 0f } /* Opcode */   \n         $op1 = { 55 b8 ff ff ff ff 89 e5 83 ec 28 89 7d fc 8b 7d } /* Opcode */   \n         $op2 = { ff 05 10 64 41 00 89 34 24 e8 df 1e 00 00 e9 31 } /* Opcode */   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377632
		},
		{
			"indicator": "afef0ce2ab6299a359ab2100106b050b8205fb8a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_cmsex {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file cmsex\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"2d8ae842e7b16172599f061b5b1f223386684a7482e87feeb47a38a3f011b810\"   \n      strings:   \n         $x1 = \"Usage: %s -i <ip_addr/hostname> -c <command> -T <target_type> (-u <port> | -t <port>) \" fullword ascii   \n         $x2 = \"-i target ip address / hostname \" fullword ascii   \n         $x3 = \"Note: Choosing the correct target type is a bit of guesswork.\" fullword ascii   \n         $x4 = \"Solaris rpc.cmsd remote root exploit\" fullword ascii   \n         $x5 = \"If one choice fails, you may want to try another.\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 50KB and 1 of ($x*) ) or ( 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377633
		},
		{
			"indicator": "6db9098bcb02e17ce66ccfa0f7f188eb7a85d0b3",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Rpctouch_2_1_0 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"7fe4c3cedfc98a3e994ca60579f91b8b88bf5ae8cf669baa0928508642c5a887\"   \n      strings:   \n         $x1 = \"[*] Failed to detect OS / Service Pack on %s:%d\" fullword ascii   \n         $x2 = \"[*] SMB String: %s (%s)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 80KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377634
		},
		{
			"indicator": "814e143656ab046f829e000286b89a4d3e218a17",
			"description": "",
			"title": "",
			"content": "rule EquationGroup__pclean_v2_1_1_pclean_v2_1_1_4 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- from files pclean.v2.1.1.0-linux-i386, pclean.v2.1.1.0-linux-x86_64\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         super_rule = 1   \n         hash1 = \"cdb5b1173e6eb32b5ea494c38764b9975ddfe83aa09ba0634c4bafa41d844c97\"   \n         hash2 = \"ab7f26faed8bc2341d0517d9cb2bbf41795f753cd21340887fc2803dc1b9a1dd\"   \n      strings:   \n         $s1 = \"-c cmd_name:     strncmp() search for 1st %d chars of commands that \" fullword ascii   \n         $s2 = \"e.g.: -n 1-1024,1080,6666,31337 \" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 50KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377635
		},
		{
			"indicator": "ba5df99e517d0c72e4c8ad0269f5400f43c2022a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_GrDo_FileScanner_Implant {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"8d2e43567e1360714c4271b75c21a940f6b26a789aa0fce30c6478ae4ac587e4\"   \n      strings:   \n         $s1 = \"system32\\\\winsrv.dll\" fullword wide   \n         $s2 = \"raw_open CreateFile error\" fullword ascii   \n         $s3 = \"\\\\dllcache\\\\\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 400KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377636
		},
		{
			"indicator": "2cfcd5928955879c278e8ce2a929276232315341",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Educatedscholar_1_0_0 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"4cce9e39c376f67c16df3bcd69efd9b7472c3b478e2e5ef347e1410f1105c38d\"   \n      strings:   \n         $x1 = \"[+] Shellcode Callback %s:%d\" fullword ascii   \n         $x2 = \"[+] Exploiting Target\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 150KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377637
		},
		{
			"indicator": "41fa8ecc868cb7828efa073c6a4f4c6f3260b26a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_slugger2 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file slugger2\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"a6a9ab66d73e4b443a80a69ef55a64da7f0af08dfaa7e17eb19c327301a70bdf\"   \n      strings:   \n         $x1 = \"usage: %s hostip port cmd [printer_name]\" fullword ascii   \n         $x2 = \"command must be less than 61 chars\" fullword ascii   \n      \n         $s1 = \"__rw_read_waiting\" fullword ascii   \n         $s2 = \"completed.1\" fullword ascii   \n         $s3 = \"__mutexkind\" fullword ascii   \n         $s4 = \"__rw_pshared\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 50KB and ( 4 of them and 1 of ($x*) ) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30377638
		},
		{
			"indicator": "40e5e79a183d25b11d4a1f66fb633fa55e9028a6",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_scanner {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"f180bdb247687ea9f1b58aded225d5c80a13327422cd1e0515ea891166372c53\"   \n      strings:   \n         $x1 = \"+daemon_version,system,processor,refid,clock\" fullword ascii   \n         $x2 = \"Usage: %s typeofscan IP_address\" fullword ascii   \n         $x3 = \"# scanning ip  %d.%d.%d.%d\" fullword ascii   \n         $x4 = \"Welcome to the network scanning tool\" fullword ascii   \n         $x5 = \"***** %s ***** (length %d)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 90KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377639
		},
		{
			"indicator": "4e62f9cac3019eae266784ba7514dae2bd159869",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_cursehappy_win2k_v_6_1_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"eb669afd246a7ac4de79724abcce5bda38117b3138908b90cac58936520ea632\"   \n      strings:   \n         $op1 = { e8 24 2c 01 00 85 c0 89 c6 ba ff ff ff ff 74 d6 } /* Opcode */   \n         $op2 = { 89 4c 24 04 89 34 24 89 44 24 08 e8 ce 49 ff ff } /* Opcode */   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 400KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377640
		},
		{
			"indicator": "f498b90a0c2d2bf1311c564811f659ef72db09f5",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_DiBa_Target {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"ffff3526ed0d550108e97284523566392af8523bbddb5f212df12ef61eaad3e6\"   \n      strings:   \n         $op1 = { 41 5a 41 59 41 58 5f 5e 5d 5a 59 5b 58 48 83 c4 }   \n         $op2 = { f9 48 03 fa 48 33 c0 8a 01 49 03 c1 49 f7 e0 88 }   \n         $op3 = { 01 41 f6 e0 49 03 c1 88 01 48 33 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 2000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377641
		},
		{
			"indicator": "82edd483957e108beffcf92f1ad8003d5f1ceb08",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_svctouch {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"96b6a3c4f53f9e7047aa99fd949154745e05dc2fd2eb21ef6f0f9b95234d516b\"   \n      strings:   \n         $s1 = \"Causes: Firewall,Machine down,DCOM disabled\\\\not supported,etc.\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 10KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377642
		},
		{
			"indicator": "3ed50f0fdf1c734260c3a8eb3010709b67c7c04d",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_packrat {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file packrat\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"d3e067879c51947d715fc2cf0d8d91c897fe9f50cae6784739b5c17e8a8559cf\"   \n      strings:   \n         $x2 = \"Use this on target to get your RAT:\" fullword ascii   \n         $x3 = \"$ratremotename && \" fullword ascii   \n         $x5 = \"$command = \\\"$nc$bindto -vv -l -p $port < ${ratremotename}\\\" ;\" fullword ascii   \n      condition:   \n         ( filesize < 70KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377643
		},
		{
			"indicator": "ad7226092354065e30adf01c69a1ae27f98446af",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_DmGz_Target_2 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"55ac29b9a67e0324044dafaba27a7f01ca3d8e4d8e020259025195abe42aa904\"   \n      strings:   \n         $s1 = \"\\\\\\\\.\\\\%ls\" fullword ascii   \n      \n         $op0 = { e8 ce 34 00 00 b8 02 00 00 f0 e9 26 02 00 00 48 }   \n         $op1 = { 8b 4d 28 e8 02 05 00 00 89 45 34 eb 07 c7 45 34 }   \n         $op2 = { e8 c2 34 00 00 90 48 8d 8c 24 00 01 00 00 e8 a4 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377644
		},
		{
			"indicator": "4b04dade086bab792872f5753de99e8b7480e0d3",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_pwd_Implant {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"ee72ac76d82dfec51c8fbcfb5fc99a0a45849a4565177e01d8d23a358e52c542\"   \n      strings:   \n         $s1 = \"7\\\"7(7/7>7O7]7o7w7\" fullword ascii   \n      \n         $op1 = { 40 50 89 44 24 18 FF 15 34 20 00 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 20KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377645
		},
		{
			"indicator": "6fc87fb0518751bdee58cd65c9cc11cb481078d4",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_exze {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file exze\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"1af6dde6d956db26c8072bf5ff26759f1a7fa792dd1c3498ba1af06426664876\"   \n      strings:   \n         $s1 = \"shellFile\" fullword ascii   \n         $s2 = \"completed.1\" fullword ascii   \n         $s3 = \"zeke_remove\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 80KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377646
		},
		{
			"indicator": "8b356ca3a951628838d8d31a0317113365b1719e",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__ecwi_ESKE_EVFR_RPC2_2 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"c4152f65e45ff327dade50f1ac3d3b876572a66c1ce03014f2877cea715d9afd\"   \n         hash2 = \"9d16d97a6c964e0658b6cd494b0bbf70674bf37578e2ff32c4779a7936e40556\"   \n         hash3 = \"c5e119ff7b47333f415aea1d2a43cb6cb322f8518562cfb9b90399cac95ac674\"   \n         hash4 = \"5c0896dbafc5d8cc19b1bc7924420b20ed5999ac5bee2cb5a91aada0ea01e337\"   \n      strings:   \n         $s1 = \"Target is share name\" fullword ascii   \n         $s2 = \"Could not make UdpNetbios header -- bailing\" fullword ascii   \n         $s3 = \"Request non-NT session key\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 2000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377647
		},
		{
			"indicator": "76c99108c2e726978d8288943859b155e09ed952",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_tmpwatch {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"65ed8066a3a240ee2e7556da74933a9b25c5109ffad893c21a626ea1b686d7c1\"   \n      strings:   \n         $s1 = \"chown root:root /tmp/.scsi/dev/bin/gsh\" fullword ascii   \n         $s2 = \"chmod 4777 /tmp/.scsi/dev/bin/gsh\" fullword ascii   \n      condition:   \n         ( filesize < 1KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377648
		},
		{
			"indicator": "0fd6355a51befbc63acd7a10870047eb90e5cb25",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_watcher_solaris_i386_v_3_3_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"395ec2531970950ffafde234dded0cce0c95f1f9a22763d1d04caa060a5222bb\"   \n      strings:   \n         $s1 = \"getexecname\" fullword ascii   \n         $s2 = \"invalid option `\" fullword ascii   \n         $s6 = \"__fpstart\" fullword ascii   \n         $s12 = \"GHFIJKLMNOPQRSTUVXW\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 700KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377649
		},
		{
			"indicator": "a1836c88cfd74f60d719b71c915255771a99a9d4",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_cursetingle_2_0_1_2_mswin32_v_2_0_1 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"614bf159b956f20d66cedf25af7503b41e91841c75707af0cdf4495084092a61\"   \n      strings:   \n         $s1 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii   \n         $s2 = \"0123456789abcdefABCEDF:\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377650
		},
		{
			"indicator": "41b53ad9ce82eb4ba9f26daf4f918ddafdf3a3c6",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_gr_dev_bin_post {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"c1546155efa95dbc4e3cc95299a3968fc075f89d33164e78b00b76c7d08a0591\"   \n      strings:   \n         $x1 = \"op=cron&action=once&frame=cronOnceFrame&cronK=cronV&cronCommand=%2Ftmp%2Ftmpwatch&time=12%3A12+01%2F28%2F2005\" ascii   \n      condition:   \n         ( filesize < 1KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377651
		},
		{
			"indicator": "ee9ce23f448a952ae2386fd193229bc185b4bc84",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__AddResource {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"e83e4648875d4c4aa8bc6f3c150c12bad45d066e2116087cdf78a4a4efbab6f0\"   \n         hash2 = \"5a04d65a61ef04f5a1cbc29398c767eada367459dc09c54c3f4e35015c71ccff\"   \n      strings:   \n         $s1 = \"%s cm 10 2000 \\\"c:\\\\MY DIR\\\\myapp.exe\\\" c:\\\\MyResourceData.dat\" fullword ascii   \n         $s2 = \"<PE path> - the path to the PE binary to which to add the resource.\" fullword ascii   \n         $s3 = \"Unable to get path for target binary.\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377652
		},
		{
			"indicator": "4e244a8bbba90c49b27e6fde3bc19584a71d98f7",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__LSADUMP_Lp_ModifyPrivilege_Lp_PacketScan_Lp_put_Lp_RemoteExecute_Lp_Windows_Lp_wmi_Lp_9 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"c7bf4c012293e7de56d86f4f5b4eeb6c1c5263568cc4d9863a286a86b5daf194\"   \n         hash2 = \"d92928a867a685274b0a74ec55c0b83690fca989699310179e184e2787d47f48\"   \n         hash3 = \"2d963529e6db733c5b74db1894d75493507e6e40da0de2f33e301959b50f3d32\"   \n         hash4 = \"e9f6a84899c9a042edbbff391ca076169da1a6f6dfb61b927942fe4be3327749\"   \n         hash5 = \"d989d610b032c72252a2df284d0b53f63f382e305de2a18b453a0510ab6246a3\"   \n         hash6 = \"23d98bca1f6e2f6989d53c2f2adff996ede2c961ea189744f8ae65621003b8b1\"   \n         hash7 = \"d7ae24816fda190feda6a60639cf3716ea00fb63a4bd1069b8ce52d10ad8bc7f\"   \n      strings:   \n         $x1 = \"Injection Lib -  \" wide   \n         $x2 = \"LSADUMP - - ERROR\" wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377653
		},
		{
			"indicator": "a80d8f5574b6f6faf4ee5b9442fb82bd19ab7d5c",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_regprobe {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"99a42440d4cf1186aad1fd09072bd1265e7c6ebbc8bcafc28340b4fe371767de\"   \n      strings:   \n         $x1 = \"Usage: %s targetIP protocolSequence portNo [redirectorIP] [CLSID]\" fullword ascii   \n         $x2 = \"key does not exist or pinging w2k system\" fullword ascii   \n         $x3 = \"RpcProxy=255.255.255.255:65536\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377654
		},
		{
			"indicator": "552ddba0a601a71d22935ccc36b3f4bf503899d8",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_ewok {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file ewok\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"567da502d7709b7814ede9c7954ccc13d67fc573f3011db04cf212f8e8a95d72\"   \n      strings:   \n         $x1 = \"Example: ewok -t target public\" fullword ascii   \n         $x2 = \"Usage:  cleaner host community fake_prog\" fullword ascii   \n         $x3 = \"-g  - Subset of -m that Green Spirit hits \" fullword ascii   \n         $x4 = \"--- ewok version\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 80KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377655
		},
		{
			"indicator": "5c31eaeb2ea9520d00a0e839e2476835e4e9332e",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_linux_exactchange {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         super_rule = 1   \n         hash1 = \"dfecaf5b85309de637b84a686dd5d2fca9c429e8285b7147ae4213c1f49d39e6\"   \n         hash2 = \"6ef6b7ec1f1271503957cf10bb6b1bfcedb872d2de3649f225cf1d22da658bec\"   \n         hash3 = \"39d4f83c7e64f5b89df9851bdba917cf73a3449920a6925b6cd379f2fdec2a8b\"   \n         hash4 = \"15e12c1c27304e4a68a268e392be4972f7c6edf3d4d387e5b7d2ed77a5b43c2c\"   \n      strings:   \n         $x1 = \"[+] looking for vulnerable socket\" fullword ascii   \n         $x2 = \"can't use 32-bit exploit on 64-bit target\" fullword ascii   \n         $x3 = \"[+] %s socket ready, exploiting...\" fullword ascii   \n         $x4 = \"[!] nothing looks vulnerable, trying everything\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 2000KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377656
		},
		{
			"indicator": "ced7180abf2233b68422a593b1c2d8aca0195680",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_lp_mstcp {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"2ab1e1d23021d887759750a0c053522e9149b7445f840936bbc7e703f8700abd\"   \n      strings:   \n         $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide   \n         $s2 = \"_PacketNDISRequestComplete@12\\\"\" fullword ascii   \n         $s3 = \"_LDNdis5RegDeleteKeys@4\" fullword ascii   \n      \n         $op1 = { 89 7e 04 75 06 66 21 46 02 eb }   \n         $op2 = { fc 74 1b 8b 49 04 0f b7 d3 66 83 }   \n         $op3 = { aa 0f b7 45 fc 8b 52 04 8d 4e }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and ( all of ($s*) or all of ($op*) ) )   \n   }",
			"type": "YARA",
			"id": 30377657
		},
		{
			"indicator": "c2b1ee2776f0cd3977389f189d877ea18784d0ff",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_PC_Level3_Gen {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"c7dd49b98f399072c2619758455e8b11c6ee4694bb46b2b423fa89f39b185a97\"   \n         hash2 = \"f6b723ef985dfc23202870f56452581a08ecbce85daf8dc7db4491adaa4f6e8f\"   \n      strings:   \n         $s1 = \"S-%u-%u\" fullword ascii   \n         $s2 = \"Copyright (C) Microsoft\" fullword wide   \n      \n         $op1 = { 24 39 65 c6 44 24 3a 6c c6 44 24 3b 65 c6 44 24 }   \n         $op2 = { 44 24 4e 41 88 5c 24 4f ff }   \n         $op3 = { 44 24 3f 6e c6 44 24 40 45 c6 44 24 41 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 400KB and 3 of them )   \n   }",
			"type": "YARA",
			"id": 30377658
		},
		{
			"indicator": "4b810b3175d7e6535c60199c24a8dfbe587fa2fd",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_libXmexploit2 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file libXmexploit2.8\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"d7ed0234d074266cb37dd6a6a60119adb7d75cc6cc3b38654c8951b643944796\"   \n      strings:   \n         $s1 = \"Usage: ./exp command display_to_return_to\" fullword ascii   \n         $s2 = \"sizeof shellcode = %d\" fullword ascii   \n         $s3 = \"Execve failed!\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 40KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377659
		},
		{
			"indicator": "71f3f5536e3f1cd1785be072b27cbdd88e9d83e0",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_curseflower_mswin32_v_1_0_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"fdc452629ff7befe02adea3a135c3744d8585af890a4301b2a10a817e48c5cbf\"   \n      strings:   \n         $s1 = \"<pVt,<et(<st$<ct$<nt\" fullword ascii   \n      \n         $op1 = { 6a 04 83 c0 08 6a 01 50 e8 10 34 00 00 83 c4 10 } /* Opcode */   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377660
		},
		{
			"indicator": "4113a032601c8b123ed7e2b94287ee5c9e34be37",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Oracle_Implant {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"8e9be4960c62ed7f210ce08f291e410ce0929cd3a86fe70315d7222e3df4587e\"   \n      strings:   \n         $op0 = { fe ff ff ff 48 89 9c 24 80 21 00 00 48 89 ac 24 }   \n         $op1 = { e9 34 11 00 00 b8 3e 01 00 00 e9 2a 11 00 00 b8 }   \n         $op2 = { 48 8b ca e8 bf 84 00 00 4c 8b e0 8d 34 00 44 8d }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 500KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377661
		},
		{
			"indicator": "f00bd6b41aada2f2654da620a30de1ddbb525dd1",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_store_linux_i386_v_3_3_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"abc27fda9a0921d7cf2863c29768af15fdfe47a0b3e7a131ef7e5cc057576fbc\"   \n      strings:   \n         $s1 = \"[-] Failed to map file: %s\" fullword ascii   \n         $s2 = \"[-] can not NULL terminate input data\" fullword ascii   \n         $s3 = \"[!] Name has size of 0!\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 60KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377662
		},
		{
			"indicator": "7c0e002af3e1156a066eb41dd0576f7467962d76",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_ebbshave {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file ebbshave.v5\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"eb5e0053299e087c87c2d5c6f90531cc1946019c85a43a2998c7b66a6f19ca4b\"   \n      strings:   \n         $s1 = \"executing ./ebbnew_linux -r %s -v %s -A %s %s -t %s -p %s\" fullword ascii   \n         $s2 = \"./ebbnew_linux.wrapper -o 2 -v 2 -t 192.168.10.4 -p 32772\" fullword ascii   \n         $s3 = \"version 1 - Start with option #18 first, if it fails then try this option\" fullword ascii   \n         $s4 = \"%s is a wrapper program for ebbnew_linux exploit for Sparc Solaris RPC services\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 20KB and 1 of them ) or ( 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377663
		},
		{
			"indicator": "dd7da9f76bc7dc6589b3f983b9b3a0ea81b73d07",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_cursewham_curserazor_cursezinger_curseroot_win2k {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"aff27115ac705859871ab1bf14137322d1722f63705d6aeada43d18966843225\"   \n         hash2 = \"7a25e26950bac51ca8d37cec945eb9c38a55fa9a53bc96da53b74378fb10b67e\"   \n      strings:   \n         $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/%s,%s\" fullword ascii   \n         $s3 = \",%02d%03d\" fullword ascii   \n         $s4 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii   \n      \n         $op1 = { 7d ec 8d 74 3f 01 0f af f7 c1 c6 05 } /* Opcode */   \n         $op2 = { 29 f1 89 fb d3 eb 89 f1 d3 e7 } /* Opcode */   \n         $op3 = { 7d e4 8d 5c 3f 01 0f af df c1 c3 05 } /* Opcode */   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 400KB and 3 of them )   \n   }",
			"type": "YARA",
			"id": 30377664
		},
		{
			"indicator": "a8454796d59aef8a1fe7175689bebe23ed237f0a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Easypi_Explodingcan {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"dc1ddad7e8801b5e37748ec40531a105ba359654ffe8bdb069bd29fb0b5afd94\"   \n         hash2 = \"97af543cf1fb59d21ba5ec6cb2f88c8c79c835f19c8f659057d2f58c321a0ad4\"   \n      strings:   \n         $x1 = \"[-] %s - Target might not be in a usable state.\" fullword ascii   \n         $x2 = \"[*] Exploiting Target\" fullword ascii   \n         $x3 = \"[-] Encoding Exploit Payload failed!\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377665
		},
		{
			"indicator": "0b8521c8d7ffc311d819a0869c11c28322d43405",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_ys {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file ys.auto\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"a6387307d64778f8d9cfc60382fdcf0627cde886e952b8d73cc61755ed9fde15\"   \n      strings:   \n         $x1 = \"EXPLOIT_SCRIPME=\\\"$EXPLOIT_SCRIPME\\\"\" fullword ascii   \n         $x3 = \"DEFTARGET=`head /current/etc/opscript.txt 2>/dev/null | grepip 2>/dev/null | head -1`\" fullword ascii   \n         $x4 = \"FATAL ERROR: -x port and -n port MUST NOT BE THE SAME.\" fullword ascii   \n      condition:   \n         filesize < 250KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30377666
		},
		{
			"indicator": "0ce62872c64ca6dfcb4c9ab536afc386cb670d98",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_FullThreadDump {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"b68f3f32bfa6cf11145c9fb9bf0075a5ca3938ea218b1cc29ad62f7b9e043255\"   \n      strings:   \n         $s1 = \"FullThreadDump.class\" fullword ascii   \n         $s2 = \"ThreadMonitor.class\" fullword ascii   \n         $s3 = \"Deadlock$DeadlockThread.class\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x4b50 and filesize < 30KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377667
		},
		{
			"indicator": "f0a811605ad737515cddb3a949373915d608df37",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_EpWrapper {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"a8eed17665ee22198670e22458eb8c9028ff77130788f24f44986cce6cebff8d\"   \n      strings:   \n         $x1 = \"* Failed to get remote TCP socket address\" fullword wide   \n         $x2 = \"* Failed to get 'LPStart' export\" fullword wide   \n         $s5 = \"Usage: %ls <logdir> <dll_search_path> <dll_to_load_path> <socket>\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 20KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377668
		},
		{
			"indicator": "d30948327c2c664a73c30c2bd5f21505d7342955",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_RemoteExecute_Target {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"4a649ca8da7b5499821a768c650a397216cdc95d826862bf30fcc4725ce8587f\"   \n      strings:   \n         $s1 = \"Win32_Process\" fullword ascii   \n         $s2 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide   \n      \n         $op1 = { 83 7b 18 01 75 12 83 63 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377669
		},
		{
			"indicator": "37e34b7a1ea1d2f3b1d9e83aa52fda9d53ecf305",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_SendPKTrigger {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"2f9c7a857948795873a61f4d4f08e1bd0a41e3d6ffde212db389365488fa6e26\"   \n      strings:   \n         $x1 = \"----====**** PORT KNOCK TRIGGER BEGIN ****====----\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377670
		},
		{
			"indicator": "4912b803f0b3f881800058cbe99cf17511866267",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_parsescan {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file parsescan\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"942c12067b0afe9ebce50aa9dfdbf64e6ed0702d9a3a00d25b4fca62a38369ef\"   \n      strings:   \n         $s1 = \"$gotgs=1 if (($line =~ /Scan for (Sol|SNMP)\\\\s+version/) or\" fullword ascii   \n         $s2 = \"Usage:  $prog [-f file] -p prognum [-V ver] [-t proto] -i IPadr\" fullword ascii   \n      condition:   \n         filesize < 250KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30377671
		},
		{
			"indicator": "100bc2d39ece0841dace19c34f143c10bc00988a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Smbtouch_1_1_1 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"108243f61c53f00f8f1adcf67c387a8833f1a2149f063dd9ef29205c90a3c30a\"   \n      strings:   \n         $x1 = \"[+] Target is vulnerable to %d exploit%s\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 400KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377672
		},
		{
			"indicator": "db860cb0c38c346a841efb1f3875c4e2ce92df41",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Shares_Target {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"6c57fb33c5e7d2dee415ae6168c9c3e0decca41ffe023ff13056ff37609235cb\"   \n      strings:   \n         $s1 = \"Select * from Win32_Share\" fullword ascii   \n         $s2 = \"slocalhost\" fullword wide   \n         $s3 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide   \n         $s4 = \"\\\\\\\\%ls\\\\%ls\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377673
		},
		{
			"indicator": "66848aa8d4406648119ab308ccb7eeea5d292d20",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__Emphasismine {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"dcaf91bd4af7cc7d1fb24b5292be4e99c7adf4147892f6b3b909d1d84dd4e45b\"   \n         hash2 = \"348eb0a6592fcf9da816f4f7fc134bcae1b61c880d7574f4e19398c4ea467f26\"   \n      strings:   \n         $x1 = \"Error: Could not calloc() for shellcode buffer\" fullword ascii   \n         $x2 = \"shellcodeSize: 0x%04X + 0x%04X + 0x%04X = 0x%04X\" fullword ascii   \n         $x3 = \"Generating shellcode\" fullword ascii   \n         $x4 = \"([0-9a-zA-Z]+) OK LOGOUT completed\" fullword ascii   \n         $x5 = \"Error: Domino is not the expected version. (%s, %s)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377674
		},
		{
			"indicator": "dd2f85a4f9dc9339d4b448f6fe6cecf2a148fd43",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Dsz_Implant {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"fbe103fac45abe4e3638055a3cac5e7009166f626cf2d3049fb46f3b53c1057f\"   \n         hash2 = \"ad1dddd11b664b7c3ad6108178a8dade0a6d9795358c4a7cedbe789c62016670\"   \n      strings:   \n         $s1 = \"%02u:%02u:%02u.%03u-%4u: \" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 1000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377675
		},
		{
			"indicator": "77b68f3a2c9353bf4a3937b418436de0e0f5e574",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Windows_Implant {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"d38ce396926e45781daecd18670316defe3caf975a3062470a87c1d181a61374\"   \n      strings:   \n         $s2 = \"0#0)0/050;0M0Y0h0|0\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 50KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377676
		},
		{
			"indicator": "54f6196f53b83ea2812482070c10be8f0d3e6402",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_DUL {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file DUL\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"24d1d50960d4ebf348b48b4db4a15e50f328ab2c0e24db805b106d527fc5fe8e\"   \n      strings:   \n         $x1 = \"?Usage: %s <shellcode> <output_file>\" fullword ascii   \n         $x2 = \"Here is the decoder+(encoded-decoder)+payload\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 80KB and 1 of them ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30377677
		},
		{
			"indicator": "d76e6cf76f0ca069b9030832ddd8e5ae02f60bac",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Englishmansdentist_1_2_0 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"2a6ab28885ad7d5d64ac4c4fb8c619eca3b7fb3be883fc67c90f3ea9251f34c6\"   \n      strings:   \n         $x1 = \"[+] CheckCredentials(): Checking to see if valid username/password\" fullword ascii   \n         $x2 = \"Error connecting to target, TbMakeSocket() %s:%d.\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377678
		},
		{
			"indicator": "cfedb29f08402eb43b5b4393dfcabe88ddd0c35c",
			"description": "",
			"title": "",
			"content": "rule EquationGroup__ftshell {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- from files ftshell, ftshell.v3.10.3.7\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         super_rule = 1   \n         hash1 = \"9bebeb57f1c9254cb49976cc194da4be85da4eb94475cb8d813821fb0b24f893\"   \n         hash4 = \"0be739024b41144c3b63e40e46bab22ac098ccab44ab2e268efc3b63aea02951\"   \n      strings:   \n         $s1 = \"if { [string length $uRemoteUploadCommand]\" fullword ascii   \n         $s2 = \"processUpload\" fullword ascii   \n         $s3 = \"global dothisreallyquiet\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x2123 and filesize < 100KB and 2 of them ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30377679
		},
		{
			"indicator": "14b96a21f9c80d89fd02436fa273c3e19a75eae6",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_envoytomato {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file envoytomato\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"9bd001057cc97b81fdf2450be7bf3b34f1941379e588a7173ab7fffca41d4ad5\"   \n      strings:   \n         $s1 = \"[-] kernel not vulnerable\" fullword ascii   \n         $s2 = \"[-] failed to spawn shell\" fullword ascii   \n      condition:   \n         filesize < 250KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30377680
		},
		{
			"indicator": "8c08910163fb098d66e0eef7cce2465f63e98c2e",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__DoubleFeatureReader_DoubleFeatureReader_0 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"052e778c26120c683ee2d9f93677d9217e9d6c61ffc0ab19202314ab865e3927\"   \n         hash2 = \"5db457e7c7dba80383b1df0c86e94dc6859d45e1d188c576f2ba5edee139d9ae\"   \n      strings:   \n         $x1 = \"DFReader.exe logfile AESKey [-j] [-o outputfilename]\" fullword ascii   \n         $x2 = \"Double Feature Target Version\" fullword ascii   \n         $x3 = \"DoubleFeature Process ID\" fullword ascii   \n      \n         $op1 = { a1 30 21 41 00 89 85 d8 fc ff ff a1 34 21 41 00 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and 1 of them ) or ( 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377681
		},
		{
			"indicator": "5c974891661bce3629b07f7f56496d90f40ed2d4",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_tacothief {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"c71953cc84c27dc61df8f6f452c870a7880a204e9e21d9fd006a5c023b052b35\"   \n      strings:   \n         $x1 = \"File too large!  Must be less than 655360 bytes.\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377682
		},
		{
			"indicator": "7cb83f7e4dba78ffb211bd8f7c71f8d013752f76",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_scripme {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file scripme\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"a1adf1c1caad96e7b7fd92cbf419c4cfa13214e66497c9e46ec274a487cd098a\"   \n      strings:   \n         $x1 = \"running \\\\\\\"tcpdump -n -n\\\\\\\", on the environment variable \\\\$INTERFACE, scripted\" fullword ascii   \n         $x2 = \"Cannot read $opetc/scripme.override -- are you root?\" ascii   \n         $x3 = \"$ENV{EXPLOIT_SCRIPME}\" ascii   \n         $x4 = \"$opetc/scripme.override\" ascii   \n      condition:   \n         ( filesize < 30KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377683
		},
		{
			"indicator": "841df90083bed48f20405a22b5cb2d88ee6de502",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Easybee_1_0_1 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"59c17d6cb564edd32c770cd56b5026e4797cf9169ff549735021053268b31611\"   \n      strings:   \n         $x1 = \"@@for /f \\\"delims=\\\" %%i in ('findstr /smc:\\\"%s\\\" *.msg') do if not \\\"%%MsgFile1%%\\\"==\\\"%%i\\\" del /f \\\"%%i\\\"\" fullword ascii   \n         $x2 = \"Logging out of WebAdmin (as target account)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377684
		},
		{
			"indicator": "52edacc4b3024f47b9e4e34f95c9acccd4764b7f",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Darkpulsar_1_1_0 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"b439ed18262aec387984184e86bfdb31ca501172b1c066398f8c56d128ba855a\"   \n      strings:   \n         $x1 = \"[%s] - Error upgraded DLL architecture does not match target architecture (0x%x)\" fullword ascii   \n         $x2 = \"[%s] - Error building DLL loading shellcode\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377685
		},
		{
			"indicator": "ab5ca931f683bd0e0ff7349b1cfdf01237ebb221",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_drivers_Implant {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"ee8b048f1c6ba821d92c15d614c2d937c32aeda7b7ea0943fd4f640b57b1c1ab\"   \n      strings:   \n         $s1 = \".?AVFeFinallyFailure@@\" fullword ascii   \n         $s2 = \"hZwLoadDriver\" fullword ascii   \n      \n         $op1 = { b0 01 e8 58 04 00 00 c3 33 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 30KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377686
		},
		{
			"indicator": "caa4f5d954b01ef34a6bed02f8a31dc9dcae3b3b",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_gr_dev_bin_now {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"f5ed8312fc6e624b04e1e2d6614f3c651c9e9902ff41f4d069c32caca0869fa4\"   \n      strings:   \n         $x1 = \"HTTP_REFERER=\\\"https://127.0.0.1:6655/cgi/redmin?op=cron&action=once\\\"\" fullword ascii   \n         $x2 = \"exec /usr/share/redmin/cgi/redmin\" fullword ascii   \n      condition:   \n         ( filesize < 1KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377687
		},
		{
			"indicator": "24e0124221fb6b044e07b81662edb27ad06ec734",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_electricslide {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file electricslide\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"d27814b725568fa73641e86fa51850a17e54905c045b8b31a9a5b6d2bdc6f014\"   \n      strings:   \n         $x1 = \"Firing with the same hosts, on altername ports (target is on 8080, listener on 443)\" fullword ascii   \n         $x2 = \"Recieved Unknown Command Payload: 0x%x\" fullword ascii   \n         $x3 = \"Usage: eslide   [options] <-t profile> <-l listenerip> <targetip>\" fullword ascii   \n         $x4 = \"-------- Delete Key - Remove a *closed* tab\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 2000KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377688
		},
		{
			"indicator": "ab346d0e8deb16fa91acc6a66de366c5463ce35a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Ifconfig_Target {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"1ebfc0ce7139db43ddacf4a9af2cb83a407d3d1221931d359ee40588cfd0d02b\"   \n      strings:   \n         $s1 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters\\\\Interfaces\\\\%hs\" fullword wide   \n      \n         $op1 = { 0f be 37 85 f6 0f 85 4e ff ff ff 45 85 ed 74 21 }   \n         $op2 = { 4c 8d 44 24 34 48 8d 57 08 41 8d 49 07 e8 a6 4b }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377689
		},
		{
			"indicator": "fb1b51dda92348ec17cbc5fdee89eea37ac97396",
			"description": "",
			"title": "",
			"content": "rule EquationGroup__ghost_sparc_ghost_x86_3 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- from files ghost_sparc, ghost_x86\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         super_rule = 1   \n         hash1 = \"d5ff0208d9532fc0c6716bd57297397c8151a01bf4f21311f24e7a72551f9bf1\"   \n         hash2 = \"82c899d1f05b50a85646a782cddb774d194ef85b74e1be642a8be2c7119f4e33\"   \n      strings:   \n         $x1 = \"Usage: %s [-v os] [-p] [-r] [-c command] [-a attacker] target\" fullword ascii   \n         $x2 = \"Sending shellcode as part of an open command...\" fullword ascii   \n         $x3 = \"cmdshellcode\" fullword ascii   \n         $x4 = \"You will not be able to run the shellcode. Exiting...\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 70KB and 1 of them ) or ( 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377690
		},
		{
			"indicator": "db85b0184b4236619d2504960b3b8ede3668094d",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_SetCallbackPorts {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"16f66c2593665c2507a78f96c0c2a9583eab0bda13a639e28f550c92f9134ff0\"   \n      strings:   \n         $s1 = \"USAGE: %s <input file> <output file> <port1> [port2] [port3] [port4] [port5] [port6]\" fullword ascii   \n         $s2 = \"You may enter between 1 and 6 ports to change the defaults.\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377691
		},
		{
			"indicator": "68bc46a3343016ad64fd445f22720b4fcecd8df5",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_emptycriss {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file emptycriss\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"a698d35a0c4d25fd960bd40c1de1022bb0763b77938bf279e91c9330060b0b91\"   \n      strings:   \n         $s1 = \"./emptycriss <target IP>\" fullword ascii   \n         $s2 = \"Cut and paste the following to the telnet prompt:\" fullword ascii   \n         $s8 = \"environ define TTYPROMPT abcdef\" fullword ascii   \n      condition:   \n         ( filesize < 50KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377692
		},
		{
			"indicator": "c7a1792c6cf5e275a2b03b0b5ae39ccd35509d05",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_jackpop {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file jackpop\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"0b208af860bb2c7ef6b1ae1fcef604c2c3d15fc558ad8ea241160bf4cbac1519\"   \n      strings:   \n         $x1 = \"%x:%d  --> %x:%d %d bytes\" fullword ascii   \n      \n         $s1 = \"client: can't bind to local address, are you root?\" fullword ascii   \n         $s2 = \"Unable to register port\" fullword ascii   \n         $s3 = \"Could not resolve destination\" fullword ascii   \n         $s4 = \"raw troubles\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 30KB and 3 of them ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30377693
		},
		{
			"indicator": "d14a851d9986ee395bc13fe4ceccd14724e6eca0",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_ntevt {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"4254ee5e688fc09bdc72bcc9c51b1524a2bb25a9fb841feaf03bc7ec1a9975bf\"   \n      strings:   \n         $x1 = \"c:\\\\ntevt.pdb\" fullword ascii   \n      \n         $s1 = \"ARASPVU\" fullword ascii   \n      \n         $op1 = { 41 5a 41 59 41 58 5f 5e 5d 5a 59 5b 58 48 83 c4 }   \n         $op2 = { f9 48 03 fa 48 33 c0 8a 01 49 03 c1 49 f7 e0 88 }   \n         $op3 = { 01 41 f6 e0 49 03 c1 88 01 48 33 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 700KB and $x1 or 3 of them )   \n   }",
			"type": "YARA",
			"id": 30377694
		},
		{
			"indicator": "cccbbacf82c1f6f7c9329cd9d9c320b122c09874",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_scanner_output {   \n      meta:   \n         description = \"Detects output generated by EQGRP scanner.exe\"   \n         author = \"Florian Roth\"   \n         reference = \"Internal Research\"   \n         date = \"2017-04-17\"   \n      strings:   \n         $s1 = \"# Scan for windows boxes\" ascii fullword   \n         $s2 = \"Going into send\" ascii fullword   \n         $s3 = \"# Does not work\" ascii fullword   \n         $s4 = \"You are the weakest link, goodbye\" ascii fullword   \n         $s5 = \"rpc   Scan for RPC  folks\" ascii fullword   \n      condition:   \n         filesize < 1000KB and 2 of them   \n   }",
			"type": "YARA",
			"id": 30377695
		},
		{
			"indicator": "e9e2c4496abbd9841d1a80532310d0e5f90288ed",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_tnmunger {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file tnmunger\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"1ab985d84871c54d36ba4d2abd9168c2a468f1ba06994459db06be13ee3ae0d2\"   \n      strings:   \n         $s1 = \"TEST: mungedport=%6d  pp=%d  unmunged=%6d\" fullword ascii   \n         $s2 = \"mungedport=%6d  pp=%d  unmunged=%6d\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 10KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377696
		},
		{
			"indicator": "3846f519d6623b856b3d268e89389a768c1df3d3",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_DS_ParseLogs {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"0228691d63038b072cdbf50782990d505507757efbfa87655bb2182cf6375956\"   \n      strings:   \n         $x1 = \"* Size (%d) of remaining capture file is too small to contain a valid header\" fullword wide   \n         $x2 = \"* Capture header not found at start of buffer\" fullword wide   \n         $x3 = \"Usage: %ws <capture_file> <results_prefix>\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377697
		},
		{
			"indicator": "1678ffdc0eec2a17f59e5512f62208747676404e",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_promiscdetect_safe {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"6070d8199061870387bb7796fb8ccccc4d6bafed6718cbc3a02a60c6dc1af847\"   \n      strings:   \n         $s1 = \"running on this computer!\" fullword ascii   \n         $s2 = \"- Promiscuous (capture all packets on the network)\" fullword ascii   \n         $s3 = \"Active filter for the adapter:\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 80KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377698
		},
		{
			"indicator": "7be0e82f843ac25c37fc3cc7ca32badcc602e89a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_greatdoc_dll_config {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"fd9d0abfa727784dd07562656967d220286fc0d63bcf7e2c35d4c02bc2e5fc2e\"   \n      strings:   \n         $x1 = \"C:\\\\Projects\\\\GREATERDOCTOR\\\\trunk\\\\GREATERDOCTOR\" ascii   \n         $x2 = \"src\\\\build\\\\Release\\\\dllConfig\\\\dllConfig.pdb\" ascii   \n         $x3 = \"GREATERDOCTOR [ commandline args configuration ]\" fullword ascii   \n         $x4 = \"-useage: <scanner> \\\"<cmdline args>\\\"\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377699
		},
		{
			"indicator": "ecc6a2b77686ee5a938f7304e92c9b174bc223df",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_SetOurAddr {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"04ccc060d401ddba674371e66e0288ebdbfa7df74b925c5c202109f23fb78504\"   \n      strings:   \n         $s1 = \"USAGE: SetOurAddr <input file> <output file> <protocol> [IP/IPX address]\" fullword ascii   \n         $s2 = \"Replaced default IP address (127.0.0.1) with Local IP Address %d.%d.%d.%d\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377700
		},
		{
			"indicator": "a09ce40ccd38a6336fde4f3323ffc49676334143",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_cryptTool {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file cryptTool\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"96947ad30a2ab15ca5ef53ba8969b9d9a89c48a403e8b22dd5698145ac6695d2\"   \n      strings:   \n         $s1 = \"The encryption key is \" fullword ascii   \n         $s2 = \"___tempFile2.out\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 200KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377701
		},
		{
			"indicator": "5f1a5923dda5169ddbce53ad592e76ed0fc01abe",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_toast_v3_2_0 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file toast_v3.2.0.1-linux\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"2ce2d16d24069dc29cf1464819a9dc6deed38d1e5ffc86d175b06ddb691b648b\"   \n      strings:   \n         $x2 = \"Del --- Usage: %s -l file -w wtmp -r user\" fullword ascii   \n         $s5 = \"Roasting ->%s<- at ->%d:%d<-\" fullword ascii   \n         $s6 = \"rbnoil -Roasting ->\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 50KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377702
		},
		{
			"indicator": "95a61e805166f1045e24c9cfbc0fba510de058a8",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_scanner {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file scanner\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"dcbcd8a98ec93a4e877507058aa26f0c865b35b46b8e6de809ed2c4b3db7e222\"   \n      strings:   \n         $x1 = \"program version netid     address             service         owner\" fullword ascii   \n         $x4 = \"*** Sorry about the raw output, I'll leave it for now\" fullword ascii   \n         $x5 = \"-scan winn %s one\" fullword ascii   \n      condition:   \n         filesize < 250KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30377703
		},
		{
			"indicator": "e8fb5add53e8cd1fa70fc7c51cb139bfda7be3d4",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_magicjack_v1_1_0_0_client_1_1_0_0 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file magicjack_v1.1.0.0_client-1.1.0.0.py\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"63292a2353275a3bae012717bb500d5169cd024064a1ce8355ecb4e9bfcdfdd1\"   \n      strings:   \n         $x1 = \"result = self.send_command(\\\"ls -al %s\\\" % self.options.DIR)\" fullword ascii   \n         $x2 = \"cmd += \\\"D=-l%s \\\" % self.options.LISTEN_PORT\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x2123 and filesize < 80KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377704
		},
		{
			"indicator": "80f5c02f546d7ebeb9ece09821095a8b97919c27",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_curseroot_win2k_v_2_1_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"a1637948ed6ebbd2e582eb99df0c06b27a77c01ad1779b3d84c65953ca2cb603\"   \n      strings:   \n         $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/%s,%s\" fullword ascii   \n         $op0 = { c7 44 24 04 ff ff ff ff 89 04 24 e8 46 65 01 00 } /* Opcode */   \n         $op1 = { 8d 5d 88 89 1c 24 e8 24 1b 01 00 be ff ff ff ff } /* Opcode */   \n         $op2 = { d3 e0 48 e9 0c ff ff ff 8b 45 } /* Opcode */   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 400KB and $s1 and 2 of ($op*) )   \n   }",
			"type": "YARA",
			"id": 30377705
		},
		{
			"indicator": "a6954767f135fe9fe48a8faf446ab65c8b0844a9",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Banner_Implant9x {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"5d69a8cfc9b636448f023fcf18d111f13a8e6bcb9a693eb96276e0d796ab4e0c\"   \n      strings:   \n         $s1 = \".?AVFeFinallyFailure@@\" fullword ascii   \n      \n         $op1 = { c9 c3 57 8d 85 2c eb ff ff }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 20KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377706
		},
		{
			"indicator": "226a7968be1d83c2c435dcf9a0831917fd8e5083",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_xxxRIDEAREA {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"214b0de83b04afdd6ad05567825b69663121eda9e804daff9f2da5554ade77c6\"   \n      strings:   \n         $x1 = \"USAGE: %s -i InputFile -o OutputFile [-f FunctionOrdinal] [-a FunctionArgument] [-t ThreadOption]\" fullword ascii   \n         $x2 = \"The output payload \\\"%s\\\" has a size of %d-bytes.\" fullword ascii   \n         $x3 = \"ERROR: fwrite(%s) failed on ucPayload\" fullword ascii   \n         $x4 = \"Load and execute implant within the existing thread\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377707
		},
		{
			"indicator": "e0410acc777898d11ab4fcf6783103b3f9711d98",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_st_lp {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"3b6f756cca096548dcad2b6c241c1dafd16806c060bec82a530f4d38755286a2\"   \n      strings:   \n         $x1 = \"Previous command: set injection processes (status=0x%x)\" fullword ascii   \n         $x2 = \"Secondary injection process is <null> [no secondary process will be used]\" fullword ascii   \n         $x3 = \"Enter the address to be used as the spoofed IP source address (xxx.xxx.xxx.xxx) -> \" fullword ascii   \n         $x4 = \"E: Execute a Command on the Implant\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 300KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377708
		},
		{
			"indicator": "f86377119d376287be9cd15a84cf15a3b66a899f",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_renamer {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"9c30331cb00ae8f417569e9eb2c645ebbb36511d2d1531bb8d06b83781dfe3ac\"   \n      strings:   \n         $s1 = \"FILE_NAME_CONVERSION.LOG\" fullword wide   \n         $s2 = \"Log file exists. You must delete it!!!\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 80KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377709
		},
		{
			"indicator": "69476f96f92282d336eec7d70bf569d5527ccf9a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_SlDecoder {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"b220f51ca56d9f9d7d899fa240d3328535f48184d136013fd808d8835919f9ce\"   \n      strings:   \n         $x1 = \"Error in conversion. SlDecoder.exe <input filename> <output filename> at command line \" fullword wide   \n         $x2 = \"KeyLogger_Data\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377710
		},
		{
			"indicator": "2de5f42ce026e9348a3e8b9bfca33212c8fd6731",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_DiBa_Target_BH_2000 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"0654b4b8727488769390cd091029f08245d690dd90d1120e8feec336d1f9e788\"   \n      strings:   \n         $s2 = \"0M1U1Z1p1\" fullword ascii /* base64 encoded string '3U5gZu' */   \n         $s14 = \"SPRQWV\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 2000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377711
		},
		{
			"indicator": "3dd7db2e141cdb2b0a9867dce86e44dc68e38389",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__vtuner_vtuner_1 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"3e6bec0679c1d8800b181f3228669704adb2e9cbf24679f4a1958e4cdd0e1431\"   \n         hash2 = \"b0d2ebf455092f9d1f8e2997237b292856e9abbccfbbebe5d06b382257942e0e\"   \n      strings:   \n         $s1 = \"Unable to get -w hash.  %x\" fullword wide   \n         $s2 = \"!\\\"invalid instruction mnemonic constant Id3vil\\\"\" fullword wide   \n         $s4 = \"Unable to set -w provider. %x\" fullword wide   \n      \n         $op0 = { 2b c7 50 e8 3a 8c ff ff ff b6 c0 }   \n         $op2 = { a1 8c 62 47 00 81 65 e0 ff ff ff 7f 03 d8 8b c1 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 2000KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377712
		},
		{
			"indicator": "5b84573795d83c1bf94413e653b54b3897c7b5dc",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_sambal {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file sambal\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"2abf4bbe4debd619b99cb944298f43312db0947217437e6b71b9ea6e9a1a4fec\"   \n      strings:   \n         $s1 = \"+ Bruteforce mode.\" fullword ascii   \n         $s3 = \"+ Host is not running samba!\" fullword ascii   \n         $s4 = \"+ connecting back to: [%d.%d.%d.%d:45295]\" fullword ascii   \n         $s5 = \"+ Exploit failed, try -b to bruteforce.\" fullword ascii   \n         $s7 = \"Usage: %s [-bBcCdfprsStv] [host]\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 90KB and 1 of them ) or ( 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377713
		},
		{
			"indicator": "7b5daff3c415385f51cd12260ce21912d0fb6288",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_PC_Level3_http_exe {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"3e855fbea28e012cd19b31f9d76a73a2df0eb03ba1cb5d22aafe9865150b020c\"   \n      strings:   \n         $s1 = \"Copyright (C) Microsoft\" fullword wide   \n      \n         $op1 = { 24 39 65 c6 44 24 3a 6c c6 44 24 3b 65 c6 44 24 }   \n         $op2 = { 44 24 4e 41 88 5c 24 4f ff }   \n         $op3 = { 44 24 3f 6e c6 44 24 40 45 c6 44 24 41 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 400KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377714
		},
		{
			"indicator": "14a0e71fff624cf39f78eccbd1425b05f41b979b",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_DiBa_Target_BH {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"7ae9a247b60dc31f424e8a7a3b3f1749ba792ff1f4ba67ac65336220021fce9f\"   \n      strings:   \n         $op0 = { 44 89 20 e9 40 ff ff ff 8b c2 48 8b 5c 24 60 48 }   \n         $op1 = { 45 33 c9 49 8d 7f 2c 41 ba }   \n         $op2 = { 89 44 24 34 eb 17 4c 8d 44 24 28 8b 54 24 30 48 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 2000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377715
		},
		{
			"indicator": "992eca44e302007cfd2261e5793a791073ec24cf",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Erraticgopher_1_0_1 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"3d11fe89ffa14f267391bc539e6808d600e465955ddb854201a1f31a9ded4052\"   \n      strings:   \n         $x1 = \"[-] Error appending shellcode buffer\" fullword ascii   \n         $x2 = \"[-] Shellcode is too big\" fullword ascii   \n         $x3 = \"[+] Exploit Payload Sent!\" fullword ascii   \n         $x4 = \"[+] Bound to Dimsvc, sending exploit request to opnum 29\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 150KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377716
		},
		{
			"indicator": "9e324d3ff0273152933052d18c09cd324ab74b26",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_morerats_client_genkey {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"0ce455fb7f46e54a5db9bef85df1087ff14d2fc60a88f2becd5badb9c7fe3e89\"   \n      strings:   \n         $x1 = \"rsakey_txt = lo_execute('openssl genrsa 2048 2> /dev/null | openssl rsa -text 2> /dev/null')\" fullword ascii   \n         $x2 = \"client_auth = binascii.hexlify(lo_execute('openssl rand 16'))\" fullword ascii   \n      condition:   \n         ( filesize < 3KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377717
		},
		{
			"indicator": "66f7d57afff24708aff81f29dead7a70bd71ad1d",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_morerats_client_noprep {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"a5b191a8ede8297c5bba790ef95201c516d64e2898efaeb44183f8fdfad578bb\"   \n      strings:   \n         $x1 = \"storestr = 'echo -n \\\"%s\\\" | Store --nullterminate --file=\\\"%s\\\" --set=\\\"%s\\\"' % (nopenargs, outfile, VAR_NAME)\" fullword ascii   \n         $x2 = \"The NOPEN-args provided are injected into infile if it is a valid\" fullword ascii   \n         $x3 = \" -i                do not autokill after 5 hours\" fullword ascii   \n      condition:   \n         ( filesize < 9KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377718
		},
		{
			"indicator": "a282aac413ead906d91e99e00098684f8b3564fd",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Eclipsedwing_Rpcproxy_Pcdlllauncher {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"48251fb89c510fb3efa14c4b5b546fbde918ed8bb25f041a801e3874bd4f60f8\"   \n         hash2 = \"237c22f4d43fdacfcbd6e1b5f1c71578279b7b06ea8e512b4b6b50f10e8ccf10\"   \n         hash3 = \"79a584c127ac6a5e96f02a9c5288043ceb7445de2840b608fc99b55cf86507ed\"   \n      strings:   \n         $x1 = \"[-] Failed to Prepare Payload!\" fullword ascii   \n         $x2 = \"ShellcodeStartOffset\" fullword ascii   \n         $x3 = \"[*] Waiting for AuthCode from exploit\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377719
		},
		{
			"indicator": "37bdb389beff03fe739701d2403ee1565662e40d",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_morerats_client_Store {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"619944358bc0e1faffd652b6af0600de055c5e7f1f1d91a8051ed9adf5a5b465\"   \n      strings:   \n         $s1 = \"[-] Failed to mmap file: %s\" fullword ascii   \n         $s2 = \"[-] can not NULL terminate input data\" fullword ascii   \n         $s3 = \"Missing argument for `-x'.\" fullword ascii   \n         $s4 = \"[!] Value has size of 0!\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 60KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377720
		},
		{
			"indicator": "d5fa0a854d3b6f054867f603fe59ede2d78204c9",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_reverse_shell {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file reverse.shell.script\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"d29aa24e6fb9e3b3d007847e1630635d6c70186a36c4ab95268d28aa12896826\"   \n      strings:   \n         $s1 = \"sh >/dev/tcp/\" ascii   \n         $s2 = \" <&1 2>&1\" fullword ascii   \n      condition:   \n         ( filesize < 1KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377721
		},
		{
			"indicator": "ea21769b3be4def8cc23edb3c83265c8fe591c3b",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_cursezinger_linuxrh7_3_v_2_0_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"af7c7d03f59460fa60c48764201e18f3bd3f72441fd2e2ff6a562291134d2135\"   \n      strings:   \n         $s1 = \",%02d%03d\" fullword ascii   \n         $s2 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii   \n         $s3 = \"__strtoll_internal\" fullword ascii   \n         $s4 = \"__strtoul_internal\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 400KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377722
		},
		{
			"indicator": "bb7c52cd0e692324e482756ffacff74972d64281",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_sshobo {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- file sshobo\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         hash1 = \"c7491898a0a77981c44847eb00fb0b186aa79a219a35ebbca944d627eefa7d45\"   \n      strings:   \n         $x1 = \"Requested forwarding of port %d but user is not root.\" fullword ascii   \n         $x2 = \"internal error: we do not read, but chan_read_failed for istate\" fullword ascii   \n         $x3 = \"~#  - list forwarded connections\" fullword ascii   \n         $x4 = \"packet_inject_ignore: block\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 600KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377723
		},
		{
			"indicator": "43da507c72dfd871e52b9a4a60e2940d92c55f87",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Eternalromance {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"f1ae9fdbb660aae3421fd3e5b626c1e537d8e9ee2f9cd6d56cb70b6878eaca5d\"   \n         hash2 = \"b99c3cc1acbb085c9a895a8c3510f6daaf31f0d2d9ccb8477c7fb7119376f57b\"   \n      strings:   \n         $x1 = \"[-] Error: Exploit choice not supported for target OS!!\" fullword ascii   \n         $x2 = \"Error: Target machine out of NPP memory (VERY BAD!!) - Backdoor removed\" fullword ascii   \n         $x3 = \"[-] Error: Backdoor not present on target\" fullword ascii   \n         $x4 = \"***********    TARGET ARCHITECTURE IS X64    ************\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them ) or 2 of them   \n   }",
			"type": "YARA",
			"id": 30377724
		},
		{
			"indicator": "5393f5b88b4df7590c6bbdb5cb3035be6d17f469",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_seconddate_ImplantStandalone_3_0_3 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"d687aa644095c81b53a69c206eb8d6bdfe429d7adc2a57d87baf8ff8d4233511\"   \n      strings:   \n         $s1 = \"EFDGHIJKLMNOPQRSUT\" fullword ascii   \n         $s2 = \"G8HcJ HcF LcF0LcN\" fullword ascii   \n         $s3 = \"GhHcJ0HcF@LcF0LcN8H\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 1000KB and all of them )   \n   }",
			"type": "YARA",
			"id": 30377725
		},
		{
			"indicator": "c743bdf787d0d0944354feb3e55211cc9add7041",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Esteemaudit_2_1_0 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"61f98b12c52739647326e219a1cf99b5440ca56db3b6177ea9db4e3b853c6ea6\"   \n      strings:   \n         $x1 = \"[+] Connected to target %s:%d\" fullword ascii   \n         $x2 = \"[-] build_exploit_run_x64():\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377726
		},
		{
			"indicator": "d152b599aabc7c1200774e16682673d37fff6ac2",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_Esteemaudittouch_2_1_0 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"f6b9caf503bb664b22c6d39c87620cc17bdb66cef4ccfa48c31f2a3ae13b4281\"   \n      strings:   \n         $x1 = \"[-] Touching the target failed!\" fullword ascii   \n         $x2 = \"[-] OS fingerprint not complete - 0x%08x!\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377727
		},
		{
			"indicator": "d6a072041f84cb22d8068aa70fbb8894fc48475a",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_msgkd_msslu64_msgki_mssld {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"9ab667b7b5b9adf4ff1d6db6f804824a22c7cc003eb4208d5b2f12809f5e69d0\"   \n         hash2 = \"320144a7842500a5b69ec16f81a9d1d4c8172bb92301afd07fb79bc0eca81557\"   \n         hash3 = \"c10f4b9abee0fde50fe7c21b9948a2532744a53bb4c578630a81d2911f6105a3\"   \n         hash4 = \"551174b9791fc5c1c6e379dac6110d0aba7277b450c2563e34581565609bc88e\"   \n         hash5 = \"8419866c9058d738ebc1a18567fef52a3f12c47270f2e003b3e1242d86d62a46\"   \n      strings:   \n         $s1 = \"PQRAPAQSTUVWARASATAUAVAW\" fullword ascii   \n         $s2 = \"SQRUWVAWAVAUATASARAQAP\" fullword ascii   \n         $s3 = \"iijymqp\" fullword ascii   \n         $s4 = \"AWAVAUATASARAQI\" fullword ascii   \n         $s5 = \"WARASATAUAVM\" fullword ascii   \n      \n         $op1 = { 0c 80 30 02 48 83 c2 01 49 83 e9 01 75 e1 c3 cc }   \n         $op2 = { e8 10 66 0d 00 80 66 31 02 48 83 c2 02 49 83 e9 }   \n         $op3 = { 48 b8 53 a5 e1 41 d4 f1 07 00 48 33 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 1000KB and 2 of ($s*) or all of ($op*) )   \n   }",
			"type": "YARA",
			"id": 30377728
		},
		{
			"indicator": "b560b3999fc7c8f821da15880aafa519e680cb98",
			"description": "",
			"title": "",
			"content": "rule EquationGroup__scanner_scanner_v2_1_2 {   \n      meta:   \n         description = \"Equation Group hack tool leaked by ShadowBrokers- from files scanner, scanner.v2.1.2\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-08\"   \n         super_rule = 1   \n         hash1 = \"dcbcd8a98ec93a4e877507058aa26f0c865b35b46b8e6de809ed2c4b3db7e222\"   \n         hash2 = \"9807aaa7208ed6c5da91c7c30ca13d58d16336ebf9753a5cea513bcb59de2cff\"   \n      strings:   \n         $s1 = \"Welcome to the network scanning tool\" fullword ascii   \n         $s2 = \"Scanning port %d\" fullword ascii   \n         $s3 = \"/current/down/cmdout/scans\" fullword ascii   \n         $s4 = \"Scan for SSH version\" fullword ascii   \n         $s5 = \"program vers proto   port  service\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 100KB and 2 of them ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 30377729
		},
		{
			"indicator": "e1c244be8d02a201e37ced7328487f061626677c",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_cursesleepy_mswin32_v_1_0_0 {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         hash1 = \"6293439b4b49e94f923c76e302f5fc437023c91e063e67877d22333f05a24352\"   \n      strings:   \n         $s1 = \"A}%j,R\" fullword ascii   \n         $op1 = { a1 e0 43 41 00 8b 0d 34 44 41 00 6b c0 } /* Opcode */   \n         $op2 = { 33 C0 F3 A6 74 14 8B 5D 08 8B 4B 34 50 } /* Opcode */   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 2 of them )   \n   }",
			"type": "YARA",
			"id": 30377730
		},
		{
			"indicator": "288144765c1ee2f8d899589be48297d74d1c37ce",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_DUMPEL {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"bf42532be2d36f522dca7d3d3eb40b1d25c33d508a5a37c7e28f148945136dc6\"   \n      strings:   \n         $x1 = \"dumpel -f file [-s \\\\\\\\server]\" fullword ascii   \n         $x2 = \"records will not appear in the dumped log.\" fullword ascii   \n         $x3 = \"obj\\\\i386\\\\Dumpel.exe\" fullword ascii   \n         $s13 = \"DUMPEL Usage:    \" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 200KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377731
		},
		{
			"indicator": "9031dcedd983e32d5045a68ba081358325708115",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17_SetResourceName {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         hash1 = \"537793d5158aecd0debae25416450bd885725adfc8ca53b0577a3df4b0222e2e\"   \n      strings:   \n         $x1 = \"Updates the name of the dll or executable in the resource file\" fullword ascii   \n         $x2 = \"*NOTE: SetResourceName does not work with PeddleCheap versions\" fullword ascii   \n         $x3 = \"2 = [appinit.dll] level4 dll\" fullword ascii   \n         $x4 = \"1 = [spcss32.exe] level3 exe\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 100KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377732
		},
		{
			"indicator": "7930bab04ec590fbc26e4e400f8a7f554b5880cb",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_Toolset_Apr17__SendCFTrigger_SendPKTrigger_6 {   \n      meta:   \n         description = \"Detects EquationGroup Tool - April Leak\"   \n         author = \"Florian Roth\"   \n         reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"   \n         date = \"2017-04-15\"   \n         super_rule = 1   \n         hash1 = \"3bee31b9edca8aa010a4684c2806b0ca988b2bcc14ad0964fec4f11f3f6fb748\"   \n         hash2 = \"2f9c7a857948795873a61f4d4f08e1bd0a41e3d6ffde212db389365488fa6e26\"   \n      strings:   \n         $s4 = \"* Failed to connect to destination - %u\" fullword wide   \n         $s6 = \"* Failed to convert destination address into sockaddr_storage values\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 400KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377733
		},
		{
			"indicator": "122d08bddf357a77b273ee9db6e1ea63b0e00aba",
			"description": "",
			"title": "",
			"content": "rule EquationGroup_x86_linux_exactchange {   \n      meta:   \n         description = \"Equation Group hack tool set\"   \n         author = \"Florian Roth\"   \n         reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"   \n         date = \"2017-04-09\"   \n         super_rule = 1   \n         hash1 = \"dfecaf5b85309de637b84a686dd5d2fca9c429e8285b7147ae4213c1f49d39e6\"   \n         hash2 = \"6ef6b7ec1f1271503957cf10bb6b1bfcedb872d2de3649f225cf1d22da658bec\"   \n      strings:   \n         $x1 = \"kernel has 4G/4G split, not exploitable\" fullword ascii   \n         $x2 = \"[+] kernel stack size is %d\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x457f and filesize < 1000KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 30377734
		},
		{
			"indicator": "c284ccf479ac77b3c41b6e9a3ee005232c9055b4",
			"description": "",
			"title": "",
			"content": "rule COZY_FANCY_BEAR_pagemgr_Hunt    \n   {   \n      \n       meta:   \n           description = \"Detects a pagemgr.exe as mentioned in the CrowdStrike report\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/\"   \n           date = \"2016-06-14\"   \n      \n       strings:   \n           $s1 = \"pagemgr.exe\" wide fullword   \n      \n       condition:   \n           uint16(0) == 0x5a4d and 1 of them   \n   }",
			"type": "YARA",
			"id": 30377990
		},
		{
			"indicator": "390e1109e04dbcd4a47ae508ad5beb2b9fea1c33",
			"description": "",
			"title": "",
			"content": "rule COZY_FANCY_BEAR_Hunt    \n   {   \n      \n       meta:   \n           description = \"Detects Cozy Bear / Fancy Bear C2 Server IPs\"   \n           author = \"Florian Roth\"   \n           reference = \"https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/\"   \n           date = \"2016-06-14\"   \n      \n       strings:   \n           $s1 = \"185.100.84.134\" ascii wide fullword   \n           $s2 = \"58.49.58.58\" ascii wide fullword   \n           $s3 = \"218.1.98.203\" ascii wide fullword   \n           $s4 = \"187.33.33.8\" ascii wide fullword   \n           $s5 = \"185.86.148.227\" ascii wide fullword   \n           $s6 = \"45.32.129.185\" ascii wide fullword   \n           $s7 = \"23.227.196.217\" ascii wide fullword   \n      \n       condition:   \n           uint16(0) == 0x5a4d and 1 of them   \n   }",
			"type": "YARA",
			"id": 30377991
		},
		{
			"indicator": "62063aa09d45ad4476f205dd9d649d1c2246a596",
			"description": "",
			"title": "",
			"content": "rule GEN_PowerShell    \n   {   \n      \n       meta:   \n           description = \"Generic PowerShell Malware Rule\"   \n           author = \"https://github.com/interleaved\"   \n          \n       strings:   \n           $s1 = \"powershell\"   \n           $s2 = \"-ep bypass\" nocase   \n           $s3 = \"-nop\" nocase   \n           $s10 = \"-executionpolicy bypass\" nocase   \n           $s4 = \"-win hidden\" nocase   \n           $s5 = \"-windowstyle hidden\" nocase   \n           $s11 = \"-w hidden\" nocase   \n           /*$s6 = \"-noni\" fullword ascii*/   \n           /*$s7 = \"-noninteractive\" fullword ascii*/   \n           $s8 = \"-enc\" nocase   \n           $s9 = \"-encodedcommand\" nocase   \n          \n       condition:   \n           $s1 and (($s2 or $s3 or $s10) and ($s4 or $s5 or $s11) and ($s8 or $s9))   \n   }",
			"type": "YARA",
			"id": 30378011
		},
		{
			"indicator": "afceda7c4d3f90ae226f9ffadad5a6531c2f2bcb",
			"description": "",
			"title": "",
			"content": "rule alina   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Brian Wallace @botnet_hunter\"   \n   \t\tauthor_email = \"bwall@ballastsecurity.net\"   \n   \t\tdate = \"2014-08-09\"   \n   \t\tdescription = \"Identify Alina\"   \n   \tstrings:   \n   \t\t$s1 = \"Alina v1.0\"   \n   \t\t$s2 = \"POST\"   \n   \t\t$s3 = \"1[0-2])[0-9]\"   \n      \n   \tcondition:   \n           \tall of them   \n   }",
			"type": "YARA",
			"id": 30378019
		},
		{
			"indicator": "aa2abedd98934d2f3dd2458b4eb5254ab7e559c1",
			"description": "",
			"title": "",
			"content": "rule andromeda   \n   {   \n          \n       meta:   \n           author = \"Brian Wallace @botnet_hunter\"   \n           author_email = \"bwall@ballastsecurity.net\"   \n           date = \"2014-03-13\"   \n           description = \"Identify Andromeda\"   \n          \n       strings:   \n           $config = {1c 1c 1d 03 49 47 46}   \n           $c1 = \"hsk\\\\ehs\\\\dihviceh\\\\serhlsethntrohntcohurrehem\\\\chsyst\"   \n          \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30394406
		},
		{
			"indicator": "4868c9cb6282281d4229063d740bde94e9a445ef",
			"description": "",
			"title": "",
			"content": "rule Worm_Gamarue    \n   {   \n      \n       meta:   \n           author = \"Centro Criptolgico Nacional (CCN)\"   \n           ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"   \n           description = \"Gamarue_Andromeda\"          \n      \n       strings:   \n           $a = { 69 E1 2A B0 2D 80 44 E3 2D 80 44 E3 2D 80 44 E3 EE 8F 1B E3 2A 80 44 E3 EE 8F 19 E3 3A 80 44 E3 2D 80 45 E3 CD 81 44 E3 0A 46 39 E3 34 80 44 E3 0A 46 29 E3 A5 80 44 E3 0A 46 2A E3 5C 80 44 E3 0A 46 36 E3 2C 80 44 E3 0A 46 3C E3 2C 80 44 E3 }   \n       condition:   \n           $a    \n   }",
			"type": "YARA",
			"id": 30394407
		},
		{
			"indicator": "bc81e7999bda79ad29a904d47eb195bd228ab232",
			"description": "",
			"title": "",
			"content": "rule andromeda_bot   \n   {    \n       meta:   \n           maltype = \"Andromeda bot\"   \n           author = \"https://github.com/reed1713\"   \n           description = \"IOC looks for the creation or termination of a process associated with the Andromeda Trojan. The malware will execute the msiexec.exe within the suspicious directory. Shortly after, it creates and injects itself into the wuauctl.exe (windows update) process. It then attempts to beacon to its C2.\"   \n         \n       strings:   \n           $type=\"Microsoft-Windows-Security-Auditing\"   \n           $eventid=\"4688\"   \n           $data=\"AppData\\\\Local\\\\Temp\\\\_.net_\\\\msiexec.exe\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30394408
		},
		{
			"indicator": "a308ba5a5dfb913fe07537738bf7362c8b87e8a9",
			"description": "",
			"title": "",
			"content": "rule Atmos_Packed_Malware    \n   {   \n         \n       meta:   \n       description = \"Second Generic Spyware.Citadel.Atmos signture when builder add a packed layer\"   \n       author = \"xylitol@temari.fr\"   \n       reference = \"http://www.xylibox.com/2016/02/citadel-0011-atmos.html\"   \n       date = \"20/08/2016\"   \n       // May only the challenge guide you   \n      \n       strings:   \n           $MZ = {4D 5A}   \n           // Entry point identifier with CreateThread pointer in '??'    \n           $a = {55 8B EC 83 EC 0C 53 56 8B 35 ?? ?? ?? 00 57 33 DB BF 00 28 00 00}   \n           // End of main proc with sleep value in '??' and api call to sleep in '??'   \n           $b = {68 ?? ?? ?? ?? FF 15 ?? ?? ?? 00 E9 62 FF FF FF E8 69 10 FE FF 5F 5E 5B C9 C3}   \n           // API String identifier (ShellExecuteExW, SHELL32.dll, GetUserNameExW, Secur32.dll)   \n           $c = {53 68 65 6C 6C 45 78 65 63 75 74 65 45 78 57 00 53 48 45 4C 4C 33 32 2E 64 6C 6C 00 1E 00 47 65}   \n           $d = {74 55 73 65 72 4E 61 6D 65 45 78 57 00 00 53 65 63 75 72 33 32 2E 64 6C 6C 00 10 00}   \n           // New Thread identifier   \n           $e = {55 8B EC 83 E4 F8 83 EC 1C 83 7D 08 00 57 74 ?? 6A FF FF 75 08 FF 15 ?? ?? ?? 00}   \n      \n       condition:   \n       all of them and filesize < 300KB // Standard size (raw from builder) should be arround ~264kb   \n           // Remove the above line if you want to trig also on memory dumps, etc...   \n   }",
			"type": "YARA",
			"id": 30394409
		},
		{
			"indicator": "94226c61a2c5667a25a6a153958e1a405f122160",
			"description": "",
			"title": "",
			"content": "rule Atmos_Malware   \n   {   \n          \n       meta:   \n           description = \"Generic Spyware.Citadel.Atmos Signature\"   \n           author = \"xylitol@temari.fr\"   \n           reference = \"http://www.xylibox.com/2016/02/citadel-0011-atmos.html\"   \n           date = \"20/08/2016\"   \n           // May only the challenge guide you   \n      \n       strings:   \n           // Check for the presence of MZ and kutuzov license identifier   \n           $MZ = {4D 5A}   \n           $LKEY = \"533D9226E4C1CE0A9815DBEB19235AE4\" wide ascii   \n              \n           // TokenSpy identifiers   \n           $TS1 = \"X-TS-Rule-Name: %s\" wide ascii   \n           $TS2 = \"X-TS-Rule-PatternID: %u\" wide ascii   \n           $TS3 = \"X-TS-BotID: %s\" wide ascii   \n           $TS4 = \"X-TS-Domain: %s\" wide ascii   \n           $TS5 = \"X-TS-SessionID: %s\" wide ascii   \n           $TS6 = \"X-TS-Header-Cookie: %S\" wide ascii   \n           $TS7 = \"X-TS-Header-Referer: %S\" wide ascii   \n           $TS8 = \"X-TS-Header-AcceptEncoding: %S\" wide ascii   \n           $TS9 = \"X-TS-Header-AcceptLanguage: %S\" wide ascii   \n           $TS10 = \"X-TS-Header-UserAgent: %S\" wide ascii   \n              \n           // Hidden VNC identifiers   \n           $VNC1 = \"_hvnc_init@4\" wide ascii   \n           $VNC2 = \"_hvnc_uninit@0\" wide ascii   \n           $VNC3 = \"_hvnc_start@8\" wide ascii   \n           $VNC4 = \"_hvnc_stop@0\" wide ascii   \n           $VNC5 = \"_hvnc_wait@0\" wide ascii   \n           $VNC6 = \"_hvnc_work@0\" wide ascii   \n              \n           // Browsers identifiers   \n           $WB1 = \"nspr4.dll\" wide ascii   \n           $WB2 = \"nss3.dll\" wide ascii   \n           $WB3 = \"chrome.dll\" wide ascii   \n           $WB4 = \"Internet Explorer\" wide ascii   \n           $WB5 = \"Firefox\" wide ascii   \n           $WB6 = \"Chrome\" wide ascii   \n      \n       condition:   \n       ($MZ at 0 and $LKEY) and ( (5 of ($TS*) and all of ($WB*)) or (3 of ($VNC*) and all of ($WB*)))   \n       and filesize < 300KB // Standard size (raw from builder) should be arround ~264kb   \n           // Remove the above line if you want to trig also on memory dumps, etc...   \n   }",
			"type": "YARA",
			"id": 30394410
		},
		{
			"indicator": "0bc8dcc047c10677577c640085453237c5add637",
			"description": "",
			"title": "",
			"content": "rule Atmos_Builder   \n   {   \n          \n       meta:   \n           description = \"Generic signature for Hacktool.Atmos.Builder cracked version\"   \n           author = \"xylitol@temari.fr\"   \n           reference = \"http://www.xylibox.com/2016/02/citadel-0011-atmos.html\"   \n           date = \"20/08/2016\"   \n           // May only the challenge guide you   \n      \n       strings:   \n           // Check for the presence of MZ, kutuzov license identifier, and good hardware ID   \n           $MZ = {4D 5A}   \n           $LKEY = \"533D9226E4C1CE0A9815DBEB19235AE4\" wide ascii   \n           $HWID = \"D19FC0FB14BE23BCF35DA427951BB5AE\" wide ascii   \n      \n           // Builder strings identifiers   \n           $s1 = \"url_loader=%S\" wide ascii   \n           $s2 = \"url_webinjects=%S\" wide ascii   \n           $s3 = \"url_tokenspy=%S\" wide ascii   \n           $s4 = \"file_webinjects=%S\" wide ascii   \n           $s5 = \"moneyparser.enabled=%u\" wide ascii   \n           $s6 = \"enable_luhn10_post=%u\" wide ascii   \n           $s7 = \"insidevm_enable=%u\" wide ascii   \n           $s8 = \"disable_antivirus=%u\" wide ascii   \n              \n       condition:   \n           $MZ at 0 and $LKEY and $HWID and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 30394411
		},
		{
			"indicator": "b885e064b55851dd29684d47befbe958a3f6dc52",
			"description": "",
			"title": "",
			"content": "rule backoff    \n   {   \n      \n       meta:   \n           author = \"Brian Wallace @botnet_hunter\"   \n           author_email = \"bwall@ballastsecurity.net\"   \n           date = \"2014-08-21\"   \n           description = \"Identify Backoff\"   \n      \n       strings:   \n           $s1 = \"&op=%d&id=%s&ui=%s&wv=%d&gr=%s&bv=%s\"   \n           $s2 = \"%s @ %s\"   \n           $s3 = \"Upload KeyLogs\"   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30409329
		},
		{
			"indicator": "35799c451299c2cdb8b89d06d939ac8ca4277057",
			"description": "",
			"title": "",
			"content": "rule BoousetCode   \n   {   \n          \n       meta:   \n           description = \"Boouset code tricks\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-06-19\"   \n              \n       strings:   \n           $boousetdat = { C6 ?? ?? ?? ?? 00 62 C6 ?? ?? ?? ?? 00 6F C6 ?? ?? ?? ?? 00 6F C6 ?? ?? ?? ?? 00 75 }   \n              \n       condition:   \n           any of them   \n   }",
			"type": "YARA",
			"id": 30409360
		},
		{
			"indicator": "8205c4a7eff0dc7dd198ccc0125c1821366c92a9",
			"description": "",
			"title": "",
			"content": "rule Bublik   \n   {   \n         \n       meta:   \n           author=\"Kevin Falcoz\"   \n           date=\"29/09/2013\"   \n           description=\"Bublik Trojan Downloader\"   \n              \n       strings:   \n           $signature1={63 6F 6E 73 6F 6C 61 73}   \n           $signature2={63 6C 55 6E 00 69 6E 66 6F 2E 69 6E 69}   \n              \n       condition:   \n           $signature1 and $signature2   \n   }",
			"type": "YARA",
			"id": 30409361
		},
		{
			"indicator": "e508026c2c2620bd4bd11d35499cfc2b563a1392",
			"description": "",
			"title": "",
			"content": "rule ChickenDOS_Linux    \n   {   \n       \n       meta:   \n           author = \"Jason Jones <jasonjones@arbor.net>\"   \n           description = \"Linux-variant of Chicken ident for both dropper and dropped file\"   \n           source = \"https://github.com/arbor/yara/blob/master/chicken.yara\"   \n          \n       strings:   \n           $cfg = \"fake.cfg\"   \n           $file1 = \"ThreadAttack.cpp\"   \n           $file2 = \"Fake.cpp\"   \n           $str1 = \"dns_array\"   \n           $str2 = \"DomainRandEx\"   \n           $str3 = \"cpu %llu %llu %llu %llu\"   \n           $str4 = \"[ %02d.%02d %02d:%02d:%02d.%03ld ] [%lu] [%s] %s\" ascii   \n          \n       condition:   \n           $cfg and all of ($file*) and 3 of ($str*)   \n   }",
			"type": "YARA",
			"id": 30409371
		},
		{
			"indicator": "6d42e4d8e3d9099b855d530eb0f165c54b82dcd4",
			"description": "",
			"title": "",
			"content": "rule ChickenDOS   \n   {   \n      \n       meta:   \n           author = \"Jason Jones <jasonjones@arbor.net>\"   \n           description = \"Win32-variant of Chicken ident for both dropper and dropped file\"   \n           source = \"https://github.com/arbor/yara/blob/master/chicken.yara\"   \n      \n       strings:   \n           $pdb1 = \"\\\\Chicken\\\\Release\\\\svchost.pdb\"   \n           $pdb2 = \"\\\\IntergrateCHK\\\\Release\\\\IntergrateCHK.pdb\"   \n           $str2 = \"fake.cf\"   \n           $str3 = \"8.8.8.8\"   \n           $str4 = \"Processor(%d)\\\\\"   \n           $str5 = \"DbProtectSupport\"   \n           $str1 = \"dm1712/`jvpnpkte/bpl\"   \n           $str6 = \"InstallService NPF %d\"   \n           $str7 = \"68961\"   \n           $str8 = \"InstallService DbProtectSupport %d\"   \n           $str9 = \"C:\\\\Program Files\\\\DbProtectSupport\\\\npf.sys\"   \n         \n       condition:   \n           ($pdb1 or $pdb2) and 5 of ($str*)   \n   }",
			"type": "YARA",
			"id": 30409372
		},
		{
			"indicator": "f5beb585c1e0184ca5cdaa0935eb8ae000844283",
			"description": "",
			"title": "",
			"content": "rule citadel13xy   \n   {   \n          \n       meta:   \n           author = \"Jean-Philippe Teissier / @Jipe_\"   \n           description = \"Citadel 1.5.x.y trojan banker\"   \n           date = \"2013-01-12\"    \n           version = \"1.0\"    \n           filetype = \"memory\"   \n         \n       strings:   \n           $a = \"Coded by BRIAN KREBS for personnal use only. I love my job & wife.\"   \n           $b = \"http://%02x%02x%02x%02x%02x%02x%02x%02x.com/%02x%02x%02x%02x/%02x%02x%02x%02x%02x.php\"   \n           $c = \"%BOTID%\"   \n           $d = \"%BOTNET%\"   \n           $e = \"cit_video.module\"   \n           $f = \"bc_remove\"   \n           $g = \"bc_add\"   \n           $ggurl = \"http://www.google.com/webhp\"   \n      \n       condition:   \n           3 of them   \n   }",
			"type": "YARA",
			"id": 30409373
		},
		{
			"indicator": "410c0b87b5031bf2a6e85c60a499a44739829ccc",
			"description": "",
			"title": "",
			"content": "rule Citadel_Malware   \n   {   \n          \n       meta:   \n           author = \"xylitol@temari.fr\"   \n           date = \"2015-10-08\"    \n           description = \"Search for nss3.dll pattern indicating an hexed copy of Citadel malware to work on firefox > v23.0\"   \n           // May only the challenge guide you   \n              \n       strings:   \n           $s1 = \"Coded by BRIAN KREBS for personal use only. I love my job & wife\" wide ascii   \n           $s2 = \"nss3.dll\" wide ascii   \n      \n           $h1 = {8B C7 EB F5 55 8B EC}   \n           $h2 = {55 8B EC 83 EC 0C 8A 82 00 01 00 00}   \n           $h3 = {3D D0 FF 1F 03 77 ?? 83 7D}   \n           $h4 = {83 F9 66 74 ?? 83 F9 6E 74 ?? 83 F9 76 74 ?? 83 F9 7A}   \n      \n       condition:   \n           all of ($s*) and 2 of ($h*)   \n   }",
			"type": "YARA",
			"id": 30409374
		},
		{
			"indicator": "e9ce871f60a6abcf850f1a5f04147b15115fec4a",
			"description": "",
			"title": "",
			"content": "rule Binary_Drop_Certutil   \n   {   \n      \n       meta:   \n           description = \"Drop binary as base64 encoded cert trick\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/9DNn8q\"   \n           date = \"2015-07-15\"   \n           score = 70   \n      \n       strings:   \n           $s0 = \"echo -----BEGIN CERTIFICATE----- >\" ascii   \n           $s1 = \"echo -----END CERTIFICATE----- >>\" ascii   \n           $s2 = \"certutil -decode \" ascii   \n        \n       condition:   \n           filesize < 10KB and all of them   \n   }",
			"type": "YARA",
			"id": 30409375
		},
		{
			"indicator": "ec486fbea24230fc7982abbf41574820ca1d1e99",
			"description": "",
			"title": "",
			"content": "rule StegoKatz    \n   {   \n      \n       meta:   \n           description = \"Encoded Mimikatz in other file types\"   \n           author = \"Florian Roth\"   \n           reference = \"https://goo.gl/jWPBBY\"   \n           date = \"2015-09-11\"   \n           score = 70   \n      \n       strings:   \n           $s1 = \"VC92Ny9TSXZMNk5jLy8vOUlqUTFVRlFNQTZMLysvdjlJaTh2L0ZUNXJBUUJJaTFRa1NFaUx6K2hWSS8vL1NJME44bklCQU9pZC92Ny9USTJjSkpBQUFBQXp3RW1MV3hCSmkyc1lTWXR6S0VtTDQxL0R6TXhNaTl4SmlWc0lUWWxMSUUySlF4aFZWbGRCVkVGVlFWWkJWMGlCN1BBQUFBQklnMlFrYUFDNE1BQUFBRW1MNkVTTmNPQ0pSQ1JnaVVRa1pFbU5RN0JKaTlsTWpRWFBGQU1BU0ls\" ascii   \n           $s2 = \"Rpd3ovN3FlalVtNklLQ0xNNGtOV1BiY0VOVHROT0Zud25CWGN0WS9BcEdMR28rK01OWm85Nm9xMlNnY1U5aTgrSTBvNkFob1FOTzRHQWdtUElEVmlqald0Tk90b2FmN01ESWJUQkF5T0pYbTB4bFVHRTBZWEFWOXVoNHBkQnRrS0VFWWVBSEE2TDFzU0c5a2ZFTEc3QWd4WTBYY1l3ZzB6QUFXS09JZE9wQVhEK3lnS3lsR3B5Q1ljR1NJdFNseGZKWUlVVkNFdEZPVjRJUldERUl1QXpKZ2pCQWdsd0Va\" ascii   \n         \n       condition:   \n           filesize < 1000KB and 1 of them   \n   }",
			"type": "YARA",
			"id": 30409376
		},
		{
			"indicator": "3d331a18e5f9963531f47a1684844bdc84b5d07e",
			"description": "",
			"title": "",
			"content": "rule CorkowDLL   \n   {   \n      \n       meta:   \n           description = \"Rule to detect the Corkow DLL files\"   \n           reference = \"IB-Group | http://www.group-ib.ru/brochures/Group-IB-Corkow-Report-EN.pdf\"   \n      \n       strings:   \n           $mz = { 4d 5a }   \n           $binary1 = {60 [0-8] 9C [0-8] BB ?? ?? ?? ?? [0-8] 81 EB ?? ?? ?? ?? [0-8] E8 ?? 00 00 00 [0-8] 58 [0-8] 2B C3}   \n           $binary2 = {(FF75??|53)FF7510FF750CFF7508E8????????[3-9]C9C20C 00}   \n           $export1 = \"Control_RunDLL\"   \n           $export2 = \"ServiceMain\"   \n           $export3 = \"DllGetClassObject\"   \n      \n       condition:   \n           ($mz at 0) and ($binary1 and $binary2) and any of ($export*)   \n   }",
			"type": "YARA",
			"id": 30420509
		},
		{
			"indicator": "e6ca8f797529e08abb2eca661910d35662af6ad7",
			"description": "",
			"title": "",
			"content": "rule Derkziel   \n   {   \n          \n       meta:   \n           description = \"Derkziel info stealer (Steam, Opera, Yandex, ...)\"   \n           author = \"The Malware Hunter\"   \n           filetype = \"pe\"   \n           date = \"2015-11\"   \n           md5 = \"f5956953b7a4acab2e6fa478c0015972\"   \n           site = \"https://zoo.mlw.re/samples/f5956953b7a4acab2e6fa478c0015972\"   \n           reference = \"https://bhf.su/threads/137898/\"   \n          \n       strings:   \n           $drz = \"{!}DRZ{!}\"   \n           $ua = \"User-Agent: Uploador\"   \n           $steam = \"SteamAppData.vdf\"   \n           $login = \"loginusers.vdf\"   \n           $config = \"config.vdf\"   \n          \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30447268
		},
		{
			"indicator": "31b4a93e7e9bf928741054927e504344de005c33",
			"description": "",
			"title": "",
			"content": "rule dexter_strings   \n   {   \n         \n       meta:   \n           author = \"Brian Wallace @botnet_hunter\"   \n           author_email = \"bwall@ballastsecurity.net\"   \n           date = \"2014-09-10\"   \n           description = \"Identify Dexter POSGrabber\"   \n         \n       strings:   \n           $s1 = \"UpdateMutex:\"   \n           $s2 = \"response=\"   \n           $s3 = \"page=\"   \n           $s4 = \"scanin:\"   \n         \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30447418
		},
		{
			"indicator": "c68fa54c6ffecefd3c39d8e788d48a986a8b533a",
			"description": "",
			"title": "",
			"content": "rule Dexter_Malware    \n   {   \n      \n       meta:   \n           description = \"Detects the Dexter Trojan/Agent http://goo.gl/oBvy8b\"   \n           author = \"Florian Roth\"   \n           reference = \"http://goo.gl/oBvy8b\"   \n           date = \"2015/02/10\"   \n           score = 70   \n      \n       strings:   \n           $s0 = \"Java Security Plugin\" fullword wide   \n           $s1 = \"%s\\\\%s\\\\%s.exe\" fullword wide   \n           $s2 = \"Sun Java Security Plugin\" fullword wide   \n           $s3 = \"\\\\Internet Explorer\\\\iexplore.exe\" fullword wide   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30447419
		},
		{
			"indicator": "ae173783304f92627ed4846eae5ba17716e043c3",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_Mimikatz_Gen {   \n      meta:   \n         description = \"Detects Empire component - file Invoke-Mimikatz.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"   \n      strings:   \n         $s1 = \"= \\\"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQ\" ascii   \n         $s2 = \"Invoke-Command -ScriptBlock $RemoteScriptBlock -ArgumentList @($PEBytes64, $PEBytes32, \\\"Void\\\", 0, \\\"\\\", $ExeArgs)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467228
		},
		{
			"indicator": "9f8e3068fd05279fa4c7097423ea5aa0c7e62e09",
			"description": "",
			"title": "",
			"content": "rule Empire_PowerShell_Framework_Gen2 {   \n      meta:   \n         description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-CredentialInjection.ps1, Invoke-DCSync.ps1, Invoke-DCSync.ps1, Invoke-Mimikatz.ps1, Invoke-PSInject.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1, Invoke-ReflectivePEInjection.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         super_rule = 1   \n         hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"   \n         hash3 = \"a3428a7d4f9e677623fadff61b2a37d93461123535755ab0f296aa3b0396eb28\"   \n         hash5 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"   \n         hash6 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"   \n         hash8 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"   \n      strings:   \n         $x1 = \"$DllMain = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($DllMainPtr, $DllMainDelegate)\" fullword ascii   \n         $s20 = \"#Shellcode: CallDllMain.asm\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467229
		},
		{
			"indicator": "9180f1a1f67f1d71ca2d3964b3915a0a90c9f969",
			"description": "",
			"title": "",
			"content": "rule Empire_KeePassConfig {   \n      meta:   \n         description = \"Detects Empire component - file KeePassConfig.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"5a76e642357792bb4270114d7cd76ce45ba24b0d741f5c6b916aeebd45cff2b3\"   \n      strings:   \n         $s1 = \"$UserMasterKeyFiles = @(, $(Get-ChildItem -Path $UserMasterKeyFolder -Force | Select-Object -ExpandProperty FullName) )\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7223 and filesize < 80KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467230
		},
		{
			"indicator": "c4dead9a8a29b9fbe8d5d8c21ae71837012896c1",
			"description": "",
			"title": "",
			"content": "rule Empire_Out_Minidump {   \n      meta:   \n         description = \"Detects Empire component - file Out-Minidump.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"7803ae7ba5d4e7d38e73745b3f321c2ca714f3141699d984322fa92e0ff037a1\"   \n      strings:   \n         $s1 = \"$Result = $MiniDumpWriteDump.Invoke($null, @($ProcessHandle,\" fullword ascii   \n         $s2 = \"$ProcessFileName = \\\"$($ProcessName)_$($ProcessId).dmp\\\"\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 10KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467231
		},
		{
			"indicator": "7f929a16fb3423f19e6cb931492abf29d3ea4470",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_SMBAutoBrute {   \n      meta:   \n         description = \"Detects Empire component - file Invoke-SMBAutoBrute.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"7950f8abdd8ee09ed168137ef5380047d9d767a7172316070acc33b662f812b2\"   \n      strings:   \n         $s1 = \"[*] PDC: LAB-2008-DC1.lab.com\" fullword ascii   \n         $s2 = \"$attempts = Get-UserBadPwdCount $userid $dcs\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 30KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467232
		},
		{
			"indicator": "6f6d5e63e52f6098627211695f3b4dea6d159a0b",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_PsExec {   \n      meta:   \n         description = \"Detects Empire component - file Invoke-PsExec.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"0218be4323959fc6379489a6a5e030bb9f1de672326e5e5b8844ab5cedfdcf88\"   \n      strings:   \n         $s1 = \"Invoke-PsExecCmd\" fullword ascii   \n         $s2 = \"\\\"[*] Executing service .EXE\" fullword ascii   \n         $s3 = \"$cmd = \\\"%COMSPEC% /C echo $Command ^> %systemroot%\\\\Temp\\\\\" ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 50KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467233
		},
		{
			"indicator": "20f3c9ef52265dcd6e9e41bf36bd4c9d9502b678",
			"description": "",
			"title": "",
			"content": "rule Empire_PowerShell_Framework_Gen5 {   \n      meta:   \n         description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         super_rule = 1   \n         hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"   \n         hash2 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"   \n         hash3 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"   \n      strings:   \n         $s1 = \"if ($ExeArgs -ne $null -and $ExeArgs -ne '')\" fullword ascii   \n         $s2 = \"$ExeArgs = \\\"ReflectiveExe $ExeArgs\\\"\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 1000KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467234
		},
		{
			"indicator": "3c55f491d4121623875b49a0b74428304c3bf1df",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_Gen {   \n      meta:   \n         description = \"Detects Empire component - from files Invoke-DCSync.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         super_rule = 1   \n         hash1 = \"a3428a7d4f9e677623fadff61b2a37d93461123535755ab0f296aa3b0396eb28\"   \n         hash2 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"   \n         hash3 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"   \n      strings:   \n         $s1 = \"$Shellcode1 += 0x48\" fullword ascii   \n         $s2 = \"$PEHandle = [IntPtr]::Zero\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 3000KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467235
		},
		{
			"indicator": "053965cfb400952ee40d81d93a1be3db62f658ba",
			"description": "",
			"title": "",
			"content": "rule Empire_Agent_Gen {   \n      meta:   \n         description = \"Detects Empire component - from files agent.ps1, agent.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         super_rule = 1   \n         hash1 = \"380fd09bfbe47d5c8c870c1c97ff6f44982b699b55b61e7c803d3423eb4768db\"   \n         hash2 = \"380fd09bfbe47d5c8c870c1c97ff6f44982b699b55b61e7c803d3423eb4768db\"   \n      strings:   \n         $s1 = \"$wc.Headers.Add(\\\"User-Agent\\\",$script:UserAgent)\" fullword ascii   \n         $s2 = \"$min = [int]((1-$script:AgentJitter)*$script:AgentDelay)\" fullword ascii   \n         $s3 = \"if ($script:AgentDelay -ne 0){\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x660a and filesize < 100KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467236
		},
		{
			"indicator": "04a6e29c071d189c66a1a540eabf5dcd236af0ea",
			"description": "",
			"title": "",
			"content": "rule Empire_PowerShell_Framework_Gen1 {   \n      meta:   \n         description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-DCSync.ps1, Invoke-Mimikatz.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         super_rule = 1   \n         hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"   \n         hash2 = \"a3428a7d4f9e677623fadff61b2a37d93461123535755ab0f296aa3b0396eb28\"   \n         hash3 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"   \n         hash4 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"   \n         hash5 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"   \n      strings:   \n         $s1 = \"Write-BytesToMemory -Bytes $Shellcode\" ascii   \n         $s2 = \"$GetCommandLineAAddrTemp = Add-SignedIntAsUnsigned $GetCommandLineAAddrTemp ($Shellcode1.Length)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467237
		},
		{
			"indicator": "d18c35f300a8bb002161cc92bae47322f98ee342",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_EgressCheck {   \n      meta:   \n         description = \"Detects Empire component - file Invoke-EgressCheck.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"e2d270266abe03cfdac66e6fc0598c715e48d6d335adf09a9ed2626445636534\"   \n      strings:   \n         $s1 = \"egress -ip $ip -port $c -delay $delay -protocol $protocol\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x233c and filesize < 10KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467238
		},
		{
			"indicator": "779527690a5f285fc1206863b39839d449314f78",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_CredentialInjection_Invoke_Mimikatz_Gen {   \n      meta:   \n         description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-Mimikatz.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         super_rule = 1   \n         hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"   \n         hash2 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"   \n      strings:   \n         $s1 = \"$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs -RemoteProcHandle $RemoteProcHandle\" fullword ascii   \n         $s2 = \"$PELoadedInfo = Invoke-MemoryLoadLibrary -PEBytes $PEBytes -ExeArgs $ExeArgs\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467239
		},
		{
			"indicator": "295114da32fa77f8209c1923004ff1d56ad9c8dd",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_SSHCommand {   \n      meta:   \n         description = \"Detects Empire component - file Invoke-SSHCommand.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"cbaf086b14d5bb6a756cbda42943d4d7ef97f8277164ce1f7dd0a1843e9aa242\"   \n      strings:   \n         $s1 = \"$Base64 = 'TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAA\" ascii   \n         $s2 = \"Invoke-SSHCommand -ip 192.168.1.100 -Username root -Password test -Command \\\"id\\\"\" fullword ascii   \n         $s3 = \"Write-Verbose \\\"[*] Error loading dll\\\"\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x660a and filesize < 2000KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467240
		},
		{
			"indicator": "f0dbeb30f6b8a14f38ea418600e4b3001a8b5f0a",
			"description": "",
			"title": "",
			"content": "rule Empire_Get_SecurityPackages {   \n      meta:   \n         description = \"Detects Empire component - file Get-SecurityPackages.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"5d06e99121cff9b0fce74b71a137501452eebbcd1e901b26bde858313ee5a9c1\"   \n      strings:   \n         $s1 = \"$null = $EnumBuilder.DefineLiteral('LOGON', 0x2000)\" fullword ascii   \n         $s2 = \"$EnumBuilder = $ModuleBuilder.DefineEnum('SSPI.SECPKG_FLAG', 'Public', [Int32])\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 20KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467241
		},
		{
			"indicator": "aa03b0a206a3c9da47d48af1318f161e3172bcc0",
			"description": "",
			"title": "",
			"content": "rule Empire__Users_neo_code_Workspace_Empire_4sigs_PowerUp {   \n      meta:   \n         description = \"Detects Empire component - file PowerUp.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"ad9a5dff257828ba5f15331d59dd4def3989537b3b6375495d0c08394460268c\"   \n      strings:   \n         $x2 = \"$PoolPasswordCmd = 'c:\\\\windows\\\\system32\\\\inetsrv\\\\appcmd.exe list apppool\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x233c and filesize < 2000KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467242
		},
		{
			"indicator": "7350ef336ff813097fbe67da676952492dfcbd0f",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_MetasploitPayload {   \n      meta:   \n         description = \"Detects Empire component - file Invoke-MetasploitPayload.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"a85ca27537ebeb79601b885b35ddff6431860b5852c6a664d32a321782808c54\"   \n      strings:   \n         $s1 = \"$ProcessInfo.Arguments=\\\"-nop -c $DownloadCradle\\\"\" fullword ascii   \n         $s2 = \"$PowershellExe=$env:windir+'\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe'\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 9KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467243
		},
		{
			"indicator": "928ce1ca6b7214ddb411ddd8fd80dd269b5dd04c",
			"description": "",
			"title": "",
			"content": "rule Empire_Install_SSP {   \n      meta:   \n         description = \"Detects Empire component - file Install-SSP.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"7fd921a23950334257dda57b99e03c1e1594d736aab2dbfe9583f99cd9b1d165\"   \n      strings:   \n         $s1 = \"Install-SSP -Path .\\\\mimilib.dll\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 20KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467244
		},
		{
			"indicator": "5aebcf5475d2929b080eda75a0d030d354ab5979",
			"description": "",
			"title": "",
			"content": "rule Empire_Exploit_JBoss {   \n      meta:   \n         description = \"Detects Empire component - file Exploit-JBoss.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"9ea3e00b299e644551d90bbee0ce3e4e82445aa15dab7adb7fcc0b7f1fe4e653\"   \n      strings:   \n         $s1 = \"Exploit-JBoss\" fullword ascii   \n         $s2 = \"$URL = \\\"http$($SSL)://\\\" + $($Rhost) + ':' + $($Port)\" ascii   \n         $s3 = \"\\\"/jmx-console/HtmlAdaptor?action=invokeOp&name=jboss.system:service\" ascii   \n         $s4 = \"http://blog.rvrsh3ll.net\" fullword ascii   \n         $s5 = \"Remote URL to your own WARFile to deploy.\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 10KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467245
		},
		{
			"indicator": "de17817237f5946c0f7a4a5b776727b3d29ebf43",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_PostExfil {   \n      meta:   \n         description = \"Detects Empire component - file Invoke-PostExfil.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"00c0479f83c3dbbeff42f4ab9b71ca5fe8cd5061cb37b7b6861c73c54fd96d3e\"   \n      strings:   \n         $s1 = \"# upload to a specified exfil URI\" fullword ascii   \n         $s2 = \"Server path to exfil to.\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x490a and filesize < 2KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467246
		},
		{
			"indicator": "7429731a068172e1a03416e7df90d5ec13b7441c",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_InveighRelay_Gen {   \n      meta:   \n         description = \"Detects Empire component - from files Invoke-InveighRelay.ps1, Invoke-InveighRelay.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         super_rule = 1   \n         hash2 = \"21b90762150f804485219ad36fa509aeda210d46453307a9761c816040312f41\"   \n      strings:   \n         $s1 = \"$inveigh.SMBRelay_failed_list.Add(\\\"$HTTP_NTLM_domain_string\\\\$HTTP_NTLM_user_string $SMBRelayTarget\\\")\" fullword ascii   \n         $s2 = \"$NTLM_challenge_base64 = [System.Convert]::ToBase64String($HTTP_NTLM_bytes)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 200KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467247
		},
		{
			"indicator": "1fd8a6daf1e939d7e7dcbb2922e2437aed971d03",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_SmbScanner {   \n      meta:   \n         description = \"Detects Empire component - file Invoke-SmbScanner.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"9a705f30766279d1e91273cfb1ce7156699177a109908e9a986cc2d38a7ab1dd\"   \n      strings:   \n         $s1 = \"$up = Test-Connection -count 1 -Quiet -ComputerName $Computer \" fullword ascii   \n         $s2 = \"$out | add-member Noteproperty 'Password' $Password\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 10KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467248
		},
		{
			"indicator": "07cb560cfa585e3fdde6f217aa8939ff1a52d907",
			"description": "",
			"title": "",
			"content": "rule Empire_PowerShell_Framework_Gen4 {   \n      meta:   \n         description = \"Detects Empire component - from files Invoke-BypassUAC.ps1, Invoke-CredentialInjection.ps1, Invoke-CredentialInjection.ps1, Invoke-DCSync.ps1, Invoke-DllInjection.ps1, Invoke-Mimikatz.ps1, Invoke-PsExec.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1, Invoke-Shellcode.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         super_rule = 1   \n         hash1 = \"743c51334f17751cfd881be84b56f648edbdaf31f8186de88d094892edc644a9\"   \n         hash2 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"   \n         hash3 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"   \n         hash4 = \"a3428a7d4f9e677623fadff61b2a37d93461123535755ab0f296aa3b0396eb28\"   \n         hash5 = \"304031aa9eca5a83bdf1f654285d86df79cb3bba4aa8fe1eb680bd5b2878ebf0\"   \n         hash6 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"   \n         hash7 = \"0218be4323959fc6379489a6a5e030bb9f1de672326e5e5b8844ab5cedfdcf88\"   \n         hash8 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"   \n         hash9 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"   \n         hash10 = \"fa75cfd57269fbe3ad6bdc545ee57eb19335b0048629c93f1dc1fe1059f60438\"   \n      strings:   \n         $s1 = \"Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split('\\\\\\\\')[-1].Equals('System.dll') }\" fullword ascii   \n         $s2 = \"# Get a handle to the module specified\" fullword ascii   \n         $s3 = \"$Kern32Handle = $GetModuleHandle.Invoke($null, @($Module))\" fullword ascii   \n         $s4 = \"$DynAssembly = New-Object System.Reflection.AssemblyName('ReflectedDelegate')\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467249
		},
		{
			"indicator": "029e8292905abadb29e076ebdd96598b1eb5c28d",
			"description": "",
			"title": "",
			"content": "rule Empire_Get_GPPPassword {   \n      meta:   \n         description = \"Detects Empire component - file Get-GPPPassword.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"55a4519c4f243148a971e4860225532a7ce730b3045bde3928303983ebcc38b0\"   \n      strings:   \n         $s1 = \"$Base64Decoded = [Convert]::FromBase64String($Cpassword)\" fullword ascii   \n         $s2 = \"$XMlFiles += Get-ChildItem -Path \\\"\\\\\\\\$DomainController\\\\SYSVOL\\\" -Recurse\" ascii   \n         $s3 = \"function Get-DecryptedCpassword {\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 30KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467250
		},
		{
			"indicator": "65187ee0f00175fa92ef2090547f737e7039b426",
			"description": "",
			"title": "",
			"content": "rule Empire_ReflectivePick_x64_orig {   \n      meta:   \n         description = \"Detects Empire component - file ReflectivePick_x64_orig.dll\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"a8c1b108a67e7fc09f81bd160c3bafb526caf3dbbaf008efb9a96f4151756ff2\"   \n      strings:   \n         $s1 = \"\\\\PowerShellRunner.pdb\" fullword ascii   \n         $s2 = \"PowerShellRunner.dll\" fullword wide   \n         $s3 = \"ReflectivePick_x64.dll\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 400KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467251
		},
		{
			"indicator": "984513319e788415ede1d57394159a7a81662358",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_ShellcodeMSIL {   \n      meta:   \n         description = \"Detects Empire component - file Invoke-ShellcodeMSIL.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"9a9c6c9eb67bde4a8ce2c0858e353e19627b17ee2a7215fa04a19010d3ef153f\"   \n      strings:   \n         $s1 = \"$FinalShellcode.Length\" fullword ascii   \n         $s2 = \"@(0x60,0xE8,0x04,0,0,0,0x61,0x31,0xC0,0xC3)\" fullword ascii   \n         $s3 = \"@(0x41,0x54,0x41,0x55,0x41,0x56,0x41,0x57,\" fullword ascii   \n         $s4 = \"$TargetMethod.Invoke($null, @(0x11112222)) | Out-Null\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 30KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467252
		},
		{
			"indicator": "da131d8efb881aefa543088a56b7ceb3ca08a1b7",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_Portscan_Gen {   \n      meta:   \n         description = \"Detects Empire component - from files Invoke-Portscan.ps1, Invoke-Portscan.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         super_rule = 1   \n         hash2 = \"cf7030be01fab47e79e4afc9e0d4857479b06a5f68654717f3bc1bc67a0f38d3\"   \n      strings:   \n         $s1 = \"Test-Port -h $h -p $Port -timeout $Timeout\" fullword ascii   \n         $s2 = \"1 {$nHosts=10;  $Threads = 32;   $Timeout = 5000 }\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 100KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467253
		},
		{
			"indicator": "1b85fec13eeed3555e7441b2397fa4da5245351a",
			"description": "",
			"title": "",
			"content": "rule Empire_Get_Keystrokes {   \n      meta:   \n         description = \"Detects Empire component - file Get-Keystrokes.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"c36e71db39f6852f78df1fa3f67e8c8a188bf951e96500911e9907ee895bf8ad\"   \n      strings:   \n         $s1 = \"$RightMouse   = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::RButton) -band 0x8000) -eq 0x8000\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 30KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467254
		},
		{
			"indicator": "cc118fdcc4491f4be87380b103da5c3fe20468ab",
			"description": "",
			"title": "",
			"content": "rule Empire_PowerShell_Framework_Gen3 {   \n      meta:   \n         description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-Mimikatz.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         super_rule = 1   \n         hash1 = \"1be3e3ec0e364db0c00fad2c59c7041e23af4dd59c4cc7dc9dcf46ca507cd6c8\"   \n         hash2 = \"4725a57a5f8b717ce316f104e9472e003964f8eae41a67fd8c16b4228e3d00b3\"   \n         hash3 = \"61e5ca9c1e8759a78e2c2764169b425b673b500facaca43a26c69ff7e09f62c4\"   \n         hash4 = \"eaff29dd0da4ac258d85ecf8b042d73edb01b4db48c68bded2a8b8418dc688b5\"   \n      strings:   \n         $s1 = \"if (($PEInfo.FileType -ieq \\\"DLL\\\") -and ($RemoteProcHandle -eq [IntPtr]::Zero))\" fullword ascii   \n         $s2 = \"remote DLL injection\" ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 4000KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467255
		},
		{
			"indicator": "b8dd43fa80d407c976f324c503c4b66b9105aebc",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_DllInjection {   \n      meta:   \n         description = \"Detects Empire component - file Invoke-DllInjection.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"304031aa9eca5a83bdf1f654285d86df79cb3bba4aa8fe1eb680bd5b2878ebf0\"   \n      strings:   \n         $s1 = \"-Dll evil.dll\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7566 and filesize < 40KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467256
		},
		{
			"indicator": "bb347266831cc6053c66993941d45f1c23607ebe",
			"description": "",
			"title": "",
			"content": "rule Empire_Invoke_PowerDump {   \n      meta:   \n         description = \"Detects Empire component - file Invoke-PowerDump.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"095c5cf5c0c8a9f9b1083302e2ba1d4e112a410e186670f9b089081113f5e0e1\"   \n      strings:   \n         $x16 = \"$enc = Get-PostHashdumpScript\" fullword ascii   \n         $x19 = \"$lmhash = DecryptSingleHash $rid $hbootkey $enc_lm_hash $almpassword;\" fullword ascii   \n         $x20 = \"$rc4_key = $md5.ComputeHash($hbootkey[0..0x0f] + [BitConverter]::GetBytes($rid) + $lmntstr);\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x2023 and filesize < 60KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467257
		},
		{
			"indicator": "da6210c88969a546d106d337290a541357818b84",
			"description": "",
			"title": "",
			"content": "rule Empire_PowerUp_Gen {   \n      meta:   \n         description = \"Detects Empire component - from files PowerUp.ps1, PowerUp.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         super_rule = 1   \n         hash1 = \"ad9a5dff257828ba5f15331d59dd4def3989537b3b6375495d0c08394460268c\"   \n      strings:   \n         $s1 = \"$Result = sc.exe config $($TargetService.Name) binPath= $OriginalPath\" fullword ascii   \n         $s2 = \"$Result = sc.exe pause $($TargetService.Name)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x233c and filesize < 2000KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467258
		},
		{
			"indicator": "52a63273b5873c41efd3877a3bd81de50eca8961",
			"description": "",
			"title": "",
			"content": "rule Empire_Exploit_Jenkins {   \n      meta:   \n         description = \"Detects Empire component - file Exploit-Jenkins.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"a5182cccd82bb9984b804b365e07baba78344108f225b94bd12a59081f680729\"   \n      strings:   \n         $s1 = \"$postdata=\\\"script=println+new+ProcessBuilder%28%27\\\"+$($Cmd)+\\\"\" ascii   \n         $s2 = \"$url = \\\"http://\\\"+$($Rhost)+\\\":\\\"+$($Port)+\\\"/script\\\"\" fullword ascii   \n         $s3 = \"$Cmd = [System.Web.HttpUtility]::UrlEncode($Cmd)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x6620 and filesize < 7KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467259
		},
		{
			"indicator": "be57b0e3b52f21f427d138c2ff664513877779e6",
			"description": "",
			"title": "",
			"content": "rule Empire_KeePassConfig_Gen {   \n      meta:   \n         description = \"Detects Empire component - from files KeePassConfig.ps1, KeePassConfig.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         super_rule = 1   \n         hash2 = \"5a76e642357792bb4270114d7cd76ce45ba24b0d741f5c6b916aeebd45cff2b3\"   \n      strings:   \n         $s1 = \"$KeePassXML = [xml](Get-Content -Path $KeePassXMLPath)\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x7223 and filesize < 80KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467260
		},
		{
			"indicator": "c6e6f9595f0fd8eb0729cc9a7e9fd2d968f960c5",
			"description": "",
			"title": "",
			"content": "rule Empire_dumpCredStore {   \n      meta:   \n         description = \"Detects Empire component - file dumpCredStore.ps1\"   \n         author = \"Florian Roth\"   \n         reference = \"https://github.com/adaptivethreat/Empire\"   \n         date = \"2016-11-05\"   \n         hash1 = \"c1e91a5f9cc23f3626326dab2dcdf4904e6f8a332e2bce8b9a0854b371c2b350\"   \n      strings:   \n         $x1 = \"[DllImport(\\\"Advapi32.dll\\\", SetLastError = true, EntryPoint = \\\"CredReadW\\\"\" ascii   \n         $s12 = \"[String] $Msg = \\\"Failed to enumerate credentials store for user '$Env:UserName'\\\"\" fullword ascii   \n         $s15 = \"Rtn = CredRead(\\\"Target\\\", CRED_TYPE.GENERIC, out Cred);\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x233c and filesize < 40KB and 1 of them ) or all of them   \n   }",
			"type": "YARA",
			"id": 30467261
		},
		{
			"indicator": "d132d5e5bdbd551ae660033e5b28c182b46930ce",
			"description": "",
			"title": "",
			"content": "rule EnfalStrings : Enfal Family   \n   {   \n       meta:   \n           description = \"Enfal Identifying Strings\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-06-19\"   \n              \n       strings:   \n           $ = \"D:\\\\work\\\\\\xe6\\xba\\x90\\xe5\\x93\\xa5\\xe5\\x85\\x8d\\xe6\\x9d\\x80\\\\tmp\\\\Release\\\\ServiceDll.pdb\"   \n           $ = \"e:\\\\programs\\\\LuridDownLoader\"   \n           $ = \"LuridDownloader for Falcon\"   \n           $ = \"DllServiceTrojan\"   \n           $ = \"\\\\k\\\\\\xe6\\xa1\\x8c\\xe8\\x9d\\xa2\\\\\"   \n           $ = \"EtenFalcon\\xef\\xbc\\x88\\xe4\\xbf\\xae\\xe6\\x94\\xb9\\xef\\xbc\\x89\"   \n           $ = \"Madonna\\x00Jesus\"   \n           $ = \"/iupw82/netstate\"   \n           $ = \"fuckNodAgain\"   \n           $ = \"iloudermao\"   \n           $ = \"Crpq2.cgi\"   \n           $ = \"Clnpp5.cgi\"   \n           $ = \"Dqpq3ll.cgi\"   \n           $ = \"dieosn83.cgi\"   \n           $ = \"Rwpq1.cgi\"   \n           $ = \"/Ccmwhite\"   \n           $ = \"/Cmwhite\"   \n           $ = \"/Crpwhite\"   \n           $ = \"/Dfwhite\"   \n           $ = \"/Query.txt\"   \n           $ = \"/Ufwhite\"   \n           $ = \"/cgl-bin/Clnpp5.cgi\"   \n           $ = \"/cgl-bin/Crpq2.cgi\"   \n           $ = \"/cgl-bin/Dwpq3ll.cgi\"   \n           $ = \"/cgl-bin/Owpq4.cgi\"   \n           $ = \"/cgl-bin/Rwpq1.cgi\"   \n           $ = \"/trandocs/mm/\"   \n           $ = \"/trandocs/netstat\"   \n           $ = \"NFal.exe\"   \n           $ = \"LINLINVMAN\"   \n           $ = \"7NFP4R9W\"   \n              \n       condition:   \n           any of them   \n   }",
			"type": "YARA",
			"id": 30467293
		},
		{
			"indicator": "2c4fa3992f8843108d75535822b79cad14375cce",
			"description": "",
			"title": "",
			"content": "rule Enfal_Malware_Backdoor {   \n   \tmeta:   \n   \t\tdescription = \"Generic Rule to detect the Enfal Malware\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\tdate = \"2015/02/10\"   \n   \t\tsuper_rule = 1   \n   \t\thash0 = \"6d484daba3927fc0744b1bbd7981a56ebef95790\"   \n   \t\thash1 = \"d4071272cc1bf944e3867db299b3f5dce126f82b\"   \n   \t\thash2 = \"6c7c8b804cc76e2c208c6e3b6453cb134d01fa41\"   \n   \t\tscore = 60   \n   \tstrings:   \n   \t\t$mz = { 4d 5a }   \n   \t\t\t   \n   \t\t$x1 = \"Micorsoft Corportation\" fullword wide   \n   \t\t$x2 = \"IM Monnitor Service\" fullword wide   \n   \t\t   \n   \t\t$s1 = \"imemonsvc.dll\" fullword wide   \n   \t\t$s2 = \"iphlpsvc.tmp\" fullword   \n   \t\t   \n   \t\t$z1 = \"urlmon\" fullword   \n   \t\t$z2 = \"Registered trademarks and service marks are the property of their respec\" wide\t\t   \n   \t\t$z3 = \"XpsUnregisterServer\" fullword   \n   \t\t$z4 = \"XpsRegisterServer\" fullword   \n   \t\t$z5 = \"{53A4988C-F91F-4054-9076-220AC5EC03F3}\" fullword   \n   \tcondition:   \n   \t\t( $mz at 0 ) and    \n   \t\t(    \n   \t\t\t1 of ($x*) or    \n   \t\t\t( all of ($s*) and all of ($z*) )   \n   \t\t)   \n   }",
			"type": "YARA",
			"id": 30467294
		},
		{
			"indicator": "e45ed109e5c0d14ef4d874e8f473b259115f7a38",
			"description": "",
			"title": "",
			"content": "rule ce_enfal_cmstar_debug_msg   \n   {   \n       meta:   \n           Author      = \"rfalcone\"   \n           Date        = \"2015.05.10\"   \n           Description = \"Detects the static debug strings within CMSTAR\"   \n           Reference   = \"http://researchcenter.paloaltonetworks.com/2015/05/cmstar-downloader-lurid-and-enfals-new-cousin\"   \n      \n       strings:   \n           $d1 = \"EEE\\x0d\\x0a\" fullword   \n           $d2 = \"TKE\\x0d\\x0a\" fullword   \n           $d3 = \"VPE\\x0d\\x0a\" fullword   \n           $d4 = \"VPS\\x0d\\x0a\" fullword   \n           $d5 = \"WFSE\\x0d\\x0a\" fullword   \n           $d6 = \"WFSS\\x0d\\x0a\" fullword   \n           $d7 = \"CM**\\x0d\\x0a\" fullword   \n      \n       condition:   \n           uint16(0) == 0x5a4d and all of ($d*)   \n   }",
			"type": "YARA",
			"id": 30467295
		},
		{
			"indicator": "c9b5b484c3a839f51d5824e3327ac9fe034a2a02",
			"description": "",
			"title": "",
			"content": "rule Enfal_Malware {   \n   \tmeta:   \n   \t\tdescription = \"Detects a certain type of Enfal Malware\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"not set\"   \n   \t\tdate = \"2015/02/10\"   \n   \t\thash = \"9639ec9aca4011b2724d8e7ddd13db19913e3e16\"   \n   \t\tscore = 60   \n   \tstrings:   \n   \t\t$s0 = \"POWERPNT.exe\" fullword ascii   \n   \t\t$s1 = \"%APPDATA%\\\\Microsoft\\\\Windows\\\\\" fullword ascii   \n   \t\t$s2 = \"%HOMEPATH%\" fullword ascii   \n   \t\t$s3 = \"Server2008\" fullword ascii   \n   \t\t$s4 = \"Server2003\" fullword ascii   \n   \t\t$s5 = \"Server2003R2\" fullword ascii   \n   \t\t$s6 = \"Server2008R2\" fullword ascii   \n   \t\t$s9 = \"%HOMEDRIVE%\" fullword ascii   \n   \t\t$s13 = \"%ComSpec%\" fullword ascii   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 30467296
		},
		{
			"indicator": "d57de3c2bd5273dffbfbb2ad1836c9bf5d5931d2",
			"description": "",
			"title": "",
			"content": "rule ws_f0xy_downloader {   \n     meta:   \n       description = \"f0xy malware downloader\"   \n       author = \"Nick Griffin (Websense)\"   \n      \n     strings:   \n       $mz=\"MZ\"   \n       $string1=\"bitsadmin /transfer\"   \n       $string2=\"del rm.bat\"   \n       $string3=\"av_list=\"   \n        \n     condition:   \n       ($mz at 0) and (all of ($string*))   \n   }",
			"type": "YARA",
			"id": 30467311
		},
		{
			"indicator": "f42b576c3b5d8cd9275eb68b3cf0fffa71d5f843",
			"description": "",
			"title": "",
			"content": "rule HTMLVariant : FakeM Family HTML Variant   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Identifier for html variant of FAKEM\"   \n   \t\tauthor = \"Katie Kleemola\"   \n   \t\tlast_updated = \"2014-05-20\"   \n   \t   \n   \tstrings:   \n   \t\t// decryption loop   \n   \t\t$s1 = { 8B 55 08 B9 00 50 00 00 8D 3D ?? ?? ?? 00 8B F7 AD 33 C2 AB 83 E9 04 85 C9 75 F5 }   \n   \t\t//mov byte ptr [ebp - x] y, x: 0x10-0x1 y: 0-9,A-F   \n   \t\t$s2 = { C6 45 F? (3?|4?) }   \n      \n   \tcondition:   \n   \t\t$s1 and #s2 == 16   \n      \n   }",
			"type": "YARA",
			"id": 30467312
		},
		{
			"indicator": "1b4ec745b3129350b0b1ff92714615dba8cde2cd",
			"description": "",
			"title": "",
			"content": "rule FakeM_Generic {   \n   \tmeta:   \n   \t\tdescription = \"Detects FakeM malware samples\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"http://researchcenter.paloaltonetworks.com/2016/01/scarlet-mimic-years-long-espionage-targets-minority-activists/\"   \n   \t\tdate = \"2016-01-25\"   \n   \t\tscore = 85   \n   \t\thash1 = \"631fc66e57acd52284aba2608e6f31ba19e2807367e33d8704f572f6af6bd9c3\"   \n   \t\thash2 = \"3d9bd26f5bd5401efa17690357f40054a3d7b438ce8c91367dbf469f0d9bd520\"   \n   \t\thash3 = \"53af257a42a8f182e97dcbb8d22227c27d654bea756d7f34a80cc7982b70aa60\"   \n   \t\thash4 = \"4a4dfffae6fc8be77ac9b2c67da547f0d57ffae59e0687a356f5105fdddc88a3\"   \n   \t\thash5 = \"7bfbf49aa71b8235a16792ef721b7e4195df11cb75371f651595b37690d108c8\"   \n   \t\thash6 = \"12dedcdda853da9846014186e6b4a5d6a82ba0cf61d7fa4cbe444a010f682b5d\"   \n   \t\thash7 = \"9adda3d95535c6cf83a1ba08fe83f718f5c722e06d0caff8eab4a564185971c5\"   \n   \t\thash8 = \"3209ab95ca7ee7d8c0140f95bdb61a37d69810a7a23d90d63ecc69cc8c51db90\"   \n   \t\thash9 = \"41948c73b776b673f954f497e09cc469d55f27e7b6e19acb41b77f7e64c50a33\"   \n   \t\thash10 = \"53cecc0d0f6924eacd23c49d0d95a6381834360fbbe2356778feb8dd396d723e\"   \n   \t\thash11 = \"523ad50b498bfb5ab688d9b1958c8058f905b634befc65e96f9f947e40893e5b\"   \n   \tstrings:   \n   \t\t$a1 = \"\\\\system32\\\\kernel32.dll\" fullword ascii   \n   \t\t$a2 = \"\\\\boot.lnk\" fullword ascii   \n   \t\t$a3 = \"%USERPROFILE%\" fullword ascii /* Goodware String - occured 16 times */   \n      \n   \t\t$b1 = \"Wizard.EXE\" fullword wide   \n   \t\t$b2 = \"CommandLineA\" fullword ascii   \n      \n   \t\t$c1 = \"\\\\system32\\\\kernel32.dll\" fullword ascii   \n   \t\t$c2 = \"\\\\aapz.tmp\" fullword ascii   \n      \n   \t\t$e1 = \"C:\\\\Documents and Settings\\\\A\\\\\" fullword ascii   \n   \t\t$e2 = \"\\\\svchost.exe\" fullword ascii   \n   \t\t$e3 = \"\\\\Perform\\\\Release\\\\Perform.pdb\" fullword ascii   \n      \n   \t\t$f1 = \"Browser.EXE\" fullword wide   \n   \t\t$f2 = \"\\\\browser.exe\" fullword ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and filesize < 100KB and   \n   \t\t( all of ($a*) or all of ($b*) or all of ($c*) or all of ($e*) or 1 of ($f*) )   \n   }",
			"type": "YARA",
			"id": 30467313
		},
		{
			"indicator": "459e15969a272d333d04d1688112e665049b00f4",
			"description": "",
			"title": "",
			"content": "rule Fareit_Trojan_Oct15 {   \n   \tmeta:   \n   \t\tdescription = \"Detects Fareit Trojan from Sep/Oct 2015 Wave\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"http://goo.gl/5VYtlU\"   \n   \t\tdate = \"2015-10-18\"   \n   \t\tscore = 80   \n   \t\tsuper_rule = 1   \n   \t\thash1 = \"230ca0beba8ae712cfe578d2b8ec9581ce149a62486bef209b04eb11d8c088c3\"   \n   \t\thash2 = \"3477d6bfd8313d37fedbd3d6ba74681dd7cb59040cabc2991655bdce95a2a997\"   \n   \t\thash3 = \"408fa0bd4d44de2940605986b554e8dab42f5d28a6a525b4bc41285e37ab488d\"   \n   \t\thash4 = \"76669cbe6a6aac4aa52dbe9d2e027ba184bf3f0b425f478e8c049637624b5dae\"   \n   \t\thash5 = \"9486b73eac92497e703615479d52c85cfb772b4ca6c846ef317729910e7c545f\"   \n   \t\thash6 = \"c3300c648aebac7bf1d90f58ea75660c78604410ca0fa705d3b8ec1e0a45cdd9\"   \n   \t\thash7 = \"ff83e9fcfdec4ffc748e0095391f84a8064ac958a274b9684a771058c04cb0fa\"   \n   \tstrings:   \n   \t\t$s1 = \"ebai.exe\" fullword wide   \n   \t\t$s2 = \"Origina\" fullword wide   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and $s1 in (0..30000) and $s2 in (0..30000)   \n   }",
			"type": "YARA",
			"id": 30467325
		},
		{
			"indicator": "906b6d3a9bcf91b2b9feb627d073be5e8f9d4cb1",
			"description": "",
			"title": "",
			"content": "rule FavoriteStrings : Favorite Family   \n   {   \n       meta:   \n           description = \"Favorite Identifying Strings\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-06-24\"   \n              \n       strings:   \n           $string1 = \"!QAZ4rfv\"   \n           $file1 = \"msupdater.exe\"   \n           $file2 = \"FAVORITES.DAT\"   \n              \n       condition:   \n          any of ($string*) or all of ($file*)   \n   }",
			"type": "YARA",
			"id": 30502541
		},
		{
			"indicator": "04f453dd6ca6717d19ef352d5bf0f13a288596dc",
			"description": "",
			"title": "",
			"content": "rule FavoriteCode : Favorite Family    \n   {   \n       meta:   \n           description = \"Favorite code features\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-06-24\"   \n          \n       strings:   \n           // standard string hiding   \n           $ = { C6 45 ?? 3B C6 45 ?? 27 C6 45 ?? 34 C6 45 ?? 75 C6 45 ?? 6B C6 45 ?? 6C C6 45 ?? 3B C6 45 ?? 2F }   \n           $ = { C6 45 ?? 6F C6 45 ?? 73 C6 45 ?? 73 C6 45 ?? 76 C6 45 ?? 63 C6 45 ?? 65 C6 45 ?? 78 C6 45 ?? 65 }   \n          \n       condition:   \n           any of them   \n   }",
			"type": "YARA",
			"id": 30502542
		},
		{
			"indicator": "0284370f609fe70cf7fc797f6a2b89b898fd7ef1",
			"description": "",
			"title": "",
			"content": "rule Gafgyt_Botnet_generic : MALW   \n   {   \n   meta:   \n   description = \"Gafgyt Trojan\"   \n   author = \"Joan Soriano / @joanbtl\"   \n   date = \"2017-05-01\"   \n   version = \"1.0\"   \n   MD5 = \"e3fac853203c3f1692af0101eaad87f1\"   \n   SHA1 = \"710781e62d49419a3a73624f4a914b2ad1684c6a\"   \n      \n   strings:   \n   \t$etcTZ = \"/bin/busybox;echo -e 'gayfgt'\"   \n   \t$s2 = \"/proc/net/route\"   \n   \t$s3 = \"admin\"   \n   \t$s4 = \"root\"   \n      \n   condition:   \n   \t$etcTZ and $s2 and $s3 and $s4   \n   }",
			"type": "YARA",
			"id": 30502543
		},
		{
			"indicator": "92446b8e251e1137ea1e985e1d363ae4dec53efb",
			"description": "",
			"title": "",
			"content": "rule Gafgyt_Botnet_oh : MALW   \n   {   \n   meta:   \n   description = \"Gafgyt Trojan\"   \n   author = \"Joan Soriano / @joanbtl\"   \n   date = \"2017-05-025\"   \n   version = \"1.0\"   \n   MD5 = \"97f5edac312de349495cb4afd119d2a5\"   \n   SHA1 = \"916a51f2139f11e8be6247418dca6c41591f4557\"   \n      \n       strings:   \n               $s1 = \"busyboxterrorist\"   \n               $s2 = \"BOGOMIPS\"   \n               $s3 = \"124.105.97.%d\"   \n               $s4 = \"fucknet\"   \n       condition:   \n               $s1 and $s2 and $s3 and $s4   \n   }",
			"type": "YARA",
			"id": 30502544
		},
		{
			"indicator": "5e1826235c629f915cb8a3312dd1bd7f74136c14",
			"description": "",
			"title": "",
			"content": "rule Gafgyt_Botnet_jackmy : MALW   \n   {   \n   meta:   \n   description = \"Gafgyt Trojan\"   \n   author = \"Joan Soriano / @joanbtl\"   \n   date = \"2017-05-25\"   \n   version = \"1.0\"   \n   MD5 = \"419b8a10a3ac200e7e8a0c141b8abfba\"   \n   SHA1 = \"5433a5768c5d22dabc4d133c8a1d192d525939d5\"   \n      \n       strings:   \n               $s1 = \"PING\"   \n               $s2 = \"PONG\"   \n               $s3 = \"jackmy\"            \n               $s4 = \"203.134.%d.%d\"          \n       condition:   \n               $s1 and $s2 and $s3 and $s4   \n   }",
			"type": "YARA",
			"id": 30502545
		},
		{
			"indicator": "9d2b252a4ec4bd3dcd93c8e77bb47d297388f2d2",
			"description": "",
			"title": "",
			"content": "rule Gafgyt_Botnet_hoho : MALW   \n   {   \n   meta:   \n   description = \"Gafgyt Trojan\"   \n   author = \"Joan Soriano / @joanbtl\"   \n   date = \"2017-05-25\"   \n   version = \"1.0\"   \n   MD5 = \"369c7c66224b343f624803d595aa1e09\"   \n   SHA1 = \"54519d2c124cb536ed0ddad5683440293d90934f\"   \n      \n       strings:   \n               $s1 = \"PING\"   \n               $s2 = \"PRIVMSG\"   \n               $s3 = \"Remote IRC Bot\"   \n               $s4 = \"23.95.43.182\"   \n       condition:   \n               $s1 and $s2 and $s3 and $s4   \n   }",
			"type": "YARA",
			"id": 30502546
		},
		{
			"indicator": "51f5fdc83a10405577322bc28cf3446f70070758",
			"description": "",
			"title": "",
			"content": "rule Gafgyt_Botnet_HIHI: MALW   \n   {   \n   meta:   \n   description = \"Gafgyt Trojan\"   \n   author = \"Joan Soriano / @joanbtl\"   \n   date = \"2017-05-01\"   \n   version = \"1.0\"   \n   MD5 = \"cc99e8dd2067fd5702a4716164865c8a\"   \n   SHA1 = \"b9b316c1cc9f7a1bf8c70400861de08d95716e49\"   \n      \n       strings:   \n               $s1 = \"PING\"   \n               $s2 = \"PONG\"   \n               $s3 = \"TELNET LOGIN CRACKED - %s:%s:%s\"   \n               $s4 = \"ADVANCEDBOT\"   \n               $s5 = \"46.166.185.92\"   \n               $s6 = \"LOLNOGTFO\"   \n      \n       condition:   \n               $s1 and $s2 and $s3 and $s4 and $s5 and $s6   \n   }",
			"type": "YARA",
			"id": 30502547
		},
		{
			"indicator": "c61425a49571b3ed44f06fce40f8ac3ff2289bd0",
			"description": "",
			"title": "",
			"content": "rule Gafgyt_Botnet_bash : MALW   \n   {   \n   meta:   \n   description = \"Gafgyt Trojan\"   \n   author = \"Joan Soriano / @joanbtl\"   \n   date = \"2017-05-25\"   \n   version = \"1.0\"   \n   MD5 = \"c8d58acfe524a09d4df7ffbe4a43c429\"   \n   SHA1 = \"b41fefa8470f3b3657594af18d2ea4f6ac4d567f\"   \n      \n       strings:   \n               $s1 = \"PONG!\"   \n               $s2 = \"GETLOCALIP\"   \n               $s3 = \"HTTPFLOOD\"   \n               $s4 = \"LUCKYLILDUDE\"   \n       condition:   \n               $s1 and $s2 and $s3 and $s4   \n   }",
			"type": "YARA",
			"id": 30502548
		},
		{
			"indicator": "d63df4394378a67a0ab42fdf273d837db84cc7e7",
			"description": "",
			"title": "",
			"content": "rule GoziRule : Gozi Family {   \n   meta:   \n       description = \"Win32.Gozi\"   \n       author = \"CCN-CERT\"   \n       version = \"1.0\"   \n       ref = \"https://www.ccn-cert.cni.es/informes/informes-ccn-cert-publicos.html\"   \n   strings:   \n       $ = {63 00 6F 00 6F 00 6B 00 69 00 65 00 73 00 2E 00 73 00 71 00 6C 00 69 00 74 00 65 00 2D 00 6A 00 6F 00 75 00 72 00 6E 00 61 00 6C 00 00 00 4F 50 45 52 41 2E 45 58 45 00}   \n   condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 30502583
		},
		{
			"indicator": "6f6647ad56ac0dee2accb454bd1fb1abf4c98ca0",
			"description": "",
			"title": "",
			"content": "rule moleransomware_campaign {   \n   strings:   \n   $a = \"Decrypting of your files is only possible with the private key and decrypt program, which is on our secret server.\" nocase wide ascii   \n   $b = \"click on the chrome_font.exe\" nocase wide ascii   \n      \n   condition:   \n   any of them   \n   }",
			"type": "YARA",
			"id": 30513754
		},
		{
			"indicator": "919586a586112769532ec71eb5857e435e143494",
			"description": "",
			"title": "",
			"content": "rule Backdoor_Jolob   \n   {   \n   \tmeta:   \n   \t\tmaltype = \"Backdoor.Jolob\"   \n       ref = \"https://github.com/reed1713\"   \n   \t\treference = \"http://www.symantec.com/connect/blogs/new-flash-zero-day-linked-yet-more-watering-hole-attacks\"   \n   \t\tdescription = \"the backdoor registers an auto start service with the display name \\\"Network Access Management Agent\\\" pointing to the dll netfilter.dll. This is accomplished without notifying the user via the sysprep UAC bypass method.\"   \n   \tstrings:      \n   \t\t$type = \"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid = \"4673\"   \n   \t\t$data1 = \"Security\"   \n   \t\t$data2 = \"SeCreateGlobalPrivilege\"   \n   \t\t$data3 = \"Windows\\\\System32\\\\sysprep\\\\sysprep.exe\" nocase   \n              \n   \t\t$type1 = \"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid1 = \"4688\"   \n   \t\t$data4 = \"Windows\\\\System32\\\\sysprep\\\\sysprep.exe\" nocase   \n              \n   \t\t$type2 = \"Service Control Manager\"   \n   \t\t$eventid2 = \"7036\"   \n   \t\t$data5 = \"Network Access Management Agent\"   \n   \t\t$data6 = \"running\"   \n              \n   \t\t$type3 = \"Service Control Manager\"   \n   \t\t$eventid3 = \"7045\"   \n   \t\t$data7 = \"Network Access Management Agent\"   \n   \t\t$data8 = \"user mode service\"   \n   \t\t$data9 = \"auto start\"         \n       condition:   \n       \tall of them   \n   }",
			"type": "YARA",
			"id": 30515752
		},
		{
			"indicator": "d39a14043f5d0e071a1881343edafc3c53f606ee",
			"description": "",
			"title": "",
			"content": "rule KelihosHlux   \n   {   \n     meta:   \n   \tauthor = \"@malpush\"   \n   \tmaltype = \"KelihosHlux\"   \n   \tdescription = \"http://malwared.ru\"   \n   \tdate = \"22/02/2014\"   \n     strings:   \n       $KelihosHlux_HexString = { 73 20 7D 8B FE 95 E4 12 4F 3F 99 3F 6E C8 28 26 C2 41 D9 8F C1 6A 72 A6 CE 36 0F 73 DD 2A 72 B0 CC D1 07 8B 2B 98 73 0E 7E 8C 07 DC 6C 71 63 F4 23 27 DD 17 56 AE AB 1E 30 52 E7 54 51 F7 20 ED C7 2D 4B 72 E0 77 8E B4 D2 A8 0D 8D 6A 64 F9 B7 7B 08 70 8D EF F3 9A 77 F6 0D 88 3A 8F BB C8 89 F5 F8 39 36 BA 0E CB 38 40 BF 39 73 F4 01 DC C1 17 BF C1 76 F6 84 8F BD 87 76 BC 7F 85 41 81 BD C6 3F BC 39 BD C0 89 47 3E 92 BD 80 60 9D 89 15 6A C6 B9 89 37 C4 FF 00 3D 45 38 09 CD 29 00 90 BB B6 38 FD 28 9C 01 39 0E F9 30 A9 66 6B 19 C9 F8 4C 3E B1 C7 CB 1B C9 3A 87 3E 8E 74 E7 71 D1 }   \n         \n     condition:   \n       $KelihosHlux_HexString   \n   }",
			"type": "YARA",
			"id": 30536753
		},
		{
			"indicator": "58c266a536c37c5e07240f281598c7c9ffad56b8",
			"description": "",
			"title": "",
			"content": "rule korlia   \n   {    \n   meta:   \n   author = \"Nick Hoffman\"    \n   company = \"Morphick\"   \n   reference = \"http://www.morphick.com/resources/lab-blog/curious-korlia\"   \n   information = \"korlia malware found in apt dump\"    \n      \n   //case a   \n   //b2 1f mov dl, 0x1f ; mov key (wildcard)    \n   // -----------------    \n   //8A 86 98 40 00 71 mov al, byte ptr url[esi]   \n   //BF 98 40 00 71 mov edi, offset url    \n   //32 C2 xor al, dl    \n   //83 C9 FF or ecx, 0FFFFFFFFh    \n   //88 86 98 40 00 71 mov byte ptr url[esi], al    \n   //33 C0 xor eax, eax    \n   //46 inc esi    \n   //F2 AE repne scasb    \n   //F7 D1 not ecx    \n   //49 dec ecx    \n   //3B F1 cmp esi, ecx    \n   //72 DE jb short loc_71001DE0   \n      \n   //case b (variant of loop a)    \n   //8A 8A 28 50 40 00 mov cl, byte_405028[edx]    \n   //BF 28 50 40 00 mov edi, offset byte_405028    \n   //32 CB xor cl, bl    \n   //33 C0 xor eax, eax    \n   //88 8A 28 50 40 00 mov byte_405028[edx], cl   \n   //83 C9 FF or ecx, 0FFFFFFFFh    \n   //42 inc edx    \n   //F2 AE repne scasb    \n   //F7 D1 not ecx    \n   //49 dec ecx    \n   //3B D1 cmp edx, ecx    \n   //72 DE jb short loc_4047F2    \n      \n   //case c (not a variant of the above loop)    \n   //8A 0C 28 mov cl, [eax+ebp]    \n   //80 F1 28 xor cl, 28h    \n   //88 0C 28 mov [eax+ebp], cl    \n   //8B 4C 24 14 mov ecx, [esp+0D78h+var_D64]   \n   //40 inc eax    \n   //3B C1 cmp eax, ecx    \n   //7C EE jl short loc_404F1C    \n      \n   strings:   \n   $a = {b2 ?? 8A 86 98 40 00 71 BF 98 40 00 71 32 c2 83 C9 FF 88 86 98 40 00 71 33 C0 46 F2 AE F7 D1 49 3B F1}    \n   $b = {B3 ?? ?? ?? 8A 8A 28 50 40 00 BF 28 50 40 00 32 CB 33 C0 88 8A 28 50 40 00 83 C9 FF 42 F2 AE F7 D1 49 3B D1}    \n   $c = {8A 0C 28 80 F1 ?? 88 0C 28 8B 4C 24 14 40 3B C1}    \n   $d = {00 62 69 73 6F 6E 61 6C 00} //config marker \"\\x00bisonal\\x00\"   \n   condition:   \n   any of them    \n   }",
			"type": "YARA",
			"id": 30536754
		},
		{
			"indicator": "0fbcc8b75ac516520e38aaffb405f2adc14571d4",
			"description": "",
			"title": "",
			"content": "rule Korplug   \n   {    \n   \tmeta:   \n   \t\tmaltype = \"Korplug Backdoor\"   \n           author = \"https://github.com/reed1713\"   \n   \t\treference = \"http://www.symantec.com/connect/blogs/new-sample-backdoorkorplug-signed-stolen-certificate\"   \n   \t\tdescription = \"IOC looks for events associated with the KORPLUG Backdoor linked to the recent operation greedy wonk activity.\"   \n   \t\t   \n   \tstrings:   \n   \t\t$type=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid=\"4688\"   \n   \t\t$data=\"ProgramData\\\\RasTls\\\\RasTls.exe\"   \n      \n   \t\t$type1=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid1=\"4688\"   \n   \t\t$data1=\"ProgramData\\\\RasTls\\\\rundll32.exe\"   \n      \n   \t\t$type2=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid2=\"4688\"   \n   \t\t$data2=\"ProgramData\\\\RasTls\\\\svchost.exe\"   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 30536755
		},
		{
			"indicator": "662c8c460cadc8d76bab3014fccec768b7c1b7ac",
			"description": "",
			"title": "",
			"content": "rule Korplug_FAST {   \n       meta:   \n           description = \"Rule to detect Korplug/PlugX FAST variant\"   \n           author = \"Florian Roth\"   \n           date = \"2015-08-20\"   \n           hash = \"c437465db42268332543fbf6fd6a560ca010f19e0fd56562fb83fb704824b371\"   \n       strings:   \n           $x1 = \"%s\\\\rundll32.exe \\\"%s\\\", ShadowPlay\" fullword ascii   \n      \n           $a1 = \"ShadowPlay\" fullword ascii   \n      \n           $s1 = \"%s\\\\rundll32.exe \\\"%s\\\",\" fullword ascii   \n           $s2 = \"nvdisps.dll\" fullword ascii   \n           $s3 = \"%snvdisps.dll\" fullword ascii   \n           $s4 = \"\\\\winhlp32.exe\" fullword ascii   \n           $s5 = \"nvdisps_user.dat\" fullword ascii   \n           $s6 = \"%snvdisps_user.dat\" fullword ascii   \n       condition:   \n           uint16(0) == 0x5a4d and filesize < 500KB and    \n           (   \n               $x1 or   \n               ($a1 and 1 of ($s*)) or    \n               4 of ($s*)   \n           )   \n   }",
			"type": "YARA",
			"id": 30536756
		},
		{
			"indicator": "ad57e1e761dc24cbcc5d5453ffe345801a91ea59",
			"description": "",
			"title": "",
			"content": "rule Kovter   \n   {    \n   \tmeta:   \n   \t\tmaltype = \"Kovter\"   \n       reference = \"http://blog.airbuscybersecurity.com/post/2016/03/FILELESS-MALWARE-%E2%80%93-A-BEHAVIOURAL-ANALYSIS-OF-KOVTER-PERSISTENCE\"   \n   \t\tdate = \"9-19-2016\"   \n   \t\tdescription = \"fileless malware\"   \n   \tstrings:   \n   \t\t$type=\"Microsoft-Windows-Security-Auditing\" wide ascii   \n   \t\t$eventid=\"4688\" wide ascii   \n   \t\t$data=\"Windows\\\\System32\\\\regsvr32.exe\" wide ascii   \n   \t\t   \n   \t\t$type1=\"Microsoft-Windows-Security-Auditing\" wide ascii   \n   \t\t$eventid1=\"4689\" wide ascii   \n   \t\t$data1=\"Windows\\\\System32\\\\mshta.exe\" wide ascii   \n   \t\t   \n   \t\t$type2=\"Microsoft-Windows-Security-Auditing\" wide ascii   \n   \t\t$eventid2=\"4689\" wide ascii   \n   \t\t$data2=\"Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\" wide ascii   \n      \n   \t\t$type3=\"Microsoft-Windows-Security-Auditing\" wide ascii   \n   \t\t$eventid3=\"4689\" wide ascii   \n   \t\t$data3=\"Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\" wide ascii   \n      \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 30536758
		},
		{
			"indicator": "7502d2b4e7235d836074baf2c048431ddda0f105",
			"description": "",
			"title": "",
			"content": "rule Kraken_Bot_Sample : bot {   \n   \tmeta:   \n   \t\tdescription = \"Kraken Bot Sample - file inf.bin\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"https://blog.gdatasoftware.com/blog/article/dissecting-the-kraken.html\"   \n   \t\tdate = \"2015-05-07\"   \n   \t\thash = \"798e9f43fc199269a3ec68980eb4d91eb195436d\"   \n   \t\tscore = 90   \n   \tstrings:   \n   \t\t$s2 = \"%s=?getname\" fullword ascii   \n   \t\t$s4 = \"&COMPUTER=^\" fullword ascii   \n   \t\t$s5 = \"xJWFwcGRhdGElAA=\" fullword ascii /* base64 encoded string '%appdata%' */   \n   \t\t$s8 = \"JVdJTkRJUi\" fullword ascii /* base64 encoded string '%WINDIR' */   \n   \t\t$s20 = \"btcplug\" fullword ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and all of them   \n   }",
			"type": "YARA",
			"id": 30536759
		},
		{
			"indicator": "f292913b5aa7416b49c3970746b8625c4335a6df",
			"description": "",
			"title": "",
			"content": "rule LuaBot : MALW   \n   {   \n           meta:   \n                   description = \"LuaBot\"   \n                   author = \"Joan Soriano / @joanbtl\"   \n                   date = \"2017-06-07\"   \n                   version = \"1.0\"   \n                   MD5 = \"9df3372f058874fa964548cbb74c74bf\"   \n                   SHA1 = \"89226865501ee7d399354656d870b4a9c02db1d3\"   \n                   ref1 = \"http://blog.malwaremustdie.org/2016/09/mmd-0057-2016-new-elf-botnet-linuxluabot.html\"   \n      \n           strings:   \n                   $a = \"LUA_PATH\"   \n                   $b = \"Hi. Happy reversing, you can mail me: luabot@yandex.ru\"   \n                   $c = \"/tmp/lua_XXXXXX\"   \n                   $d = \"NOTIFY\"   \n                   $e = \"UPDATE\"   \n      \n           condition:   \n                   all of them   \n   }",
			"type": "YARA",
			"id": 30536762
		},
		{
			"indicator": "e1bb87306f8ad2d446a9413bdc381e412a37acf4",
			"description": "",
			"title": "",
			"content": "rule Rurktar   \n   {   \n   meta:   \n   author = \"Nathan Stern\"   \n   description = \"Rurktar detection rule\"   \n   strings:   \n    $a = \"FriendlyID\" wide ascii nocase   \n    $a2 = \"CaptureMode\" wide ascii nocase   \n    $a3 = \"CaptureStart\" wide ascii nocase   \n    $a4 = \"CaptureMonikerString\" wide ascii nocase   \n    $a5 = \"ACaptureMonikerString\" wide ascii nocase   \n    $a6 = \"VideoCap\" wide ascii nocase   \n    $a7 = \"SkipFrames\" wide ascii nocase   \n    $a8 = \"SkipDetectionFrames\" wide ascii nocase   \n    $a9 = \"SkipTakeFrames\" wide ascii nocase   \n    $a10 = \"DetectionPreBuffer\" wide ascii nocase   \n    $a11 = \"MaxCaptureFrames\" wide ascii nocase   \n    $a12 = \"MaxCaptureFolderSize\" wide ascii nocase   \n    $a13 = \"NetworkImageQ\" wide ascii nocase   \n    $a14 = \"CaptureDirectory\" wide ascii nocase   \n    $a15 = \"DefPass\" wide ascii nocase   \n    $a16 = \"CaptureStopProcess1\" wide ascii nocase   \n    $a17 = \"CaptureStopProcess2\" wide ascii nocase   \n    $a18 = \"DetectPorog\" wide ascii nocase   \n    $a19 = \"WatchFiles\" wide ascii nocase   \n    $a20 = \"AutoSendPreviews\" wide ascii nocase   \n    $a21 = \"ControlExt\" wide ascii nocase   \n    $a22 = \"SendOriginPreviews\" wide ascii nocase   \n    $a23 = \"CopyOriginsToCaptureDir\" wide ascii nocase   \n    $a24 = \"WatchProc\" wide ascii nocase   \n    $a25 = \"ScreenshotExt\" wide ascii nocase   \n    $a26 = \"ScreenshotAutoCapture\" wide ascii nocase   \n    $a27 = \"ScreenshotAutoStartProcess\" wide ascii nocase   \n    $a28 = \"ScreenshotPause\" wide ascii nocase   \n    $a29 = \"ProxyEnabled\" wide ascii nocase   \n    $b = \"\\\\R_C_S.ini\" wide ascii nocase   \n    $b2 = \"\\\\RCS.ini\" wide ascii nocase   \n    $b3 = \"RCS.log\" wide ascii nocase   \n    $b4 = \"RCSU.exe\" wide ascii nocase   \n    $b5 = \"RCS.log\" wide ascii nocase   \n    $c = \"?share*\" wide ascii nocase   \n    $c2 = \"?find*\" wide ascii nocase   \n    $c3 = \"user?\" wide ascii nocase   \n    $c4 = \"?prefs*\" wide ascii nocase   \n    $c5 = \"?type*abstract\" wide ascii nocase   \n    $c6 = \"?FriendlyID*\" wide ascii nocase   \n    $c7 = \"?disc*\" wide ascii nocase   \n   condition:   \n   5 of ($a*) or   \n   3 of ($b*) or   \n    4 of ($c*)   \n   }",
			"type": "YARA",
			"id": 30547932
		},
		{
			"indicator": "b27bf6e47584fe57e38a2244023d1752605cfa6a",
			"description": "",
			"title": "",
			"content": "rule GreenbugLsmPdbs {\n    meta:\n        reference = \"https://otx.alienvault.com/pulse/58862b1d066f9d7608a08593/\"\n        author = \"jaime.blasco@alienvault.com\"\n    strings:\n        $a = \"Bot Fresh.pdb\" wide ascii\n        $b = \"\\\\Ism.pdb\" wide ascii\n        $c = \"\\\\Nrtscan.pdb\" wide ascii\n        $d = \"\\\\hhhb3.pdb\" wide ascii\n        //$c1 = \"Command executed successfully\"\n        //$c2 = \"message=\"\n        //$c3 = \"filename=\"\n        //$c4 = \"appId=\"\n        //$c5 = \"DownloadFile\"\n    condition:\n        uint16(0) == 0x5A4D and (($a) or ($b) or ($c) or ($d)) \n}",
			"type": "YARA",
			"id": 30576931
		},
		{
			"indicator": "e943fc2395cd4adecbb797fc13c5bc9ef8cbbfe6",
			"description": "",
			"title": "",
			"content": "rule Linux_EternalMiner : LinuxMalware    \n   {   \n   \tmeta:    \n   \t\treference = \"06778ca06eb0be4a734a2908f3746764c148817707dbc32fad5f8dac6cc81e46,13a0ce618dcd0e17c7d8267174d07a997d39fcea10f8951ea7c0b5218ddcfe85\"   \n   \t\tauthor=\"jaime.blasco@alienvault.com\"   \n   \tstrings:   \n   \t\t$elf = {7f 45}   \n   \t\t$dstr = \"samba-root-shellcode.c\"   \n   \t\t$s1 = \"samba_init_module\"   \n   \t\t$s2 = \"change_to_root_user\"   \n   \t\t$s3 = \"getpid\"   \n   \t\t$s4 = \"payload\"   \n      \n   \tcondition:   \n   \t\t$elf at 0 and ($dstr or all of ($s*))   \n   }",
			"type": "YARA",
			"id": 30629993
		},
		{
			"indicator": "ec2e939ed735f083ad1195cd52978123b6a10c86",
			"description": "",
			"title": "",
			"content": "rule Elknot_malware   \n   {   \n    meta:   \n    author = \"Novetta Advanced Research Group\"   \n    description = \"Detection of the Elknot malware related to the Elasticsearch vulnerability attacks\"   \n    strings:   \n    $ = \"13CThreadAttack\"   \n    $ = \"%7s %llu %lu %lu %lu %lu %lu %lu %lu %llu %lu %lu %lu %lu %lu %lu\"   \n    $ = \"fake.cfg\"   \n    $ = \"[ %02d.%02d %02d:%02d:%02d.%03ld ] [%lu] [%s] %s\"   \n    condition:   \n    all of them   \n   }",
			"type": "YARA",
			"id": 30630001
		},
		{
			"indicator": "ea388664d8ad387eb5a3640e8187c5de69ab079b",
			"description": "",
			"title": "",
			"content": "rule Elknot_dropper   \n   {   \n    meta:   \n    author = \"Novetta Advanced Research Group\"   \n    description = \"Detection of the Elknot dropper related to the Elasticsearch vulnerability attacks after UPX is removed\"   \n    strings:   \n    $ = { 2F 70 72 6F 63 2F 73 65 6C 66 2F 65 78 65 00 63   \n    70 20 25 73 20 25 73 00 25 73 20 25 73 20 31 00   \n    63 70 20 25 73 20 25 73 61 00 }   \n    condition:   \n    all of them   \n   }",
			"type": "YARA",
			"id": 30630002
		},
		{
			"indicator": "feb29c4fdabfd3bad246df4242459be212411c77",
			"description": "",
			"title": "",
			"content": "rule BillGates   \n   {   \n   meta:   \n   author = \"Novetta Advanced Research Group\"   \n   description = \"Detection of the BillGates malware\"   \n   strings:   \n   $ = \"CThreadClientStatus\"   \n   $ = \"CLoopCmd\"   \n   $ = \"/tmp/gates.lock\"   \n   condition:   \n   all of them   \n   }",
			"type": "YARA",
			"id": 30630003
		},
		{
			"indicator": "e8260076a4d0fae2521eadc9744f135718a9bf67",
			"description": "",
			"title": "",
			"content": "rule penquinTurla1 : LinuxMalware    \n   {   \n   \tmeta:   \n   \t\tauthor = \"Alienvault Labs\"   \n   \t\treference = \"https://securelist.com/blog/research/67962/the-penquin-turla-2/\"   \n   \tstrings:   \n    \t$elf = {7f 45}   \n   \t\t$s1 = \"/tmp/.xdfg\"   \n   \t\t$s2 = \"Read or recive 0 status\"   \n   \t\t$s3 = \"TREX_PID=%u\"   \n      \n   \tcondition:   \n   \t\t$elf at 0 and all of ($s*)   \n      \n   }",
			"type": "YARA",
			"id": 30630016
		},
		{
			"indicator": "fed654cc7c3eea5d4c96ce48d7f1aaffb00e8a49",
			"description": "",
			"title": "",
			"content": "rule BackoffROM    \n   {   \n   \tmeta:   \n   \t\tauthor = \"Alienvault Labs\"   \n   \t\treference = \"http://blog.fortinet.com/post/rom-a-new-version-of-the-backoff-pos-malware\"   \n   \tstrings:   \n   \t\t$mz = {4d 5a}   \n   \t\t$mutex = \"aMD6qt7lWb1N3TNBSe4N\"   \n   \t\t$httpparam1 = \"data=%s\"   \n   \t\t$httpparam2 = \"oprat=%d\"   \n   \t\t$httpparam3 = \"uid=%s\"   \n   \t\t$httpparam4 = \"uinfo=%s\"   \n   \t\t$httpparam5 = \"win=%d\"   \n   \t\t$httpparam6 = \"grup=%s\"   \n   \t\t$httpparam7 = \"vers=%s\"   \n   \tcondition:   \n   \t\t($mz at 0) and ($mutex or all of ($httpparam*))   \n   }",
			"type": "YARA",
			"id": 30630038
		},
		{
			"indicator": "bcb652cc6552b949631ed0fd2654b522c6635d45",
			"description": "",
			"title": "",
			"content": "rule BackoffROMHashes   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Alienvault Labs\"   \n   \t\treference_hash = \"35fb5c75a5b472eb2c6fd059ca136a9e,01dd913425f36e56e42fec6f96282a3d\"   \n   \t\treference = \"http://blog.fortinet.com/post/rom-a-new-version-of-the-backoff-pos-malware\"   \n   \tstrings:   \n   \t\t$mz = {4d 5a}   \n   \t\t$func1 = {56 57 8B F9 33 F6 8B D6 85 FF ?? ?? 33 C0 ?? ?? 0F B7 0F 8B C6 66 85 C9 ?? ?? 66 83 F9 2E 0F 44 D0 40 0F B7 0C 47 66 85 C9 ?? ?? 85 D2 ?? ?? 8B D0 53 8B DE 85 D2 ?? ?? 8A 04 5F 0C 20 0F BE C8 03 F1 C1 E1 07 33 F1 43 3B DA}   \n   \t\t$func2 = {7E 7C 00 00 73 37 00 00 68 07 00 00 0A 31 00 00 C6 0C 00 00 2E 35 00 00 02 31 00 00 1A 34 00 00 88 03 00 00 1B 4F 00 00 2C 27 00 00 FB 0E 00 00 25 01 00 00 ED 0C 00 00 64 03 00 00 26 3F 00 00 16 36 00 00 1B 0B 00 00 34 34 00 00 84 08 00 00 07 0A 00 00 9A 0B 00 00 FD 72 00 00 7D 3D 00 00 F1 07 00 00 85 3F 00 00 99 2B 00 00 24 3C 00 00 55 6C 7B 6F 2F 29 00 00 6E 75 79 68 6E 4A 6D 6B 75 54 67 44 00 00 00 00 66 4F 68 4A 63 41 51 6B 36 4F 00 00}   \n   \tcondition:   \n   \t\t($mz at 0) and (any of ($func*))   \n   }",
			"type": "YARA",
			"id": 30630039
		},
		{
			"indicator": "8c5c07450c83b2719229aa5cb621a3e163bd4703",
			"description": "",
			"title": "",
			"content": "rule PoS_Malware_MalumPOS   \n   {   \n       meta:   \n           author = \"Trend Micro, Inc.\"   \n           date = \"2015-05-25\"   \n           description = \"Used to detect MalumPOS memory dumper\"   \n           sample_filtype = \"exe\"   \n       strings:   \n           $string1 = \"SOFTWARE\\\\Borland\\\\Delphi\\\\RTL\"   \n           $string2 = \"B)[0-9]{13,19}\\\\\"   \n           $string3 = \"[A-Za-z\\\\s]{0,30}\\\\/[A-Za-z\\\\s]{0,30}\\\\\"   \n           $string4 = \"TRegExpr(exec): ExecNext Without Exec[Pos]\"   \n           $string5 = /Y:\\\\PROGRAMS\\\\.{20,300}\\.pas/    \n       condition:   \n           all of ($string*)   \n   }",
			"type": "YARA",
			"id": 30688372
		},
		{
			"indicator": "9c797c5fa4e142124fa2196019015698801de1ba",
			"description": "",
			"title": "",
			"content": "rule sakula_v1_4: RAT   \n   {   \n       meta:   \n           description = \"Sakula v1.4\"   \n           date = \"2015-10-13\"   \n           author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"   \n       strings:   \n           $m1 = \"%d_of_%d_for_%s_on_%s\"   \n           $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"   \n           $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"   \n      \n           $v1_4 = { 50 E8 CD FC FF FF 83 C4  04 68 E8 03 00 00 FF D7 56 E8 54 12 00 00 E9 AE  FE FF FF E8 13 F5 FF FF }   \n      \n           $MZ = \"MZ\"   \n       condition:   \n           $MZ at 0 and all of them   \n   }",
			"type": "YARA",
			"id": 30690306
		},
		{
			"indicator": "b5722256e2ce4af26e62eb111a158418aa64d7ca",
			"description": "",
			"title": "",
			"content": "rule sakula_v1_0: RAT   \n   {   \n       meta:   \n           description = \"Sakula v1.0\"   \n           date = \"2015-10-13\"   \n           author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"   \n       strings:   \n           $m1 = \"%d_of_%d_for_%s_on_%s\"   \n           $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"   \n           $m3 = \"=%s&type=%d\"   \n           $m4 = \"?photoid=\"   \n           $m5 = \"iexplorer\"   \n                   $m6 = \"net start \\\"%s\\\"\"   \n           $v1_1 = \"MicroPlayerUpdate.exe\"   \n           $MZ = \"MZ\"   \n       condition:   \n           $MZ at 0 and all of ($m*) and not $v1_1   \n   }",
			"type": "YARA",
			"id": 30690307
		},
		{
			"indicator": "d9da1e0553b50f47d414249c02e0aa4d60ab0970",
			"description": "",
			"title": "",
			"content": "rule sakula_v1_3: RAT   \n   {   \n       meta:   \n           description = \"Sakula v1.3\"   \n           date = \"2015-10-13\"   \n           author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"   \n       strings:   \n           $m1 = \"%d_of_%d_for_%s_on_%s\"   \n           $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"   \n           $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"   \n      \n           $v1_3 = { 81 3E 78 03 00 00 75 57  8D 54 24 14 52 68 0C 05 41 00 68 01 00 00 80 FF  15 00 F0 40 00 85 C0 74 10 8B 44 24 14 68 2C 31  41 00 50 FF 15 10 F0 40 00 8B 4C 24 14 51 FF 15  24 F0 40 00 E8 0F 09 00 }   \n      \n           $MZ = \"MZ\"   \n       condition:   \n           $MZ at 0 and all of them   \n   }",
			"type": "YARA",
			"id": 30690308
		},
		{
			"indicator": "587a751ff33b175d663f198e34e8aed4f9d41c56",
			"description": "",
			"title": "",
			"content": "rule sakula_v1_1: RAT   \n   {   \n       meta:   \n           description = \"Sakula v1.1\"   \n           date = \"2015-10-13\"   \n           author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"   \n       strings:   \n           $m1 = \"%d_of_%d_for_%s_on_%s\"   \n           $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"   \n           $m3 = \"=%s&type=%d\"   \n           $m4 = \"?photoid=\"   \n           $m5 = \"iexplorer\"   \n                   $m6 = \"net start \\\"%s\\\"\"   \n           $v1_1 = \"MicroPlayerUpdate.exe\"   \n           $MZ = \"MZ\"   \n       condition:   \n           $MZ at 0 and all of them   \n   }",
			"type": "YARA",
			"id": 30690309
		},
		{
			"indicator": "e70409f91e4c0eb219d9394bf3076952fff442b1",
			"description": "",
			"title": "",
			"content": "rule sakula_v1_2: RAT   \n   {   \n       meta:   \n           description = \"Sakula v1.2\"   \n           date = \"2015-10-13\"   \n           author = \"Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou\"   \n       strings:   \n           $m1 = \"%d_of_%d_for_%s_on_%s\"   \n           $m2 = \"/c ping 127.0.0.1 & del /q \\\"%s\\\"\"   \n           $m3 = \"cmd.exe /c rundll32 \\\"%s\\\"\"   \n           $v1_1 = \"MicroPlayerUpdate.exe\"   \n           $v1_2 = \"CCPUpdate\"   \n      \n           $MZ = \"MZ\"   \n       condition:   \n           $MZ at 0 and $m1 and $m2 and $m3 and $v1_2 and not $v1_1   \n   }",
			"type": "YARA",
			"id": 30690310
		},
		{
			"indicator": "91d59dffcf7543e9fa5a6210a3bc44ebeca01f40",
			"description": "",
			"title": "",
			"content": "rule ursnif_stariks_pdb {   \n     strings:   \n       $a = \"stariks.pdb\" nocase wide ascii   \n     condition:   \n       any of them   \n   }",
			"type": "YARA",
			"id": 30841744
		},
		{
			"indicator": "478c8477107a8f2aafb0a2645460b774d85d9d52",
			"description": "",
			"title": "",
			"content": "rule leverage_a   \n   {   \n   \tmeta:   \n   \t\tauthor = \"earada@alienvault.com\"   \n   \t\tversion = \"1.0\"   \n   \t\tdescription = \"OSX/Leverage.A\"   \n   \t\tdate = \"2013/09\"   \n   \tstrings:   \n   \t\t$a1 = \"ioreg -l | grep \\\"IOPlatformSerialNumber\\\" | awk -F\"   \n   \t\t$a2 = \"+:Users:Shared:UserEvent.app:Contents:MacOS:\"   \n   \t\t$a3 = \"rm '/Users/Shared/UserEvent.app/Contents/Resources/UserEvent.icns'\"   \n   \t\t$script1 = \"osascript -e 'tell application \\\"System Events\\\" to get the hidden of every login item'\"   \n   \t\t$script2 = \"osascript -e 'tell application \\\"System Events\\\" to get the name of every login item'\"   \n   \t\t$script3 = \"osascript -e 'tell application \\\"System Events\\\" to get the path of every login item'\"   \n   \t\t$properties = \"serverVisible \\x00\"   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 30914918
		},
		{
			"indicator": "e12cebd4b1f980b143011148ea7f72ad3616a6b0",
			"description": "",
			"title": "",
			"content": "rule Mirai_SPARC_MSB : MALW   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Mirai Botnet TR-069 Worm - SPARC MSB\"    \n   \t\tauthor = \"Felipe Molina / @felmoltor\"   \n   \t\tdate = \"2016-12-04\"   \n   \t\tversion = \"1.0\"    \n   \t\tMD5= \"05891dbabc42a36f33c30535f0931555\"   \n   \t\tSHA1 = \"3d770480b6410cba39e19b3a2ff3bec774cabe47\"   \n   \t\tref1 = \"http://www.theregister.co.uk/2016/11/28/router_flaw_exploited_in_massive_attack/\"\t   \n   \t\tref2 = \"https://isc.sans.edu/forums/diary/Port+7547+SOAP+Remote+Code+Execution+Attack+Against+DSL+Modems/21759\"    \n   \t\tref3 = \"https://krebsonsecurity.com/2016/11/new-mirai-worm-knocks-900k-germans-offline/\"   \n      \n   \tstrings:   \n   \t\t$miname = \"Myname--is:\"   \n   \t\t$iptables1 = \"busybox iptables -A INPUT -p tcp --destination-port 7547 -j DROP\"   \n   \t\t$iptables2 = \"busybox iptables -A INPUT -p tcp --destination-port 5555 -j DROP\"   \n   \t\t$procnet = \"/proc/net/tcp\"   \n      \n   \tcondition:   \n   \t\t( $miname and $iptables1 and $iptables2 and $procnet )   \n   }",
			"type": "YARA",
			"id": 30927380
		},
		{
			"indicator": "e1ce32438aaca10ceff8d801e6aef1ebf6528940",
			"description": "",
			"title": "",
			"content": "rule Mirai_1 : MALW   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Mirai Variant 1\"   \n   \t\tauthor = \"Joan Soriano / @joanbtl\"   \n   \t\tdate = \"2017-04-16\"   \n   \t\tversion = \"1.0\"   \n   \t\tMD5 = \"655c3cf460489a7d032c37cd5b84a3a8\"   \n   \t\tSHA1 = \"4dd3803956bc31c8c7c504734bddec47a1b57d58\"   \n      \n   \tstrings:   \n   \t\t$dir1 = \"/dev/watchdog\"   \n   \t\t$dir2 = \"/dev/misc/watchdog\"   \n   \t\t$pass1 = \"PMMV\"   \n   \t\t$pass2 = \"FGDCWNV\"   \n   \t\t$pass3 = \"OMVJGP\"   \n   \tcondition:   \n   \t\t$dir1 and $pass1 and $pass2 and not $pass3 and not $dir2   \n      \n   }",
			"type": "YARA",
			"id": 30927381
		},
		{
			"indicator": "61a3b2fa95db32ea786c2507d8f53d4a8094bf69",
			"description": "",
			"title": "",
			"content": "rule Mirai_2 : MALW   \n   {   \n   meta:   \n   \tdescription = \"Mirai Variant 2\"   \n   \tauthor = \"Joan Soriano / @joanbtl\"   \n   \tdate = \"2017-04-16\"   \n   \tversion = \"1.0\"   \n   \tMD5 = \"0e5bda9d39b03ce79ab8d421b90c0067\"   \n   \tSHA1 = \"96f42a9fad2923281d21eca7ecdd3161d2b61655\"   \n      \n       strings:   \n   \t$dir1 = \"/dev/watchdog\"   \n   \t$dir2 = \"/dev/misc/watchdog\"   \n           $s1 = \"PMMV\"   \n           $s2 = \"ZOJFKRA\"   \n           $s3 = \"FGDCWNV\"   \n           $s4 = \"OMVJGP\"   \n       condition:   \n           $dir1 and $dir2 and $s1 and $s2 and $s3 and not $s4    \n      \n   }",
			"type": "YARA",
			"id": 30927382
		},
		{
			"indicator": "2a710a8e38f40b8f37d59b86de1ea1d61d9016f3",
			"description": "",
			"title": "",
			"content": "rule Mirai_MIPS_LSB : MALW   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Mirai Botnet TR-069 Worm - MIPS LSB\"    \n   \t\tauthor = \"Felipe Molina / @felmoltor\"   \n   \t\tdate = \"2016-12-04\"   \n   \t\tversion = \"1.0\"    \n   \t\tMD5 = \"bf650d39eb603d92973052ca80a4fdda\"   \n   \t\tSHA1 = \"03ecd3b49aa19589599c64e4e7a51206a592b4ef\"   \n   \t\tref1 = \"http://www.theregister.co.uk/2016/11/28/router_flaw_exploited_in_massive_attack/\"\t   \n   \t\tref2 = \"https://isc.sans.edu/forums/diary/Port+7547+SOAP+Remote+Code+Execution+Attack+Against+DSL+Modems/21759\"    \n   \t\tref3 = \"https://krebsonsecurity.com/2016/11/new-mirai-worm-knocks-900k-germans-offline/\"   \n      \n   \tstrings:   \n   \t\t$miname = \"Myname--is:\"   \n   \t\t$iptables1 = \"busybox iptables -A INPUT -p tcp --destination-port 7547 -j DROP\"   \n   \t\t$iptables2 = \"busybox iptables -A INPUT -p tcp --destination-port 5555 -j DROP\"   \n   \t\t$procnet = \"/proc/net/tcp\"   \n      \n   \tcondition:   \n   \t\t$miname and $iptables1 and $iptables2 and $procnet   \n   }",
			"type": "YARA",
			"id": 30927383
		},
		{
			"indicator": "0e6105298e24746e4046927f81bfd92a515c63bc",
			"description": "",
			"title": "",
			"content": "rule Mirai_Renesas_SH : MALW   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Mirai Botnet TR-069 Worm - Renesas SH LSB\"    \n   \t\tauthor = \"Felipe Molina / @felmoltor\"   \n   \t\tdate = \"2016-12-04\"   \n   \t\tversion = \"1.0\"    \n   \t\tMD5 = \"863dcf82883c885b0686dce747dcf502\"   \n   \t\tSHA1 = \"bdc86295fad70480f0c6edcc37981e3cf11d838c\"   \n   \t\tref1 = \"http://www.theregister.co.uk/2016/11/28/router_flaw_exploited_in_massive_attack/\"\t   \n   \t\tref2 = \"https://isc.sans.edu/forums/diary/Port+7547+SOAP+Remote+Code+Execution+Attack+Against+DSL+Modems/21759\"    \n   \t\tref3 = \"https://krebsonsecurity.com/2016/11/new-mirai-worm-knocks-900k-germans-offline/\"   \n      \n   \tstrings:   \n   \t\t$miname = \"Myname--is:\"   \n   \t\t$iptables1 = \"busybox iptables -A INPUT -p tcp --destination-port 7547 -j DROP\"   \n   \t\t$iptables2 = \"busybox iptables -A INPUT -p tcp --destination-port 5555 -j DROP\"   \n   \t\t$procnet = \"/proc/net/tcp\"   \n      \n   \tcondition:   \n   \t\t$miname and $iptables1 and $iptables2 and $procnet   \n   }",
			"type": "YARA",
			"id": 30927384
		},
		{
			"indicator": "6cb759a447935ba07c688545808083bfd9cbb525",
			"description": "",
			"title": "",
			"content": "rule Mirai_4 : MALW   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Mirai Variant 4\"   \n   \t\tauthor = \"Joan Soriano / @joanbtl\"   \n   \t\tdate = \"2017-04-16\"   \n   \t\tversion = \"1.0\"   \n   \t\tMD5 = \"f832ef7a4fcd252463adddfa14db43fb\"   \n   \t\tSHA1 = \"4455d237aadaf28aafce57097144beac92e55110\"   \n   \tstrings:   \n   \t\t$s1 = \"210765\"   \n   \t\t$s2 = \"qllw\"   \n   \t\t$s3 = \";;;;;;\"   \n   \tcondition:   \n   \t\t$s1 and $s2 and $s3   \n   }",
			"type": "YARA",
			"id": 30927385
		},
		{
			"indicator": "d91ef230834a66f021dccc1fac4988be52b6d93d",
			"description": "",
			"title": "",
			"content": "rule Mirai_PPC_Cisco : MALW   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Mirai Botnet TR-069 Worm - PowerPC or Cisco 4500\"    \n   \t\tauthor = \"Felipe Molina / @felmoltor\"   \n   \t\tdate = \"2016-12-04\"   \n   \t\tversion = \"1.0\"    \n   \t\tMD5= \"dbd92b08cbff8455ff76c453ff704dc6\"   \n   \t\tSHA1 = \"6933d555a008a07b859a55cddb704441915adf68\"   \n   \t\tref1 = \"http://www.theregister.co.uk/2016/11/28/router_flaw_exploited_in_massive_attack/\"\t   \n   \t\tref2 = \"https://isc.sans.edu/forums/diary/Port+7547+SOAP+Remote+Code+Execution+Attack+Against+DSL+Modems/21759\"    \n   \t\tref3 = \"https://krebsonsecurity.com/2016/11/new-mirai-worm-knocks-900k-germans-offline/\"   \n      \n   \tstrings:   \n   \t\t$miname = \"Myname--is:\"   \n   \t\t$iptables1 = \"busybox iptables -A INPUT -p tcp --destination-port 7547 -j DROP\"   \n   \t\t$iptables2 = \"busybox iptables -A INPUT -p tcp --destination-port 5555 -j DROP\"   \n   \t\t$procnet = \"/proc/net/tcp\"   \n      \n   \tcondition:   \n   \t\t( $miname and $iptables1 and $iptables2 and $procnet )   \n   }",
			"type": "YARA",
			"id": 30927386
		},
		{
			"indicator": "0b8d4b25f8b397441db12bfd1acfdafb61ddc8e9",
			"description": "",
			"title": "",
			"content": "rule Mirai_3 : MALW   \n   {   \n       meta:   \n   \tdescription = \"Mirai Variant 3\"   \n   \tauthor = \"Joan Soriano / @joanbtl\"   \n   \tdate = \"2017-04-16\"   \n   \tversion = \"1.0\"   \n   \tMD5 = \"bb22b1c921ad8fa358d985ff1e51a5b8\"   \n   \tSHA1 = \"432ef83c7692e304c621924bc961d95c4aea0c00\"   \n      \n       strings:   \n               $dir1 = \"/dev/watchdog\"   \n               $dir2 = \"/dev/misc/watchdog\"   \n               $s1 = \"PMMV\"   \n               $s2 = \"ZOJFKRA\"   \n               $s3 = \"FGDCWNV\"   \n               $s4 = \"OMVJGP\"   \n   \t    $ssl = \"ssl3_ctrl\"   \n       condition:   \n               $dir1 and $dir2 and $s1 and $s2 and $s3 and $s4 and not $ssl   \n      \n   }",
			"type": "YARA",
			"id": 30927387
		},
		{
			"indicator": "a369721691f0d1646c678f8b253b3bd7aea201f5",
			"description": "",
			"title": "",
			"content": "rule Mirai_Dwnl : MALW   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Mirai Downloader\"   \n   \t\tauthor = \"Joan Soriano / @joanbtl\"   \n   \t\tdate = \"2017-04-16\"   \n   \t\tversion = \"1.0\"   \n   \t\tMD5 = \"85784b54dee0b7c16c57e3a3a01db7e6\"   \n   \t\tSHA1 = \"6f6c625ef730beefbc23c7f362af329426607dee\"   \n   \tstrings:   \n   \t\t$s1 = \"GET /mirai/\"   \n   \t\t$s2 = \"dvrHelper\"   \n   \tcondition:   \n   \t\t$s1 and $s2   \n   }",
			"type": "YARA",
			"id": 30927388
		},
		{
			"indicator": "13289daeee02659ec49c3afaf72bf7e6d57b321b",
			"description": "",
			"title": "",
			"content": "rule Mirai_MIPS_MSB : MALW   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Mirai Botnet TR-069 Worm - MIPS MSB\"    \n   \t\tauthor = \"Felipe Molina / @felmoltor\"   \n   \t\tdate = \"2016-12-04\"   \n   \t\tversion = \"1.0\"    \n   \t\tMD5 = \"0eb51d584712485300ad8e8126773941\"\t   \n   \t\tSHA1 = \"18bce2f0107b5fab1b0b7c453e2a6b6505200cbd\"   \n   \t\tref1 = \"http://www.theregister.co.uk/2016/11/28/router_flaw_exploited_in_massive_attack/\"\t   \n   \t\tref2 = \"https://isc.sans.edu/forums/diary/Port+7547+SOAP+Remote+Code+Execution+Attack+Against+DSL+Modems/21759\"    \n   \t\tref3 = \"https://krebsonsecurity.com/2016/11/new-mirai-worm-knocks-900k-germans-offline/\"   \n      \n   \tstrings:   \n   \t\t$miname = \"Myname--is:\"   \n   \t\t$iptables1 = \"busybox iptables -A INPUT -p tcp --destination-port 7547 -j DROP\"   \n   \t\t$iptables2 = \"busybox iptables -A INPUT -p tcp --destination-port 5555 -j DROP\"   \n   \t\t$procnet = \"/proc/net/tcp\"   \n      \n   \tcondition:   \n   \t\t$miname and $iptables1 and $iptables2 and $procnet   \n   }",
			"type": "YARA",
			"id": 30927389
		},
		{
			"indicator": "5b816114ac73ceea68c32b04a484f735f7c3bb2a",
			"description": "",
			"title": "",
			"content": "rule Mirai_ARM_LSB : MALW   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Mirai Botnet TR-069 Worm - ARM LSB\"    \n   \t\tauthor = \"Felipe Molina / @felmoltor\"   \n   \t\tdate = \"2016-12-04\"   \n   \t\tversion = \"1.0\"    \n   \t\tMD5= \"eba670256b816e2d11f107f629d08494\"   \n   \t\tSHA1 = \"8a25dee4ea7d61692b2b95bd047269543aaf0c81\"   \n   \t\tref1 = \"http://www.theregister.co.uk/2016/11/28/router_flaw_exploited_in_massive_attack/\"\t   \n   \t\tref2 = \"https://isc.sans.edu/forums/diary/Port+7547+SOAP+Remote+Code+Execution+Attack+Against+DSL+Modems/21759\"    \n   \t\tref3 = \"https://krebsonsecurity.com/2016/11/new-mirai-worm-knocks-900k-germans-offline/\"   \n      \n   \tstrings:   \n   \t\t$miname = \"Myname--is:\"   \n   \t\t$iptables1 = \"busybox iptables -A INPUT -p tcp --destination-port 7547 -j DROP\"   \n   \t\t$iptables2 = \"busybox iptables -A INPUT -p tcp --destination-port 5555 -j DROP\"   \n   \t\t$procnet = \"/proc/net/tcp\"   \n      \n   \tcondition:   \n   \t\t$miname and $iptables1 and $iptables2 and $procnet   \n   }",
			"type": "YARA",
			"id": 30927390
		},
		{
			"indicator": "9595ef5b8730479e3c5bdfb99f5946877cea6ea6",
			"description": "",
			"title": "",
			"content": "rule Mirai_5 : MALW   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Mirai Variant 5\"   \n   \t\tauthor = \"Joan Soriano / @joanbtl\"   \n   \t\tdate = \"2017-04-16\"   \n   \t\tversion = \"1.0\"   \n   \t\tMD5 = \"7e17c34cddcaeb6755c457b99a8dfe32\"   \n   \t\tSHA1 = \"b63271672d6a044704836d542d92b98e2316ad24\"   \n      \n   \tstrings:   \n   \t\t    $dir1 = \"/dev/watchdog\"   \n   \t\t    $dir2 = \"/dev/misc/watchdog\"   \n   \t\t    $s1 = \"PMMV\"   \n   \t\t    $s2 = \"ZOJFKRA\"   \n   \t\t    $s3 = \"FGDCWNV\"   \n   \t\t    $s4 = \"OMVJGP\"   \n   \t\t    $ssl = \"ssl3_ctrl\"   \n   \tcondition:   \n   \t\t    $dir1 and $dir2 and $s1 and $s2 and $s3 and $s4 and $ssl   \n      \n   }",
			"type": "YARA",
			"id": 30927391
		},
		{
			"indicator": "afc93e099ec36645bb61ab110a2ab8ad75e5450e",
			"description": "",
			"title": "",
			"content": "rule Mirai_Generic_Arch : MALW   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Mirai Botnet TR-069 Worm - Generic Architecture\"    \n   \t\tauthor = \"Felipe Molina / @felmoltor\"   \n   \t\tdate = \"2016-12-04\"   \n   \t\tversion = \"1.0\"    \n   \t\tref1 = \"http://www.theregister.co.uk/2016/11/28/router_flaw_exploited_in_massive_attack/\"\t   \n   \t\tref2 = \"https://isc.sans.edu/forums/diary/Port+7547+SOAP+Remote+Code+Execution+Attack+Against+DSL+Modems/21759\"    \n   \t\tref3 = \"https://krebsonsecurity.com/2016/11/new-mirai-worm-knocks-900k-germans-offline/\"   \n      \n   \tstrings:   \n   \t\t$miname = \"Myname--is:\"   \n   \t\t$iptables1 = \"busybox iptables -A INPUT -p tcp --destination-port 7547 -j DROP\"   \n   \t\t$iptables2 = \"busybox iptables -A INPUT -p tcp --destination-port 5555 -j DROP\"   \n   \t\t$procnet = \"/proc/net/tcp\"   \n      \n   \tcondition:   \n   \t\t$miname and $iptables1 and $iptables2 and $procnet   \n   }",
			"type": "YARA",
			"id": 30927392
		},
		{
			"indicator": "ff9fabeb3f71ae898f60b54b538289000e20766b",
			"description": "",
			"title": "",
			"content": "rule tran_duy_linh   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \tmaltype = \"Misc.\"   \n   \tversion = \"0.2\"   \n   \treference = \"8fa804105b1e514e1998e543cd2ca4ea, 872876cfc9c1535cd2a5977568716ae1, etc.\"    \n   \tdate = \"01/03/2014\"   \n   strings:   \n   \t$doc = {D0 CF 11 E0} //DOCFILE0   \n   \t$string1 = \"Tran Duy Linh\" fullword   \n   \t$string2 = \"DLC Corporation\" fullword   \n   condition:   \n       ($doc at 0) and (all of ($string*))   \n   }",
			"type": "YARA",
			"id": 30927417
		},
		{
			"indicator": "1ec88284039c6a44047c8f9160efd31723ecd1ed",
			"description": "",
			"title": "",
			"content": "rule ScanBox_Malware_Generic {   \n   \tmeta:   \n   \t\tdescription = \"Scanbox Chinese Deep Panda APT Malware http://goo.gl/MUUfjv and http://goo.gl/WXUQcP\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference1 = \"http://goo.gl/MUUfjv\"   \n   \t\treference2 = \"http://goo.gl/WXUQcP\"   \n   \t\tdate = \"2015/02/28\"   \n   \t\thash1 = \"8d168092d5601ebbaed24ec3caeef7454c48cf21366cd76560755eb33aff89e9\"   \n   \t\thash2 = \"d4be6c9117db9de21138ae26d1d0c3cfb38fd7a19fa07c828731fa2ac756ef8d\"   \n   \t\thash3 = \"3fe208273288fc4d8db1bf20078d550e321d9bc5b9ab80c93d79d2cb05cbf8c2\"   \n   \tstrings:   \n   \t\t/* Sample 1 */   \n   \t\t$s0 = \"http://142.91.76.134/p.dat\" fullword ascii   \n   \t\t$s1 = \"HttpDump 1.1\" fullword ascii   \n   \t\t   \n   \t\t/* Sample 2 */   \n   \t\t$s3 = \"SecureInput .exe\" fullword wide   \n   \t\t$s4 = \"http://extcitrix.we11point.com/vpn/index.php?ref=1\" fullword ascii   \n   \t\t   \n   \t\t/* Sample 3 */   \n   \t\t$s5 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k msupdate\" fullword ascii   \n   \t\t$s6 = \"ServiceMaix\" fullword ascii\t\t   \n   \t\t   \n   \t\t/* Certificate and Keywords */   \n   \t\t$x1 = \"Management Support Team1\" fullword ascii   \n   \t\t$x2 = \"DTOPTOOLZ Co.,Ltd.0\" fullword ascii   \n   \t\t$x3 = \"SEOUL1\" fullword ascii   \n   \tcondition:   \n   \t\t( 1 of ($s*) and 2 of ($x*) ) or    \n   \t\t( 3 of ($x*) )   \n   }",
			"type": "YARA",
			"id": 30929329
		},
		{
			"indicator": "35f39c384f02d4d0afebd3d000c61121c994f748",
			"description": "",
			"title": "",
			"content": "rule more_scanbox {   \n     strings:   \n       $a = \"navigator.plugins[x].filename.replace\" nocase wide ascii   \n       $b = \"scanbox.basicposturl\"   \n     condition:   \n       any of them   \n   }",
			"type": "YARA",
			"id": 30929336
		},
		{
			"indicator": "98913ff3e41ea2d9299ef842c737bde4bc0847e8",
			"description": "",
			"title": "",
			"content": "rule ZXProxy   \n   {   \n   meta:   \n   \tauthor = \"ThreatConnect Intelligence Research Team\"   \n   \t   \n   strings:   \n   \t$C = \"\\\\Control\\\\zxplug\" nocase wide ascii   \n   \t$h = \"http://www.facebook.com/comment/update.exe\" wide ascii   \n   \t$S = \"Shared a shell to %s:%s Successfully\" nocase wide ascii   \n   condition:   \n   \tany of them   \n   }",
			"type": "YARA",
			"id": 30929345
		},
		{
			"indicator": "95c36efa4c4573df3e39cc8c01a43b7f6caa9f97",
			"description": "",
			"title": "",
			"content": "rule SpyGate_v2_9   \n   {   \n   \tmeta:   \n   \t\tdate = \"2014/09\"   \n   \t\tmaltype = \"Spygate v2.9 Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n   \t\treference = \"https://blogs.mcafee.com/mcafee-labs/middle-east-developer-spygate-struts-stuff-online\"   \n   \tstrings:   \n   \t\t$1 = \"shutdowncomputer\" wide   \n   \t\t$2 = \"shutdown -r -t 00\" wide   \n   \t\t$3 = \"blockmouseandkeyboard\" wide   \n   \t\t$4 = \"ProcessHacker\"   \n   \t\t$5 = \"FileManagerSplit\" wide   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 30929390
		},
		{
			"indicator": "ef9055d859c57c2050164c84c95c1edbfd904960",
			"description": "",
			"title": "",
			"content": "rule spyeye : banker   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"   \n   \t\tdescription = \"SpyEye X.Y memory\"   \n   \t\tdate = \"2012-05-23\"    \n   \t\tversion = \"1.0\"    \n   \t\tfiletype = \"memory\"   \n      \n   \tstrings:   \n   \t\t$spyeye = \"SpyEye\"   \n   \t\t$a = \"%BOTNAME%\"   \n   \t\t$b = \"globplugins\"   \n   \t\t$c = \"data_inject\"   \n   \t\t$d = \"data_before\"   \n   \t\t$e = \"data_after\"   \n   \t\t$f = \"data_end\"   \n   \t\t$g = \"bot_version\"   \n   \t\t$h = \"bot_guid\"   \n   \t\t$i = \"TakeBotGuid\"   \n   \t\t$j = \"TakeGateToCollector\"   \n   \t\t$k = \"[ERROR] : Omfg! Process is still active? Lets kill that mazafaka!\"   \n   \t\t$l = \"[ERROR] : Update is not successfull for some reason\"   \n   \t\t$m = \"[ERROR] : dwErr == %u\"   \n   \t\t$n = \"GRABBED DATA\"   \n   \t\t   \n   \tcondition:   \n   \t\t$spyeye or (any of ($a,$b,$c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$n))   \n   }",
			"type": "YARA",
			"id": 30929393
		},
		{
			"indicator": "1be4c18a291b38fee74948a0f8e4e84d6478aa98",
			"description": "",
			"title": "",
			"content": "rule DownExecute_A   \n   {   \n   \tmeta:   \n           Author      = \"PwC Cyber Threat Operations :: @tlansec\"   \n           Date        = \"2015/04/27\"   \n           Description = \"Malware is often wrapped/protected, best to run on memory\"   \n           Reference   = \"http://pwc.blogs.com/cyber_security_updates/2015/04/attacks-against-israeli-palestinian-interests.html\"   \n      \n       strings:   \n           $winver1 = \"win 8.1\"   \n           $winver2 = \"win Server 2012 R2\"   \n           $winver3 = \"win Srv 2012\"   \n           $winver4 = \"win srv 2008 R2\"   \n           $winver5 = \"win srv 2008\"   \n           $winver6 = \"win vsta\"   \n           $winver7 = \"win srv 2003 R2\"   \n           $winver8 = \"win hm srv\"   \n           $winver9 = \"win Strg srv 2003\"   \n           $winver10 = \"win srv 2003\"   \n           $winver11 = \"win XP prof x64 edt\"   \n           $winver12 = \"win XP\"   \n           $winver13 = \"win 2000\"   \n      \n           $pdb1 = \"D:\\\\Acms\\\\2\\\\docs\\\\Visual Studio 2013\\\\Projects\\\\DownloadExcute\\\\DownloadExcute\\\\Release\\\\DownExecute.pdb\"   \n           $pdb2 = \"d:\\\\acms\\\\2\\\\docs\\\\visual studio 2013\\\\projects\\\\downloadexcute\\\\downloadexcute\\\\downexecute\\\\json\\\\rapidjson\\\\writer.h\"   \n           $pdb3 = \":\\\\acms\\\\2\\\\docs\\\\visual studio 2013\\\\projects\\\\downloadexcute\\\\downloadexcute\\\\downexecute\\\\json\\\\rapidjson\\\\internal/stack.h\"   \n           $pdb4 = \"\\\\downloadexcute\\\\downexecute\\\\\"   \n      \n           $magic1 = \"<Win Get Version Info Name Error\"   \n           $magic2 = \"P@$sw0rd$nd\"   \n           $magic3 = \"$t@k0v2rF10w\"   \n           $magic4 = \"|*|123xXx(Mutex)xXx321|*|6-21-2014-03:06PM\" wide   \n      \n   \t\t$str1 = \"Download Excute\" ascii wide fullword   \n           $str2 = \"EncryptorFunctionPointer %d\"   \n           $str3 = \"%s\\\\%s.lnk\"   \n           $str4 = \"Mac:%s-Cpu:%s-HD:%s\"   \n           $str5 = \"feed back responce of host\"   \n           $str6 = \"GET Token at host\"   \n           $str7 = \"dwn md5 err\"   \n      \n       condition:   \n           all of ($winver*) or any of ($pdb*) or any of ($magic*) or 2 of ($str*)   \n   }",
			"type": "YARA",
			"id": 30929396
		},
		{
			"indicator": "81c38185de1d8932f1ee2bf482621c154e940d6d",
			"description": "",
			"title": "",
			"content": "rule Invoke_mimikittenz {   \n   \tmeta:   \n   \t\tdescription = \"Detects Mimikittenz - file Invoke-mimikittenz.ps1\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"https://github.com/putterpanda/mimikittenz\"   \n   \t\tdate = \"2016-07-19\"   \n   \t\tscore = 90   \n   \t\thash1 = \"14e2f70470396a18c27debb419a4f4063c2ad5b6976f429d47f55e31066a5e6a\"   \n   \tstrings:   \n   \t\t$x1 = \"[mimikittenz.MemProcInspector]\" ascii   \n      \n   \t\t$s1 = \"PROCESS_ALL_ACCESS = PROCESS_TERMINATE | PROCESS_CREATE_THREAD | PROCESS_SET_SESSIONID | PROCESS_VM_OPERATION |\" fullword ascii   \n   \t\t$s2 = \"IntPtr processHandle = MInterop.OpenProcess(MInterop.PROCESS_WM_READ | MInterop.PROCESS_QUERY_INFORMATION, false, process.Id);\" fullword ascii   \n   \t\t$s3 = \"&email=.{1,48}&create=.{1,2}&password=.{1,22}&metadata1=\" ascii   \n   \t\t$s4 = \"[DllImport(\\\"kernel32.dll\\\", SetLastError = true)]\" fullword ascii   \n   \tcondition:   \n   \t\t( uint16(0) == 0x7566 and filesize < 60KB and 2 of them ) or $x1   \n   }",
			"type": "YARA",
			"id": 30929407
		},
		{
			"indicator": "dc0814e247edd0e91a6c1325cad7055704403e6c",
			"description": "",
			"title": "",
			"content": "rule LinuxTsunami   \n   {   \n       meta:   \n   \t   \n   \t\tAuthor      = \"@benkow_\"   \n   \t\tDate        = \"2014/09/12\"    \n   \t\tDescription = \"Strings inside\"   \n   \t\tReference   = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3483\"   \n      \n       strings:   \n           $a = \"PRIVMSG %s :[STD]Hitting %s\"   \n           $b = \"NOTICE %s :TSUNAMI <target> <secs>\"   \n           $c = \"NOTICE %s :I'm having a problem resolving my host, someone will have to SPOOFS me manually.\"   \n       condition:   \n           $a or $b or $c   \n   }",
			"type": "YARA",
			"id": 30929412
		},
		{
			"indicator": "2a0821f1b4cdc00f9e8d13c5ff0e0f0e64f5bc28",
			"description": "",
			"title": "",
			"content": "rule LinuxElknot   \n   {   \n       meta:   \n   \tAuthor      = \"@benkow_\"   \n           Date        = \"2013/12/24\"    \n           Description = \"Strings inside\"   \n           Reference   = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3099\"   \n      \n       strings:   \n           $a = \"ZN8CUtility7DeCryptEPciPKci\"   \n   \t$b = \"ZN13CThreadAttack5StartEP11CCmdMessage\"   \n      \n       condition:   \n   \tall of them   \n   }",
			"type": "YARA",
			"id": 30929413
		},
		{
			"indicator": "5b69639aaede7663807b92347759f4c8aa801f21",
			"description": "",
			"title": "",
			"content": "rule exploit   \n   {   \n           meta:   \n                   author=\"xorseed\"   \n                   reference= \"https://stuff.rop.io/\"   \n   \tstrings:   \n   \t\t$xpl1 = \"set_fs_root\" nocase ascii wide   \n   \t\t$xpl2 = \"set_fs_pwd\" nocase ascii wide   \n   \t\t$xpl3 = \"__virt_addr_valid\" nocase ascii wide   \n   \t\t$xpl4 = \"init_task\" nocase ascii wide   \n   \t\t$xpl5 = \"init_fs\" nocase ascii wide   \n   \t\t$xpl6 = \"bad_file_ops\" nocase ascii wide   \n   \t\t$xpl7 = \"bad_file_aio_read\" nocase ascii wide   \n   \t\t$xpl8 = \"security_ops\" nocase ascii wide   \n   \t\t$xpl9 = \"default_security_ops\" nocase ascii wide   \n   \t\t$xpl10 = \"audit_enabled\" nocase ascii wide   \n   \t\t$xpl11 = \"commit_creds\" nocase ascii wide   \n   \t\t$xpl12 = \"prepare_kernel_cred\" nocase ascii wide   \n   \t\t$xpl13 = \"ptmx_fops\" nocase ascii wide   \n   \t\t$xpl14 = \"node_states\" nocase ascii wide   \n   \tcondition:   \n   \t\t7 of them   \n   }",
			"type": "YARA",
			"id": 30929414
		},
		{
			"indicator": "477e80afe6fefc45573c5391a22e21717e9fa3c0",
			"description": "",
			"title": "",
			"content": "rule LinuxMrBlack   \n   {   \n       meta:   \n   \tAuthor      = \"@benkow_\"   \n           Date        = \"2014/09/12\"    \n           Description = \"Strings inside\"   \n           Reference   = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3483\"   \n      \n       strings:   \n           $a = \"Mr.Black\"   \n   \t$b = \"VERS0NEX:%s|%d|%d|%s\"   \n       condition:   \n           $a and $b   \n   }",
			"type": "YARA",
			"id": 30929415
		},
		{
			"indicator": "775815d848783a1f888a0c54bc17b28ebc662a24",
			"description": "",
			"title": "",
			"content": "rule LinuxBillGates    \n   {   \n       meta:   \n          Author      = \"@benkow_\"   \n          Date        = \"2014/08/11\"    \n          Description = \"Strings inside\"   \n          Reference   = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3429\"    \n      \n       strings:   \n           $a= \"12CUpdateGates\"   \n           $b= \"11CUpdateBill\"   \n      \n       condition:   \n           $a and $b   \n   }",
			"type": "YARA",
			"id": 30929416
		},
		{
			"indicator": "6dc6040bd9cdcdda27ee51530726c8d13baafece",
			"description": "",
			"title": "",
			"content": "rule rootkit   \n   {   \n   \tmeta:   \n                   author=\"xorseed\"   \n                   reference= \"https://stuff.rop.io/\"   \n   \tstrings:   \n   \t\t$sys1 = \"sys_write\" nocase ascii wide\t   \n   \t\t$sys2 = \"sys_getdents\" nocase ascii wide   \n   \t\t$sys3 = \"sys_getdents64\" nocase ascii wide   \n   \t\t$sys4 = \"sys_getpgid\" nocase ascii wide   \n   \t\t$sys5 = \"sys_getsid\" nocase ascii wide   \n   \t\t$sys6 = \"sys_setpgid\" nocase ascii wide   \n   \t\t$sys7 = \"sys_kill\" nocase ascii wide   \n   \t\t$sys8 = \"sys_tgkill\" nocase ascii wide   \n   \t\t$sys9 = \"sys_tkill\" nocase ascii wide   \n   \t\t$sys10 = \"sys_sched_setscheduler\" nocase ascii wide   \n   \t\t$sys11 = \"sys_sched_setparam\" nocase ascii wide   \n   \t\t$sys12 = \"sys_sched_getscheduler\" nocase ascii wide   \n   \t\t$sys13 = \"sys_sched_getparam\" nocase ascii wide   \n   \t\t$sys14 = \"sys_sched_setaffinity\" nocase ascii wide   \n   \t\t$sys15 = \"sys_sched_getaffinity\" nocase ascii wide   \n   \t\t$sys16 = \"sys_sched_rr_get_interval\" nocase ascii wide   \n   \t\t$sys17 = \"sys_wait4\" nocase ascii wide   \n   \t\t$sys18 = \"sys_waitid\" nocase ascii wide   \n   \t\t$sys19 = \"sys_rt_tgsigqueueinfo\" nocase ascii wide   \n   \t\t$sys20 = \"sys_rt_sigqueueinfo\" nocase ascii wide   \n   \t\t$sys21 = \"sys_prlimit64\" nocase ascii wide   \n   \t\t$sys22 = \"sys_ptrace\" nocase ascii wide   \n   \t\t$sys23 = \"sys_migrate_pages\" nocase ascii wide   \n   \t\t$sys24 = \"sys_move_pages\" nocase ascii wide   \n   \t\t$sys25 = \"sys_get_robust_list\" nocase ascii wide   \n   \t\t$sys26 = \"sys_perf_event_open\" nocase ascii wide   \n   \t\t$sys27 = \"sys_uname\" nocase ascii wide   \n   \t\t$sys28 = \"sys_unlink\" nocase ascii wide   \n   \t\t$sys29 = \"sys_unlikat\" nocase ascii wide   \n   \t\t$sys30 = \"sys_rename\" nocase ascii wide   \n   \t\t$sys31 = \"sys_read\" nocase ascii wide   \n   \t\t$sys32 = \"kobject_del\" nocase ascii wide   \n   \t\t$sys33 = \"list_del_init\" nocase ascii wide   \n   \t\t$sys34 = \"inet_ioctl\" nocase ascii wide   \n   \tcondition:   \n   \t\t9 of them   \n   }",
			"type": "YARA",
			"id": 30929418
		},
		{
			"indicator": "11f471c6c33fb1c179fa456b61254566be1e3c51",
			"description": "",
			"title": "",
			"content": "rule NSFreeCode : NSFree Family    \n   {   \n       meta:   \n           description = \"NSFree code features\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-06-24\"   \n          \n       strings:   \n           // push vars then look for MZ   \n           $ = { 53 56 57 66 81 38 4D 5A }   \n           // nops then look for PE\\0\\0   \n           $ = { 90 90 90 90 81 3F 50 45 00 00 }   \n          \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30929419
		},
		{
			"indicator": "2204e4fa11d79383ac27cc5d3505bf75ad7f9c5e",
			"description": "",
			"title": "",
			"content": "rule NSFreeStrings : NSFree Family   \n   {   \n       meta:   \n           description = \"NSFree Identifying Strings\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-06-24\"   \n              \n       strings:   \n           $ = \"\\\\MicNS\\\\\" nocase   \n           $ = \"NSFreeDll\" wide ascii   \n           // xor 0x58 dos stub   \n           $ = { 0c 30 31 2b 78 28 2a 37 3f 2a 39 35 78 3b 39 36 36 37 }   \n              \n       condition:   \n          any of them   \n   }",
			"type": "YARA",
			"id": 30929420
		},
		{
			"indicator": "bcfafabacae4ccb75077952038a43bdf3774b1b8",
			"description": "",
			"title": "",
			"content": "rule Backdoor_Naikon_APT_Sample1 {   \n   \tmeta:   \n   \t\tdescription = \"Detects backdoors related to the Naikon APT\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"https://goo.gl/7vHyvh\"   \n   \t\tdate = \"2015-05-14\"   \n   \t\thash = \"d5716c80cba8554eb79eecfb4aa3d99faf0435a1833ec5ef51f528146c758eba\"   \n   \t\thash = \"f5ab8e49c0778fa208baad660fe4fa40fc8a114f5f71614afbd6dcc09625cb96\"   \n   \tstrings:   \n   \t\t$x0 = \"GET http://%s:%d/aspxabcdef.asp?%s HTTP/1.1\" fullword ascii   \n   \t\t$x1 = \"POST http://%s:%d/aspxabcdefg.asp?%s HTTP/1.1\" fullword ascii   \n   \t\t$x2 = \"greensky27.vicp.net\" fullword ascii   \n   \t\t$x3 = \"\\\\tempvxd.vxd.dll\" fullword wide   \n   \t\t$x4 = \"otna.vicp.net\" fullword ascii   \n   \t\t$x5 = \"smithking19.gicp.net\" fullword ascii   \n   \t\t   \n   \t\t$s1 = \"User-Agent: webclient\" fullword ascii   \n   \t\t$s2 = \"\\\\User.ini\" fullword ascii   \n   \t\t$s3 = \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/200\" ascii   \n   \t\t$s4 = \"\\\\UserProfile.dll\" fullword wide   \n   \t\t$s5 = \"Connection:Keep-Alive: %d\" fullword ascii   \n   \t\t$s6 = \"Referer: http://%s:%d/\" fullword ascii   \n   \t\t$s7 = \"%s %s %s %d %d %d \" fullword ascii   \n   \t\t$s8 = \"%s--%s\" fullword wide   \n   \t\t$s9 = \"Run File Success!\" fullword wide   \n   \t\t$s10 = \"DRIVE_REMOTE\" fullword wide   \n   \t\t$s11 = \"ProxyEnable\" fullword wide   \n   \t\t$s12 = \"\\\\cmd.exe\" fullword wide   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and filesize < 1000KB and   \n   \t\t(   \n   \t\t\t1 of ($x*) or 7 of ($s*)   \n   \t\t)   \n   }",
			"type": "YARA",
			"id": 30929423
		},
		{
			"indicator": "f4a208533d75b3284c27ee4dc92a9eceda1575b7",
			"description": "",
			"title": "",
			"content": "rule NetpassStrings : NetPass Variant {   \n      \n           meta:   \n                   description = \"Identifiers for netpass variant\"   \n                   author = \"Katie Kleemola\"   \n                   last_updated = \"2014-05-29\"   \n      \n           strings:   \n                   $exif1 = \"Device Protect ApplicatioN\" wide   \n                   $exif2 = \"beep.sys\" wide //embedded exe name   \n                   $exif3 = \"BEEP Driver\" wide //embedded exe description   \n      \n                   $string1 = \"\\x00NetPass Update\\x00\"   \n                   $string2 = \"\\x00%s:DOWNLOAD\\x00\"   \n                   $string3 = \"\\x00%s:UPDATE\\x00\"   \n                   $string4 = \"\\x00%s:uNINSTALL\\x00\"   \n      \n           condition:   \n                   all of ($exif*) or any of ($string*)   \n      \n   }",
			"type": "YARA",
			"id": 30941212
		},
		{
			"indicator": "98b6313e39ee734fed1e7709982375ffdac48170",
			"description": "",
			"title": "",
			"content": "rule NetTravExports : NetTraveler Family {   \n      \n   \tmeta:   \n   \t\tdescription = \"Export names for dll component\"   \n   \t\tauthor = \"Katie Kleemola\"   \n   \t\tlast_updated = \"2014-05-20\"   \n   \t   \n   \tstrings:   \n   \t\t//dll component exports   \n   \t\t$ = \"?InjectDll@@YAHPAUHWND__@@K@Z\"   \n   \t\t$ = \"?UnmapDll@@YAHXZ\"   \n   \t\t$ = \"?g_bSubclassed@@3HA\"   \n   \t\t   \n   \tcondition:   \n   \t\tany of them   \n   }",
			"type": "YARA",
			"id": 30941213
		},
		{
			"indicator": "766942467c71520a7b4124f172915d042d121476",
			"description": "",
			"title": "",
			"content": "rule NetTravStrings : NetTraveler Family {   \n      \n      \n   \tmeta:   \n           \tdescription = \"Identifiers for NetTraveler DLL\"   \n   \t\tauthor = \"Katie Kleemola\"   \n           \tlast_updated = \"2014-05-20\"   \n      \n   \tstrings:   \n   \t\t//network strings   \n   \t\t$ = \"?action=updated&hostid=\"   \n   \t\t$ = \"travlerbackinfo\"   \n   \t\t$ = \"?action=getcmd&hostid=\"   \n   \t\t$ = \"%s?action=gotcmd&hostid=\"   \n   \t\t$ = \"%s?hostid=%s&hostname=%s&hostip=%s&filename=%s&filestart=%u&filetext=\"   \n      \n   \t\t//debugging strings   \n   \t\t$ = \"\\x00Method1 Fail!!!!!\\x00\"   \n   \t\t$ = \"\\x00Method3 Fail!!!!!\\x00\"   \n   \t\t$ = \"\\x00method currect:\\x00\"   \n   \t\t$ = /\\x00\\x00[\\w\\-]+ is Running!\\x00\\x00/   \n   \t\t$ = \"\\x00OtherTwo\\x00\"   \n      \n   \tcondition:   \n   \t\tany of them   \n      \n   }",
			"type": "YARA",
			"id": 30941214
		},
		{
			"indicator": "ca89f0f7bcb76771b6aee9801ac10f72b663986e",
			"description": "",
			"title": "",
			"content": "rule NionSpy : win32   \n   {   \n   meta:   \n   description = \"Triggers on old and new variants of W32/NionSpy file infector\"   \n   reference = \"https://blogs.mcafee.com/mcafee-labs/taking-a-close-look-at-data-stealing-nionspy-file-infector\"   \n   strings:   \n   $variant2015_infmarker = \"aCfG92KXpcSo4Y94BnUrFmnNk27EhW6CqP5EnT\"   \n   $variant2013_infmarker = \"ad6af8bd5835d19cc7fdc4c62fdf02a1\"   \n   $variant2013_string = \"%s?cstorage=shell&comp=%s\"   \n   condition:   \n   uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and 1 of ($variant*)   \n   }",
			"type": "YARA",
			"id": 30941302
		},
		{
			"indicator": "846300ed48220f3abe167a6bd805c121c062e667",
			"description": "",
			"title": "",
			"content": "rule TROJAN_Notepad {   \n       meta:   \n           Author = \"RSA_IR\"   \n           Date     = \"4Jun13\"   \n           File     = \"notepad.exe v 1.1\"   \n           MD5      = \"106E63DBDA3A76BEEB53A8BBD8F98927\"   \n       strings:   \n           $s1 = \"75BAA77C842BE168B0F66C42C7885997\"   \n           $s2 = \"B523F63566F407F3834BCC54AAA32524\"   \n       condition:   \n           $s1 or $s2   \n   }",
			"type": "YARA",
			"id": 30941304
		},
		{
			"indicator": "910960f633f14c0e639f25910213dfe9d4874115",
			"description": "",
			"title": "",
			"content": "rule Odinaff_swift {   \n           meta:   \n                   author = \"@j0sm1\"   \n                   date = \"2016/10/27\"   \n                   description = \"Odinaff malware\"   \n                   reference = \"https://www.symantec.com/security_response/writeup.jsp?docid=2016-083006-4847-99\"   \n                   filetype = \"binary\"   \n      \n           strings:   \n      \n                   $s1 = \"getapula.pdb\"   \n                   $i1 = \"wtsapi32.dll\"   \n                   $i2 = \"cmpbk32.dll\"   \n                   $i3 = \"PostMessageA\"   \n                   $i4 = \"PeekMessageW\"   \n                   $i5 = \"DispatchMessageW\"   \n                   $i6 = \"WTSEnumerateSessionsA\"   \n      \n           condition:   \n                   all of them   \n   }",
			"type": "YARA",
			"id": 30941456
		},
		{
			"indicator": "f4979e868929453c5457729dd5e2db5e66d30983",
			"description": "",
			"title": "",
			"content": "rule PolishBankRAT_fdsvc_xor_loop    \n   {   \n   \tmeta:   \n      \n   \t\tauthor = \"Booz Allen Hamilton Dark Labs\"   \n   \t\tdescription = \"Finds the custom xor decode loop for <PolishBankRAT_fdsvc>\"   \n      \n   \tstrings:   \n      \n   \t\t$loop = {0F B6 42 FF 48 8D 52 FF 30 42 01 FF CF 75 F1}   \n      \n   \tcondition:   \n      \n   \t\t(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and $loop   \n   }",
			"type": "YARA",
			"id": 30943223
		},
		{
			"indicator": "54e50c6a44b4c0e8633c39817337cc577cc8b52c",
			"description": "",
			"title": "",
			"content": "rule PolishBankRAT_fdsvc_decode2    \n   {   \n   \tmeta:   \n   \t\t   \n   \t\tauthor = \"Booz Allen Hamilton Dark Labs\"   \n   \t\tdescription = \"Find a constant used as part of a payload decoding function in PolishBankRAT_fdsvc\"   \n      \n   \tstrings:   \n   \t\t   \n   \t\t$part1 = {A6 EB 96}   \n   \t\t$part2 = {61 B2 E2 EF}   \n   \t\t$part3 = {0D CB E8 C4}   \n   \t\t$part4 = {5A F1 66 9C}   \n   \t\t$part5 = {A4 80 CD 9A}   \n   \t\t$part6 = {F1 2F 46 25}   \n   \t\t$part7 = {2F DB 16 26}   \n   \t\t$part8 = {4B C4 3F 3C}   \n   \t\t$str1 = \"This program cannot be run in DOS mode\"   \n      \n   \tcondition:   \n      \n   \t\t(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and all of them   \n   }",
			"type": "YARA",
			"id": 30943224
		},
		{
			"indicator": "4fb5e1583603d8cca8e23a3db11e5439ea6397e2",
			"description": "",
			"title": "",
			"content": "rule decoded_PolishBankRAT_fdsvc_strings    \n   {   \n   \tmeta:   \n      \n   \t\tauthor = \"Booz Allen Hamilton Dark Labs\"   \n   \t\tdescription = \"Finds hard coded strings in PolishBankRAT_fdsvc\"   \n      \n   \tstrings:   \n      \n   \t\t$str1 = \"ssylka\" wide ascii   \n   \t\t$str2 = \"ustanavlivat\" wide ascii   \n   \t\t$str3 = \"poluchit\" wide ascii   \n   \t\t$str4 = \"pereslat\" wide ascii   \n   \t\t$str5 = \"derzhat\" wide ascii   \n   \t\t$str6 = \"vykhodit\" wide ascii   \n   \t\t$str7 = \"Nachalo\" wide ascii   \n      \n   \tcondition:   \n   \t\t   \n   \t\t(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and 4 of ($str*)   \n   }",
			"type": "YARA",
			"id": 30943225
		},
		{
			"indicator": "8d87d01dd0397129cc7adea70219b3b806decf88",
			"description": "",
			"title": "",
			"content": "rule PolishBankRAT_srservice_xorloop    \n   {   \n   \tmeta:   \n   \t   \n   \t\tauthor = \"Booz Allen Hamilton Dark Labs\"   \n   \t\tdescription = \"Finds the custom xor decode loop for <PolishBankRAT_srservice>\"   \n   \t   \n   \tstrings:   \n      \n   \t\t$loop = { 48 8B CD E8 60 FF FF FF 48 FF C3 32 44 1E FF 48 FF CF 88 43 FF }   \n      \n   \tcondition:   \n      \n   \t\t(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and $loop   \n   }",
			"type": "YARA",
			"id": 30943226
		},
		{
			"indicator": "69cfde7ccebd365e0e1b17ec5bcec4078c867791",
			"description": "",
			"title": "",
			"content": "rule pony {   \n       meta:   \n           author = \"Brian Wallace @botnet_hunter\"   \n           author_email = \"bwall@ballastsecurity.net\"   \n           date = \"2014-08-16\"   \n           description = \"Identify Pony\"   \n   \tstrings:   \n       \t$s1 = \"{%08X-%04X-%04X-%02X%02X-%02X%02X%02X%02X%02X%02X}\"   \n       \t$s2 = \"YUIPWDFILE0YUIPKDFILE0YUICRYPTED0YUI1.0\"   \n       \t$s3 = \"POST %s HTTP/1.0\"   \n       \t$s4 = \"Accept-Encoding: identity, *;q=0\"   \n      \n       \t//$useragent1 = \"Mozilla/4.0 (compatible; MSIE 5.0; Windows 98)\"   \n       \t//$useragent2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/5.0)\"   \n       condition:   \n           $s1 and $s2 and $s3 and $s4   \n   }",
			"type": "YARA",
			"id": 30943284
		},
		{
			"indicator": "c1e5ef54c6cb519f07788eae537e8225a8973a46",
			"description": "",
			"title": "",
			"content": "rule Retefe   \n   {   \n   meta:   \n   \tauthor = \"bartblaze\"   \n   \tdescription = \"Retefe\"   \n   strings:   \n   \t$string0 = \"01050000\"   \n   \t$string1 = \"00000000\"   \n   \t$string2 = \"5061636b61676500\"   \n   \t$string3 = \"000000000000000000000000000000000000000000000000000000000000000000000000000000\"   \n   \t$string4 = \"{\\\\stylesheet{ Normal;}{\\\\s1 heading 1;}{\\\\s2 heading 2;}}\"   \n   \t$string5 = \"02000000\"   \n   condition:   \n   \t5 of them   \n   }",
			"type": "YARA",
			"id": 30943291
		},
		{
			"indicator": "50d597a25cfdaf5ab55b78988e0939f0269a3c2e",
			"description": "",
			"title": "",
			"content": "rule RockLoader {   \n   meta:   \n   name = \"RockLoader\"   \n   description = \"RockLoader Malware\"   \n   author = \"@seanmw\"   \n   strings:   \n   $hdr = {4d 5a 90 00}   \n   $op1 = {39 45 f0 0f 8e b0 00 00 00}   \n   $op2 = {32 03 77 73 70 72 69 6e 74 66 41 00 ce 02 53 65}   \n   condition:   \n   $hdr at 0 and all of ($op*) and filesize < 500KB   \n   }",
			"type": "YARA",
			"id": 30943292
		},
		{
			"indicator": "0cfa65d2d0fece885d995520c6551adc7d1c5a55",
			"description": "",
			"title": "",
			"content": "rule rovnix_downloader : downloader    \n   {   \n   \tmeta:   \n   \t\tauthor=\"Intel Security\"   \n   \t\tdescription=\"Rovnix downloader with sinkhole checks\"   \n   \t\treference = \"https://blogs.mcafee.com/mcafee-labs/rovnix-downloader-sinkhole-time-checks/\"   \n   \tstrings:   \n   \t\t\t$sink1= \"control\"   \n   \t\t\t$sink2 = \"sink\"   \n   \t\t\t$sink3 = \"hole\"   \n   \t\t\t$sink4= \"dynadot\"   \n   \t\t\t$sink5= \"block\"   \n   \t\t\t$sink6= \"malw\"   \n   \t\t\t$sink7= \"anti\"   \n   \t\t\t$sink8= \"googl\"   \n   \t\t\t$sink9= \"hack\"   \n   \t\t\t$sink10= \"trojan\"   \n   \t\t\t$sink11= \"abuse\"   \n   \t\t\t$sink12= \"virus\"   \n   \t\t\t$sink13= \"black\"   \n   \t\t\t$sink14= \"spam\"   \n   \t\t\t$boot= \"BOOTKIT_DLL.dll\"   \n   \t\t\t$mz = { 4D 5A }   \n   \tcondition:   \n   \t\t$mz in (0..2) and all of ($sink*) and $boot   \n   }",
			"type": "YARA",
			"id": 30943297
		},
		{
			"indicator": "ae84e99c5ca7136e2d9431ba22de5888c58887f8",
			"description": "",
			"title": "",
			"content": "rule Sakurel_backdoor   \n   {   \n   \tmeta:   \n   \t\tmaltype = \"Sakurel backdoor\"   \n       ref = \"https://github.com/reed1713\"   \n   \t\treference = \"http://www.microsoft.com/security/portal/threat/encyclopedia/entry.aspx?Name=Trojan:Win32/Sakurel.A#tab=2\"   \n   \t\tdescription = \"malware creates a process in the temp directory and performs the sysprep UAC bypass method.\"   \n   \tstrings:   \n   \t\t$type=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid=\"4688\"   \n   \t\t$data=\"Windows\\\\System32\\\\sysprep\\\\sysprep.exe\" nocase   \n      \n   \t\t$type1=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid1=\"4688\"   \n   \t\t$data1=\"AppData\\\\Local\\\\Temp\\\\MicroMedia\\\\MediaCenter.exe\" nocase   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 30943300
		},
		{
			"indicator": "0a654750ed307c1e0a941d571c5e06b39c73f3dd",
			"description": "",
			"title": "",
			"content": "rule Vinsula_Sayad_Binder : infostealer binder   \n   {   \n       meta:   \n           Author      = \"Vinsula, Inc\"   \n           Date        = \"2014/06/20\"   \n           Description = \"Sayad Infostealer Binder\"   \n           Reference   = \"http://vinsula.com/2014/07/20/sayad-flying-kitten-infostealer-malware/\"   \n      \n       strings:    \n           $pdbstr = \"\\\\Projects\\\\C#\\\\Sayad\\\\Source\\\\Binder\\\\obj\\\\Debug\\\\Binder.pdb\"    \n           $delphinativestr = \"DelphiNative.dll\" nocase   \n           $sqlite3str = \"sqlite3.dll\" nocase   \n           $winexecstr = \"WinExec\"    \n           $sayadconfig = \"base.dll\" wide   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30943301
		},
		{
			"indicator": "c73387c36416570cbe62ec1fff52d12dfbea4a0e",
			"description": "",
			"title": "",
			"content": "rule Vinsula_Sayad_Client : infostealer   \n   {   \n       meta:   \n           Author      = \"Vinsula, Inc\"   \n           Date        = \"2014/06/20\"   \n           Description = \"Sayad Infostealer Client\"   \n           Reference   = \"http://vinsula.com/2014/07/20/sayad-flying-kitten-infostealer-malware/\"   \n      \n       strings:    \n           $pdbstr = \"\\\\Projects\\\\C#\\\\Sayad\\\\Source\\\\Client\\\\bin\\\\x86\\\\Debug\\\\Client.pdb\"    \n           $sayadconfig = \"base.dll\" wide   \n           $sqlite3str = \"sqlite3.dll\" nocase   \n           $debugstr01 = \"Config loaded\" wide   \n           $debugstr02 = \"Config parsed\" wide   \n           $debugstr03 = \"storage uploader\" wide   \n           $debugstr04 = \"updater\" wide   \n           $debugstr05 = \"keylogger\" wide   \n           $debugstr06 = \"Screenshot\" wide   \n           $debugstr07 = \"sqlite found & start collectiong data\" wide   \n           $debugstr08 = \"Machine info collected\" wide   \n           $debugstr09 = \"browser ok\" wide   \n           $debugstr10 = \"messenger ok\" wide   \n           $debugstr11 = \"vpn ok\" wide   \n           $debugstr12 = \"ftp client ok\" wide   \n           $debugstr13 = \"ftp server ok\" wide   \n           $debugstr14 = \"rdp ok\" wide   \n           $debugstr15 = \"kerio ok\" wide   \n           $debugstr16 = \"skype ok\" wide   \n           $debugstr17 = \"serialize data ok\" wide   \n           $debugstr18 = \"Keylogged\" wide   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 30943302
		},
		{
			"indicator": "cee2903d8bdbe8d5d536a7c950af5ecc472d0063",
			"description": "",
			"title": "",
			"content": "rule sendsafe {   \n      \n       meta:   \n           author = \" J from THL <j@techhelplist.com>\"   \n           date = \"2016/09\"   \n           reference = \"http://pastebin.com/WPWWs406\"   \n   \t\tversion = 2   \n           maltype = \"Spammer\"   \n           filetype = \"memory\"   \n      \n       strings:   \n           $a = \"Enterprise Mailing Service\"   \n           $b = \"Blacklisted by rule: %s:%s\"   \n           $c = \"/SuccessMails?CampaignNum=%ld\"   \n           $d = \"/TimedOutMails?CampaignNum=%ld\"   \n           $e = \"/InvalidMails?CampaignNum=%ld\"   \n           $f = \"Failed to download maillist, retrying\"   \n           $g = \"No maillist loaded\"   \n           $h = \"Successfully sent using SMTP account %s (%d of %ld messages to %s)\"   \n           $i = \"Successfully sent %d of %ld messages to %s\"   \n           $j = \"Sending to %s in the same connection\"   \n           $k = \"New connection required, will send to %s\"   \n   \t\t$l = \"Mail transaction for %s is over.\"   \n   \t\t$m = \"Domain %s is bad (found in cache)\"   \n   \t\t$n = \"Domain %s found in cache\"   \n   \t\t$o = \"Domain %s isn't found in cache, resolving it\"   \n   \t\t$p = \"All tries to resolve %s failed.\"   \n   \t\t$q = \"Failed to receive response for %s from DNS server\"   \n   \t\t$r = \"Got DNS server response: domain %s is bad\"   \n   \t\t$s = \"Got error %d in response for %s from DNS server\"   \n   \t\t$t = \"MX's IP for domain %s found in cache:\"   \n   \t\t$u = \"Timeout waiting for domain %s to be resolved\"   \n   \t\t$v = \"No valid MXes for domain %s. Marking it as bad\"   \n   \t\t$w = \"Resolving MX %s using existing connection to DNS server\"   \n   \t\t$x = \"All tries to resolve MX for %s are failed\"   \n   \t\t$y = \"Resolving MX %s using DNS server\"   \n   \t\t$z = \"Failed to receive response for MX %s from DNS server\"   \n      \n       condition:   \n           13 of them   \n   }",
			"type": "YARA",
			"id": 30957719
		},
		{
			"indicator": "6fdd9e0840ff8e112642632101098e949f27a7ee",
			"description": "",
			"title": "",
			"content": "rule CrowdStrike_Shamoon_DroppedFile {    \n   \tmeta:   \n   \t\tdescription = \"Rule to detect Shamoon malware http://goo.gl/QTxohN\"   \n   \t\treference = \"http://www.rsaconference.com/writable/presentations/file_upload/exp-w01-hacking-exposed-day-of-destruction.pdf\"   \n   \tstrings:   \n   \t\t$testn123 = \"test123\" wide   \n   \t\t$testn456 = \"test456\" wide   \n   \t\t$testn789 = \"test789\" wide   \n   \t\t$testdomain = \"testdomain.com\" wide $pingcmd = \"ping -n 30 127.0.0.1 >nul\" wide   \n   \tcondition:   \n   \t\t(any of ($testn*) or $pingcmd) and $testdomain   \n   }",
			"type": "YARA",
			"id": 30957720
		},
		{
			"indicator": "be377cc05fbcf1413f9af61c478ebf09b4c20930",
			"description": "",
			"title": "",
			"content": "rule Shamoon2_Wiper {   \n      meta:   \n         description = \"Detects Shamoon 2.0 Wiper Component\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/jKIfGB\"   \n         date = \"2016-12-01\"   \n         score = 70   \n         hash1 = \"c7fc1f9c2bed748b50a599ee2fa609eb7c9ddaeb9cd16633ba0d10cf66891d8a\"   \n         hash2 = \"128fa5815c6fee68463b18051c1a1ccdf28c599ce321691686b1efa4838a2acd\"   \n      strings:   \n         $a1 = \"\\\\??\\\\%s\\\\System32\\\\%s.exe\" fullword wide   \n         $x1 = \"IWHBWWHVCIDBRAFUASIIWURRTWRTIBIVJDGWTRRREFDEAEBIAEBJGGCSVUHGVJUHADIEWAFGWADRUWDTJBHTSITDVVBCIDCWHRHVTDVCDESTHWSUAEHGTWTJWFIRTBRB\" wide   \n         $s1 = \"UFWYNYNTS\" fullword wide   \n         $s2 = \"\\\\\\\\?\\\\ElRawDisk\" fullword wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 1000KB and 2 of them ) or ( 3 of them )   \n   }",
			"type": "YARA",
			"id": 30957721
		},
		{
			"indicator": "04c5cef6420c91b6649f1fa48c3eba868b55436d",
			"description": "",
			"title": "",
			"content": "rule Shamoon2_ComComp {   \n      meta:   \n         description = \"Detects Shamoon 2.0 Communication Components\"   \n         author = \"Florian Roth (with Binar.ly)\"   \n         reference = \"https://goo.gl/jKIfGB\"   \n         date = \"2016-12-01\"   \n         score = 70   \n         hash1 = \"61c1c8fc8b268127751ac565ed4abd6bdab8d2d0f2ff6074291b2d54b0228842\"   \n      strings:   \n         $s1 = \"mkdir %s%s > nul 2>&1\" fullword ascii   \n         $s2 = \"p[%s%s%d.%s\" fullword ascii   \n      \n         $op1 = { 04 32 cb 88 04 37 88 4c 37 01 88 54 37 02 83 c6 }   \n         $op2 = { c8 02 d2 c0 e9 06 02 d2 24 3f 02 d1 88 45 fb 8d }   \n         $op3 = { 0c 3b 40 8d 4e 01 47 3b c1 7c d8 83 fe 03 7d 1c }   \n      condition:   \n         uint16(0) == 0x5a4d and filesize < 500KB and ( all of ($s*) or all of ($op*) )   \n   }",
			"type": "YARA",
			"id": 30957722
		},
		{
			"indicator": "f784728245a4d1073d631d8b829f232c3412089f",
			"description": "",
			"title": "",
			"content": "rule EldoS_RawDisk {   \n      meta:   \n         description = \"EldoS Rawdisk Device Driver (Commercial raw disk access driver - used in Operation Shamoon 2.0)\"   \n         author = \"Florian Roth (with Binar.ly)\"   \n         reference = \"https://goo.gl/jKIfGB\"   \n         date = \"2016-12-01\"   \n         score = 50   \n         hash1 = \"47bb36cd2832a18b5ae951cf5a7d44fba6d8f5dca0a372392d40f51d1fe1ac34\"   \n         hash2 = \"394a7ebad5dfc13d6c75945a61063470dc3b68f7a207613b79ef000e1990909b\"   \n      strings:   \n         $s1 = \"g\\\\system32\\\\\" fullword wide   \n         $s2 = \"ztvttw\" fullword wide   \n         $s3 = \"lwizvm\" fullword ascii   \n         $s4 = \"FEJIKC\" fullword ascii   \n         $s5 = \"INZQND\" fullword ascii   \n         $s6 = \"IUTLOM\" fullword wide   \n         $s7 = \"DKFKCK\" fullword ascii   \n      \n         $op1 = { 94 35 77 73 03 40 eb e9 }   \n         $op2 = { 80 7c 41 01 00 74 0a 3d }   \n         $op3 = { 74 0a 3d 00 94 35 77 }   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 2000KB and 4 of them )   \n   }",
			"type": "YARA",
			"id": 30957723
		},
		{
			"indicator": "5915862fdbaac989ed4c348270107c76356f5ef6",
			"description": "",
			"title": "",
			"content": "rule Shifu_Banking_Trojan_0 : banking {   \n   \tmeta:   \n   \t\tdescription = \"Detects Shifu Banking Trojan\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"https://securityintelligence.com/shifu-masterful-new-banking-trojan-is-attacking-14-japanese-banks/\"   \n   \t\tdate = \"2015-09-01\"   \n   \t\thash1 = \"4ff1ebea2096f318a2252ebe1726bcf3bbc295da9204b6c720b5bbf14de14bb2\"   \n   \t\thash2 = \"4881c7d89c2b5e934d4741a653fbdaf87cc5e7571b68c723504069d519d8a737\"   \n   \tstrings:   \n   \t\t$x1 = \"c:\\\\oil\\\\feet\\\\Seven\\\\Send\\\\Gather\\\\Dividerail.pdb\" fullword ascii   \n      \n   \t\t$s1 = \"listen above\" fullword wide   \n   \t\t$s2 = \"familycould cost\" fullword wide   \n   \t\t$s3 = \"SetSystemTimeAdjustment\" fullword ascii /* Goodware String - occured 33 times */   \n   \t\t$s4 = \"PeekNamedPipe\" fullword ascii /* Goodware String - occured 347 times */   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and filesize < 1000KB and ($x1 or all of ($s*))   \n   }",
			"type": "YARA",
			"id": 30957732
		},
		{
			"indicator": "489f782d67b91ec161bf38fc0333bf6a31976af9",
			"description": "",
			"title": "",
			"content": "rule SHIFU_Banking_Trojan_1 : banking {   \n   \tmeta:   \n   \t\tdescription = \"Detects SHIFU Banking Trojan\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"http://goo.gl/52n8WE\"   \n   \t\tdate = \"2015-10-31\"   \n   \t\tscore = 70   \n   \t\thash1 = \"0066d1c8053ff8b0c07418c7f8d20e5cd64007bb850944269f611febd0c1afe0\"   \n   \t\thash2 = \"3956d32a870d81be34cafc867769b2a2f55a96360070f1cb3d9addc2918357d5\"   \n   \t\thash3 = \"3fde1b2b50fcb36a695f1e6bc577cd930c2343066d98982cf982393e55bfce0d\"   \n   \t\thash4 = \"457ad4a4d4e675fe09f63873ca3364434dc872dde7d9b64ce7db919eaff47485\"   \n   \t\thash5 = \"51edba913e8b83d1388b1be975957e439015289d51d3d5774d501551f220df6f\"   \n   \t\thash6 = \"6611a2b79a3acf0003b1197aa5bfe488a33db69b663c79c6c5b023e86818d38b\"   \n   \t\thash7 = \"72e239924faebf8209f8e3d093f264f778a55efb56b619f26cea73b1c4feb7a4\"   \n   \t\thash8 = \"7a29cb641b9ac33d1bb405d364bc6e9c7ce3e218a8ff295b75ca0922cf418290\"   \n   \t\thash9 = \"92fe4f9a87c796e993820d1bda8040aced36e316de67c9c0c5fc71aadc41e0f8\"   \n   \t\thash10 = \"93ecb6bd7c76e1b66f8c176418e73e274e2c705986d4ac9ede9d25db4091ab05\"   \n   \t\thash11 = \"a0b7fac69a4eb32953c16597da753b15060f6eba452d150109ff8aabc2c56123\"   \n   \t\thash12 = \"a8b6e798116ce0b268e2c9afac61536b8722e86b958bd2ee95c6ecdec86130c9\"   \n   \t\thash13 = \"d6244c1177b679b3d67f6cec34fe0ae87fba21998d4f5024d8eeaf15ca242503\"   \n   \t\thash14 = \"dcc9c38e695ffd121e793c91ca611a4025a116321443297f710a47ce06afb36d\"   \n   \tstrings:   \n   \t\t$x1 = \"\\\\Gather\\\\Dividerail.pdb\" ascii   \n      \n   \t\t$s0 = \"\\\\payload\\\\payload.x86.pdb\" ascii   \n   \t\t$s1 = \"USER_PRIV_GUEST\" fullword wide   \n   \t\t$s2 = \"USER_PRIV_ADMIN\" fullword wide   \n   \t\t$s3 = \"USER_PRIV_USER\" fullword wide   \n   \t\t$s4 = \"PPSWVPP\" fullword ascii   \n   \t\t$s5 = \"WinSCard.dll\" fullword ascii /* Goodware String - occured 83 times */   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and ($x1 or 5 of ($s*))   \n   }",
			"type": "YARA",
			"id": 30957733
		},
		{
			"indicator": "7432efb2d623c83d22c8a017907f460119c5f8d8",
			"description": "",
			"title": "",
			"content": "rule Shifu : banking {   \n   \tmeta:   \n   \t\treference = \"https://blogs.mcafee.com/mcafee-labs/japanese-banking-trojan-shifu-combines-malware-tools/\"   \n   \t\tauthor = \"McAfee Labs\"   \n   \tstrings:   \n   \t\t$b = \"RegCreateKeyA\"   \n   \t\t$a = \"CryptCreateHash\"   \n   \t\t$c = {2F 00 63 00 20 00 73 00 74 00 61 00 72 00 74 00 20 00 22 00 22 00 20 00 22 00 25 00 73 00 22 00 20 00 25 00 73 00 00 00 00 00 63 00 6D 00 64 00 2E 00 65 00 78 00 65 00 00 00 72 00 75 00 6E}   \n   \t\t$d = {53 00 6E 00 64 00 56 00 6F 00 6C 00 2E 00 65 00 78 00 65}   \n   \t\t$e = {52 00 65 00 64 00 69 00 72 00 65 00 63 00 74 00 45 00 58 00 45}   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 30957734
		},
		{
			"indicator": "281c7d7ba74322275e1ec6b50290e0d1840b32ac",
			"description": "",
			"title": "",
			"content": "rule unk_packer   \n   {   \n       meta:   \n           author = \"pekeinfo\"   \n           date = \"2017-02-22\"   \n           description = \"Spora & Cerber ek\"   \n      \n       strings:   \n           $a = {0E 9E 52 69 C8 E4 73 BF 87 2B 95 15 33 1B B7 6B 46 62 D8 C1 01 A9 F9 17 FC EF 1A 6E B7 36 3C C4 72 7D 5D 1A 2D C4 7E 70 E8 0A A0 C6 A3 51 C1 1C 5E 98 E2 72 19 DF 03 C9 D4 25 25 1F EF 6B 46 75 9C BB 1D D2 57 56 35 75 31 35 56 8F B7 5B 23 3D }   \n           $b ={00 10 00 2E E8 77 EC FF FF 85 C0 0F 85 78 C4 FF}   \n      \n       condition:   \n           $a and $b   \n   }",
			"type": "YARA",
			"id": 30957751
		},
		{
			"indicator": "c400a54d638d7fcbe17fb764c55da63b73da4c84",
			"description": "",
			"title": "",
			"content": "rule Spora   \n   {   \n       meta:   \n           author = \"pekeinfo\"   \n           date = \"2017-02-22\"   \n           description = \"Spora\"   \n          \n       strings:   \n           $a={7B 7F 4E 11 5D F3 FE 15 F9 55 FD 00 AD E9 CF FE E2 56 78 03 D0 21 46 00 30 68 C4 D0 01 FD 00 C3 B7 00 4A 0D 57 D2 52 91 05}   \n           $b={6F 51 3E 6B F9 15 29 D9 DF 26 1E 80 62 8A 0D E3 64 51 3B 0F F3 FE FF FF F3 FE FF FF F3 FE FF FF F3 FE FF FF}   \n      \n       condition:   \n           $a and $b    \n   }",
			"type": "YARA",
			"id": 30957752
		},
		{
			"indicator": "ebefb6cd55d8744849f13bcc88c46d34b7a3208f",
			"description": "",
			"title": "",
			"content": "rule T5000Strings : T5000 Family   \n   {   \n       meta:   \n           description = \"T5000 Identifying Strings\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-06-26\"   \n              \n       strings:   \n           $ = \"_tmpR.vbs\"   \n           $ = \"_tmpg.vbs\"   \n           $ = \"Dtl.dat\" wide ascii   \n           $ = \"3C6FB3CA-69B1-454f-8B2F-BD157762810E\"   \n           $ = \"EED5CA6C-9958-4611-B7A7-1238F2E1B17E\"   \n           $ = \"8A8FF8AD-D1DE-4cef-B87C-82627677662E\"   \n           $ = \"43EE34A9-9063-4d2c-AACD-F5C62B849089\"   \n           $ = \"A8859547-C62D-4e8b-A82D-BE1479C684C9\"   \n           $ = \"A59CF429-D0DD-4207-88A1-04090680F714\"   \n           $ = \"utd_CE31\" wide ascii   \n           $ = \"f:\\\\Project\\\\T5000\\\\Src\\\\Target\\\\1 KjetDll.pdb\"   \n           $ = \"l:\\\\MyProject\\\\Vc 7.1\\\\T5000\\\\T5000Ver1.28\\\\Target\\\\4 CaptureDLL.pdb\"   \n           $ = \"f:\\\\Project\\\\T5000\\\\Src\\\\Target\\\\4 CaptureDLL.pdb\"   \n           $ = \"E:\\\\VS2010\\\\xPlat2\\\\Release\\\\InstRes32.pdb\"   \n              \n       condition:   \n          any of them   \n   }",
			"type": "YARA",
			"id": 30957758
		},
		{
			"indicator": "ad4284189f83ffe1d8c059f8a23a16642b739b75",
			"description": "",
			"title": "",
			"content": "rule Tinba2 : banking {   \n           meta:   \n                   author = \"n3sfox <n3sfox@gmail.com>\"   \n                   date = \"2015/11/07\"   \n                   description = \"Tinba 2 (DGA) banking trojan\"   \n                   reference = \"https://securityintelligence.com/tinba-malware-reloaded-and-attacking-banks-around-the-world\"   \n                   filetype = \"memory\"   \n                   hash1 = \"c7f662594f07776ab047b322150f6ed0\"   \n                   hash2 = \"dc71ef1e55f1ddb36b3c41b1b95ae586\"   \n                   hash3 = \"b788155cb82a7600f2ed1965cffc1e88\"   \n      \n           strings:   \n                   $str1 = \"MapViewOfFile\"   \n                   $str2 = \"OpenFileMapping\"   \n                   $str3 = \"NtCreateUserProcess\"   \n                   $str4 = \"NtQueryDirectoryFile\"   \n                   $str5 = \"RtlCreateUserThread\"   \n                   $str6 = \"DeleteUrlCacheEntry\"   \n                   $str7 = \"PR_Read\"   \n                   $str8 = \"PR_Write\"   \n                   $pubkey = \"BEGIN PUBLIC KEY\"   \n                   $code1 = {50 87 44 24 04 6A ?? E8}   \n      \n           condition:   \n                   all of ($str*) and $pubkey and $code1   \n   }",
			"type": "YARA",
			"id": 30957763
		},
		{
			"indicator": "4a77e2ceb614b75a51a9d747eb08c08d8d230e5b",
			"description": "",
			"title": "",
			"content": "rule TreasureHunt   \n     {   \n       meta:   \n         author = \"Minerva Labs\"   \n         ref =\"http://www.minerva-labs.com/#!Cybercriminals-Adopt-the-Mossad-Emblem/c7a5/573da2d60cf2f90ca6f6e3ed\"   \n         date = \"2016/06\"   \n         maltype = \"Point of Sale (POS) Malware\"   \n         filetype = \"exe\"   \n      \n       strings:   \n         $a = \"treasureHunter.pdb\"   \n         $b = \"jucheck\"   \n         $c = \"cmdLineDecrypted\"   \n      \n       condition:   \n         all of them   \n   }",
			"type": "YARA",
			"id": 31000046
		},
		{
			"indicator": "677188be54173bad67fe7e95a1973f1d10b09312",
			"description": "",
			"title": "",
			"content": "rule MALW_trickbot_bankBot : Trojan   \n   {   \n   meta:   \n    author = \"Marc Salinas @Bondey_m\"   \n    description = \"Detects Trickbot Banking Trojan\"   \n   strings:   \n   $str_trick_01 = \"moduleconfig\"   \n   $str_trick_02 = \"Start\"   \n   $str_trick_03 = \"Control\"   \n   $str_trick_04 = \"FreeBuffer\"   \n   $str_trick_05 = \"Release\"   \n   condition:   \n   all of ($str_trick_*)   \n   }",
			"type": "YARA",
			"id": 31000047
		},
		{
			"indicator": "8c8d9909b69e430e0439c2889935c220947fcbed",
			"description": "",
			"title": "",
			"content": "rule MALW_systeminfo_trickbot_module :   \n   Trojan   \n   {   \n   meta:   \n   author = \"Marc Salinas @Bondey_m\"   \n   description = \"Detects systeminfo module from Trickbot Trojan\"   \n   strings:   \n   $str_systeminf_01 = \"<program>\"   \n   $str_systeminf_02 = \"<service>\"   \n   $str_systeminf_03 = \"</systeminfo>\"   \n   $str_systeminf_04 =   \n   \"GetSystemInfo.pdb\"   \n   $str_systeminf_05 = \"</autostart>\"   \n   $str_systeminf_06 = \"</moduleconfig>\"   \n   condition:   \n   all of ($str_systeminf_*)   \n   }",
			"type": "YARA",
			"id": 31000048
		},
		{
			"indicator": "9c1056019db63f3cce5e49bdbfc49918118f8b81",
			"description": "",
			"title": "",
			"content": "rule MALW_mailsercher_trickbot_module :   \n   Trojan   \n   {   \n   meta:   \n   author = \"Marc Salinas @Bondey_m\"   \n   description = \" Detects mailsearcher module from Trickbot Trojan\"   \n   strings:   \n   $str_mails_01 = \"mailsearcher\"   \n   $str_mails_02 = \"handler\"   \n   $str_mails_03 = \"conf\"   \n   $str_mails_04 = \"ctl\"   \n   $str_mails_05 = \"SetConf\"   \n   $str_mails_06 = \"file\"   \n   $str_mails_07 = \"needinfo\"   \n   $str_mails_08 = \"mailconf\"   \n   condition:   \n   all of ($str_mails_*)   \n   }",
			"type": "YARA",
			"id": 31000049
		},
		{
			"indicator": "f24c75f560f0067dc71c923149e9b31412eb8264",
			"description": "",
			"title": "",
			"content": "rule MALW_dllinject_trickbot_module : Trojan   \n   {   \n   meta:   \n   author = \"Marc Salinas @Bondey_m\"   \n   description = \" Detects dllinject module from Trickbot Trojan\"   \n   strings:   \n   $str_dllinj_01 = \"user_pref(\"   \n   $str_dllinj_02 = \"<ignore_mask>\"   \n   $str_dllinj_03 = \"<require_header>\"   \n   $str_dllinj_04 = \"</dinj>\"   \n   condition:   \n   all of ($str_dllinj_*)   \n   }",
			"type": "YARA",
			"id": 31000050
		},
		{
			"indicator": "74da37adee9f614ec6ec27ad062d0fb589ec294c",
			"description": "",
			"title": "",
			"content": "rule Upatre_Hazgurut {   \n   \tmeta:   \n   \t\tdescription = \"Detects Upatre malware - file hazgurut.exe\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"https://weankor.vxstream-sandbox.com/sample/6b857ef314938d37997c178ea50687a281d8ff9925f0c4e70940754643e2c0e3?environmentId=7\"   \n   \t\tdate = \"2015-10-13\"   \n   \t\tscore = 70   \n   \t\thash1 = \"7ee0d20b15e24b7fe72154d9521e1959752b4e9c20d2992500df9ac096450a50\"   \n   \t\thash2 = \"79ffc620ddb143525fa32bc6a83c636168501a4a589a38cdb0a74afac1ee8b92\"   \n   \t\thash3 = \"62d8a6880c594fe9529158b94a9336179fa7a3d3bf1aa9d0baaf07d03b281bd3\"   \n   \t\thash4 = \"c64282aca980d558821bec8b3dfeae562d9620139dc43d02ee4d1745cd989f2a\"   \n   \t\thash5 = \"a35f9870f9d4b993eb094460b05ee1f657199412807abe6264121dd7cc12aa70\"   \n   \t\thash6 = \"f8cb2730ebc8fac1c58da1346ad1208585fe730c4f03d976eb1e13a1f5d81ef9\"   \n   \t\thash7 = \"b65ad7e2d299d6955d95b7ae9b62233c34bc5f6aa9f87dc482914f8ad2cba5d2\"   \n   \t\thash8 = \"6b857ef314938d37997c178ea50687a281d8ff9925f0c4e70940754643e2c0e3\"   \n   \t\thash9 = \"33a288cef0ae7192b34bd2ef3f523dfb7c6cbc2735ba07edf988400df1713041\"   \n   \t\thash10 = \"2a8e50afbc376cb2a9700d2d83c1be0c21ef942309676ecac897ba4646aba273\"   \n   \t\thash11 = \"3d0f2c7e07b7d64b1bad049b804ff1aae8c1fc945a42ad555eca3e1698c7f7d3\"   \n   \t\thash12 = \"951360b32a78173a1f81da0ded8b4400e230125d05970d41621830efc5337274\"   \n   \t\thash13 = \"bd90faebfd7663ef89b120fe69809532cada3eb94bb94094e8bc615f70670295\"   \n   \t\thash14 = \"8c5823f67f9625e4be39a67958f0f614ece49c18596eacc5620524bc9b6bad3d\"   \n   \tstrings:   \n   \t\t$a1 = \"barcod\" fullword ascii   \n      \n   \t\t$s0 = \"msports.dll\" fullword ascii   \n   \t\t$s1 = \"nddeapi.dll\" fullword ascii   \n   \t\t$s2 = \"glmf32.dll\" fullword ascii   \n   \t\t$s3 = \"<requestedExecutionLevel level=\\\"requireAdministrator\\\" uiAccess=\\\"false\\\">\" fullword ascii   \n   \t\t$s4 = \"cmutil.dll\" fullword ascii   \n   \t\t$s5 = \"mprapi.dll\" fullword ascii   \n   \t\t$s6 = \"glmf32.dll\" fullword ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and filesize < 1500KB   \n   \t\tand $a1 in (0..4000)   \n   \t\tand all of ($s*)   \n   }",
			"type": "YARA",
			"id": 31000051
		},
		{
			"indicator": "dac52fee854553d2315168f948c2b5cb97b273c4",
			"description": "",
			"title": "",
			"content": "rule VidgrabCode : Vidgrab Family    \n   {   \n       meta:   \n           description = \"Vidgrab code tricks\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-06-20\"   \n              \n       strings:   \n           $divbyzero = { B8 02 00 00 00 48 48 BA 02 00 00 00 83 F2 02 F7 F0 }   \n           // add eax, ecx; xor byte ptr [eax], ??h; inc ecx   \n           $xorloop = { 03 C1 80 30 (66 | 58) 41 }   \n           $junk = { 8B 4? ?? 8B 4? ?? 03 45 08 52 5A }   \n              \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 31011941
		},
		{
			"indicator": "691121b31029d0c2d87cb4a05c4e378508f68e31",
			"description": "",
			"title": "",
			"content": "rule VidgrabStrings : Vidgrab Family   \n   {   \n       meta:   \n           description = \"Vidgrab Identifying Strings\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-06-20\"   \n              \n       strings:   \n           $ = \"IDI_ICON5\" wide ascii   \n           $ = \"starter.exe\"   \n           $ = \"wmifw.exe\"   \n           $ = \"Software\\\\rar\"   \n           $ = \"tmp092.tmp\"   \n           $ = \"temp1.exe\"   \n              \n       condition:   \n          3 of them   \n   }",
			"type": "YARA",
			"id": 31011942
		},
		{
			"indicator": "574527e301d15f521d5518f9ac3045dbe74790fc",
			"description": "",
			"title": "",
			"content": "rule XOR_DDosv1 : DDoS   \n   {   \n     meta:   \n       author = \"Akamai CSIRT\"   \n       description = \"Rule to detect XOR DDos infection\"   \n     strings:   \n       $st0 = \"BB2FA36AAA9541F0\"   \n       $st1 = \"md5=\"   \n       $st2 = \"denyip=\"   \n       $st3 = \"filename=\"   \n       $st4 = \"rmfile=\"   \n       $st5 = \"exec_packet\"   \n       $st6 = \"build_iphdr\"   \n     condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 31013861
		},
		{
			"indicator": "fd4261ec112d426ddeb2d01e0ebd224a0a84c952",
			"description": "",
			"title": "",
			"content": "rule Zegost : Trojan   \n   {   \n   \tmeta:   \n   \t\tauthor=\"Kevin Falcoz\"   \n   \t\tdate=\"10/06/2013\"   \n   \t\tdescription=\"Zegost Trojan\"   \n   \t\t   \n   \tstrings:   \n   \t\t$signature1={39 2F 66 33 30 4C 69 35 75 62 4F 35 44 4E 41 44 44 78 47 38 73 37 36 32 74 71 59 3D}   \n   \t\t$signature2={00 BA DA 22 51 42 6F 6D 65 00}   \n   \t\t   \n   \tcondition:   \n   \t\t$signature1 and $signature2   \n   }",
			"type": "YARA",
			"id": 31013862
		},
		{
			"indicator": "caeb03337a5978d8b2e9170cbe04d005f4e1dcee",
			"description": "",
			"title": "",
			"content": "rule Windows_Malware : Zeus_1134   \n       {   \n               meta:   \n                       author = \"Xylitol xylitol@malwareint.com\"   \n                       date = \"2014-03-03\"   \n                       description = \"Match first two bytes, protocol and string present in Zeus 1.1.3.4\"   \n                       reference = \"http://www.xylibox.com/2014/03/zeus-1134.html\"   \n                          \n               strings:   \n                       $mz = {4D 5A}   \n                       $protocol1 = \"X_ID: \"   \n                       $protocol2 = \"X_OS: \"   \n                       $protocol3 = \"X_BV: \"   \n                       $stringR1 = \"InitializeSecurityDescriptor\"   \n                       $stringR2 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; SV1)\"   \n               condition:   \n                       ($mz at 0 and all of ($protocol*) and ($stringR1 or $stringR2))   \n       }",
			"type": "YARA",
			"id": 31013864
		},
		{
			"indicator": "9ec1deca5c281fd01d95b0079d1c0fc9b041cf7f",
			"description": "",
			"title": "",
			"content": "rule xDedic_SysScan_unpacked : crimeware {   \n   meta:   \n   author = \" Kaspersky Lab\"   \n   ref = \"https://securelist.com/files/2016/06/xDedic_marketplace_ENG.pdf\"   \n   maltype = \"crimeware\"   \n   type =\"crimeware\"   \n   filetype = \"Win32 EXE\"   \n   date = \"2016-03-14\"   \n   version = \"1.0\"   \n   hash = \"fac495be1c71012682ebb27092060b43\"   \n   hash = \"e8cc69231e209db7968397e8a244d104\"   \n   hash = \"a53847a51561a7e76fd034043b9aa36d\"   \n   hash = \"e8691fa5872c528cd8e72b82e7880e98\"   \n   hash = \"F661b50d45400e7052a2427919e2f777\"   \n   strings:   \n   $a1=\"/c ping -n 2 127.0.0.1 & del \\\"SysScan.exe\\\"\" ascii wide   \n   $a2=\"SysScan DEBUG Mode!!!\" ascii wide   \n   $a3=\"This rechecking? (set 0/1 or press enter key)\" ascii wide   \n   $a4=\"http://37.49.224.144:8189/manual_result\" ascii wide   \n   $b1=\"Checker end work!\" ascii wide   \n   $b2=\"Trying send result...\" ascii wide   \n   condition:   \n   ((uint16(0) == 0x5A4D)) and (filesize < 5000000) and   \n   ((any of ($a*)) or (all of ($b*)))   \n   }",
			"type": "YARA",
			"id": 31013986
		},
		{
			"indicator": "c684e1b5e646d7a18c53544b270c2fd8dcfab7f5",
			"description": "",
			"title": "",
			"content": "rule blackpos_v2   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \tversion = \"0.1\"   \n   \treference = \"http://blog.nuix.com/2014/09/08/blackpos-v2-new-variant-or-different-family\"   \n   strings:   \n   \t$s1 = \"Usage: -[start|stop|install|uninstall\"   \n   \t$s2 = \"\\\\SYSTEM32\\\\sc.exe config LanmanWorkstation\"   \n   \t$s3 = \"t.bat\"   \n   \t$s4 = \"mcfmisvc\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 31013993
		},
		{
			"indicator": "a13a2e075f8c9ae5d876e0f117dfb895be78951c",
			"description": "",
			"title": "",
			"content": "rule dump_tool   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"Related to pwdump6 and fgdump tools\"   \n   strings:   \n   \t$s1 = \"lsremora\"   \n   \t$s2 = \"servpw\"   \n   \t$s3 = \"failed: %d\"   \n   \t$s4 = \"fgdump\"   \n   \t$s5 = \"fgexec\"   \n   \t$s6 = \"fgexecpipe\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and 3 of ($s*)   \n   }",
			"type": "YARA",
			"id": 31013994
		},
		{
			"indicator": "13603bd4622d2d4a8ade482d40eb60edfef52f77",
			"description": "",
			"title": "",
			"content": "rule regex_pos   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"POS malware - Regex\"   \n   strings:   \n   \t$n1 = \"REGEXEND\" nocase   \n   \t$n2 = \"RegExpr\" nocase   \n   \t$n3 = \"regex\"   \n   \t$s4 = \"[1-5][0-9]{14}=(?!1201|1202|1203|1204|11|10|09|08|07|06|05|04|03|02)[0-9]{5}[0-9]*\"   \n   \t$s5 = \"[47][0-9]{13}=(?!1201|1202|1203|1204|11|10|09|08|07|06|05|04|03|02)[0-9]{5}[0-9]*\"   \n   \t$s6 = \"(?:0[0-5]|[68][0-9])[0-9]{11}=(?!1201|1202|1203|1204|11|10|09|08|07|06|05|04|03|02)[0-9]{5}[0-9]*\"   \n   \t$s7 = \"(?:011|5[0-9]{2})[0-9]{12}=(?!1201|1202|1203|1204|11|10|09|08|07|06|05|04|03|02)[0-9]{5}[0-9]*\"   \n   \t$s8 = \"(?:2131|1800|35\\\\d{3})\\\\d{11}=(?!1201|1202|1203|1204|11|10|09|08|07|06|05|04|03|02)[0-9]{5}[0-9]*\"   \n   \t$s9 = \"([0-9]{15,16}[D=](0[7-9]|1[0-5])((0[1-9])|(1[0-2]))[0-9]{8,30})\"   \n   \t$s10 = \"((b|B)[0-9]{13,19}\\\\^[A-Za-z\\\\s]{0,30}\\\\/[A-Za-z\\\\s]{0,30}\\\\^(0[7-9]|1[0-5])((0[1-9])|(1[0-2]))[0-9\\\\s]{3,50}[0-9]{1})\"   \n   \t$s11 = \"[0-9]*\\\\^[a-zA-Z]*/[a-zA-Z ]*\\\\^[0-9]*\"   \n   \t$s12 = \"\\\\d{15,19}=\\\\d{13,}\"   \n   \t$s13 = \"\\\\;?[3-9]{1}[0-9]{12,19}[D=\\\\u0061][0-9]{10,30}\\\\??\"   \n   \t$s14 = \"[0-9]{12}(?:[0-9]{3})?=(?!1201|1202|1203|1204|11|10|09|08|07|06|05|04|03|02)[0-9]{5}[0-9]*\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and 1 of ($n*) and 1 of ($s*)   \n   }",
			"type": "YARA",
			"id": 31013995
		},
		{
			"indicator": "6ba721108a6dbc9480dfcc7baa7970ceac02ddb3",
			"description": "",
			"title": "",
			"content": "rule unknown   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"Unknown POS\"   \n   strings:   \n   \t$s1 = \"a.exe\" wide   \n   \t$s2 = \"Can anyone test\" wide   \n   \t$s3 = \"I m in computer class now\" wide   \n   condition:   \n   \tuint16(0) == 0x5A4D and 3 of ($s*)   \n   }",
			"type": "YARA",
			"id": 31013996
		},
		{
			"indicator": "ccfc7c12bb5d5f76eed47d326654e2aed07e013e",
			"description": "",
			"title": "",
			"content": "rule monitor_tool_pos   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"POS malware - Monitoring Tool??\"   \n   strings:   \n   \t$s1 = \"RCPT TO\"   \n   \t$s2 = \"MAIL FROM\"   \n   \t$s3 = \"AUTH LOGIN\"   \n   \t$s4 = \"Reply-To\"   \n   \t$s5 = \"X-Mailer\"   \n   \t$s6 = \"crypto\"   \n   \t$s7 = \"test335.txt\" wide   \n   \t$s8 = \"/c del\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and 7 of ($s*)   \n   }",
			"type": "YARA",
			"id": 31013997
		},
		{
			"indicator": "49e68de3d2634eb71ed868fffbd1fe5e6302439c",
			"description": "",
			"title": "",
			"content": "rule pos_uploader   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \tmaltype = \"Point of Sale (POS) Malware\"   \n       reference = \"http://blogs.mcafee.com/mcafee-labs/analyzing-the-target-point-of-sale-malware\"   \n   \tversion = \"0.1\"   \n   \tdescription = \"Testing the base64 encoded file in sys32\"   \n   \tdate = \"01/30/2014\"   \n   strings:   \n   \t$s1 = \"cmd /c net start %s\"   \n   \t$s2 = \"ftp -s:%s\"   \n   \t$s3 = \"data_%d_%d_%d_%d_%d.txt\"   \n   \t$s4 = \"\\\\uploader\\\\\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 31013998
		},
		{
			"indicator": "c30e5afdd3dc8eadf3f57e4eefdeb64137e17dd6",
			"description": "",
			"title": "",
			"content": "rule lacy_keylogger   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"Appears to be a form of keylogger.\"   \n   strings:   \n   \t$s1 = \"Lacy.exe\" wide   \n   \t$s2 = \"Bldg Chive Duel Rip Query\" wide   \n   condition:   \n   \tuint16(0) == 0x5A4D and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 31013999
		},
		{
			"indicator": "cb82457ea4ba3e016ec4ebfff8a4e7ed0422e093",
			"description": "",
			"title": "",
			"content": "rule winxml_dll   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \tmaltype = \"Point of Sale (POS) Malware\"   \n       reference = \"ce0296e2d77ec3bb112e270fc260f274\"   \n   \tversion = \"0.1\"   \n   \tdescription = \"Testing the base64 encoded file in sys32\"   \n   \tdate = \"01/30/2014\"   \n   strings:   \n   \t$s1 = \"\\\\system32\\\\winxml.dll\"   \n   \t//$s2 = \"cmd /c net start %s\"   \n   \t//$s3 = \"=== pid:\"   \n   \t//$s4 = \"GOTIT\"   \n   \t//$s5 = \".memdump\"   \n   \t//$s6 = \"POSWDS\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and (all of ($s*))   \n   }",
			"type": "YARA",
			"id": 31014000
		},
		{
			"indicator": "7a08a4b300fcd8e2f4beb4ed51710b03c474a50a",
			"description": "",
			"title": "",
			"content": "rule sets_pos   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"POS malware - Sets\"   \n   strings:   \n   \t$s1 = \"GET /sets.txt\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and $s1   \n   }",
			"type": "YARA",
			"id": 31014001
		},
		{
			"indicator": "0b7b5fae2bde4035553be61cd7e46391450bf590",
			"description": "",
			"title": "",
			"content": "rule searchinject   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"Usage: SearchInject <PID1>[PID2][PID3] - It loads Searcher.dll (appears to be hard coded)\"   \n   strings:   \n   \t$s1 = \"SearchInject\"   \n   \t$s2 = \"inject base:\"   \n   \t$s3 = \"Searcher.dll\" nocase   \n   condition:   \n   \tuint16(0) == 0x5A4D and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 31014002
		},
		{
			"indicator": "7d56c3c1e626832b79264c681026b77558840c65",
			"description": "",
			"title": "",
			"content": "rule pstgdump   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"pstgdump\"   \n   strings:   \n   \t$s1 = \"fgdump\\\\pstgdump\"   \n   \t$s2 = \"pstgdump\"   \n   \t$s3 = \"Outlook\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 31014003
		},
		{
			"indicator": "5e909d6f2625bd41a39edf6181f75c808cd46203",
			"description": "",
			"title": "",
			"content": "rule memdump_diablo   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"Process Memory Dumper - DiabloHorn\"   \n   strings:   \n   \t$s1 = \"DiabloHorn\"   \n   \t$s2 = \"Process Memory Dumper\"   \n   \t$s3 = \"pid-%s.dmp\"   \n   \t$s4 = \"Pid %d in not acessible\" // SIC   \n   \t$s5 = \"memdump.exe\"   \n   \t$s6 = \"%s-%d.dmp\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and 3 of ($s*)   \n   }",
			"type": "YARA",
			"id": 31014004
		},
		{
			"indicator": "a272359a20eee0c291c77b95bd049ccc1981843a",
			"description": "",
			"title": "",
			"content": "rule sysocmgr   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"System stand-alone Optional Component Manager - http://support.microsoft.com/kb/222444\"   \n   strings:   \n   \t$s1 = \"SYSOCMGR.EXE\" wide   \n   \t$s2 = \"System stand-alone Optional Component Manager\" wide   \n   condition:   \n   \tuint16(0) == 0x5A4D and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 31014005
		},
		{
			"indicator": "81ba74f62912c0d48973169b5b71826ae5fc9b31",
			"description": "",
			"title": "",
			"content": "rule pos_malwre_dexter_stardust   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \tmaltype = \"Dexter Malware - StarDust Variant\"   \n   \tversion = \"0.1\"   \n   \tdescription = \"Table 2 arbornetworks.com/asert/wp-content/uploads/2013/12/Dexter-and-Project-Hook-Break-the-Bank.pdf\"   \n   \treference = \"16b596de4c0e4d2acdfdd6632c80c070, 2afaa709ef5260184cbda8b521b076e1, and e3dd1dc82ddcfaf410372ae7e6b2f658\"   \n   \tdate = \"12/30/2013\"   \n   strings:   \n   \t$s1 = \"ceh_3\\\\.\\\\ceh_4\\\\..\\\\ceh_6\"   \n   \t$s2 = \"Yatoed3fe3rex23030am39497403\"   \n   \t$s3 = \"Poo7lo276670173quai16568unto1828Oleo9eds96006nosysump7hove19\"   \n   \t$s4 = \"CommonFile.exe\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 31014006
		},
		{
			"indicator": "f6937fc39440d28732815a5a25dccfb7dcd38547",
			"description": "",
			"title": "",
			"content": "rule pos_malware_project_hook   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \tmaltype = \"Project Hook\"   \n   \tversion = \"0.1\"   \n   \tdescription = \"Table 1 arbornetworks.com/asert/wp-content/uploads/2013/12/Dexter-and-Project-Hook-Break-the-Bank.pdf\"   \n   \treference = \"759154d20849a25315c4970fe37eac59\"   \n   \tdate = \"12/30/2013\"   \n   strings:   \n   \t$s1 = \"CallImage.exe\"   \n   \t$s2 = \"BurpSwim\"   \n   \t$s3 = \"Work\\\\Project\\\\Load\"   \n   \t$s4 = \"WortHisnal\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 31014007
		},
		{
			"indicator": "cf4c9ec69f86e752c7d9e88988d9283b81c7ad9b",
			"description": "",
			"title": "",
			"content": "rule regexpr_pos   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"POS malware - RegExpr\"   \n   strings:   \n   \t$s1 = \"RegExpr\" nocase   \n   \t$s2 = \"Data.txt\"   \n   \t$s3 = \"Track1\"   \n   \t$s4 = \"Track2\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and 3 of ($s*)   \n   }",
			"type": "YARA",
			"id": 31014008
		},
		{
			"indicator": "a4ee1c089e017fc6dd27faf8f0d69e7680b5da75",
			"description": "",
			"title": "",
			"content": "rule pos_jack   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \tmaltype = \"Point of Sale (POS) Malware\"   \n   \tversion = \"0.1\"   \n   \treference = \"http://blog.spiderlabs.com/2014/02/jackpos-the-house-always-wins.html\"   \n   \tdate = \"2/22/2014\"   \n   strings:   \n   \t$pdb1 = \"\\\\ziedpirate.ziedpirate-PC\\\\\"   \n   \t$pdb2 = \"\\\\sop\\\\sop\\\\\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and 1 of ($pdb*)   \n   }",
			"type": "YARA",
			"id": 31014009
		},
		{
			"indicator": "f2746ffd62bdf3c5f03bd45c7fccfebbbf24f7aa",
			"description": "",
			"title": "",
			"content": "rule heistenberg_pos   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"POS Malware\"   \n   strings:   \n   \t$s1 = \"KARTOXA\"   \n   \t$s2 = \"dmpz.log\"   \n   \t$s3 = \"/api/process.php?xy=\"   \n   \t$s4 = \"User-Agent: PCICompliant\" // PCICompliant/3.33   \n   \t$s6 = \"%s:*:Enabled:%s\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and 3 of ($s*)   \n   }",
			"type": "YARA",
			"id": 31014010
		},
		{
			"indicator": "81c3214c866943e249071b79e90d09ab9697ec49",
			"description": "",
			"title": "",
			"content": "rule keyfinder_tool   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"Magical Jelly Bean KeyFinder\"   \n   strings:   \n   \t$s1 = \"chgxp.vbs\"   \n   \t$s2 = \"officekey.exe\"   \n   \t$s3 = \"findkey.exe\"   \n   \t$s4 = \"xpkey.exe\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and 2 of ($s*)   \n   }",
			"type": "YARA",
			"id": 31014011
		},
		{
			"indicator": "ccbe07542ae66224d3e1ba2cd1157f81f23ae3a6",
			"description": "",
			"title": "",
			"content": "rule reg_pos   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"POS malware - RegExpr\"   \n   strings:   \n   \t$s1 = \"T1_FOUND: %s\"   \n   \t$s2 = \"id=%s&log=%s\"   \n   \t$s3 = \"\\\\d{15,19}=\\\\d{13,}\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and 2 of ($s*)   \n   }",
			"type": "YARA",
			"id": 31014012
		},
		{
			"indicator": "3828e360858e7fd89a5fc4ba784b296dba2bdcdd",
			"description": "",
			"title": "",
			"content": "rule misc_pos   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"POS Malware\"   \n   strings:   \n   \t$s1 = \"KAPTOXA\"   \n   \t$s2 = \"cmd /c net start %s\"   \n   \t$s3 = \"pid:\"   \n   \t$s4 = \"%ADD%\"   \n   \t$s5 = \"COMSPEC\"   \n   \t$s6 = \"KARTOXA\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and 3 of ($s*)   \n   }",
			"type": "YARA",
			"id": 31014013
		},
		{
			"indicator": "2f7fe4755ac45fe31959c850225c466245e49608",
			"description": "",
			"title": "",
			"content": "rule pos_chewbacca   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \tmaltype = \"Point of Sale (POS) Malware\"   \n       reference = \"https://www.securelist.com/en/blog/208214185/ChewBacca_a_new_episode_of_Tor_based_Malware\"   \n       hashes = \"21f8b9d9a6fa3a0cd3a3f0644636bf09, 28bc48ac4a92bde15945afc0cee0bd54\"   \n   \tversion = \"0.2\"   \n   \tdescription = \"Testing the base64 encoded file in sys32\"   \n   \tdate = \"01/30/2014\"   \n   strings:   \n   \t$s1 = \"tor -f <torrc>\"   \n   \t$s2 = \"tor_\"   \n   \t$s3 = \"umemscan\"   \n   \t$s4 = \"CHEWBAC\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and (all of ($s*))   \n   }",
			"type": "YARA",
			"id": 31014014
		},
		{
			"indicator": "fc6f8d65a9800ef7eba57e93578dd75b95d44e73",
			"description": "",
			"title": "",
			"content": "rule pdb_strings_Rescator   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \tmaltype = \"Target Attack\"   \n   \tversion = \"0.3\"   \n   \tdescription = \"Rescator PDB strings within binaries\"   \n   \tdate = \"01/30/2014\"   \n   strings:   \n   \t$pdb1 = \"\\\\Projects\\\\Rescator\" nocase   \n   condition:   \n   \tuint16(0) == 0x5A4D and $pdb1   \n   }",
			"type": "YARA",
			"id": 31014015
		},
		{
			"indicator": "21a0b337d3a7f6cd0ffbb6eda2d1945f71bf354d",
			"description": "",
			"title": "",
			"content": "rule pos_memory_scrapper_   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \tmaltype = \"Point of Sale (POS) Malware Memory Scraper\"   \n   \tversion = \"0.3\"   \n   \tdescription = \"POS Memory Scraper\"   \n   \tdate = \"01/30/2014\"   \n   strings:   \n   \t$s1 = \"kartoxa\" nocase   \n   \t$s2 = \"CC2 region:\"   \n   \t$s3 = \"CC memregion:\"   \n   \t$s4 = \"target pid:\"   \n   \t$s5 = \"scan all processes:\"   \n   \t$s6 = \"<pid> <PATTERN>\"   \n   \t$s7 = \"KAPTOXA\"   \n   \t$s8 = \"ATTERN\"   \n   \t$s9 = \"\\\\svhst%p\"   \n   condition:   \n   \tuint16(0) == 0x5A4D and 3 of ($s*)   \n   }",
			"type": "YARA",
			"id": 31014016
		},
		{
			"indicator": "bba215d9c1f426c9d75f3f02b23c2dfcc81ef63a",
			"description": "",
			"title": "",
			"content": "rule blazingtools   \n   {   \n   meta:   \n   \tauthor = \"@patrickrolsen\"   \n   \treference = \"Blazing Tools - http://www.blazingtools.com (Keyloggers)\"   \n   strings:   \n   \t$s1 = \"blazingtools.com\"   \n   \t$s2 = \"Keystrokes\" wide   \n   \t$s3 = \"Screenshots\" wide   \n   condition:   \n   \tuint16(0) == 0x5A4D and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 31014017
		},
		{
			"indicator": "ef5009c8a880704d3f5f856ce9d8f320c4e96e3e",
			"description": "",
			"title": "",
			"content": "rule easterjackpos {   \n       meta:   \n           author = \"Brian Wallace @botnet_hunter\"   \n           author_email = \"bwall@ballastsecurity.net\"   \n           date = \"2014-09-02\"   \n           description = \"Identify JackPOS\"   \n   \tstrings:   \n   \t    $s1 = \"updateinterval=\"   \n           $s2 = \"cardinterval=\"   \n           $s3 = \"{[!17!]}{[!18!]}\"   \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 31014029
		},
		{
			"indicator": "e5d9a9cdb2e784b8328cecc273645dc03ce32ea7",
			"description": "",
			"title": "",
			"content": "rule PoS_Malware_fastpos : FastPOS POS keylogger   \n   {   \n   meta:   \n   author = \"Trend Micro, Inc.\"   \n   date = \"2016-05-18\"   \n   description = \"Used to detect FastPOS keyloggger + scraper\"   \n   reference = \"http://documents.trendmicro.com/assets/fastPOS-quick-and-easy-credit-card-theft.pdf\"   \n   sample_filetype = \"exe\"   \n   strings:   \n   $string1 = \"uniqyeidclaxemain\"   \n   $string2 = \"http://%s/cdosys.php\"   \n   $string3 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\"   \n   $string4 = \"\\\\The Hook\\\\Release\\\\The Hook.pdb\" nocase   \n   condition:   \n   all of ($string*)   \n   }",
			"type": "YARA",
			"id": 31014030
		},
		{
			"indicator": "12091c7ef76691fcba835ad0cfea02729258dc68",
			"description": "",
			"title": "",
			"content": "rule Mozart   \n   {   \n      meta:   \n          author = \"Nick Hoffman - Morphick Inc\"   \n          description = \"Detects samples of the Mozart POS RAM scraping utility\"   \n          reference = \"http://securitykitten.github.io/the-mozart-ram-scraper/\"   \n      strings:   \n          $pdb = \"z:\\\\Slender\\\\mozart\\\\mozart\\\\Release\\\\mozart.pdb\" nocase wide ascii   \n          $output = {67 61 72 62 61 67 65 2E 74 6D 70 00}   \n          $service_name = \"NCR SelfServ Platform Remote Monitor\" nocase wide ascii   \n          $service_name_short = \"NCR_RemoteMonitor\"   \n          $encode_data = {B8 08 10 00 00 E8 ?? ?? ?? ?? A1 ?? ?? ?? ?? 53 55 8B AC 24 14 10 00 00 89 84 24 0C 10 00 00 56 8B C5 33 F6 33 DB 8D 50 01 8D A4 24 00 00 00 00 8A 08 40 84 C9 ?? ?? 2B C2 89 44 24 0C ?? ?? 8B 94 24 1C 10 00 00 57 8B FD 2B FA 89 7C 24 10 ?? ?? 8B 7C 24 10 8A 04 17 02 86 E0 BA 40 00 88 02 B8 ?? ?? ?? ?? 46 8D 78 01 8D A4 24 00 00 00 00 8A 08 40 84 C9 ?? ?? 2B C7 3B F0 ?? ?? 33 F6 8B C5 43 42 8D 78 01 8A 08 40 84 C9 ?? ?? 2B C7 3B D8 ?? ?? 5F 8B B4 24 1C 10 00 00 8B C5 C6 04 33 00 8D 50 01 8A 08 40 84 C9 ?? ?? 8B 8C 24 20 10 00 00 2B C2 51 8D 54 24 14 52 50 56 E8 ?? ?? ?? ?? 83 C4 10 8B D6 5E 8D 44 24 0C 8B C8 5D 2B D1 5B 8A 08 88 0C 02 40 84 C9 ?? ?? 8B 8C 24 04 10 00 00 E8 ?? ?? ?? ?? 81 C4 08 10 00 00}   \n      condition:   \n         any of ($pdb, $output, $encode_data) or   \n         all of ($service*)   \n   }",
			"type": "YARA",
			"id": 31025930
		},
		{
			"indicator": "cb6030f721066735aba639b406610e0a8fb426f2",
			"description": "",
			"title": "",
			"content": "rule cerber5b {   \n   meta:   \n     author = \"pekeinfo\"   \n     date = \"2016-12-20\"   \n     description = \"Cerber5b\"   \n   strings:   \n     $a={8B ?? ?8 ?? 4? 00 83 E? 02 89 ?? ?8 ?? 4? 00 68 ?C ?9 4? 00 [0-6] ?? ?? ?? ?? ?? ?8 ?? 4? 00 5? FF 15 ?? ?9 4? 00 89 45 ?4 83 7D ?4 00 75 02 EB 12 8B ?? ?0 83 C? 06 89 ?? ?0 B? DD 03 00 00 85}     \n   condition:   \n     $a   \n   }",
			"type": "YARA",
			"id": 31025942
		},
		{
			"indicator": "6ab4ad4ea8cff271a3b1636487aebcbd9ff054c1",
			"description": "",
			"title": "",
			"content": "rule cerber5 {   \n   meta:   \n     author = \"pekeinfo\"   \n     date = \"2016-12-02\"   \n     description = \"Cerber5\"   \n   strings:   \n     $a = {83 C4 04 A3 ?? ?? ?? 00 C7 45 ?? ?? ?? ?? 00 8B ?? ?? C6 0? 56 8B ?? ?? 5? 68 ?? ?? 4? 00 FF 15 ?? ?? 4? 00 50 FF 15 ?? ?? 4? 00 A3 ?? ?? 4? 00 68 1D 10 00 00 E8 ?? ?? FF FF 83 C4 04 ?? ?? ??}   \n        \n   condition:   \n     1 of them    \n   }",
			"type": "YARA",
			"id": 31025943
		},
		{
			"indicator": "b74d49816036e31d05d3668c6f2099e63c636104",
			"description": "",
			"title": "",
			"content": "rule cerber4 {   \n   meta:   \n           author = \"pekeinfo\"   \n           date = \"2016-09-09\"   \n           description = \"Cerber4\"   \n   strings:   \n           $a = {8B 0D ?? ?? 43 00 51 8B 15 ?? ?? 43 00 52 E8 C9 04 00 00 83 C4 08 89 45 FC A1 ?? ?? 43 00 3B 05 ?? ?? 43 00 72 02}   \n      \n   condition:   \n           1 of them    \n   }",
			"type": "YARA",
			"id": 31025944
		},
		{
			"indicator": "58a0f7b04b389124bd1ea9274c6ec82e1795d0e0",
			"description": "",
			"title": "",
			"content": "rule cerber3 {   \n   meta:   \n     author = \"pekeinfo\"   \n     date = \"2016-09-09\"   \n     description = \"Cerber3 \"   \n   strings:   \n     $a = {00 6A 00 68 80 00 00 00 6A 03 6A 00 6A 03 6A  01 8B 85}   \n     $b = {68 3B DB 00 00 ?? ?? ?? ?? 00 ?? FF 15}   \n        \n   condition:   \n     1 of them    \n   }",
			"type": "YARA",
			"id": 31025945
		},
		{
			"indicator": "ddea5eeec6c88f6307f95b79dec53e340075022e",
			"description": "",
			"title": "",
			"content": "rule DoublePulsarXor_Petya   \n   {   \n    meta:   \n      description = \"Rule to hit on the XORed DoublePulsar shellcode\"   \n      author = \"Patrick Jones\"   \n      company = \"Booz Allen Hamilton\"   \n      reference1 =\"https://www.boozallen.com/s/insight/publication/the-petya-ransomware-outbreak.html\"   \n      reference2 = \"https://www.boozallen.com/content/dam/boozallen_site/sig/pdf/white-paper/rollup-of-booz-allen-petya-research.pdf\"   \n      date = \"2017-06-28\"   \n      hash = \"027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745\"   \n      hash = \"64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1\"   \n    strings:   \n      $DoublePulsarXor_Petya = { FD 0C 8C 5C B8 C4 24 C5 CC CC CC 0E E8 CC 24 6B CC CC CC 0F 24 CD CC CC CC 27 5C 97 75 BA CD CC CC C3 FE }   \n    condition:   \n      $DoublePulsarXor_Petya   \n   }",
			"type": "YARA",
			"id": 31026094
		},
		{
			"indicator": "4d0d73c1802c24bcf16ee44f0a736e44eb4358c5",
			"description": "",
			"title": "",
			"content": "rule DoublePulsarDllInjection_Petya   \n   {   \n    meta:   \n     description = \"Rule to hit on the XORed DoublePulsar DLL injection shellcode\"   \n     author = \"Patrick Jones\"   \n     company = \"Booz Allen Hamilton\"   \n     reference1 =\"https://www.boozallen.com/s/insight/publication/the-petya-ransomware-outbreak.html\"   \n     reference2 = \"https://www.boozallen.com/content/dam/boozallen_site/sig/pdf/white-paper/rollup-of-booz-allen-petya-research.pdf\"   \n     date = \"2017-06-28\"   \n     hash = \"027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745\"   \n     hash = \"64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1\"    \n    strings:   \n      $DoublePulsarDllInjection_Petya = { 45 20 8D 93 8D 92 8D 91 8D 90 92 93 91 97 0F 9F 9E 9D 99 84 45 29 84 4D 20 CC CD CC CC 9B 84 45 03 84 45 14 84 45 49 CC 33 33 33 24 77 CC CC CC 84 45 49 C4 33 33 33 24 84 CD CC CC 84 45 49 DC 33 33 33 84 47 49 CC 33 33 33 84 47 41 }   \n    condition:   \n      $DoublePulsarDllInjection_Petya   \n   }",
			"type": "YARA",
			"id": 31026095
		},
		{
			"indicator": "b0a980600d761d4c444bfbf79df7c0a369558786",
			"description": "",
			"title": "",
			"content": "rule Erebus: ransom   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Erebus Ransomware\"   \n   \t\tauthor = \"Joan Soriano / @joanbtl\"   \n   \t\tdate = \"2017-06-23\"   \n   \t\tversion = \"1.0\"   \n   \t\tMD5 = \"27d857e12b9be5d43f935b8cc86eaabf\"   \n   \t\tSHA256 = \"0b7996bca486575be15e68dba7cbd802b1e5f90436ba23f802da66292c8a055f\"   \n   \t\tref1 = \"http://blog.trendmicro.com/trendlabs-security-intelligence/erebus-resurfaces-as-linux-ransomware/\"   \n   \tstrings:   \n   \t\t$a = \"/{5f58d6f0-bb9c-46e2-a4da-8ebc746f24a5}//log.log\"   \n   \t\t$b = \"EREBUS IS BEST.\"   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31027421
		},
		{
			"indicator": "ac500ffb0507d23701181ffcee2246aeb51a4262",
			"description": "",
			"title": "",
			"content": "rule GoldenEye_Ransomware_XLS {   \n      meta:   \n         description = \"GoldenEye XLS with Macro - file Schneider-Bewerbung.xls\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/jp2SkT\"   \n         date = \"2016-12-06\"   \n         hash1 = \"2320d4232ee80cc90bacd768ba52374a21d0773c39895b88cdcaa7782e16c441\"   \n      strings:   \n         $x1 = \"fso.GetTempName();tmp_path = tmp_path.replace('.tmp', '.exe')\" fullword ascii   \n         $x2 = \"var shell = new ActiveXObject('WScript.Shell');shell.run(t'\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0xcfd0 and filesize < 4000KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 31027863
		},
		{
			"indicator": "174b24832cbfda104737e71ec6d8b9805b438720",
			"description": "",
			"title": "",
			"content": "rule GoldenEyeRansomware_Dropper_MalformedZoomit {   \n      meta:   \n         description = \"Auto-generated rule - file b5ef16922e2c76b09edd71471dd837e89811c5e658406a8495c1364d0d9dc690\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/jp2SkT\"   \n         date = \"2016-12-06\"   \n         hash1 = \"b5ef16922e2c76b09edd71471dd837e89811c5e658406a8495c1364d0d9dc690\"   \n      strings:   \n         $s1 = \"ZoomIt - Sysinternals: www.sysinternals.com\" fullword ascii   \n         $n1 = \"Mark Russinovich\" wide   \n      condition:   \n         ( uint16(0) == 0x5a4d and filesize < 800KB and $s1 and not $n1 )   \n   }",
			"type": "YARA",
			"id": 31027864
		},
		{
			"indicator": "0fbe7429f2473b3ec22bf7d4d1420dc562c99a10",
			"description": "",
			"title": "",
			"content": "rule Locky_Ransomware_2: ransom {   \n   meta:   \n       description = \"Regla para detectar RANSOM.LOCKY\"   \n       author = \"CCN-CERT\"   \n       version = \"1.0\"   \n   strings:   \n       $a1 = { 2E 00 6C 00 6F 00 63 00 6B 00 79 00 00 }   \n       $a2 = { 00 5F 00 4C 00 6F 00 63 00 6B 00 79 00 }   \n       $a3 = { 5F 00 72 00 65 00 63 00 6F 00 76 00 65 }   \n       $a4 = { 00 72 00 5F 00 69 00 6E 00 73 00 74 00 }   \n       $a5 = { 72 00 75 00 63 00 74 00 69 00 6F 00 6E }   \n       $a6 = { 00 73 00 2E 00 74 00 78 00 74 00 00 }   \n       $a7 = { 53 6F 66 74 77 61 72 65 5C 4C 6F 63 6B 79 00 }   \n   condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 31027867
		},
		{
			"indicator": "04e61e4138cadf4263f8bbca1059240e5a755bc0",
			"description": "",
			"title": "",
			"content": "rule Locky_Ransomware : ransom {   \n   \tmeta:   \n   \t\tdescription = \"Detects Locky Ransomware (matches also on Win32/Kuluoz)\"   \n   \t\tauthor = \"Florian Roth (with the help of binar.ly)\"   \n   \t\treference = \"https://goo.gl/qScSrE\"   \n   \t\tdate = \"2016-02-17\"   \n   \t\thash = \"5e945c1d27c9ad77a2b63ae10af46aee7d29a6a43605a9bfbf35cebbcff184d8\"   \n   \tstrings:   \n   \t\t$o1 = { 45 b8 99 f7 f9 0f af 45 b8 89 45 b8 } // address=0x4144a7   \n   \t\t$o2 = { 2b 0a 0f af 4d f8 89 4d f8 c7 45 } // address=0x413863   \n   \tcondition:   \n   \t\tall of ($o*)   \n   }",
			"type": "YARA",
			"id": 31027868
		},
		{
			"indicator": "b123442a7dbe071d66679bd7b6204f30926af9ca",
			"description": "",
			"title": "",
			"content": "rule WannaDecryptor: WannaDecryptor   \n   {   \n           meta:   \n                   description = \"Detection for common strings of WannaDecryptor\"   \n       \n           strings:   \n                   $id1 = \"taskdl.exe\"   \n                   $id2 = \"taskse.exe\"   \n                   $id3 = \"r.wnry\"   \n                   $id4 = \"s.wnry\"   \n                   $id5 = \"t.wnry\"   \n                   $id6 = \"u.wnry\"   \n                   $id7 = \"msg/m_\"   \n       \n           condition:   \n                   3 of them   \n   }",
			"type": "YARA",
			"id": 31027870
		},
		{
			"indicator": "4a2b87a5bb6c5170d4145d05b20e80b2b902d5c2",
			"description": "",
			"title": "",
			"content": "rule Wanna_Cry_Ransomware_Generic {   \n          meta:   \n                 description = \"Detects WannaCry Ransomware on Disk and in Virtual Page\"   \n                 author = \"US-CERT Code Analysis Team\"   \n                 reference = \"not set\"                                           \n                 date = \"2017/05/12\"   \n          hash0 = \"4DA1F312A214C07143ABEEAFB695D904\"   \n          strings:   \n                 $s0 = {410044004D0049004E0024}   \n                 $s1 = \"WannaDecryptor\"   \n                 $s2 = \"WANNACRY\"   \n                 $s3 = \"Microsoft Enhanced RSA and AES Cryptographic\"   \n                 $s4 = \"PKS\"   \n                 $s5 = \"StartTask\"   \n                 $s6 = \"wcry@123\"   \n                 $s7 = {2F6600002F72}   \n                 $s8 = \"unzip 0.15 Copyrigh\"   \n                 $s9 = \"Global\\\\WINDOWS_TASKOSHT_MUTEX\"           \n                 $s10 = \"Global\\\\WINDOWS_TASKCST_MUTEX\"      \n                $s11 = {7461736B736368652E657865000000005461736B5374617274000000742E776E7279000069636163}   \n                $s12 = {6C73202E202F6772616E742045766572796F6E653A46202F54202F43202F5100617474726962202B68}   \n                $s13 = \"WNcry@2ol7\"   \n                $s14 = \"wcry@123\"   \n                $s15 = \"Global\\\\MsWinZonesCacheCounterMutexA\"   \n          condition:   \n                 $s0 and $s1 and $s2 and $s3 or $s4 and $s5 and $s6 and $s7 or $s8 and $s9 and $s10 or $s11 and $s12 or $s13 or $s14 or $s15   \n   }",
			"type": "YARA",
			"id": 31027871
		},
		{
			"indicator": "8808d317af2d94719ee7e38c2b64e511bfa19878",
			"description": "",
			"title": "",
			"content": "rule WannaCry_Ransomware_Gen {   \n      meta:   \n         description = \"Detects WannaCry Ransomware\"   \n         author = \"Florian Roth (based on rule by US CERT)\"   \n         reference = \"https://www.us-cert.gov/ncas/alerts/TA17-132A\"   \n         date = \"2017-05-12\"   \n         hash1 = \"9fe91d542952e145f2244572f314632d93eb1e8657621087b2ca7f7df2b0cb05\"   \n         hash2 = \"8e5b5841a3fe81cade259ce2a678ccb4451725bba71f6662d0cc1f08148da8df\"   \n         hash3 = \"4384bf4530fb2e35449a8e01c7e0ad94e3a25811ba94f7847c1e6612bbb45359\"   \n      strings:   \n         $s1 = \"__TREEID__PLACEHOLDER__\" fullword ascii   \n         $s2 = \"__USERID__PLACEHOLDER__\" fullword ascii   \n         $s3 = \"Windows for Workgroups 3.1a\" fullword ascii   \n         $s4 = \"PC NETWORK PROGRAM 1.0\" fullword ascii   \n         $s5 = \"LANMAN1.0\" fullword ascii   \n      condition:   \n         uint16(0) == 0x5a4d and filesize < 5000KB and all of them   \n   }",
			"type": "YARA",
			"id": 31027872
		},
		{
			"indicator": "83d956e0a64859d4229e6090454dc2efb76f7593",
			"description": "",
			"title": "",
			"content": "rule lazaruswannacry {   \n      meta:   \n         description = \"Rule based on shared code between Feb 2017 Wannacry sample and Lazarus backdoor from Feb 2015 discovered by Neel Mehta\"   \n         date = \"2017-05-15\"   \n         reference = \"https://twitter.com/neelmehta/status/864164081116225536\"   \n         author = \"Costin G. Raiu, Kaspersky Lab\"   \n         version = \"1.0\"   \n         hash = \"9c7c7149387a1c79679a87dd1ba755bc\"   \n         hash = \"ac21c8ad899727137c4b94458d7aa8d8\"   \n      strings:   \n         $a1 = { 51 53 55 8B 6C 24 10 56 57 6A 20 8B 45 00 8D 75 04 24 01 0C 01 46 89 45 00 C6 46 FF 03 C6 06 01 46 56 E8 }   \n         $a2 = { 03 00 04 00 05 00 06 00 08 00 09 00 0A 00 0D 00 10 00 11 00 12 00 13 00 14 00 15 00 16 00 2F 00 30 00 31 00 32 00 33 00 34 00 35 00 36 00 37 00 38 00 39 00 3C 00 3D 00 3E 00 3F 00 40 00 41 00 44 00 45 00 46 00 62 00 63 00 64 00 66 00 67 00 68 00 69 00 6A 00 6B 00 84 00 87 00 88 00 96 00 FF 00 01 C0 02 C0 03 C0 04 C0 05 C0 06 C0 07 C0 08 C0 09 C0 0A C0 0B C0 0C C0 0D C0 0E C0 0F C0 10 C0 11 C0 12 C0 13 C0 14 C0 23 C0 24 C0 27 C0 2B C0 2C C0 FF FE }   \n      condition:   \n         uint16(0) == 0x5A4D and filesize < 15000000 and all of them   \n   }",
			"type": "YARA",
			"id": 31027873
		},
		{
			"indicator": "65d94377a0ab026c53bd40f0d6a596eee34d8291",
			"description": "",
			"title": "",
			"content": "rule Wanna_Sample_4da1f312a214c07143abeeafb695d904: Wanna_Sample_4da1f312a214c07143abeeafb695d904   \n   {   \n           meta:   \n                   description = \"Specific sample match for WannaCryptor\"   \n                   MD5 = \"4da1f312a214c07143abeeafb695d904\"   \n                   SHA1 = \"b629f072c9241fd2451f1cbca2290197e72a8f5e\"   \n                   SHA256 = \"aee20f9188a5c3954623583c6b0e6623ec90d5cd3fdec4e1001646e27664002c\"   \n                   INFO = \"Looks for offsets of r.wry and s.wry instances\"   \n       \n           strings:   \n                   $rwnry = { 72 2e 77 72 79 }   \n                   $swnry = { 73 2e 77 72 79 }   \n       \n           condition:   \n                   $rwnry at 88195 and $swnry at 88656 and $rwnry at 4495639   \n   }",
			"type": "YARA",
			"id": 31027874
		},
		{
			"indicator": "9a95541b6b9e99c9f74eab8c77ba8c62501939de",
			"description": "",
			"title": "",
			"content": "rule ransom_telefonica : TELEF   \n   {   \n     meta:   \n       author = \"Jaume Martin <@Xumeiquer>\"   \n       description = \"Ransmoware Telefonica\"   \n       date = \"2017-05-13\"   \n       reference = \"http://www.elmundo.es/tecnologia/2017/05/12/59158a8ce5fdea194f8b4616.html\"   \n       md5 = \"7f7ccaa16fb15eb1c7399d422f8363e8\"   \n       sha256 = \"2584e1521065e45ec3c17767c065429038fc6291c091097ea8b22c8a502c41dd\"   \n     strings:   \n       $a = \"RegCreateKeyW\" wide ascii nocase   \n       $b = \"cmd.exe /c\"   \n       $c = \"115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn\" ascii   \n       $d = \"12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw\" ascii   \n       $e = \"13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94\" ascii   \n       $f = \"tasksche.exe\"   \n     condition:   \n       uint16(0) == 0x5A4D and $a and for all of ($b, $c, $d, $e, $f) : (@ > @a)   \n   }",
			"type": "YARA",
			"id": 31027875
		},
		{
			"indicator": "c28ed3ca3cc3d023d1725936534965abc6f23f4e",
			"description": "",
			"title": "",
			"content": "rule WannCry_m_vbs {   \n      meta:   \n         description = \"Detects WannaCry Ransomware VBS\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/HG2j5T\"   \n         date = \"2017-05-12\"   \n         hash1 = \"51432d3196d9b78bdc9867a77d601caffd4adaa66dcac944a5ba0b3112bbea3b\"   \n      strings:   \n         $x1 = \".TargetPath = \\\"C:\\\\@\" ascii   \n         $x2 = \".CreateShortcut(\\\"C:\\\\@\" ascii   \n         $s3 = \" = WScript.CreateObject(\\\"WScript.Shell\\\")\" ascii   \n      condition:   \n         ( uint16(0) == 0x4553 and filesize < 1KB and all of them )   \n   }",
			"type": "YARA",
			"id": 31027876
		},
		{
			"indicator": "7cb27220ed0430290482a831a96320df7424f2c9",
			"description": "",
			"title": "",
			"content": "rule NHS_Strain_Wanna: NHS_Strain_Wanna   \n   {   \n           meta:   \n                   description = \"Detection for worm-strain bundle of Wcry, DOublePulsar\"   \n                   MD5 = \"db349b97c37d22f5ea1d1841e3c89eb4\"   \n                   SHA1 = \"e889544aff85ffaf8b0d0da705105dee7c97fe26\"   \n                   SHA256 = \"24d004a104d4d54034dbcffc2a4b19a11f39008a575aa614ea04703480b1022c\"   \n                   INFO = \"Looks for specific offsets of c.wnry and t.wnry strings\"   \n       \n           strings:   \n                   $cwnry = { 63 2e 77 6e 72 79 }   \n                   $twnry = { 74 2e 77 6e 72 79 }   \n       \n           condition:   \n                   $cwnry at 262324 and $twnry at 267672 and $cwnry at 284970   \n   }",
			"type": "YARA",
			"id": 31027877
		},
		{
			"indicator": "30c438fd29c43a0faf9760b600695961f520d585",
			"description": "",
			"title": "",
			"content": "rule WannaCry_Ransomware {   \n      meta:   \n         description = \"Detects WannaCry Ransomware\"   \n         author = \"Florian Roth (with the help of binar.ly)\"   \n         reference = \"https://goo.gl/HG2j5T\"   \n         date = \"2017-05-12\"   \n         hash1 = \"ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa\"   \n      strings:   \n         $x1 = \"icacls . /grant Everyone:F /T /C /Q\" fullword ascii   \n         $x2 = \"taskdl.exe\" fullword ascii   \n         $x3 = \"tasksche.exe\" fullword ascii   \n         $x4 = \"Global\\\\MsWinZonesCacheCounterMutexA\" fullword ascii   \n         $x5 = \"WNcry@2ol7\" fullword ascii   \n         $x6 = \"www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com\" ascii   \n         $x7 = \"mssecsvc.exe\" fullword ascii   \n         $x8 = \"C:\\\\%s\\\\qeriuwjhrf\" fullword ascii   \n         $x9 = \"icacls . /grant Everyone:F /T /C /Q\" fullword ascii   \n      \n         $s1 = \"C:\\\\%s\\\\%s\" fullword ascii   \n         $s2 = \"<!-- Windows 10 --> \" fullword ascii   \n         $s3 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii   \n         $s4 = \"msg/m_portuguese.wnry\" fullword ascii   \n         $s5 = \"\\\\\\\\192.168.56.20\\\\IPC$\" fullword wide   \n         $s6 = \"\\\\\\\\172.16.99.5\\\\IPC$\" fullword wide   \n      \n         $op1 = { 10 ac 72 0d 3d ff ff 1f ac 77 06 b8 01 00 00 00 }   \n         $op2 = { 44 24 64 8a c6 44 24 65 0e c6 44 24 66 80 c6 44 }   \n         $op3 = { 18 df 6c 24 14 dc 64 24 2c dc 6c 24 5c dc 15 88 }   \n         $op4 = { 09 ff 76 30 50 ff 56 2c 59 59 47 3b 7e 0c 7c }   \n         $op5 = { c1 ea 1d c1 ee 1e 83 e2 01 83 e6 01 8d 14 56 }   \n         $op6 = { 8d 48 ff f7 d1 8d 44 10 ff 23 f1 23 c1 }   \n      condition:   \n         uint16(0) == 0x5a4d and filesize < 10000KB and ( 1 of ($x*) and 1 of ($s*) or 3 of ($op*) )   \n   }",
			"type": "YARA",
			"id": 31027878
		},
		{
			"indicator": "8fc6019e6a920ceed7fb81219cadd41afb998464",
			"description": "",
			"title": "",
			"content": "rule WannaCry_Ransomware_Dropper   \n    {   \n    meta:   \n   \tdescription = \"WannaCry Ransomware Dropper\"   \n    \treference = \"https://www.cylance.com/en_us/blog/threat-spotlight-inside-the-wannacry-attack.html\"   \n    \tdate = \"2017-05-12\"   \n      \n   strings:   \n   \t$s1 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii   \n    \t$s2 = \"tasksche.exe\" fullword ascii   \n    \t$s3 = \"icacls . /grant Everyone:F /T /C /Q\" fullword ascii   \n    \t$s4 = \"Global\\\\MsWinZonesCacheCounterMutexA\" fullword ascii   \n       \n    condition:   \n    \tuint16(0) == 0x5a4d and filesize < 4MB and all of them   \n   }",
			"type": "YARA",
			"id": 31027879
		},
		{
			"indicator": "dee6c8cad572727e66d2cbab3022514d310418c1",
			"description": "",
			"title": "",
			"content": "rule WannCry_BAT {   \n      meta:   \n         description = \"Detects WannaCry Ransomware BATCH File\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/HG2j5T\"   \n         date = \"2017-05-12\"   \n         hash1 = \"f01b7f52e3cb64f01ddc248eb6ae871775ef7cb4297eba5d230d0345af9a5077\"   \n      strings:   \n         $s1 = \"@.exe\\\">> m.vbs\" ascii   \n         $s2 = \"cscript.exe //nologo m.vbs\" fullword ascii   \n         $s3 = \"echo SET ow = WScript.CreateObject(\\\"WScript.Shell\\\")> \" ascii   \n         $s4 = \"echo om.Save>> m.vbs\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x6540 and filesize < 1KB and 1 of them )   \n   }",
			"type": "YARA",
			"id": 31027880
		},
		{
			"indicator": "50ba934eac8d6dd4f2da24a1bb62dcf61ed27006",
			"description": "",
			"title": "",
			"content": "rule Wanna_Sample_84c82835a5d21bbcf75a61706d8ab549: Wanna_Sample_84c82835a5d21bbcf75a61706d8ab549   \n   {   \n           meta:   \n                   description = \"Specific sample match for WannaCryptor\"   \n                   MD5 = \"84c82835a5d21bbcf75a61706d8ab549\"   \n                   SHA1 = \"5ff465afaabcbf0150d1a3ab2c2e74f3a4426467\"   \n                   SHA256 = \"ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa\"   \n                   INFO = \"Looks for 'taskdl' and 'taskse' at known offsets\"   \n       \n           strings:   \n                   $taskdl = { 00 74 61 73 6b 64 6c }   \n                   $taskse = { 00 74 61 73 6b 73 65 }   \n       \n           condition:   \n                   $taskdl at 3419456 and $taskse at 3422953   \n   }",
			"type": "YARA",
			"id": 31027881
		},
		{
			"indicator": "faf91883526f976359044adbf12b7db0c1a4e53d",
			"description": "",
			"title": "",
			"content": "rule MS17_010_WanaCry_worm {   \n   \tmeta:   \n   \t\tdescription = \"Worm exploiting MS17-010 and dropping WannaCry Ransomware\"   \n   \t\tauthor = \"Felipe Molina (@felmoltor)\"   \n   \t\treference = \"https://www.exploit-db.com/exploits/41987/\"   \n   \t\tdate = \"2017/05/12\"   \n   \tstrings:   \n   \t\t$ms17010_str1=\"PC NETWORK PROGRAM 1.0\"   \n   \t\t$ms17010_str2=\"LANMAN1.0\"   \n   \t\t$ms17010_str3=\"Windows for Workgroups 3.1a\"   \n   \t\t$ms17010_str4=\"__TREEID__PLACEHOLDER__\"   \n   \t\t$ms17010_str5=\"__USERID__PLACEHOLDER__\"   \n   \t\t$wannacry_payload_substr1 = \"h6agLCqPqVyXi2VSQ8O6Yb9ijBX54j\"   \n   \t\t$wannacry_payload_substr2 = \"h54WfF9cGigWFEx92bzmOd0UOaZlM\"   \n   \t\t$wannacry_payload_substr3 = \"tpGFEoLOU6+5I78Toh/nHs/RAP\"   \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31027882
		},
		{
			"indicator": "4c521ecbef4740c116d45818ebc5e35aa6aa2074",
			"description": "",
			"title": "",
			"content": "rule WannaCry_RansomNote {   \n      meta:   \n         description = \"Detects WannaCry Ransomware Note\"   \n         author = \"Florian Roth\"   \n         reference = \"https://goo.gl/HG2j5T\"   \n         date = \"2017-05-12\"   \n         hash1 = \"4a25d98c121bb3bd5b54e0b6a5348f7b09966bffeec30776e5a731813f05d49e\"   \n      strings:   \n         $s1 = \"A:  Don't worry about decryption.\" fullword ascii   \n         $s2 = \"Q:  What's wrong with my files?\" fullword ascii   \n      condition:   \n         ( uint16(0) == 0x3a51 and filesize < 2KB and all of them )   \n   }",
			"type": "YARA",
			"id": 31027883
		},
		{
			"indicator": "34692464f1826cdc91447bdf5e9549f44b5b584e",
			"description": "",
			"title": "",
			"content": "rule ransomware_PetrWrap    \n   {   \n   meta:   \n   \tcopyright= \"Kaspersky Lab\"   \n   \tdescription = \"Rule to detect PetrWrap ransomware samples\"   \n       reference = \"https://securelist.com/schroedingers-petya/78870/\"   \n   \tlast_modified = \"2017-06-27\"   \n   \tauthor = \"Kaspersky Lab\"   \n   \thash = \"71B6A493388E7D0B40C83CE903BC6B04\"   \n   \tversion = \"1.0\"   \n   strings:   \n   \t$a1 = \"MIIBCgKCAQEAxP/VqKc0yLe9JhVqFMQGwUITO6WpXWnKSNQAYT0O65Cr8PjIQInTeHkXEjfO2n2JmURWV/uHB0ZrlQ/wcYJBwLhQ9EqJ3iDqmN19Oo7NtyEUmbYmopcqYLIBZzQ2ZTK0A2DtX4GRKxEEFLCy7vP12EYOPXknVy/mf0JFWixz29QiTf5oLu15wVLONCuEibGaNNpgqCXsPwfITDbDDmdrRIiUEUw6o3pt5pNOskfOJbMan2TZu\" fullword wide   \n   \t$a2 = \".3ds.7z.accdb.ai.asp.aspx.avhd.back.bak.c.cfg.conf.cpp.cs.ctl.dbf.disk.djvu.doc.docx.dwg.eml.fdb.gz.h.hdd.kdbx.mail.mdb.msg.nrg.ora.ost.ova.ovf.pdf.php.pmf.ppt.pptx.pst.pvi.py.pyc.rar.rtf.sln.sql.tar.vbox.vbs.vcb.vdi.vfd.vmc.vmdk.vmsd.vmx.vsdx.vsv.work.xls\" fullword wide   \n   \t$a3 = \"DESTROY ALL OF YOUR DATA PLEASE ENSURE THAT YOUR POWER CABLE IS PLUGGED\" fullword ascii   \n   \t$a4 = \"1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX\" fullword ascii   \n   \t$a5 = \"wowsmith123456posteo.net.\" fullword wide   \n   condition:   \n   \tuint16(0) == 0x5A4D and filesize < 1000000 and any of them    \n   }",
			"type": "YARA",
			"id": 31027905
		},
		{
			"indicator": "00bb0619131981a12523824e760823ec6ca7c134",
			"description": "",
			"title": "",
			"content": "rule Petya_Ransomware {   \n   \tmeta:   \n   \t\tdescription = \"Detects Petya Ransomware\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"http://www.heise.de/newsticker/meldung/Erpressungs-Trojaner-Petya-riegelt-den-gesamten-Rechner-ab-3150917.html\"   \n   \t\tdate = \"2016-03-24\"   \n   \t\thash = \"26b4699a7b9eeb16e76305d843d4ab05e94d43f3201436927e13b3ebafa90739\"   \n   \tstrings:   \n   \t\t$a1 = \"<description>WinRAR SFX module</description>\" fullword ascii   \n      \n   \t\t$s1 = \"BX-Proxy-Manual-Auth\" fullword wide   \n   \t\t$s2 = \"<!--The ID below indicates application support for Windows 10 -->\" fullword ascii   \n   \t\t$s3 = \"X-HTTP-Attempts\" fullword wide   \n   \t\t$s4 = \"@CommandLineMode\" fullword wide   \n   \t\t$s5 = \"X-Retry-After\" fullword wide   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and filesize < 500KB and $a1 and 3 of ($s*)   \n   }",
			"type": "YARA",
			"id": 31027908
		},
		{
			"indicator": "b947df16aa881dbc580c190726baef954a3a0a6a",
			"description": "",
			"title": "",
			"content": "rule FE_CPE_MS17_010_RANSOMWARE {   \n   meta:version=\"1.1\"   \n         //filetype=\"PE\"   \n         author=\"Ian.Ahl@fireeye.com @TekDefense, Nicholas.Carr@mandiant.com @ItsReallyNick\"   \n         date=\"2017-06-27\"   \n         description=\"Probable PETYA ransomware using ETERNALBLUE, WMIC, PsExec\"   \n         reference = \"https://www.fireeye.com/blog/threat-research/2017/06/petya-ransomware-spreading-via-eternalblue-exploit.html\"   \n   strings:   \n         // DRIVE USAGE   \n         $dmap01 = \"\\\\\\\\.\\\\PhysicalDrive\" nocase ascii wide   \n         $dmap02 = \"\\\\\\\\.\\\\PhysicalDrive0\" nocase ascii wide   \n         $dmap03 = \"\\\\\\\\.\\\\C:\" nocase ascii wide   \n         $dmap04 = \"TERMSRV\" nocase ascii wide   \n         $dmap05 = \"\\\\admin$\" nocase ascii wide   \n         $dmap06 = \"GetLogicalDrives\" nocase ascii wide   \n         $dmap07 = \"GetDriveTypeW\" nocase ascii wide   \n      \n         // RANSOMNOTE   \n         $msg01 = \"WARNING: DO NOT TURN OFF YOUR PC!\" nocase ascii wide   \n         $msg02 = \"IF YOU ABORT THIS PROCESS\" nocase ascii wide   \n         $msg03 = \"DESTROY ALL OF YOUR DATA!\" nocase ascii wide   \n         $msg04 = \"PLEASE ENSURE THAT YOUR POWER CABLE IS PLUGGED\" nocase ascii wide   \n         $msg05 = \"your important files are encrypted\" ascii wide   \n         $msg06 = \"Your personal installation key\" nocase ascii wide   \n         $msg07 = \"worth of Bitcoin to following address\" nocase ascii wide   \n         $msg08 = \"CHKDSK is repairing sector\" nocase ascii wide   \n         $msg09 = \"Repairing file system on \" nocase ascii wide   \n         $msg10 = \"Bitcoin wallet ID\" nocase ascii wide   \n         $msg11 = \"wowsmith123456@posteo.net\" nocase ascii wide   \n         $msg12 = \"1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX\" nocase ascii wide   \n         $msg_pcre = /(en|de)crypt(ion|ed\\.)/        \n      \n         // FUNCTIONALITY, APIS   \n         $functions01 = \"need dictionary\" nocase ascii wide   \n         $functions02 = \"comspec\" nocase ascii wide   \n         $functions03 = \"OpenProcessToken\" nocase ascii wide   \n         $functions04 = \"CloseHandle\" nocase ascii wide   \n         $functions05 = \"EnterCriticalSection\" nocase ascii wide   \n         $functions06 = \"ExitProcess\" nocase ascii wide   \n         $functions07 = \"GetCurrentProcess\" nocase ascii wide   \n         $functions08 = \"GetProcAddress\" nocase ascii wide   \n         $functions09 = \"LeaveCriticalSection\" nocase ascii wide   \n         $functions10 = \"MultiByteToWideChar\" nocase ascii wide   \n         $functions11 = \"WideCharToMultiByte\" nocase ascii wide   \n         $functions12 = \"WriteFile\" nocase ascii wide   \n         $functions13 = \"CoTaskMemFree\" nocase ascii wide   \n         $functions14 = \"NamedPipe\" nocase ascii wide   \n         $functions15 = \"Sleep\" nocase ascii wide // imported, not in strings        \n      \n         // COMMANDS   \n         //  -- Clearing event logs & USNJrnl   \n         $cmd01 = \"wevtutil cl Setup\" ascii wide nocase   \n         $cmd02 = \"wevtutil cl System\" ascii wide nocase   \n         $cmd03 = \"wevtutil cl Security\" ascii wide nocase   \n         $cmd04 = \"wevtutil cl Application\" ascii wide nocase   \n         $cmd05 = \"fsutil usn deletejournal\" ascii wide nocase   \n         // -- Scheduled task   \n         $cmd06 = \"schtasks \" nocase ascii wide   \n         $cmd07 = \"/Create /SC \" nocase ascii wide   \n         $cmd08 = \" /TN \" nocase ascii wide   \n         $cmd09 = \"at %02d:%02d %ws\" nocase ascii wide   \n         $cmd10 = \"shutdown.exe /r /f\" nocase ascii wide   \n         // -- Sysinternals/PsExec and WMIC   \n         $cmd11 = \"-accepteula -s\" nocase ascii wide   \n         $cmd12 = \"wmic\"   \n         $cmd13 = \"/node:\" nocase ascii wide   \n         $cmd14 = \"process call create\" nocase ascii wide   \n      \n   condition:   \n         // (uint16(0) == 0x5A4D)   \n         3 of ($dmap*)   \n         and 2 of ($msg*)   \n         and 9 of ($functions*)   \n         and 7 of ($cmd*)   \n   }",
			"type": "YARA",
			"id": 31027909
		},
		{
			"indicator": "5dac5121a167a9012ad871b4f5051eae3c074744",
			"description": "",
			"title": "",
			"content": "rule Ransom_Petya {   \n   meta:   \n       description = \"Regla para detectar Ransom.Petya con md5 AF2379CC4D607A45AC44D62135FB7015\"   \n       author = \"CCN-CERT\"   \n       version = \"1.0\"   \n   strings:   \n       $a1 = { C1 C8 14 2B F0 03 F0 2B F0 03 F0 C1 C0 14 03 C2 }   \n       $a2 = { 46 F7 D8 81 EA 5A 93 F0 12 F7 DF C1 CB 10 81 F6 }   \n       $a3 = { 0C 88 B9 07 87 C6 C1 C3 01 03 C5 48 81 C3 A3 01 00 00 }   \n   condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 31027910
		},
		{
			"indicator": "52400d4439620b489c98b53be346236cdd25d236",
			"description": "",
			"title": "",
			"content": "rule TeslaCrypt {   \n   meta:   \n       description = \"Regla para detectar Tesla con md5\"   \n       author = \"CCN-CERT\"   \n       version = \"1.0\"   \n   strings:   \n       $ = { 4E 6F 77 20 69 74 27 73 20 25 49 3A 25 4D 25 70 2E 00 00 00 76 61 6C 20 69 73 20 25 64 0A 00 00 }   \n   condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 31027913
		},
		{
			"indicator": "ef75938046243303d625064b4d584d797eb0be51",
			"description": "",
			"title": "",
			"content": "rule Adzok : binary RAT Adzok   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tDescription = \"Adzok Rat\"   \n   \t\tVersions = \"Free 1.0.0.3,\"   \n   \t\tdate = \"2015/05\"   \n   \t\tref = \"http://malwareconfig.com/stats/Adzok\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"jar\"   \n      \n   \tstrings:   \n   \t\t$a1 = \"config.xmlPK\"   \n   \t\t$a2 = \"key.classPK\"   \n   \t\t$a3 = \"svd$1.classPK\"   \n   \t\t$a4 = \"svd$2.classPK\"   \n       \t$a5 = \"Mensaje.classPK\"   \n   \t\t$a6 = \"inic$ShutdownHook.class\"   \n   \t\t$a7 = \"Uninstall.jarPK\"   \n   \t\t$a8 = \"resources/icono.pngPK\"   \n              \n   \tcondition:   \n       7 of ($a*)   \n   }",
			"type": "YARA",
			"id": 31028312
		},
		{
			"indicator": "3111bd046c950b374df8127fd22b77e52f8c2eea",
			"description": "",
			"title": "",
			"content": "rule CyberGate : RAT   \n   {   \n      \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/CyberGate\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$string1 = {23 23 23 23 40 23 23 23 23 E8 EE E9 F9 23 23 23 23 40 23 23 23 23}   \n   \t\t$string2 = {23 23 23 23 40 23 23 23 23 FA FD F0 EF F9 23 23 23 23 40 23 23 23 23}   \n   \t\t$string3 = \"EditSvr\"   \n   \t\t$string4 = \"TLoader\"   \n   \t\t$string5 = \"Stroks\"   \n   \t\t$string6 = \"####@####\"   \n   \t\t$res1 = \"XX-XX-XX-XX\"   \n   \t\t$res2 = \"CG-CG-CG-CG\"   \n      \n   \tcondition:   \n   \t\tall of ($string*) and any of ($res*)   \n   }",
			"type": "YARA",
			"id": 31028372
		},
		{
			"indicator": "7910693c10c34ecf5eb7cad68c76b1965d4f948f",
			"description": "",
			"title": "",
			"content": "rule DarkComet_3 : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/DarkComet\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t// Versions 2x   \n   \t\t$a1 = \"#BOT#URLUpdate\"   \n   \t\t$a2 = \"Command successfully executed!\"   \n   \t\t$a3 = \"MUTEXNAME\" wide   \n   \t\t$a4 = \"NETDATA\" wide   \n   \t\t// Versions 3x & 4x & 5x   \n   \t\t$b1 = \"FastMM Borland Edition\"   \n   \t\t$b2 = \"%s, ClassID: %s\"   \n   \t\t$b3 = \"I wasn't able to open the hosts file\"   \n   \t\t$b4 = \"#BOT#VisitUrl\"   \n   \t\t$b5 = \"#KCMDDC\"   \n   \tcondition:   \n   \t\tall of ($a*) or all of ($b*)   \n   }",
			"type": "YARA",
			"id": 31028373
		},
		{
			"indicator": "6df96dc6a03038b2e9ae1abafc666b36ddede278",
			"description": "",
			"title": "",
			"content": "rule DarkComet_2 : rat   \n   {   \n   \tmeta:   \n   \t\tdescription = \"DarkComet\"    \n   \t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"   \n   \t\tdate = \"2013-01-12\"   \n   \t\tfiletype = \"memory\"   \n   \t\tversion = \"1.0\"    \n      \n   \tstrings:   \n   \t\t$a = \"#BEGIN DARKCOMET DATA --\"   \n   \t\t$b = \"#EOF DARKCOMET DATA --\"   \n   \t\t$c = \"DC_MUTEX-\"   \n   \t\t$k1 = \"#KCMDDC5#-890\"   \n   \t\t$k2 = \"#KCMDDC51#-890\"   \n      \n   \tcondition:   \n   \t\tany of them   \n   }",
			"type": "YARA",
			"id": 31028374
		},
		{
			"indicator": "967d968abcbc1e9bf9f27d11c017932e5e4833b8",
			"description": "",
			"title": "",
			"content": "rule DarkComet_4  : RAT   \n   {\tmeta:   \n   \t\treference = \"https://github.com/bwall/bamfdetect/blob/master/BAMF_Detect/modules/yara/darkcomet.yara\"   \n   \tstrings:   \n   \t    $a1 = \"#BOT#\"   \n   \t    $a2 = \"WEBCAMSTOP\"   \n   \t    $a3 = \"UnActiveOnlineKeyStrokes\"   \n   \t    $a4 = \"#SendTaskMgr\"   \n   \t    $a5 = \"#RemoteScreenSize\"   \n   \t    $a6 = \"ping 127.0.0.1 -n 4 > NUL &&\"   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31028375
		},
		{
			"indicator": "5dc0c1fc8b0e6f4edbac3added6c24645b519f92",
			"description": "",
			"title": "",
			"content": "rule DarkComet_5   \n   {    \n   \tmeta:   \n   \t\tmaltype = \"DarkComet RAT\"   \n   \t\tauthor = \"https://github.com/reed1713\"   \n   \t\tdescription = \"Malware creates the MSDCSC directory, which is a common path utilized by DarkComet, as well as the mutex pattern.\"   \n   \tstrings:   \n   \t\t$type=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid=\"4688\"   \n   \t\t$data=/AppData\\\\Local\\\\Temp\\\\MSDCSC\\\\.+\\.exe/   \n      \n   \t\t$type1=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid1=\"4674\"   \n   \t\t$data1=/DC_MUTEX-[0-9A-Z]{7}/   \n   \tcondition:   \n   \t\t($type and $eventid and $data) or ($type1 and $eventid1 and $data1)   \n   }",
			"type": "YARA",
			"id": 31028376
		},
		{
			"indicator": "9682f1b6e76cbdd9a6a846fe1d32b597ce0fce39",
			"description": "",
			"title": "",
			"content": "rule DarkComet_1 : RAT   \n   {   \n       meta:   \n           description = \"DarkComet RAT\"   \n   \tauthor = \"botherder https://github.com/botherder\"   \n      \n       strings:   \n           $bot1 = /(#)BOT#OpenUrl/ wide ascii   \n           $bot2 = /(#)BOT#Ping/ wide ascii   \n           $bot3 = /(#)BOT#RunPrompt/ wide ascii   \n           $bot4 = /(#)BOT#SvrUninstall/ wide ascii   \n           $bot5 = /(#)BOT#URLDownload/ wide ascii   \n           $bot6 = /(#)BOT#URLUpdate/ wide ascii   \n           $bot7 = /(#)BOT#VisitUrl/ wide ascii   \n           $bot8 = /(#)BOT#CloseServer/ wide ascii   \n      \n           $ddos1 = /(D)DOSHTTPFLOOD/ wide ascii   \n           $ddos2 = /(D)DOSSYNFLOOD/ wide ascii   \n           $ddos3 = /(D)DOSUDPFLOOD/ wide ascii   \n      \n           $keylogger1 = /(A)ctiveOnlineKeylogger/ wide ascii   \n           $keylogger2 = /(U)nActiveOnlineKeylogger/ wide ascii   \n           $keylogger3 = /(A)ctiveOfflineKeylogger/ wide ascii   \n           $keylogger4 = /(U)nActiveOfflineKeylogger/ wide ascii   \n      \n           $shell1 = /(A)CTIVEREMOTESHELL/ wide ascii   \n           $shell2 = /(S)UBMREMOTESHELL/ wide ascii   \n           $shell3 = /(K)ILLREMOTESHELL/ wide ascii   \n      \n       condition:   \n           4 of ($bot*) or all of ($ddos*) or all of ($keylogger*) or all of ($shell*)   \n   }",
			"type": "YARA",
			"id": 31028377
		},
		{
			"indicator": "7b9e910b4c5b8a90669e90d182fe8a92ddf79b5c",
			"description": "",
			"title": "",
			"content": "rule DarkComet_Keylogger_File  : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Florian Roth\"   \n   \t\tdescription = \"Looks like a keylogger file created by DarkComet Malware\"   \n   \t\tdate = \"25.07.14\"   \n   \t\treference = \"https://raw.githubusercontent.com/Neo23x0/Loki/master/signatures/thor-hacktools.yar\"   \n   \t\tscore = 50   \n   \tstrings:   \n   \t\t$magic = \"::\"   \n   \t\t$entry = /\\n:: [A-Z]/   \n   \t\t$timestamp = /\\([0-9]?[0-9]:[0-9][0-9]:[0-9][0-9] [AP]M\\)/   \n   \tcondition:   \n   \t\t($magic at 0) and #entry > 10 and #timestamp > 10   \n   }",
			"type": "YARA",
			"id": 31028378
		},
		{
			"indicator": "48f8defef4e3d92edc0c9bce1c5988f5a57d034b",
			"description": "",
			"title": "",
			"content": "rule Gh0st : RAT   \n   {   \n       meta:   \n           description = \"Gh0st\"   \n   \tauthor = \"botherder https://github.com/botherder\"   \n      \n       strings:   \n           $ = /(G)host/   \n           $ = /(i)nflate 1\\.1\\.4 Copyright 1995-2002 Mark Adler/   \n           $ = /(d)eflate 1\\.1\\.4 Copyright 1995-2002 Jean-loup Gailly/   \n           $ = /(%)s\\\\shell\\\\open\\\\command/   \n           $ = /(G)etClipboardData/   \n           $ = /(W)riteProcessMemory/   \n           $ = /(A)djustTokenPrivileges/   \n           $ = /(W)inSta0\\\\Default/   \n           $ = /(#)32770/   \n           $ = /(#)32771/   \n           $ = /(#)32772/   \n           $ = /(#)32774/   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 31040297
		},
		{
			"indicator": "8242d084d24ede79da708332f2b29de7c31ba36a",
			"description": "",
			"title": "",
			"content": "rule gh0st   \n      \n   {   \n      \n   meta:   \n   \tauthor = \"https://github.com/jackcr/\"   \n      \n      strings:   \n         $a = { 47 68 30 73 74 ?? ?? ?? ?? ?? ?? ?? ?? 78 9C }   \n         $b = \"Gh0st Update\"   \n      \n      condition:   \n         any of them   \n      \n   }",
			"type": "YARA",
			"id": 31040298
		},
		{
			"indicator": "9270a9bac5091df08ec28f589ac5cb134b381cf0",
			"description": "",
			"title": "",
			"content": "rule APT_WIN_Gh0st_ver : RAT   \n   {   \n   meta:   \n      author = \"@BryanNolen\"   \n      date = \"2012-12\"   \n      type = \"APT\"   \n      version = \"1.1\"   \n      ref = \"Detection of Gh0st RAT server DLL component\"   \n      ref1 = \"http://www.mcafee.com/au/resources/white-papers/foundstone/wp-know-your-digital-enemy.pdf\"   \n    strings:     \n      $library = \"deflate 1.1.4 Copyright 1995-2002 Jean-loup Gailly\"   \n      $capability = \"GetClipboardData\"   \n      $capability1 = \"capCreateCaptureWindowA\"   \n      $capability2 = \"CreateRemoteThread\"   \n      $capability3 = \"WriteProcessMemory\"   \n      $capability4 = \"LsaRetrievePrivateData\"   \n      $capability5 = \"AdjustTokenPrivileges\"   \n      $function = \"ResetSSDT\"   \n      $window = \"WinSta0\\\\Default\"   \n      $magic = {47 6C 6F 62 61 6C 5C [5-9] 20 25 64}    /* $magic = \"Gh0st\" */   \n    condition:   \n      all of them   \n   }",
			"type": "YARA",
			"id": 31040299
		},
		{
			"indicator": "7ed3c6c25dd467e27e186f67322a821d8d2cc7a7",
			"description": "",
			"title": "",
			"content": "rule MW_gholee_v1 : v1   \n   {   \n   meta:   \n       Author = \"@GelosSnake\"   \n       description = \"http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html\"   \n       date = \"2014-08\"   \n       maltype = \"Remote Access Trojan\"   \n       sample_filetype = \"dll\"   \n       hash0 = \"48573a150562c57742230583456b4c02\"   \n         \n   strings:   \n       $a = \"sandbox_avg10_vc9_SP1_2011\"   \n       $b = \"gholee\"   \n         \n   condition:   \n       all of them   \n   }",
			"type": "YARA",
			"id": 31040966
		},
		{
			"indicator": "1aa88691906cccd470cb76d23fc5fb5ba74c730a",
			"description": "",
			"title": "",
			"content": "rule MW_gholee_v2 : v2   \n   {   \n   meta:   \n           author = \"@GelosSnake\"   \n           date = \"2015-02-12\"   \n           description = \"http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html\"   \n           hash0 = \"05523761ca296ec09afdf79477e5f18d\"   \n           hash1 = \"08e424ac42e6efa361eccefdf3c13b21\"   \n           hash2 = \"5730f925145f1a1cd8380197e01d9e06\"   \n           hash3 = \"73461c8578dd9ab86d42984f30c04610\"   \n           sample_filetype = \"dll\"   \n   strings:   \n           $string0 = \"RichHa\"   \n           $string1 = \"         (((((                  H\" wide   \n           $string2 = \"1$1,141<1D1L1T1\\\\1d1l1t1\"   \n           $string3 = \"<8;$O' \"   \n           $string4 = \"@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]\"   \n           $string5 = \"jYPQTVTSkllZTTXRTUiHceWda/\"   \n           $string6 = \"urn:schemas-microsoft-com:asm.v1\"   \n           $string7 = \"8.848H8O8i8s8y8\"   \n           $string8 = \"wrapper3\" wide   \n           $string9 = \"pwwwwwwww\"   \n           $string10 = \"Sunday\"   \n           $string11 = \"YYuTVWh\"   \n           $string12 = \"DDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDIN\"   \n           $string13 = \"ytMMMMMMUbbrrrrrxxxxxxxxrriUMMMMMMMMMUuzt\"   \n           $string15 = \"wrapper3 Version 1.0\" wide   \n           $string16 = \"77A779\"   \n           $string17 = \"<C<G<M<R<X<\"   \n           $string18 = \"9 9-9N9X9s9\"   \n   condition:   \n           18 of them   \n   }",
			"type": "YARA",
			"id": 31040967
		},
		{
			"indicator": "87ebe417f98a50d0cdca2b6f57110f4fbe291123",
			"description": "",
			"title": "",
			"content": "rule gholeeV2   \n   {   \n      meta:   \n   \tAuthor = \"@GelosSnake\"   \n   \tDate = \"2015-02-12\"   \n       \tDescription = \"Gholee first discovered variant \"   \n   \tReference = \"http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html\"    \n      \n      strings:   \n   \t$string0 = \"RichHa\"   \n   \t$string1 = \"         (((((                  H\" wide   \n   \t$string2 = \"1$1,141<1D1L1T1\\\\1d1l1t1\"   \n   \t$string3 = \"<8;$O' \"   \n   \t$string4 = \"@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]\"   \n   \t$string5 = \"jYPQTVTSkllZTTXRTUiHceWda/\"   \n   \t$string6 = \"urn:schemas-microsoft-com:asm.v1\"   \n   \t$string7 = \"8.848H8O8i8s8y8\"   \n   \t$string8 = \"wrapper3\" wide   \n   \t$string9 = \"pwwwwwwww\"   \n   \t$string10 = \"Sunday\"   \n   \t$string11 = \"YYuTVWh\"   \n   \t$string12 = \"DDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDIN\"   \n   \t$string13 = \"ytMMMMMMUbbrrrrrxxxxxxxxrriUMMMMMMMMMUuzt\"   \n   \t$string15 = \"wrapper3 Version 1.0\" wide   \n   \t$string16 = \"77A779\"   \n   \t$string17 = \"<C<G<M<R<X<\"   \n   \t$string18 = \"9 9-9N9X9s9\"   \n      \n       condition:   \n   \t18 of them   \n   }",
			"type": "YARA",
			"id": 31040968
		},
		{
			"indicator": "f23c85dc831ad984dfb627d0ec05888b0ff9fb1a",
			"description": "",
			"title": "",
			"content": "rule gholeeV1   \n   {   \n       meta:   \n   \t Author = \"@GelosSnake\"   \n       \t Date = \"2014/08\"   \n       \t Description = \"Gholee first discovered variant \"   \n   \t Reference = \"http://securityaffairs.co/wordpress/28170/cyber-crime/gholee-malware.html\"    \n      \n       strings:   \n       \t $a = \"sandbox_avg10_vc9_SP1_2011\"   \n       \t $b = \"gholee\"   \n      \n       condition:   \n       \t all of them   \n   }",
			"type": "YARA",
			"id": 31040969
		},
		{
			"indicator": "af1d702b83a779b69c51f5fd41701f4fb97a4eed",
			"description": "",
			"title": "",
			"content": "rule apt_win32_dll_rat_hiZor_RAT: RAT   \n   {   \n   \tmeta:   \n       description = \"Detects hiZor RAT\"   \n   \t\thash1 = \"75d3d1f23628122a64a2f1b7ef33f5cf\"   \n   \t\thash2 = \"d9821468315ccd3b9ea03161566ef18e\"   \n   \t\thash3 = \"b9af5f5fd434a65d7aa1b55f5441c90a\"   \n       ref1 = \"http://www.threatgeek.com/2016/01/introducing-hi-zor-rat.html\"   \n       ref2 = \"https://github.com/Neo23x0/Loki/blob/b187ed063d73d0defc6958100ca7ad04aa77fc12/signatures/apt_hizor_rat.yar\"   \n       reference = \"https://www.fidelissecurity.com/sites/default/files/FTA_1020_Fidelis_Inocnation_FINAL.pdf\"   \n   \tstrings:   \n   \t\t// Part of the encoded User-Agent = Mozilla   \n   \t\t$s1 = { c7 [5] 40 00 62 00 c7 [5] 77 00 64 00 c7 [5] 61 00 61 00 c7 [5] 6c 00 }   \n      \n   \t\t// XOR to decode User-Agent after string stacking 0x10001630   \n   \t\t$s2 = { 66 [7] 0d 40 83 ?? ?? 7c ?? }   \n      \n   \t\t// XOR with 0x2E - 0x10002EF6   \n   \t\t$s3 = { 80 [2] 2e 40 3b ?? 72 ?? }   \n      \n   \t\t$s4 = \"CmdProcessExited\" wide ascii   \n   \t\t$s5 = \"rootDir\" wide ascii   \n   \t\t$s6 = \"DllRegisterServer\" wide ascii   \n   \t\t$s7 = \"GetNativeSystemInfo\" wide ascii   \n   \t\t$s8 = \"%08x%08x%08x%08x\" wide ascii   \n   \tcondition:   \n   \t\t(uint16(0) == 0x5A4D or uint32(0) == 0x4464c457f) and (all of them)   \n   }",
			"type": "YARA",
			"id": 31040981
		},
		{
			"indicator": "2bd4842e23253365d1d71e04c3189987ae66caab",
			"description": "",
			"title": "",
			"content": "rule apt_win32_dll_rat_1a53b0cp32e46g0qio7   \n   {   \n   \tmeta:   \n   \t\tauthor = \"https://www.fidelissecurity.com/\"   \n           \tinfo = \"Indicators for FTA-1020\"   \n   \t\thash1 = \"75d3d1f23628122a64a2f1b7ef33f5cf\"   \n   \t\thash2 = \"d9821468315ccd3b9ea03161566ef18e\"   \n   \t\thash3 = \"b9af5f5fd434a65d7aa1b55f5441c90a\"   \n   \t\treference = \"https://github.com/fideliscyber\"   \n   \tstrings:   \n       \t// Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0;rv:11.0) like Gecko   \n   \t\t$ = { c7 [2] 64 00 63 00 c7 [2] 69 00 62 00 c7 [2] 7a 00 7e 00 c7 [2] 2d 00 43 00 c7 [2] 59 00 2d 00 c7 [2] 3b 00 23 00 c7 [2] 3e 00 36 00 c7 [2] 2d 00 5a 00 c7 [2] 42 00 5a 00 c7 [2] 3b 00 39 00 c7 [2] 36 00 2d 00 c7 [2] 59 00 7f 00 c7 [2] 64 00 69 00 c7 [2] 68 00 63 00 c7 [2] 79 00 22 00 c7 [2] 3a 00 23 00 c7 [2] 3d 00 36 00 c7 [2] 2d 00 7f 00 c7 [2] 7b 00 37 00 c7 [2] 3c 00 3c 00 c7 [2] 23 00 3d 00 c7 [2] 24 00 2d 00 c7 [2] 61 00 64 00 c7 [2] 66 00 68 00 c7 [2] 2d 00 4a 00 c7 [2] 68 00 6e 00 c7 [2] 66 00 62 00 } // offset 10001566   \n   \t// Software\\Microsoft\\Windows\\CurrentVersion\\Run   \n          $ = { c7 [2] 23 00 24 00 c7 [2] 24 00 33 00 c7 [2] 38 00 22 00 c7 [2] 00 00 33 00 c7 [2] 24 00 25 00 c7 [2] 3f 00 39 00 c7 [2] 38 00 0a 00 c7 [2] 04 00 23 00 c7 [2] 38 00 00 00 c7 [2] 43 00 66 00 c7 [2] 6d 00 60 00 c7 [2] 67 00 52 00 c7 [2] 6e 00 63 00 c7 [2] 7b 00 67 00 c7 [2] 70 00 00 00 c7 [2] 43 00 4d 00 c7 [2] 44 00 00 00 c7 [2] 0f 00 43 00 c7 [2] 00 00 50 00 c7 [2] 49 00 4e 00 c7 [2] 47 00 00 00 c7 [2] 11 00 12 00 c7 [2] 17 00 0e 00 c7 [2] 10 00 0e 00 c7 [2] 10 00 0e 00 c7 [2] 11 00 06 00 c7 [2] 44 00 45 00 c7 [2] 4c 00 00 00 } // 10003D09   \n   \t$ = { 66 [4-7] 0d 40 83 f8 44 7c ?? }   \n          // xor\t\tword ptr [ebp+eax*2+var_5C], 14h   \n   \t// inc\t\teax   \n   \t// cmp     \teax, 14h   \n          // Loop to decode a static string. It reveals the \"1a53b0cp32e46g0qio9\" static string sent in the beacon   \n   \t$ = { 66 [4-7] 14 40 83 f8 14 7c ?? } // 100017F0   \n   \t$ = { 66 [4-7] 56 40 83 f8 2d 7c ?? } // 10003621   \n   \t$ = { 66 [4-7] 20 40 83 f8 1a 7c ?? } // 10003640   \n   \t$ = { 80 [2-7] 2e 40 3d 50 02 00 00 72 ?? } //  10003930   \n   \t$ = \"%08x%08x%08x%08x\" wide ascii   \n   \t$ = \"WinHttpGetIEProxyConfigForCurrentUser\" wide ascii   \n      \n   \tcondition:   \n   \t(uint16(0) == 0x5A4D or uint32(0) == 0x4464c457f) and (all of them)   \n   }",
			"type": "YARA",
			"id": 31041036
		},
		{
			"indicator": "be539d51cf46c91c9b0b44ea2702c7045240fb06",
			"description": "",
			"title": "",
			"content": "rule Meterpreter_Reverse_Tcp {    \n     meta: // This is the standard backdoor/RAT from Metasploit, could be used by any actor    \n       author = \"chort (@chort0)\"    \n       description = \"Meterpreter reverse TCP backdoor in memory. Tested on Win7x64.\"    \n     strings:    \n       $a = { 4d 45 54 45 52 50 52 45 54 45 52 5f 54 52 41 4e 53 50 4f 52 54 5f 53 53 4c [32-48] 68 74 74 70 73 3a 2f 2f 58 58 58 58 58 58 } // METERPRETER_TRANSPORT_SSL  https://XXXXXX    \n       $b = { 4d 45 54 45 52 50 52 45 54 45 52 5f 55 41 } // METERPRETER_UA    \n       $c = { 47 45 54 20 2f 31 32 33 34 35 36 37 38 39 20 48 54 54 50 2f 31 2e 30 } // GET /123456789 HTTP/1.0    \n       $d = { 6d 65 74 73 72 76 2e 64 6c 6c [2-4] 52 65 66 6c 65 63 74 69 76 65 4c 6f 61 64 65 72 } // metsrv.dll  ReflectiveLoader    \n          \n     condition:    \n       $a or (any of ($b, $d) and $c)    \n     }",
			"type": "YARA",
			"id": 31041126
		},
		{
			"indicator": "66027d2e6c44b31bacea2bd929e00bb3c84da58e",
			"description": "",
			"title": "",
			"content": "rule Nanocore_RAT_Gen_1 {   \n   \tmeta:   \n   \t\tdescription = \"Detetcs the Nanocore RAT and similar malware\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\treference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"   \n   \t\tdate = \"2016-04-22\"   \n   \t\tscore = 70   \n   \t\thash1 = \"e707a7745e346c5df59b5aa4df084574ae7c204f4fb7f924c0586ae03b79bf06\"   \n   \tstrings:   \n   \t\t$x1 = \"C:\\\\Users\\\\Logintech\\\\Dropbox\\\\Projects\\\\New folder\\\\Latest\\\\Benchmark\\\\Benchmark\\\\obj\\\\Release\\\\Benchmark.pdb\" fullword ascii   \n   \t\t$x2 = \"RunPE1\" fullword ascii   \n   \t\t$x3 = \"082B8C7D3F9105DC66A7E3267C9750CF43E9D325\" fullword ascii   \n   \t\t$x4 = \"$374e0775-e893-4e72-806c-a8d880a49ae7\" fullword ascii   \n   \t\t$x5 = \"Monitorinjection\" fullword ascii   \n   \tcondition:   \n   \t\t( uint16(0) == 0x5a4d and filesize < 100KB and ( 1 of them ) ) or ( 3 of them )   \n   }",
			"type": "YARA",
			"id": 31041127
		},
		{
			"indicator": "93f4f2e016e99e0c02247c85a2a92fc5462b429a",
			"description": "",
			"title": "",
			"content": "rule Nanocore_RAT_Gen_2 {   \n   \tmeta:   \n   \t\tdescription = \"Detetcs the Nanocore RAT\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\tscore = 100   \n   \t\treference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"   \n   \t\tdate = \"2016-04-22\"   \n   \t\thash1 = \"755f49a4ffef5b1b62f4b5a5de279868c0c1766b528648febf76628f1fe39050\"   \n   \tstrings:   \n   \t\t$x1 = \"NanoCore.ClientPluginHost\" fullword ascii   \n   \t\t$x2 = \"IClientNetworkHost\" fullword ascii   \n   \t\t$x3 = \"#=qjgz7ljmpp0J7FvL9dmi8ctJILdgtcbw8JYUc6GC8MeJ9B11Crfg2Djxcf0p8PZGe\" fullword ascii   \n   \tcondition:   \n   \t\t( uint16(0) == 0x5a4d and filesize < 1000KB and 1 of them ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 31041128
		},
		{
			"indicator": "edee1689de20c1b1b7810cf089c69ef55919e795",
			"description": "",
			"title": "",
			"content": "rule Nanocore_RAT_Sample_1 {   \n   \tmeta:   \n   \t\tdescription = \"Detetcs a certain Nanocore RAT sample\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\tscore = 75   \n   \t\treference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"   \n   \t\tdate = \"2016-04-22\"   \n   \t\thash2 = \"b7cfc7e9551b15319c068aae966f8a9ff563b522ed9b1b42d19c122778e018c8\"   \n   \tstrings:   \n   \t\t$x1 = \"TbSiaEdJTf9m1uTnpjS.n9n9M7dZ7FH9JsBARgK\" fullword wide   \n   \t\t$x2 = \"1EF0D55861681D4D208EC3070B720C21D885CB35\" fullword ascii   \n   \t\t$x3 = \"popthatkitty.Resources.resources\" fullword ascii   \n   \tcondition:   \n   \t\t( uint16(0) == 0x5a4d and filesize < 900KB and ( 1 of ($x*) ) ) or ( all of them )   \n   }",
			"type": "YARA",
			"id": 31041129
		},
		{
			"indicator": "bb24089703c1e781a86bf38b2bc403a9cd4bccc9",
			"description": "",
			"title": "",
			"content": "rule Nanocore_RAT_Sample_2 {   \n   \tmeta:   \n   \t\tdescription = \"Detetcs a certain Nanocore RAT sample\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\tscore = 75   \n   \t\treference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"   \n   \t\tdate = \"2016-04-22\"   \n   \t\thash1 = \"51142d1fb6c080b3b754a92e8f5826295f5da316ec72b480967cbd68432cede1\"   \n   \tstrings:   \n   \t\t$s1 = \"U4tSOtmpM\" fullword ascii   \n   \t\t$s2 = \")U71UDAU_QU_YU_aU_iU_qU_yU_\" fullword wide   \n   \t\t$s3 = \"Cy4tOtTmpMtTHVFOrR\" fullword ascii   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and filesize < 40KB and all of ($s*)   \n   }",
			"type": "YARA",
			"id": 31041130
		},
		{
			"indicator": "d8f68ce54b05124967d1f00e784fa9006e1d48b4",
			"description": "",
			"title": "",
			"content": "rule NetWiredRC_B : RAT   \n   {   \n   \tmeta:   \n   \t\tdescription = \"NetWiredRC\"   \n   \t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"   \n   \t\tdate = \"2014-12-23\"   \n   \t\tfiletype = \"memory\"   \n   \t\tversion = \"1.1\"    \n      \n   \tstrings:   \n   \t\t$mutex = \"LmddnIkX\"   \n      \n   \t\t$str1 = \"%s.Identifier\"   \n   \t\t$str2 = \"%d:%I64u:%s%s;\"   \n   \t\t$str3 = \"%s%.2d-%.2d-%.4d\"   \n   \t\t$str4 = \"[%s] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]\"   \n   \t\t$str5 = \"%.2d/%.2d/%d %.2d:%.2d:%.2d\"   \n   \t\t   \n   \t\t$klg1 = \"[Backspace]\"   \n   \t\t$klg2 = \"[Enter]\"   \n   \t\t$klg3 = \"[Tab]\"   \n   \t\t$klg4 = \"[Arrow Left]\"   \n   \t\t$klg5 = \"[Arrow Up]\"   \n   \t\t$klg6 = \"[Arrow Right]\"   \n   \t\t$klg7 = \"[Arrow Down]\"   \n   \t\t$klg8 = \"[Home]\"   \n   \t\t$klg9 = \"[Page Up]\"   \n   \t\t$klg10 = \"[Page Down]\"   \n   \t\t$klg11 = \"[End]\"   \n   \t\t$klg12 = \"[Break]\"   \n   \t\t$klg13 = \"[Delete]\"   \n   \t\t$klg14 = \"[Insert]\"   \n   \t\t$klg15 = \"[Print Screen]\"   \n   \t\t$klg16 = \"[Scroll Lock]\"   \n   \t\t$klg17 = \"[Caps Lock]\"   \n   \t\t$klg18 = \"[Alt]\"   \n   \t\t$klg19 = \"[Esc]\"   \n   \t\t$klg20 = \"[Ctrl+%c]\"   \n      \n   \tcondition:    \n   \t\t$mutex or (1 of ($str*) and 1 of ($klg*))   \n   }",
			"type": "YARA",
			"id": 31041155
		},
		{
			"indicator": "d21c38d4852c817f3d7a236c318071512d768cec",
			"description": "",
			"title": "",
			"content": "rule network_traffic_njRAT    \n   {   \n   meta:   \n   author = \"info@fidelissecurity.com\"   \n   descripion = \"njRAT - Remote Access Trojan\"   \n   comment = \"Rule to alert on network traffic indicators\"   \n   filetype = \"PCAP - Network Traffic\"   \n   date = \"2013-07-15\"   \n   version = \"1.0\"   \n   hash1 = \"92ee1fb5df21d8cfafa2b02b6a25bd3b\"   \n   hash2 =\"3576d40ce18bb0349f9dfa42b8911c3a\"   \n   hash3 =\"24cc5b811a7f9591e7f2cb9a818be104\"   \n   hash4 = \"3ad5fded9d7fdf1c2f6102f4874b2d52\"   \n   hash5 = \"a98b4c99f64315aac9dd992593830f35\"   \n   hash6 = \"5fcb5282da1a2a0f053051c8da1686ef\"   \n   hash7 = \"a669c0da6309a930af16381b18ba2f9d\"   \n   hash8 = \"79dce17498e1997264346b162b09bde8\"   \n   hash9 = \"fc96a7e27b1d3dab715b2732d5c86f80\"   \n   ref1 = \"http://bit.ly/19tlf4s\"   \n   ref2 = \"http://www.fidelissecurity.com/threatadvisory\"   \n   ref3 = \"http://www.threatgeek.com/2013/06/fidelis-threat-advisory-1009-njrat-uncovered.html\"   \n   ref4 = \"http://threatgeek.typepad.com/files/fta-1009---njrat-uncovered.pdf\"   \n      \n   strings:   \n   $string1 = \"FM|'|'|\"     // File Manager   \n   $string2 = \"nd|'|'|\"     // File Manager   \n   $string3 = \"rn|'|'|\"      // Run File   \n   $string4 = \"sc~|'|'|\"     // Remote Desktop   \n   $string5 = \"scPK|'|'|\"     // Remote Desktop   \n   $string6 = \"CAM|'|'|\"     // Remote Cam   \n   $string7 = \"USB Video Device[endof]\" // Remote Cam   \n   $string8 = \"rs|'|'|\"     // Reverse Shell   \n   $string9 = \"proc|'|'|\"     // Process Manager   \n   $string10 = \"k|'|'|\"     // Process Manager   \n   $string11 = \"RG|'|'|~|'|'|\"    // Registry Manipulation   \n   $string12 = \"kl|'|'|\"     // Keylogger file   \n   $string13 = \"ret|'|'|\"     // Get Browser Passwords   \n   $string14 = \"pl|'|'|\"     // Get Browser Passwords   \n   $string15 = \"lv|'|'|\"     // General   \n   $string16 = \"prof|'|'|~|'|'|\"   // Server rename   \n   $string17 = \"un|'|'|~[endof]\"   // Uninstall   \n   $idle_string = \"P[endof]\"    // Idle Connection   \n      \n   condition:   \n   any of ($string*) or #idle_string > 4     \n      \n   }",
			"type": "YARA",
			"id": 31041304
		},
		{
			"indicator": "c5f9cd3ab32388cd2d46fc9324a15b596c68dca2",
			"description": "",
			"title": "",
			"content": "rule njrat1: RAT   \n   {   \n       meta:   \n           author = \"Brian Wallace @botnet_hunter\"   \n           author_email = \"bwall@ballastsecurity.net\"   \n           date = \"2015-05-27\"   \n           description = \"Identify njRat\"   \n       strings:   \n           $a1 = \"netsh firewall add allowedprogram \" wide   \n           $a2 = \"SEE_MASK_NOZONECHECKS\" wide   \n      \n           $b1 = \"[TAP]\" wide   \n           $b2 = \" & exit\" wide   \n      \n           $c1 = \"md.exe /k ping 0 & del \" wide   \n           $c2 = \"cmd.exe /c ping 127.0.0.1 & del\" wide   \n           $c3 = \"cmd.exe /c ping\" wide   \n       condition:   \n           1 of ($a*) and 1 of ($b*) and 1 of ($c*)   \n   }",
			"type": "YARA",
			"id": 31041306
		},
		{
			"indicator": "7b1e9ebee3c8c7769c6474e4fa2bfe9c7ea7a286",
			"description": "",
			"title": "",
			"content": "rule RAT_Orcus    \n   {   \n      \n       meta:   \n           author = \" J from THL <j@techhelplist.com> with thx to MalwareHunterTeam\"   \n           date = \"2017/01\"   \n           reference = \"https://virustotal.com/en/file/0ef747363828342c184303f2d6fbead054200e9c223e5cfc4777cda03006e317/analysis/\"   \n           version = 1   \n           maltype = \"RAT\"   \n           filetype = \"memory\"   \n      \n       strings:   \n           $text01 = \"Orcus.CommandManagement\"   \n           $text02 = \"Orcus.Commands.\"   \n           $text03 = \"Orcus.Config.\"   \n           $text04 = \"Orcus.Connection.\"   \n           $text05 = \"Orcus.Core.\"   \n           $text06 = \"Orcus.exe\"   \n           $text07 = \"Orcus.Extensions.\"   \n           $text08 = \"Orcus.InstallationPromptForm\"   \n           $text09 = \"Orcus.MainForm.\"   \n           $text10 = \"Orcus.Native.\"   \n           $text11 = \"Orcus.Plugins.\"   \n           $text12 = \"orcus.plugins.dll\"   \n           $text13 = \"Orcus.Properties.\"   \n           $text14 = \"Orcus.Protection.\"   \n           $text15 = \"Orcus.Share.\"   \n           $text16 = \"Orcus.Shared\"   \n           $text17 = \"Orcus.StaticCommands\"   \n           $text18 = \"Orcus.Utilities.\"   \n           $text19 = \"\\\\Projects\\\\Orcus\\\\Source\\\\Orcus.\"   \n           $text20 = \".orcus.plugins.dll.zip\"   \n           $text21 = \".orcus.shared.dll.zip\"   \n           $text22 = \".orcus.shared.utilities.dll.zip\"   \n           $text23 = \".orcus.staticcommands.dll.zip\"   \n           $text24 = \"HvncCommunication\"   \n           $text25 = \"HvncAction\"   \n           $text26 = \"hvncDesktop\"   \n           $text27 = \".InstallationPromptForm\"   \n           $text28 = \"RequestKeyLogCommand\"   \n           $text29 = \"get_KeyLogFile\"   \n           $text30 = \"LiveKeyloggerCommand\"   \n           $text31 = \"ORCUS.STATICCOMMANDS, VERSION=\"   \n           $text32 = \"PrepareOrcusFileToRemove\"   \n           $text33 = \"ConvertFromOrcusValueKind\"   \n      \n       condition:   \n           13 of them   \n   }",
			"type": "YARA",
			"id": 31042253
		},
		{
			"indicator": "0e883448a36081ad78c52a85ee7e539c89b4d53b",
			"description": "",
			"title": "",
			"content": "rule PlugXStrings : PlugX Family   \n   {   \n       meta:   \n           description = \"PlugX Identifying Strings\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-06-12\"   \n              \n       strings:   \n           $BootLDR = \"boot.ldr\" wide ascii   \n           $Dwork = \"d:\\\\work\" nocase   \n           $Plug25 = \"plug2.5\"   \n           $Plug30 = \"Plug3.0\"   \n           $Shell6 = \"Shell6\"   \n            \n       condition:   \n           $BootLDR or ($Dwork and ($Plug25 or $Plug30 or $Shell6))   \n   }",
			"type": "YARA",
			"id": 31043093
		},
		{
			"indicator": "4e0c993410c7af6a25b2f03e8d9318402a656a70",
			"description": "",
			"title": "",
			"content": "rule plugX : rat   \n   {   \n   \tmeta:   \n   \t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"   \n   \t\tdescription = \"PlugX RAT\"   \n   \t\tdate = \"2014-05-13\"   \n   \t\tfiletype = \"memory\"   \n   \t\tversion = \"1.0\"    \n   \t\tref1 = \"https://github.com/mattulm/IR-things/blob/master/volplugs/plugx.py\"   \n   \t\t   \n   \tstrings:   \n   \t\t$v1a = { 47 55 4C 50 00 00 00 00 }   \n   \t\t$v1b = \"/update?id=%8.8x\"    \n   \t\t$v1algoa = { BB 33 33 33 33 2B }    \n   \t\t$v1algob = { BB 44 44 44 44 2B }    \n   \t\t$v2a = \"Proxy-Auth:\"    \n   \t\t$v2b = { 68 A0 02 00 00 }    \n   \t\t$v2k = { C1 8F 3A 71 }    \n   \t\t   \n   \tcondition:    \n   \t\t$v1a at 0 or $v1b or (($v2a or $v2b) and (($v1algoa and $v1algob) or $v2k))   \n   }",
			"type": "YARA",
			"id": 31043094
		},
		{
			"indicator": "c102d1dde54f2a403e1b6d0f1da14bcf56259af5",
			"description": "",
			"title": "",
			"content": "rule PlugX_mw   \n   {    \n   \tmeta:   \n   \t\tmaltype = \"plugX\"   \n   \t\tauthor = \"https://github.com/reed1713\"   \n   \t\treference = \"http://www.fireeye.com/blog/technical/targeted-attack/2014/02/operation-greedywonk-multiple-economic-and-foreign-policy-sites-compromised-serving-up-flash-zero-day-exploit.html\"   \n   \t\tdescription = \"Malware creates a randomized directory within the appdata roaming directory and launches the malware. Should see multiple events for create process rundll32.exe and iexplorer.exe as it repeatedly uses iexplorer to launch the rundll32 process.\"   \n   \tstrings:   \n   \t\t$type=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid=\"4688\"   \n   \t\t$data=/\\\\AppData\\\\Roaming\\\\[0-9]{9,12}\\VMwareCplLauncher\\.exe/   \n      \n   \t\t$type1=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid1=\"4688\"   \n   \t\t$data1=\"\\\\Windows\\\\System32\\\\rundll32.exe\"   \n      \n   \t\t$type2=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid2=\"4688\"   \n   \t\t$data2=\"Program Files\\\\Internet Explorer\\\\iexplore.exe\"   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043095
		},
		{
			"indicator": "e8dfda54780032847b023ad0200e6d0eb7bc73e0",
			"description": "",
			"title": "",
			"content": "rule poisonivy_1 : rat   \n   {   \n   \tmeta:   \n   \t\tdescription = \"Poison Ivy\"   \n   \t\tauthor = \"Jean-Philippe Teissier / @Jipe_\"   \n   \t\tdate = \"2013-02-01\"   \n   \t\tfiletype = \"memory\"   \n   \t\tversion = \"1.0\"    \n   \t\tref1 = \"https://code.google.com/p/volatility/source/browse/trunk/contrib/plugins/malware/poisonivy.py\"   \n      \n   \tstrings:   \n   \t\t$a = { 53 74 75 62 50 61 74 68 ?? 53 4F 46 54 57 41 52 45 5C 43 6C 61 73 73 65 73 5C 68 74 74 70 5C 73 68 65 6C 6C 5C 6F 70 65 6E 5C 63 6F 6D 6D 61 6E 64 [22] 53 6F 66 74 77 61 72 65 5C 4D 69 63 72 6F 73 6F 66 74 5C 41 63 74 69 76 65 20 53 65 74 75 70 5C 49 6E 73 74 61 6C 6C 65 64 20 43 6F 6D 70 6F 6E 65 6E 74 73 5C }    \n   \t\t   \n   \tcondition:   \n   \t\t$a   \n   }",
			"type": "YARA",
			"id": 31043096
		},
		{
			"indicator": "3f1a574e0deaeb4d17b1923baf7f38d6b6c72b10",
			"description": "",
			"title": "",
			"content": "rule PoisonIvy_2   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/PoisonIvy\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n       strings:   \n       \t$stub = {04 08 00 53 74 75 62 50 61 74 68 18 04}   \n           $string1 = \"CONNECT %s:%i HTTP/1.0\"   \n           $string2 = \"ws2_32\"   \n           $string3 = \"cks=u\"   \n           $string4 = \"thj@h\"   \n           $string5 = \"advpack\"   \n       condition:   \n   \t\t$stub at 0x1620 and all of ($string*) or (all of them)   \n   }",
			"type": "YARA",
			"id": 31043097
		},
		{
			"indicator": "0a92b4c84c88d81a8264e38504d4c61c0cdb1fb7",
			"description": "",
			"title": "",
			"content": "rule PoisonIvy_Generic_3 {   \n   \tmeta:   \n   \t\tdescription = \"PoisonIvy RAT Generic Rule\"   \n   \t\tauthor = \"Florian Roth\"   \n   \t\tdate = \"2015-05-14\"   \n   \t\thash = \"e1cbdf740785f97c93a0a7a01ef2614be792afcd\"   \n   \tstrings:   \n   \t\t$k1 = \"Tiger324{\" fullword ascii   \n   \t\t   \n   \t\t$s2 = \"WININET.dll\" fullword ascii   \n   \t\t$s3 = \"mscoree.dll\" fullword wide   \n   \t\t$s4 = \"WS2_32.dll\" fullword   \n   \t\t$s5 = \"Explorer.exe\" fullword wide   \n   \t\t$s6 = \"USER32.DLL\"   \n   \t\t$s7 = \"CONOUT$\"   \n   \t\t$s8 = \"login.asp\"   \n   \t\t   \n   \t\t$h1 = \"HTTP/1.0\"   \n   \t\t$h2 = \"POST\"   \n   \t\t$h3 = \"login.asp\"   \n   \t\t$h4 = \"check.asp\"   \n   \t\t$h5 = \"result.asp\"   \n   \t\t$h6 = \"upload.asp\"   \n   \tcondition:   \n   \t\tuint16(0) == 0x5a4d and filesize < 500KB and   \n   \t\t\t(    \n   \t\t\t\t$k1 or all of ($s*) or all of ($h*)   \n   \t\t\t)   \n   }",
			"type": "YARA",
			"id": 31043098
		},
		{
			"indicator": "42701fa4b172ffe3d3bcaeebe09c3df36ac27940",
			"description": "",
			"title": "",
			"content": "rule PythoRAT : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/PythoRAT\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$a = \"TKeylogger\"   \n   \t\t$b = \"uFileTransfer\"   \n   \t\t$c = \"TTDownload\"   \n   \t\t$d = \"SETTINGS\"   \n   \t\t$e = \"Unknown\" wide   \n   \t\t$f = \"#@#@#\"   \n   \t\t$g = \"PluginData\"   \n   \t\t$i = \"OnPluginMessage\"   \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043347
		},
		{
			"indicator": "3fd90296fd4d3cd1acc259ac665df572b8dba1df",
			"description": "",
			"title": "",
			"content": "rule NanoCore : RAT   \n   {   \n       meta:   \n           author = \" Kevin Breen <kevin@techanarchy.net>\"   \n           date = \"2014/04\"   \n           ref = \"http://malwareconfig.com/stats/NanoCore\"   \n           maltype = \"Remote Access Trojan\"   \n           filetype = \"exe\"   \n      \n       strings:   \n           $a = \"NanoCore\"   \n           $b = \"ClientPlugin\"   \n           $c = \"ProjectData\"   \n           $d = \"DESCrypto\"   \n           $e = \"KeepAlive\"   \n           $f = \"IPNETROW\"   \n           $g = \"LogClientMessage\"   \n   \t\t$h = \"|ClientHost\"   \n   \t\t$i = \"get_Connected\"   \n   \t\t$j = \"#=q\"   \n           $key = {43 6f 24 cb 95 30 38 39}   \n      \n      \n       condition:   \n           6 of them   \n   }",
			"type": "YARA",
			"id": 31043348
		},
		{
			"indicator": "96b57078fb40bd776667d104a6b55f43d8b80492",
			"description": "",
			"title": "",
			"content": "rule HawkEye : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2015/06\"   \n   \t\tref = \"http://malwareconfig.com/stats/HawkEye\"   \n   \t\tmaltype = \"KeyLogger\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$key = \"HawkEyeKeylogger\" wide   \n   \t\t$salt = \"099u787978786\" wide   \n   \t\t$string1 = \"HawkEye_Keylogger\" wide   \n   \t\t$string2 = \"holdermail.txt\" wide   \n   \t\t$string3 = \"wallet.dat\" wide   \n   \t\t$string4 = \"Keylog Records\" wide   \n           $string5 = \"<!-- do not script -->\" wide   \n           $string6 = \"\\\\pidloc.txt\" wide   \n           $string7 = \"BSPLIT\" wide   \n              \n      \n   \tcondition:   \n   \t\t$key and $salt and all of ($string*)   \n   }",
			"type": "YARA",
			"id": 31043349
		},
		{
			"indicator": "a2889d673bf0219abf8e30e7ecf441ac567fa1ce",
			"description": "",
			"title": "",
			"content": "rule PredatorPain : RAT   \n   {   \n      \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/PredatorPain\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$string1 = \"holderwb.txt\" wide   \n   \t\t$string3 = \"There is a file attached to this email\" wide   \n   \t\t$string4 = \"screens\\\\screenshot\" wide   \n   \t\t$string5 = \"Disablelogger\" wide   \n   \t\t$string6 = \"\\\\pidloc.txt\" wide   \n           $string7 = \"clearie\" wide   \n           $string8 = \"clearff\" wide   \n           $string9 = \"emails should be sent to you shortly\" wide   \n           $string10 = \"jagex_cache\\\\regPin\" wide   \n           $string11 = \"open=Sys.exe\" wide   \n   \t\t$ver1 = \"PredatorLogger\" wide   \n   \t\t$ver2 = \"EncryptedCredentials\" wide   \n           $ver3 = \"Predator Pain\" wide   \n      \n   \tcondition:   \n   \t\t7 of ($string*) and any of ($ver*)   \n   }",
			"type": "YARA",
			"id": 31043350
		},
		{
			"indicator": "d78636ca00308bb383eae66b8d8d1b678424fd44",
			"description": "",
			"title": "",
			"content": "rule SpyGate : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/SpyGate\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$split = \"abccba\"   \n   \t\t$a1 = \"abccbaSpyGateRATabccba\" //$a = Version 0.2.6   \n   \t\t$a2 = \"StubX.pdb\"    \n   \t\t$a3 = \"abccbaDanabccb\"   \n   \t\t$b1 = \"monikerString\" nocase //$b = Version 2.0   \n   \t\t$b2 = \"virustotal1\"   \n   \t\t$b3 = \"get_CurrentDomain\"   \n   \t\t$c1 = \"shutdowncomputer\" wide //$c = Version 2.9   \n   \t\t$c2 = \"shutdown -r -t 00\" wide   \n   \t\t$c3 = \"set cdaudio door closed\" wide   \n   \t\t$c4 = \"FileManagerSplit\" wide   \n   \t\t$c5 = \"Chating With >> [~Hacker~]\" wide   \n      \n   \tcondition:   \n   \t\t(all of ($a*) and #split > 40) or (all of ($b*) and #split > 10) or (all of ($c*))   \n   }",
			"type": "YARA",
			"id": 31043351
		},
		{
			"indicator": "3d0da0f3fe4465c8c8bed7e5a18e1ea34cf0dd98",
			"description": "",
			"title": "",
			"content": "rule LuxNet : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/LuxNet\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$a = \"GetHashCode\"   \n   \t\t$b = \"Activator\"   \n   \t\t$c = \"WebClient\"   \n   \t\t$d = \"op_Equality\"   \n   \t\t$e = \"dickcursor.cur\" wide   \n   \t\t$f = \"{0}|{1}|{2}\" wide   \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043352
		},
		{
			"indicator": "7a91f7c2ae6b51a0e0378164c422948535c49aaf",
			"description": "",
			"title": "",
			"content": "rule Vertex : RAT   \n   {   \n      \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/Vertex\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$string1 = \"DEFPATH\"   \n   \t\t$string2 = \"HKNAME\"   \n   \t\t$string3 = \"HPORT\"   \n   \t\t$string4 = \"INSTALL\"   \n   \t\t$string5 = \"IPATH\"   \n   \t\t$string6 = \"MUTEX\"   \n   \t\t$res1 = \"PANELPATH\"   \n   \t\t$res2 = \"ROOTURL\"   \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043353
		},
		{
			"indicator": "6a91c82657e0cdeba780b53544aaa92c99ca7e7a",
			"description": "",
			"title": "",
			"content": "rule Ap0calypse: RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/Ap0calypse\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$a = \"Ap0calypse\"   \n   \t\t$b = \"Sifre\"   \n   \t\t$c = \"MsgGoster\"   \n   \t\t$d = \"Baslik\"   \n   \t\t$e = \"Dosyalars\"   \n   \t\t$f = \"Injecsiyon\"   \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043354
		},
		{
			"indicator": "4c3a720bb8bd269c278874d0d3363e796f4b64cc",
			"description": "",
			"title": "",
			"content": "rule Punisher : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/Punisher\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$a = \"abccba\"   \n   \t\t$b = {5C 00 68 00 66 00 68 00 2E 00 76 00 62 00 73}   \n   \t\t$c = {5C 00 73 00 63 00 2E 00 76 00 62 00 73}   \n   \t\t$d = \"SpyTheSpy\" wide ascii   \n   \t\t$e = \"wireshark\" wide   \n   \t\t$f = \"apateDNS\" wide   \n   \t\t$g = \"abccbaDanabccb\"   \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043355
		},
		{
			"indicator": "dc9227e547114816d499cea632988c9c52e35f37",
			"description": "",
			"title": "",
			"content": "rule QRat : RAT   \n   {   \n       meta:   \n           author = \"Kevin Breen @KevTheHermit\"   \n           date = \"2015/08\"   \n           ref = \"http://malwareconfig.com\"   \n           maltype = \"Remote Access Trojan\"   \n           filetype = \"jar\"   \n              \n       strings:   \n           $a0 = \"e-data\"   \n           $a1 = \"quaverse/crypter\"   \n           $a2 = \"Qrypt.class\"   \n           $a3 = \"Jarizer.class\"   \n           $a4 = \"URLConnection.class\"   \n              \n              \n       condition:   \n           4 of them   \n      \n      \n   }",
			"type": "YARA",
			"id": 31043356
		},
		{
			"indicator": "ba078c8a0291ac1fcc2f859591120a7a4bce105c",
			"description": "",
			"title": "",
			"content": "rule DarkRAT : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/DarkRAT\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$a = \"@1906dark1996coder@\"   \n   \t\t$b = \"SHEmptyRecycleBinA\"   \n   \t\t$c = \"mciSendStringA\"   \n   \t\t$d = \"add_Shutdown\"   \n   \t\t$e = \"get_SaveMySettingsOnExit\"   \n   \t\t$f = \"get_SpecialDirectories\"   \n   \t\t$g = \"Client.My\"   \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043357
		},
		{
			"indicator": "ca5fd72224531b6ddc9d3bd547049cfb5a88a979",
			"description": "",
			"title": "",
			"content": "rule UPX : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n      \n   \tstrings:   \n   \t\t$a = \"UPX0\"   \n   \t\t$b = \"UPX1\"   \n   \t\t$c = \"UPX!\"   \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043358
		},
		{
			"indicator": "7850ec4e25d8224b406a80396aa776ca6f5f94c4",
			"description": "",
			"title": "",
			"content": "rule VirusRat : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/VirusRat\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$string0 = \"virustotal\"   \n   \t\t$string1 = \"virusscan\"   \n   \t\t$string2 = \"abccba\"   \n   \t\t$string3 = \"pronoip\"   \n   \t\t$string4 = \"streamWebcam\"   \n   \t\t$string5 = \"DOMAIN_PASSWORD\"   \n   \t\t$string6 = \"Stub.Form1.resources\"   \n   \t\t$string7 = \"ftp://{0}@{1}\" wide   \n   \t\t$string8 = \"SELECT * FROM moz_logins\" wide   \n   \t\t$string9 = \"SELECT * FROM moz_disabledHosts\" wide   \n   \t\t$string10 = \"DynDNS\\\\Updater\\\\config.dyndns\" wide   \n   \t\t$string11 = \"|BawaneH|\" wide   \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043359
		},
		{
			"indicator": "d5195c33ff51d6eefc402dc29b4a511e26408dcc",
			"description": "",
			"title": "",
			"content": "rule AAR : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/AAR\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$a = \"Hashtable\"   \n   \t\t$b = \"get_IsDisposed\"   \n   \t\t$c = \"TripleDES\"   \n   \t\t$d = \"testmemory.FRMMain.resources\"   \n   \t\t$e = \"$this.Icon\" wide   \n   \t\t$f = \"{11111-22222-20001-00001}\" wide   \n   \t\t$g = \"@@@@@\"   \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043360
		},
		{
			"indicator": "0b5aaeb5a539a31851bab566633566a280ebe0f2",
			"description": "",
			"title": "",
			"content": "rule Bandook : RAT   \n   {   \n      \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/bandook\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n              \n       strings:   \n       \t\t$a = \"aaaaaa1|\"   \n               $b = \"aaaaaa2|\"   \n               $c = \"aaaaaa3|\"   \n               $d = \"aaaaaa4|\"   \n   \t\t\t$e = \"aaaaaa5|\"   \n   \t\t\t$f = \"%s%d.exe\"   \n   \t\t\t$g = \"astalavista\"   \n   \t\t\t$h = \"givemecache\"   \n   \t\t\t$i = \"%s\\\\system32\\\\drivers\\\\blogs\\\\*\"   \n   \t\t\t$j = \"bndk13me\"   \n   \t\t\t   \n      \n              \n       condition:   \n       \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043361
		},
		{
			"indicator": "49cd81b24596a440662af5c296ecc0961ca2511d",
			"description": "",
			"title": "",
			"content": "rule Plasma : RAT   \n   {   \n       meta:   \n           author = \" Kevin Breen <kevin@techanarchy.net>\"   \n           date = \"2014/04\"   \n           ref = \"http://malwareconfig.com/stats/Plasma\"   \n           maltype = \"Remote Access Trojan\"   \n           filetype = \"exe\"   \n      \n       strings:   \n           $a = \"Miner: Failed to Inject.\" wide   \n           $b = \"Started GPU Mining on:\" wide   \n           $c = \"BK: Hard Bot Killer Ran Successfully!\" wide   \n           $d = \"Uploaded Keylogs Successfully!\" wide   \n           $e = \"No Slowloris Attack is Running!\" wide   \n           $f = \"An ARME Attack is Already Running on\" wide   \n           $g = \"Proactive Bot Killer Enabled!\" wide   \n           $h = \"PlasmaRAT\" wide ascii   \n           $i = \"AntiEverything\" wide ascii   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 31043362
		},
		{
			"indicator": "0736870c27f76ffe923dbe5aec60c765748c69de",
			"description": "",
			"title": "",
			"content": "rule Infinity : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/Infinity\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$a = \"CRYPTPROTECT_PROMPTSTRUCT\"   \n   \t\t$b = \"discomouse\"   \n   \t\t$c = \"GetDeepInfo\"   \n   \t\t$d = \"AES_Encrypt\"   \n   \t\t$e = \"StartUDPFlood\"   \n   \t\t$f = \"BATScripting\" wide   \n   \t\t$g = \"FBqINhRdpgnqATxJ.html\" wide   \n   \t\t$i = \"magic_key\" wide   \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043363
		},
		{
			"indicator": "307478d6f0580c9f7076541806b753cce83bfadb",
			"description": "",
			"title": "",
			"content": "rule BlueBanana : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/BlueBanana\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"Java\"   \n      \n   \tstrings:   \n   \t\t$meta = \"META-INF\"   \n   \t\t$conf = \"config.txt\"   \n   \t\t$a = \"a/a/a/a/f.class\"   \n   \t\t$b = \"a/a/a/a/l.class\"   \n   \t\t$c = \"a/a/a/b/q.class\"   \n   \t\t$d = \"a/a/a/b/v.class\"   \n      \n   \t\t   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043364
		},
		{
			"indicator": "3b24f6d7b82ccb77bcf8182b2e8f427e4d72b1a3",
			"description": "",
			"title": "",
			"content": "rule LuminosityLink : RAT   \n   {   \n       meta:   \n           author = \" Kevin Breen <kevin@techanarchy.net>\"   \n           date = \"2014/04\"   \n           ref = \"http://malwareconfig.com/stats/LuminosityLink\"   \n           maltype = \"Remote Access Trojan\"   \n           filetype = \"exe\"   \n      \n       strings:   \n           $a = \"SMARTLOGS\" wide   \n           $b = \"RUNPE\" wide   \n           $c = \"b.Resources\" wide   \n           $d = \"CLIENTINFO*\" wide   \n           $e = \"Invalid Webcam Driver Download URL, or Failed to Download File!\" wide   \n           $f = \"Proactive Anti-Malware has been manually activated!\" wide   \n           $g = \"REMOVEGUARD\" wide   \n           $h = \"C0n1f8\" wide   \n           $i = \"Luminosity\" wide   \n           $j = \"LuminosityCryptoMiner\" wide   \n           $k = \"MANAGER*CLIENTDETAILS*\" wide   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 31043365
		},
		{
			"indicator": "09e1f8897d2815ec74a075761d091890e1935437",
			"description": "",
			"title": "",
			"content": "rule Imminent : RAT   \n   {   \n       meta:   \n           author = \" Kevin Breen <kevin@techanarchy.net>\"   \n           date = \"2014/04\"   \n           ref = \"http://malwareconfig.com/stats/Imminent\"   \n           maltype = \"Remote Access Trojan\"   \n           filetype = \"exe\"   \n      \n       strings:   \n           $v1a = \"DecodeProductKey\"   \n           $v1b = \"StartHTTPFlood\"   \n           $v1c = \"CodeKey\"   \n           $v1d = \"MESSAGEBOX\"   \n           $v1e = \"GetFilezillaPasswords\"   \n           $v1f = \"DataIn\"   \n           $v1g = \"UDPzSockets\"   \n           $v1h = {52 00 54 00 5F 00 52 00 43 00 44 00 41 00 54 00 41}   \n      \n           $v2a = \"<URL>k__BackingField\"   \n           $v2b = \"<RunHidden>k__BackingField\"   \n           $v2c = \"DownloadAndExecute\"   \n           $v2d = \"-CHECK & PING -n 2 127.0.0.1 & EXIT\" wide   \n           $v2e = \"england.png\" wide   \n           $v2f = \"Showed Messagebox\" wide   \n       condition:   \n           all of ($v1*) or all of ($v2*)   \n   }",
			"type": "YARA",
			"id": 31043366
		},
		{
			"indicator": "8e0dc74a720a69328221bdd508dd5a14f0eda186",
			"description": "",
			"title": "",
			"content": "rule Sub7Nation : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/Sub7Nation\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$a = \"EnableLUA /t REG_DWORD /d 0 /f\"   \n   \t\t$b = \"*A01*\"   \n   \t\t$c = \"*A02*\"   \n   \t\t$d = \"*A03*\"   \n   \t\t$e = \"*A04*\"\t   \n   \t\t$f = \"*A05*\"   \n   \t\t$g = \"*A06*\"   \n   \t\t$h = \"#@#@#\"   \n   \t\t$i = \"HostSettings\"   \n   \t\t$verSpecific1 = \"sevane.tmp\"   \n   \t\t$verSpecific2 = \"cmd_.bat\"   \n   \t\t$verSpecific3 = \"a2b7c3d7e4\"   \n   \t\t$verSpecific4 = \"cmd.dll\"   \n      \n   \t\t   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043367
		},
		{
			"indicator": "32bbb6036942987ad4a4d79937af027b46992e0a",
			"description": "",
			"title": "",
			"content": "rule SmallNet : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/SmallNet\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n   \t\t   \n   \tstrings:   \n   \t\t$split1 = \"!!<3SAFIA<3!!\"   \n   \t\t$split2 = \"!!ElMattadorDz!!\"   \n   \t\t$a1 = \"stub_2.Properties\"   \n   \t\t$a2 = \"stub.exe\" wide   \n   \t\t$a3 = \"get_CurrentDomain\"   \n      \n   \tcondition:   \n   \t\t($split1 or $split2) and (all of ($a*))   \n   }",
			"type": "YARA",
			"id": 31043368
		},
		{
			"indicator": "51bbcb91fc1125efbbb9e42f3d19c8ab0511d77d",
			"description": "",
			"title": "",
			"content": "rule unrecom : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/AAR\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$meta = \"META-INF\"   \n   \t\t$conf = \"load/ID\"   \n   \t\t$a = \"load/JarMain.class\"   \n   \t\t$b = \"load/MANIFEST.MF\"   \n           $c = \"plugins/UnrecomServer.class\"   \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043369
		},
		{
			"indicator": "7368c603a4edca02123cc5d17ee59120b1aac5f2",
			"description": "",
			"title": "",
			"content": "rule Arcom : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/Arcom\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n              \n       strings:   \n           $a1 = \"CVu3388fnek3W(3ij3fkp0930di\"   \n           $a2 = \"ZINGAWI2\"   \n           $a3 = \"clWebLightGoldenrodYellow\"   \n           $a4 = \"Ancestor for '%s' not found\" wide   \n           $a5 = \"Control-C hit\" wide   \n           $a6 = {A3 24 25 21}   \n              \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 31043370
		},
		{
			"indicator": "0d5588ac9a86c4d873f34ba82a9fd583b62f38ce",
			"description": "",
			"title": "",
			"content": "rule Greame : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/Greame\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n   \t\t   \n   \tstrings:   \n       \t\t$a = {23 23 23 23 40 23 23 23 23 E8 EE E9 F9 23 23 23 23 40 23 23 23 23}   \n               $b = {23 23 23 23 40 23 23 23 23 FA FD F0 EF F9 23 23 23 23 40 23 23 23 23}   \n               $c = \"EditSvr\"   \n               $d = \"TLoader\"   \n   \t\t\t$e = \"Stroks\"   \n               $f = \"Avenger by NhT\"   \n   \t\t\t$g = \"####@####\"   \n   \t\t\t$h = \"GREAME\"   \n   \t\t\t   \n       condition:   \n       \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043371
		},
		{
			"indicator": "44096592b9f45930f3313477a5661ea4e70e3175",
			"description": "",
			"title": "",
			"content": "rule JavaDropper : RAT   \n   {   \n       meta:   \n   \t    author = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t    date = \"2015/10\"   \n   \t    ref = \"http://malwareconfig.com/stats/AlienSpy\"   \n   \t    maltype = \"Remote Access Trojan\"   \n   \t    filetype = \"exe\"   \n      \n       strings:   \n   \t    $jar = \"META-INF/MANIFEST.MF\"   \n      \n   \t    $a1 = \"ePK\"   \n   \t    $a2 = \"kPK\"   \n      \n           $b1 = \"config.ini\"   \n           $b2 = \"password.ini\"   \n      \n           $c1 = \"stub/stub.dll\"   \n      \n           $d1 = \"c.dat\"   \n      \n       condition:   \n           $jar and (all of ($a*) or all of ($b*) or all of ($c*) or all of ($d*))   \n   }",
			"type": "YARA",
			"id": 31043372
		},
		{
			"indicator": "ab75e8252ed6d54d7928e28775e3ef1b6f90bef4",
			"description": "",
			"title": "",
			"content": "rule LostDoor : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/LostDoor\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n              \n       strings:   \n       \t$a0 = {0D 0A 2A 45 44 49 54 5F 53 45 52 56 45 52 2A 0D 0A}   \n           $a1 = \"*mlt* = %\"   \n           $a2 = \"*ip* = %\"   \n           $a3 = \"*victimo* = %\"   \n           $a4 = \"*name* = %\"   \n           $b5 = \"[START]\"   \n           $b6 = \"[DATA]\"   \n           $b7 = \"We Control Your Digital World\" wide ascii   \n           $b8 = \"RC4Initialize\" wide ascii   \n           $b9 = \"RC4Decrypt\" wide ascii   \n              \n       condition:   \n       \tall of ($a*) or all of ($b*)   \n   }",
			"type": "YARA",
			"id": 31043373
		},
		{
			"indicator": "dc2a15f52e30b5b928f5bc03f16bd87890cc46be",
			"description": "",
			"title": "",
			"content": "rule Paradox : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/Paradox\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$a = \"ParadoxRAT\"   \n   \t\t$b = \"Form1\"   \n   \t\t$c = \"StartRMCam\"   \n   \t\t$d = \"Flooders\"   \n   \t\t$e = \"SlowLaris\"   \n   \t\t$f = \"SHITEMID\"   \n   \t\t$g = \"set_Remote_Chat\"   \n      \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043374
		},
		{
			"indicator": "518de1abe4c47aa01e5110b00a1f6c659b61ffad",
			"description": "",
			"title": "",
			"content": "rule BlackNix : RAT   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/BlackNix\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n              \n       strings:   \n   \t\t$a1 = \"SETTINGS\" wide   \n   \t\t$a2 = \"Mark Adler\"   \n   \t\t$a3 = \"Random-Number-Here\"   \n   \t\t$a4 = \"RemoteShell\"   \n   \t\t$a5 = \"SystemInfo\"   \n      \n   \t   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31043375
		},
		{
			"indicator": "5d0b93f710d078d34182acf169b2b4aa530505af",
			"description": "",
			"title": "",
			"content": "rule ClientMesh : RAT   \n   {   \n       meta:   \n           author = \"Kevin Breen <kevin@techanarchy.net>\"   \n           date = \"2014/06\"   \n           ref = \"http://malwareconfig.com/stats/ClientMesh\"   \n           family = \"torct\"   \n      \n       strings:   \n           $string1 = \"machinedetails\"   \n           $string2 = \"MySettings\"   \n           $string3 = \"sendftppasswords\"   \n           $string4 = \"sendbrowserpasswords\"   \n           $string5 = \"arma2keyMass\"   \n           $string6 = \"keylogger\"   \n           $conf = {00 00 00 00 00 00 00 00 00 7E}   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 31043376
		},
		{
			"indicator": "84cad77dc1fec907643532176a1f05bb5e1878b3",
			"description": "",
			"title": "",
			"content": "rule ShadowTech   \n   {   \n   \tmeta:   \n   \t\tauthor = \" Kevin Breen <kevin@techanarchy.net>\"   \n   \t\tdate = \"2014/04\"   \n   \t\tref = \"http://malwareconfig.com/stats/ShadowTech\"   \n   \t\tmaltype = \"Remote Access Trojan\"   \n   \t\tfiletype = \"exe\"   \n      \n   \tstrings:   \n   \t\t$a = \"ShadowTech\" nocase   \n   \t\t$b = \"DownloadContainer\"   \n   \t\t$c = \"MySettings\"   \n   \t\t$d = \"System.Configuration\"   \n   \t\t$newline = \"#-@NewLine@-#\" wide   \n   \t\t$split = \"pSIL\" wide   \n   \t\t$key = \"ESIL\" wide   \n      \n   \tcondition:   \n   \t\t4 of them   \n   }",
			"type": "YARA",
			"id": 31043382
		},
		{
			"indicator": "4f1352ab889a7954372114aed22431775175c612",
			"description": "",
			"title": "",
			"content": "rule ShadowTech_2   \n   {   \n       meta:   \n           description = \"ShadowTech RAT\"   \n   \tauthor = \"botherder https://github.com/botherder\"   \n      \n       strings:   \n           $string1 = /\\#(S)trings/   \n           $string2 = /\\#(G)UID/   \n           $string3 = /\\#(B)lob/   \n           $string4 = /(S)hadowTech Rat\\.exe/   \n           $string5 = /(S)hadowTech_Rat/   \n      \n       condition:   \n           all of them   \n   }",
			"type": "YARA",
			"id": 31043383
		},
		{
			"indicator": "b4cef694b07985dc11ad02d8ed9877110a6f4edd",
			"description": "",
			"title": "",
			"content": "rule xtreme_rat : Trojan   \n   {   \n   \tmeta:   \n   \t\tauthor=\"Kevin Falcoz\"   \n   \t\tdate=\"23/02/2013\"   \n   \t\tdescription=\"Xtreme RAT\"   \n   \t   \n   \tstrings:   \n   \t\t$signature1={58 00 54 00 52 00 45 00 4D 00 45} /*X.T.R.E.M.E*/   \n   \t\t   \n   \tcondition:   \n   \t\t$signature1   \n   }",
			"type": "YARA",
			"id": 31075318
		},
		{
			"indicator": "f6fbdee49ee15dd4398f58523c0707dfe8c3db9c",
			"description": "",
			"title": "",
			"content": "rule xtreme_rat_1   \n   {    \n   \tmeta:   \n   \t\tmaltype = \"Xtreme RAT\"   \n   \t\tref = \"https://github.com/reed1713\"   \n   \t\treference = \"http://blog.trendmicro.com/trendlabs-security-intelligence/xtreme-rat-targets-israeli-government/\"   \n   \tstrings:   \n   \t\t$type=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid=\"5156\"   \n   \t\t$data=\"windows\\\\system32\\\\sethc.exe\"   \n      \n   \t\t$type1=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid1=\"4688\"   \n   \t\t$data1=\"AppData\\\\Local\\\\Temp\\\\Microsoft Word.exe\"   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31075319
		},
		{
			"indicator": "a0735cc576f24468c9a7b5f5b74c02d1f5e7e203",
			"description": "",
			"title": "",
			"content": "rule xtreme_rat_0   \n   {    \n   \tmeta:   \n   \t\tmaltype = \"Xtreme RAT\"   \n   \t\treference = \"http://blog.trendmicro.com/trendlabs-security-intelligence/xtreme-rat-targets-israeli-government/\"   \n   \tstrings:   \n   \t\t$type=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid=\"5156\"   \n   \t\t$data=\"windows\\\\system32\\\\sethc.exe\"   \n      \n   \t\t$type1=\"Microsoft-Windows-Security-Auditing\"   \n   \t\t$eventid1=\"4688\"   \n   \t\t$data1=\"AppData\\\\Local\\\\Temp\\\\Microsoft Word.exe\"   \n   \tcondition:   \n   \t\tall of them   \n   }",
			"type": "YARA",
			"id": 31075320
		},
		{
			"indicator": "82a89e9576d019255d9ab2d5ecac49786610c8d9",
			"description": "",
			"title": "",
			"content": "rule XtremeRATStrings : XtremeRAT Family   \n   {   \n       meta:   \n           description = \"XtremeRAT Identifying Strings\"   \n           author = \"Seth Hardy\"   \n           last_modified = \"2014-07-09\"   \n              \n       strings:   \n           $ = \"dqsaazere\"   \n           $ = \"-GCCLIBCYGMING-EH-TDM1-SJLJ-GTHR-MINGW32\"   \n              \n       condition:   \n          any of them   \n   }",
			"type": "YARA",
			"id": 31075321
		},
		{
			"indicator": "6be2de1a165e5aee091f13140b3a0ed9fee3b842",
			"description": "",
			"title": "",
			"content": "rule Xtreme   \n   {   \n       meta:   \n           description = \"Xtreme RAT\"   \n   \tauthor = \"botherder https://github.com/botherder\"   \n      \n       strings:   \n           $string1 = /(X)tremeKeylogger/ wide ascii   \n           $string2 = /(X)tremeRAT/ wide ascii   \n           $string3 = /(X)TREMEUPDATE/ wide ascii   \n           $string4 = /(S)TUBXTREMEINJECTED/ wide ascii   \n      \n           $unit1 = /(U)nitConfigs/ wide ascii   \n           $unit2 = /(U)nitGetServer/ wide ascii   \n           $unit3 = /(U)nitKeylogger/ wide ascii   \n           $unit4 = /(U)nitCryptString/ wide ascii   \n           $unit5 = /(U)nitInstallServer/ wide ascii   \n           $unit6 = /(U)nitInjectServer/ wide ascii   \n           $unit7 = /(U)nitBinder/ wide ascii   \n           $unit8 = /(U)nitInjectProcess/ wide ascii   \n      \n       condition:   \n           5 of them   \n   }",
			"type": "YARA",
			"id": 31075322
		}
	],
	"previous": null
}
